<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘¨æ˜“è½¯ä»¶é›†æˆç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'SimSun', sans-serif;
        }
        
        body {
            background-color: #f5f3ef;
            color: #333;
            line-height: 1.6;
            background-image: linear-gradient(to bottom, #f5f3ef 0%, #e8e4dc 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* é¡µé¢æ°´å° */
        body::before {
            content: 'é’å²›è‘£å¾·é¾™è€å¸ˆ 15166397157';
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 48px;
            color: rgba(139, 69, 19, 0.1);
            z-index: -1;
            pointer-events: none;
            white-space: nowrap;
            font-weight: bold;
            letter-spacing: 8px;
        }
        
        /* ç§»é™¤æ‰€æœ‰æ¡†å’Œè¾¹æ¡† */
        .container {
            max-width: none;
            width: 100%;
            padding: 0;
            margin: 0;
        }
          .tagline {
            text-align: center;
            font-style: italic;
            margin: 20px 5px;
            font-size: 1.1rem;
            color: #8B4513;
            padding: 0 5px;
            white-space: nowrap;
        }
        
        @media (max-width: 768px) {
            .tagline {
                font-size: 0.95rem;
                margin: 20px 2px;
                padding: 0 2px;
            }
            
            section {
                padding: 20px 8px !important;
            }
        }
        
        @media (max-width: 480px) {
            .tagline {
                font-size: 0.85rem;
                margin: 20px 1px;
                padding: 0 1px;
            }
            
            section {
                padding: 20px 5px !important;
            }
        }
        
        header {
            text-align: center;
            padding: 20px 10px;
            background-color: #2c3e50;
            color: #ecf0f1;
            width: 100%;
           height: 10vh;
            position: relative;
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 8px;
            color: #f1c40f;
        }
        
        .subtitle {
            font-size: 0.9rem;
            color: #bdc3c7;
            font-style: italic;
        }
        
        nav {
            display: flex;
            justify-content: center;
            background-color: #93B70;
            overflow-x: auto;
            white-space: nowrap;
            width: 100%;
        }
        
        .nav-select {
            padding: 12px 15px;
            background: #8B4513;
            border: 2px solid #8B4513;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
            border-radius: 4px;
            outline: none;
            text-align: center;
            text-align-last: center;
        }
        
        .nav-select:hover {
            background-color: #A0522D;
            border-color: #A0522D;
        }
        
        .nav-select:focus {
            border-color: #654321;
            box-shadow: 0 0 5px rgba(139, 69, 19, 0.5);
        }
        
        .nav-select option {
            background: #8B4513;
            color: white;
            padding: 10px;
        }
        
        .page-content {
            display: none !important;
            width: 100%;
            padding: 0;
            margin: 0;
            overflow-y: visible;
        }
        
        .page-content.active {
            display: block !important;
        }
        
        /* é¡µé¢å¯¼èˆªç®­å¤´æŒ‰é’® */
        .page-nav-arrows {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            z-index: 9998;
            width: 100%;
            pointer-events: none;
        }
        
        .page-nav-arrow {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            width: 18px !important;
            height: 24px !important;
            background: #8B4513;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            transition: all 0.3s ease;
            pointer-events: auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            padding: 0;
            min-width: 18px !important;
            max-width: 18px !important;
            line-height: 1;
            overflow: visible;
        }
        
        .page-nav-arrow:hover {
            background: #A0522D;
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .page-nav-arrow:active {
            transform: translateY(-50%) scale(0.95);
        }
        
        .page-nav-arrow:disabled {
            background: #cccccc;
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .page-nav-arrow-left {
            left: 5px;
        }
        
        .page-nav-arrow-right {
            right: 5px;
        }
        
        h2 {
            color: #2c3e50;
            padding: 15px 20px 10px;
            margin: 0;
            font-size: 1.6rem;
            background-color: rgba(255, 255, 255, 0.8);
        }
        
        /* ç®€æ´çš„å†…å®¹åŒºåŸŸï¼Œæ²¡æœ‰è¾¹æ¡† */
        .content-section {
            margin: 0;
            padding: 15px 20px;
            background-color: transparent;
            border-radius: 0;
        }
        
        .content-section h3 {
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 1.2rem;
        }
        
        .content-section p {
            color: #555;
            margin-bottom: 10px;
        }
        
        .content-section .item-number {
            display: inline-block;
            background-color: #1abc9c;
            color: white;
            width: 26px;
            height: 26px;
            text-align: center;
            line-height: 26px;
            border-radius: 50%;
            margin-right: 8px;
            font-weight: bold;
        }
        
        footer {
            text-align: center;
            padding: 15px 10px;
            color: #7f8c8d;
            font-size: 0.8rem;
            background-color: #2c3e50;
            color: #ecf0f1;
            margin-top: 20px;
            width: 100%;
          
        }
        
        /* ç™»å½•é¡µé¢æ ·å¼ */
        .login-wrapper {
            max-width: 500px;
            margin: 20px auto;
            padding: 20px;
        }
        
        .login-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .login-tab {
            flex: 1;
            padding: 12px;
            background: #f5f5f5;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            color: #666;
            transition: all 0.3s;
        }
        
        .login-tab.active {
            background: #8B4513;
            color: white;
        }
        
        .login-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .login-section h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 1.2rem;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            font-size: 14px;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #8B4513;
        }
        
        .btn-primary {
            width: 100%;
            padding: 12px;
            background: #8B4513;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s;
        }
        
        .btn-primary:hover {
            background: #A0522D;
        }
        
        .btn-secondary {
            padding: 10px 15px;
            background: #95a5a6;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
        }
        
        .btn-secondary:hover {
            background: #7f8c8d;
        }
        
        .btn-secondary:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .btn-third-party {
            flex: 1;
            min-width: 150px;
            padding: 12px;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: opacity 0.3s;
        }
        
        .btn-third-party:hover {
            opacity: 0.9;
        }
        
        #loginMessage {
            text-align: center;
            font-size: 14px;
        }
        
        #loginMessage.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        #loginMessage.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        @media (max-width: 480px) {
            .login-wrapper {
                padding: 10px;
            }
            
            .login-section {
                padding: 15px;
            }
            
            .btn-third-party {
                width: 100%;
                margin-bottom: 10px;
            }
        }
        
        /* èŠå¤©ç»„ä»¶æ ·å¼ - å®Œå…¨å›ºå®šè¾“å…¥æ¡†å¤§å° */
        .chat-wrapper {
            width: 100%;
            height: calc((100vh - 120px) * 1.5); /* åŠ¨æ€é«˜åº¦ï¼Œå‡å»å¤´éƒ¨å’Œé¡µè„šï¼Œä¹˜ä»¥1.5å€ */
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 8px;
            margin: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .chat-header {
            background:#8B4513 ;linear-gradient(135deg, #1a6dff, #0d5bdd);
            color: white;
            padding: 12px 15px;
            text-align: center;
            flex-shrink: 0;
        }
        .headert {
            background:#8B4513;
            color: white;
            padding: 12px 15px;
            text-align: center;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .headert nav {
            text-align: center;
            margin-top: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        .chat-header h1 {
            font-size: 1.2rem;
            margin-bottom: 4px;
            color: white;
        }
        
        .chat-header p {
            opacity: 0.9;
            font-size: 0.85rem;
        }
        
        .chat-container {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
            background: #fafcff;
        }
        
        .message {
            max-width: 85%;
            padding: 10px 14px;
            border-radius: 16px;
            line-height: 1.5;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: pre-wrap;
            animation: fadeIn 0.3s ease;
        }
        
        .user-message {
            align-self: flex-end;
            background: linear-gradient(135deg, #1a6dff, #0d5bdd);
            color: white;
            border-bottom-right-radius: 4px;
        }
        
        .bot-message {
            align-self: flex-start;
            background: white;
            color: #333;
            border: 1px solid #e1eeff;
            border-bottom-left-radius: 4px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
        }
        
        .thinking {
            color: #666;
            font-style: italic;
            align-self: center;
            padding: 8px;
            font-size: 0.9rem;
        }
        
        .chat-input-area {
            padding: 12px 15px;
            border-top: 1px solid #eef5ff;
            background: white;
            display: flex !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
            gap: 8px;
            align-items: center !important;
            justify-content: flex-start !important;
            flex-shrink: 0;
            width: 100%;
            box-sizing: border-box;
        }
        
        /* å®Œå…¨å›ºå®šè¾“å…¥æ¡†å¤§å° - ä½¿ç”¨å›ºå®šåƒç´ å€¼ */
        #messageInput {
            flex: 1;
            padding: 14px 16px;
            border: 2px solid #e1eaff;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            background: #f8fbff;
            height: 50px !important; /* å›ºå®šé«˜åº¦ */
            min-height: 50px !important; /* æœ€å°é«˜åº¦ */
            max-height: 50px !important; /* æœ€å¤§é«˜åº¦ */
            resize: none !important; /* ç¦æ­¢è°ƒæ•´å¤§å° */
            line-height: 22px;
            box-sizing: border-box !important; /* ç¡®ä¿paddingåŒ…å«åœ¨é«˜åº¦å†… */
            display: block !important;
            margin: 0 !important;
        }
        
        #messageInput:focus {
            border-color:#3299CC;
            background: white;
            box-shadow: 0 0 0 3px rgba(26, 109, 255, 0.1);
        }
        
        /* å®Œå…¨å›ºå®šå‘é€æŒ‰é’®å¤§å° */
        #sendButton {
            background:#8B4513;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 0 24px !important;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            height: 50px !important; /* å›ºå®šé«˜åº¦ï¼Œä¸è¾“å…¥æ¡†ä¸€è‡´ */
            min-height: 50px !important; /* æœ€å°é«˜åº¦ */
            max-height: 50px !important; /* æœ€å¤§é«˜åº¦ */
            flex-shrink: 0 !important; /* é˜²æ­¢æŒ‰é’®ç¼©å° */
            min-width: 120px !important; /* æœ€å°å®½åº¦ï¼Œå¢åŠ ä¸¤ä¸ªå­—çš„é•¿åº¦ */
            transition: all 0.2s;
            box-sizing: border-box !important; /* ç¡®ä¿paddingåŒ…å«åœ¨é«˜åº¦å†… */
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            margin: 0 !important;
        }
        
        #sendButton:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(26, 109, 255, 0.3);
           colour: #8B4513;
        }
        
        #sendButton:disabled {
            background: #8B4513;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .chat-status-bar {
            padding: 8px 12px;
            background: white;
            border-top: 1px solid #eef5ff;
            color: #666;
            font-size: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background: #1a6dff;
            animation: blink 1s infinite;
            vertical-align: middle;
            margin-left: 2px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* æ–°åŠ å…¥çš„é¡µé¢æ ·å¼ - å®Œå…¨è‡ªç”±ï¼Œæ— é•¿åº¦é™åˆ¶ */
        .custom-page {
            width: 100%;
            padding: 20px;
            background-color: transparent;
        }
        
        /* ç¤ºä¾‹é•¿é¡µé¢å†…å®¹ */
        .long-content {
            width: 100%;
            padding: 20px;
            background-color: transparent;
        }
        
        .long-content h3 {
            color: #2c3e50;
            margin: 20px 0 10px;
            font-size: 1.4rem;
        }
        
        .long-content p {
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        /* ç½‘æ ¼å¸ƒå±€ç¤ºä¾‹ */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .grid-item {
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        /* è¡¨æ ¼ç¤ºä¾‹ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .data-table th {
            background-color: #2c3e50;
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .data-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #eee;
        }
        
        .data-table tr:hover {
            background-color: #f5f5f5;
        }
        
        /* å›¾ç‰‡å®¹å™¨ */
        .image-container {
            width: 100%;
            margin: 20px 0;
            text-align: center;
        }
        
        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .chat-wrapper {
                height: calc(100vh - 180px);
                margin: 8px;
            }
            
            .nav-select {
                padding: 10px 12px;
                font-size: 0.85rem;
                min-width: 150px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            h2 {
                font-size: 1.4rem;
                padding: 12px 15px 8px;
            }
            
            .chat-header {
                padding: 10px 12px;
            }
            
            .chat-header h1 {
                font-size: 1.1rem;
            }
            
            #messageInput {
                height: 42px !important;
                min-height: 42px !important;
                max-height: 42px !important;
                padding: 10px 12px;
                font-size: 0.95rem;
                background:colour: #3299CC;
            }
            
            #sendButton {
                height: 42px !important;
                min-height: 42px !important;
                max-height: 42px !important;
                padding: 0 16px !important;
                font-size: 0.95rem;
                min-width: 65px !important;
                colour: #3299CC;
            }
            
            .grid-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .chat-wrapper {
                height: calc(100vh - 160px);
                margin: 5px;
            }
            
            .nav-select {
                padding: 8px 10px;
                font-size: 0.8rem;
                min-width: 120px;
            }
            
            h1 {
                font-size: 1.4rem;
            }
            
            h2 {
                font-size: 1.2rem;
                padding: 10px 12px 6px;
            }
            
            .grid-container {
                grid-template-columns: 1fr;
                gap: 12px;
            }
        }
/* æ·»åŠ è¿™äº›æ ·å¼åˆ°æ‚¨çš„CSSæ–‡ä»¶æœ«å°¾ï¼Œè¦†ç›–æ‰€æœ‰å¯èƒ½çš„è¾¹æ¡† */

/* 1. é¦–å…ˆç¡®ä¿bodyå’Œhtmlæ²¡æœ‰ä»»ä½•è¾¹æ¡†æˆ–è¾¹è· */
body {
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    outline: none !important;
}


/* 17. ç¡®ä¿æ‰€æœ‰è¾¹æ¡†ç›¸å…³å±æ€§éƒ½è¢«è¦†ç›– */
* {
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    border-left: none !important;
}


/* 18. ç§»é™¤å¯èƒ½çš„å†…åµŒæ ·å¼è¾¹æ¡† */
*[style*="border"] {
    border: none !important;
}

/* 19. ç¡®ä¿æ²¡æœ‰ä»»ä½•æ–‡æœ¬è£…é¥°çº¿ */
a, u, ins {
    text-decoration: none !important;
}

/* 20. æœ€ç»ˆé”å®š - ç¡®ä¿é¡µé¢å®Œå…¨æ— è¾¹æ¡† */
body::before, body::after,
.container::before, .container::after {
    display: none !important;
    content: none !important;
}

        /* å¼€åœºè§†é¢‘æ ·å¼ */
        #opening-video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            overflow: hidden;
            background-color: #000;
        }

        #opening-video-container.hidden {
            display: none;
        }

        #opening-video-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
            transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
        }

        #opening-video-bg.hidden {
            opacity: 0 !important;
            visibility: hidden !important;
            pointer-events: none !important;
            display: none !important;
        }

        #opening-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 2;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-in, visibility 0.5s ease-in;
            background-color: #000;
        }

        #opening-video.playing {
            opacity: 1 !important;
            visibility: visible !important;
            z-index: 3;
        }

        #enter-button {
            position: absolute;
            z-index: 100000;
            pointer-events: auto !important;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(139, 111, 71, 0.9), rgba(107, 85, 55, 0.9));
            color: white;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 60px;
            padding: 18px 35px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4), 
                        0 0 0 0 rgba(139, 111, 71, 0.4),
                        inset 0 1px 0 rgba(255, 255, 255, 0.2);
            letter-spacing: 3px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            white-space: nowrap;
            width: auto;
            min-width: auto;
        }

        #enter-button:hover {
            background: linear-gradient(135deg, rgba(139, 111, 71, 1), rgba(107, 85, 55, 1));
            transform: translate(-50%, -50%) scale(1.08);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5), 
                        0 0 0 4px rgba(139, 111, 71, 0.3),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            letter-spacing: 4px;
        }

        #enter-button:active {
            transform: translate(-50%, -50%) scale(1.02);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        #enter-button.hidden {
            opacity: 0;
            pointer-events: none;
            transform: translate(-50%, -50%) scale(0.8);
        }

        #main-content {
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-in, visibility 0.5s ease-in;
            pointer-events: none;
        }

        #main-content.visible {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
    </style>
    
    <!-- æˆåŠŸç‰ˆæœ¬.htmlæ‰€éœ€çš„å¤–éƒ¨åº“ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å†œå†åº“åŠ è½½ï¼šä¼˜å…ˆæœ¬åœ°æ–‡ä»¶ï¼Œå¤±è´¥åå°è¯•CDNï¼ˆé€‚ç”¨äºæ‰“åŒ…è½¯ä»¶ï¼‰ -->
    <script>
        (function() {
            var isPackaged = window.location.protocol === 'file:' || 
                           window.navigator.userAgent.includes('Electron') ||
                           window.navigator.userAgent.includes('Pake') ||
                           !window.location.hostname || 
                           window.location.hostname === 'localhost' && window.location.port === '';
            
            console.log('æ£€æµ‹è¿è¡Œç¯å¢ƒ:', {
                protocol: window.location.protocol,
                hostname: window.location.hostname,
                port: window.location.port,
                userAgent: window.navigator.userAgent,
                isPackaged: isPackaged
            });
            
            // å°è¯•åŠ è½½æœ¬åœ°æ–‡ä»¶ï¼ˆé€‚ç”¨äºæ‰“åŒ…è½¯ä»¶ï¼‰
            var tryLocal = function() {
                var localScript = document.createElement('script');
                // å°è¯•å¤šä¸ªå¯èƒ½çš„è·¯å¾„
                var paths = [
                    'lunar.min.js',
                    './lunar.min.js',
                    'lunar.js',
                    './lunar.js',
                    'libs/lunar.min.js',
                    './libs/lunar.min.js'
                ];
                var currentPathIndex = 0;
                
                var tryNextPath = function() {
                    if(currentPathIndex >= paths.length) {
                        console.warn('æ‰€æœ‰æœ¬åœ°è·¯å¾„éƒ½å¤±è´¥ï¼Œå°è¯•CDN');
                        tryCDN();
                        return;
                    }
                    
                    localScript = document.createElement('script');
                    localScript.src = paths[currentPathIndex];
                    localScript.onload = function() {
                        console.log('æœ¬åœ°æ–‡ä»¶åŠ è½½æˆåŠŸ:', paths[currentPathIndex]);
                        if(typeof Solar !== 'undefined') {
                            window.lunarLibraryLoaded = true;
                            console.log('Solarå¯¹è±¡å·²å¯ç”¨');
                        } else {
                            console.warn('æœ¬åœ°æ–‡ä»¶åŠ è½½å®Œæˆä½†Solarå¯¹è±¡æœªå®šä¹‰');
                            // ç»§ç»­å°è¯•ä¸‹ä¸€ä¸ªè·¯å¾„
                            currentPathIndex++;
                            tryNextPath();
                        }
                    };
                    localScript.onerror = function() {
                        console.warn('æœ¬åœ°æ–‡ä»¶åŠ è½½å¤±è´¥:', paths[currentPathIndex]);
                        currentPathIndex++;
                        tryNextPath();
                    };
                    document.head.appendChild(localScript);
                };
                
                tryNextPath();
            };
            
            // å°è¯•CDNï¼ˆé€‚ç”¨äºç½‘ç«™ï¼‰
            var tryCDN = function() {
                var cdnScript = document.createElement('script');
                cdnScript.src = 'https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.min.js';
                cdnScript.onload = function() {
                    console.log('CDNåŠ è½½æˆåŠŸ');
                    if(typeof Solar !== 'undefined') {
                        window.lunarLibraryLoaded = true;
                        console.log('Solarå¯¹è±¡å·²å¯ç”¨');
                    } else {
                        console.warn('CDNåŠ è½½å®Œæˆä½†Solarå¯¹è±¡æœªå®šä¹‰');
                        // å°è¯•å¤‡ç”¨CDN
                        tryBackupCDN();
                    }
                };
                cdnScript.onerror = function() {
                    console.error('CDNåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨CDN');
                    tryBackupCDN();
                };
                document.head.appendChild(cdnScript);
            };
            
            // å°è¯•å¤‡ç”¨CDN
            var tryBackupCDN = function() {
                var backupScript = document.createElement('script');
                backupScript.src = 'https://unpkg.com/lunar-javascript@1.6.12/lunar.min.js';
                backupScript.onload = function() {
                    console.log('å¤‡ç”¨CDNåŠ è½½æˆåŠŸ');
                    if(typeof Solar !== 'undefined') {
                        window.lunarLibraryLoaded = true;
                    }
                };
                backupScript.onerror = function() {
                    console.error('æ‰€æœ‰åŠ è½½æ–¹æ¡ˆéƒ½å¤±è´¥ï¼Œè¯·ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸æˆ–æä¾›æœ¬åœ°lunar.min.jsæ–‡ä»¶');
                    alert('å†œå†åº“åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–æä¾›æœ¬åœ°lunar.min.jsæ–‡ä»¶ã€‚');
                };
                document.head.appendChild(backupScript);
            };
            
            // æ ¹æ®ç¯å¢ƒé€‰æ‹©åŠ è½½ç­–ç•¥
            if(isPackaged) {
                console.log('æ£€æµ‹åˆ°æ‰“åŒ…ç¯å¢ƒï¼Œä¼˜å…ˆåŠ è½½æœ¬åœ°æ–‡ä»¶');
                // æ‰“åŒ…ç¯å¢ƒï¼šå…ˆå°è¯•æœ¬åœ°æ–‡ä»¶ï¼Œå¦‚æœå¤±è´¥å†å°è¯•CDNï¼ˆä½†é€šå¸¸æ‰“åŒ…ç¯å¢ƒæ— æ³•è®¿é—®ç½‘ç»œï¼‰
                tryLocal();
            } else {
                console.log('æ£€æµ‹åˆ°ç½‘ç«™ç¯å¢ƒï¼Œä¼˜å…ˆåŠ è½½CDN');
                // ç½‘ç«™ç¯å¢ƒï¼šå…ˆå°è¯•CDNï¼Œå¦‚æœå¤±è´¥å†å°è¯•æœ¬åœ°æ–‡ä»¶
                tryCDN();
            }
            
            // è®¾ç½®è¶…æ—¶æ£€æµ‹ï¼šå¦‚æœ10ç§’åSolarä»æœªåŠ è½½ï¼Œæ˜¾ç¤ºæç¤º
            setTimeout(function() {
                if(typeof Solar === 'undefined') {
                    console.error('å†œå†åº“åŠ è½½è¶…æ—¶');
                    var errorMsg = 'å†œå†åº“åŠ è½½è¶…æ—¶ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½æ— æ³•ä½¿ç”¨ã€‚\n\n';
                    if(isPackaged) {
                        errorMsg += 'æ‰“åŒ…è½¯ä»¶ç¯å¢ƒæ£€æµ‹åˆ°ï¼Œè¯·ç¡®ä¿ï¼š\n';
                        errorMsg += '1. ä¸‹è½½ lunar.min.js æ–‡ä»¶\n';
                        errorMsg += '   è®¿é—®ï¼šhttps://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.min.js\n';
                        errorMsg += '2. å°†æ–‡ä»¶ä¿å­˜ä¸º lunar.min.js\n';
                        errorMsg += '3. å°†æ–‡ä»¶æ”¾åœ¨ä¸ index.html ç›¸åŒçš„ç›®å½•ä¸‹\n';
                        errorMsg += '4. é‡æ–°æ‰“åŒ…åº”ç”¨\n';
                    } else {
                        errorMsg += 'è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢ã€‚';
                    }
                    alert(errorMsg);
                }
            }, 10000);
        })();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <!-- æˆåŠŸç‰ˆæœ¬.htmlçš„CSSæ ·å¼ -->
    <style>
        /* === ç´«å¾®æ–—æ•°æ’ç›˜æ ·å¼ === */
        #ziwei {
            background: #f0f2f5;
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
            font-size: 12px;
            color: #333;
        }

        #ziwei .control-bar {
            background: #fff;
            padding: 8px 15px;
            border-bottom: 1px solid #dcdfe6;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 50;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        #ziwei select, #ziwei input {
            border: 1px solid #dcdfe6;
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 12px;
        }
        
        #ziwei .chart-container {
            max-width: 1100px;
            margin: 10px auto;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, minmax(140px, 150px));
            gap: 1px;
            background: #999;
            border: 1px solid #999;
            user-select: none;
        }

        #ziwei .palace {
            background: #ffffff;
            position: relative;
            display: flex;
            flex-direction: column;
            padding: 2px;
            overflow: hidden;
            cursor: pointer;
        }
        
        #ziwei .palace.active {
            background: #fffef0;
            box-shadow: inset 0 0 0 2px #E60000;
            z-index: 10;
        }
        #ziwei .palace.sanfang {
            background: #f0fdf4;
            position: relative;
        }
        #ziwei .palace.sanfang::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px dashed #16a34a;
            pointer-events: none;
            z-index: 1;
        }
        #ziwei .palace.duigong {
            background: #fef2f2;
            position: relative;
        }
        #ziwei .palace.duigong::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px dashed #dc2626;
            pointer-events: none;
            z-index: 1;
        }

        #ziwei .center-zone {
            grid-column: 2 / 4;
            grid-row: 2 / 4;
            background: #fffdf5;
            display: flex;
            flex-direction: column;
            padding: 8px;
            position: relative;
            overflow-y: auto;
            overflow-x: hidden;
            min-height: 0;
        }

        #ziwei .star-box-main {
            position: absolute;
            left: 2px;
            top: 16px;
            bottom: 20px;
            right: 2px;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            align-content: flex-start;
            gap: 2px;
        }
        #ziwei .star-box-sub {
            position: absolute;
            left: 2px;
            top: 16px;
            bottom: 20px;
            right: 2px;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            align-content: flex-start;
            gap: 0;
            line-height: 1.2;
        }
        
        /* æ˜Ÿå®¿åˆ†ç»„å®¹å™¨ - ä¸å†éœ€è¦ï¼Œä½†ä¿ç•™æ ·å¼ä»¥é˜²ä¸‡ä¸€ */
        #ziwei .star-group {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            gap: 0;
            align-items: flex-start;
        }
        
        #ziwei .star {
            position: relative;
            display: flex;
            flex-direction: column;
            line-height: 1;
            margin: 0;
            padding: 0;
        }
        #ziwei .star-char {
            display: block;
            line-height: 1;
            margin: 0;
            padding: 0;
        }
        #ziwei .s-jia {
            font-size: 12px;
            font-weight: 900;
            color: #E60000;
            letter-spacing: 0;
        }
        #ziwei .s-ji {
            font-size: 12px;
            font-weight: bold;
            color: #16a34a;
            letter-spacing: 0;
        }
        #ziwei .s-sha {
            font-size: 12px;
            font-weight: bold;
            color: #9333ea;
            letter-spacing: 0;
        }
        #ziwei .s-yi {
            font-size: 12px;
            color: #475569;
            letter-spacing: 0;
        }
        #ziwei .s-bing {
            font-size: 12px;
            color: #94a3b8;
            letter-spacing: 0;
        }
        #ziwei .s-flow {
            font-size: 12px;
            font-weight: bold;
            color: #2563eb;
            letter-spacing: 0;
        }

        #ziwei .hua {
            font-size: 9px;
            color: white;
            border-radius: 2px;
            padding: 1px 2px;
            margin-left: 1px;
            vertical-align: top;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            line-height: 1;
            transform: scale(0.9);
        }
        #ziwei .h-lu {
            background: #16a34a;
        }
        #ziwei .h-quan {
            background: #2563eb;
        }
        #ziwei .h-ke {
            background: #9333ea;
        }
        #ziwei .h-ji {
            background: #dc2626;
        }
        #ziwei .h-tag {
            font-size: 8px;
            opacity: 0.9;
            display: block !important;
            line-height: 1 !important;
            margin: 0;
            padding: 0;
            white-space: nowrap;
        }
        #ziwei .h-char {
            font-size: 9px;
            display: block !important;
            line-height: 1 !important;
            margin: 0;
            padding: 0;
            white-space: nowrap;
        }

        #ziwei .p-footer {
            margin-top: auto;
            border-top: 1px dashed #e0e0e0;
            padding-top: 2px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        #ziwei .p-name {
            background: #ff0000;
            color: #fff;
            font-weight: bold;
            font-size: 12px;
            padding: 1px 4px;
            border-radius: 1px;
            position: absolute;
            right: 2px;
            bottom: 2px;
            z-index: 5;
        }
        #ziwei .p-ganzhi {
            font-family: "KaiTi";
            font-weight: bold;
            font-size: 11px;
            color: #555;
            margin-top: auto;
        }
        
        #ziwei .limit-bar {
            position: absolute;
            bottom: 22px;
            left: 0;
            width: 100%;
            display: flex;
            gap: 1px;
            padding: 0 2px;
            pointer-events: none;
            flex-wrap: wrap;
        }
        #ziwei .limit-tag {
            font-size: 9px;
            color: #000000;
            padding: 0;
            border-radius: 0;
            line-height: 1.2;
            background: none !important;
            border: none !important;
        }

        #ziwei .dir-label {
            position: absolute;
            color: #ddd;
            font-size: 10px;
            pointer-events: none;
            font-weight: bold;
        }
        #ziwei .dir-n {
            top: 2px;
            left: 50%;
            transform: translateX(-50%);
        }
        #ziwei .dir-s {
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
        }
        #ziwei .dir-e {
            top: 50%;
            right: 2px;
            transform: translateY(-50%);
            width: 1em;
        }
        #ziwei .dir-w {
            top: 50%;
            left: 2px;
            transform: translateY(-50%);
            width: 1em;
        }
        
        #ziwei .rel-label {
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
            color: #d97706;
            background: #fff7ed;
            padding: 0 2px;
        }
        
        /* æ–‡å¢¨å¤©æœºæ ·å¼ï¼šå®«ä½åº•éƒ¨æ—¥æœŸå¹´é¾„ä¿¡æ¯ */
        #ziwei .p-dates {
            position: absolute;
            bottom: 18px;
            left: 2px;
            right: 2px;
            font-size: 8px;
            line-height: 1.2;
            color: #666;
            display: flex;
            flex-direction: column;
            gap: 1px;
        }

        #ziwei .tool-box {
            max-width: 1100px;
            margin: 20px auto;
            background: #fff;
            border: 1px solid #e4e7ed;
            padding: 15px;
        }
        #ziwei .table-wrap {
            overflow-x: auto;
            max-height: 500px;
            margin-top: 10px;
            border: 1px solid #eee;
        }
        #ziwei table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        #ziwei th, #ziwei td {
            border: 1px solid #eee;
            padding: 6px 8px;
            text-align: left;
            white-space: nowrap;
        }
        #ziwei th {
            background: #f5f7fa;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        #ziwei tr:hover {
            background: #f9fafb;
        }
    </style>
</head>
<body>
    <!-- å¼€åœºè§†é¢‘å®¹å™¨ -->
    <div id="opening-video-container">
        <video id="opening-video-bg" autoplay muted loop playsinline>
            <source src="å¼€æœºåŠ¨æ¼«.mp4" type="video/mp4">
        </video>
        <button id="enter-button">ç‚¹å‡»è¿›å…¥</button>
        <video id="opening-video" playsinline>
            <source src="å¼€æœºåŠ¨æ¼«.mp4" type="video/mp4">
            æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
        </video>
    </div>

    <!-- ä¸»è¦å†…å®¹å®¹å™¨ -->
    <div id="main-content">
    
      <div class="headert">  ä¼ æ‰¿æ˜“ç»æ–‡åŒ– Â· æ­£æœ¬æ¸…æº Â· å¹¿æ”¶é—¨å¾’<br>é’å²›è‘£å¾·é¾™è€å¸ˆåŠ©ç†ç”µè¯ 15166397157

        <nav>
            <select id="pageSelector" class="nav-select">
                <option value="statemena" selected>é¡µé¢ä¸€ï¼šæ˜“ç»æ’ç›˜åˆ†æ</option>
                <option value="divination">é¡µé¢äºŒï¼šæ˜“ç»å­¦ä¹ åŠ©æ‰‹</option>
                <option value="divinatiob">é¡µé¢ä¸‰ï¼šæ˜“ç»ç²¾å“è¯¾ç¨‹</option>
                <option value="custom2">é¡µé¢å››ï¼šæ˜“ç»äººç”Ÿè§‚/ä»·å€¼è§‚</option>
                <option value="statemenc">é¡µé¢äº”ï¼šæ˜“ç»æ–‡åŒ–ä¼ æ‰¿</option>
                <option value="ziwei">é¡µé¢å…­ï¼šç´«å¾®æ–—æ•°æ’ç›˜</option>
                <option value="paihangbang">æ’è¡Œæ¦œ</option>
                <option value="qunliao">ç¾¤èŠ</option>
                <option value="recharge">å……å€¼ä¸­å¿ƒ</option>
                <option value="login">ç™»å½•/æ³¨å†Œ</option>
            </select>
        </nav></div>
        <div class="tagline">
 
        </div>

        <!-- å‘¨æ˜“æ’ç›˜é¡µé¢ -->
        <section id="divination" class="page-content ">
            <div class="chat-wrapper">
                <div class="chat-header">
                    <h1>è‘£å¾·é¾™è€å¸ˆå‘¨æ˜“å°åŠ©æ‰‹</h1>
                </div>
                
                <div class="chat-container" id="chatBox">
                    <div class="message bot-message">
æ‚¨å¥½ï¼æˆ‘æ˜¯è‘£å¾·é¾™è€å¸ˆå‘¨æ˜“å°åŠ©æ‰‹ï¼Œæˆ‘èåˆäº†å¤§é‡å¤ç±å’Œç°ä»£çŸ¥è¯†ï¼Œæ‚¨æœ‰å‘¨æ˜“åŠä¼ ç»Ÿå›½å­¦ç­‰æ–¹é¢çš„å›°æ‰°å¯ä»¥æ‰¾æˆ‘ã€‚
                    </div>
                </div>
                
                <div class="chat-status-bar">
                    <div id="status">çŠ¶æ€: ç­‰å¾…è¾“å…¥</div>
                    <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                        <div id="balanceDisplay" style="color: #667eea; font-weight: bold; display: none;">
                            ä½™é¢: Â¥<span id="chatBalance">0.00</span> | å¯ç”¨: <span id="chatAvailableTimes">0</span>æ¬¡
                            <button onclick="switchToRecharge()" style="margin-left: 10px; padding: 4px 10px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">å……å€¼</button>
                        </div>
                        <div id="usageCount" style="color: #8b6f47; font-weight: bold;">ä»Šæ—¥å‰©ä½™: <span id="dailyRemaining">7</span>æ¬¡ | æœ¬å‘¨å‰©ä½™: <span id="weeklyRemaining">21</span>æ¬¡</div>
                        <div id="connectionStatus">ğŸŸ¢ å°±ç»ª</div>
                    </div>
                </div>
                
                <div class="chat-input-area">
                    <input type="text" id="messageInput" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..." autocomplete="off">
                    <button id="sendButton" onclick="sendMessage()">å‘é€</button>
                </div>
            </div>
        </section>
         <!-- æ˜“ç»ç²¾å“è¯¾é¡µé¢ -->
        <section id="paihangbang" class="page-content">
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ°åŒºç­›é€‰æ’åæ¦œå•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .filters {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #eaeaea;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .filter-group label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95rem;
        }
        
        select, input {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            background: white;
            transition: border-color 0.3s;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .reset-btn {
            padding: 10px 20px;
            background: #95a5a6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            margin-left: auto;
        }
        
        .reset-btn:hover {
            background: #7f8c8d;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            padding: 15px 30px;
            background: #f8f9fa;
            font-size: 0.95rem;
            color: #555;
            border-bottom: 1px solid #eaeaea;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .stat-value {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .ranking-list {
            padding: 0;
        }
        
        .ranking-item {
            border-bottom: 1px solid #eee;
            transition: background-color 0.2s;
        }
        
        .ranking-item:hover {
            background-color: #f9f9f9;
        }
        
        .basic-info {
            display: flex;
            align-items: center;
            padding: 18px 30px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .basic-info:hover {
            background-color: #f0f7ff;
        }
        
        .rank {
            width: 50px;
            font-weight: 800;
            font-size: 1.4rem;
            color: #3498db;
            text-align: center;
        }
        
        .name {
            width: 180px;
            font-weight: 600;
            font-size: 1.1rem;
            color: #2c3e50;
        }
        
        .gender {
            width: 80px;
            text-align: center;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .male {
            background-color: #e3f2fd;
            color: #1565c0;
        }
        
        .female {
            background-color: #fce4ec;
            color: #c2185b;
        }
        
        .phone {
            flex: 1;
            font-family: monospace;
            font-size: 1.05rem;
            color: #555;
        }
        
        .expand-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s, background 0.3s;
            font-weight: bold;
            color: #666;
            font-size: 1.2rem;
        }
        
        .expand-btn:hover {
            background: #e0e0e0;
        }
        
        .expanded .expand-btn {
            transform: rotate(180deg);
            background: #3498db;
            color: white;
        }
        
        .detail-info {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
            background: #f8fafc;
        }
        
        .expanded .detail-info {
            max-height: 300px;
        }
        
        .detail-content {
            padding: 25px 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .detail-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .detail-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0f0f0;
            font-size: 1.1rem;
        }
        
        .province {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(to right, #e3f2fd, #bbdefb);
            color: #1565c0;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 5px;
        }
        
        .intro {
            color: #555;
            line-height: 1.7;
        }
        
        .no-results {
            text-align: center;
            padding: 50px 30px;
            color: #95a5a6;
            font-size: 1.1rem;
        }
        
        .no-results p {
            margin-top: 10px;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 0;
                box-shadow: none;
            }
            
            .filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .reset-btn {
                margin-left: 0;
                margin-top: 10px;
            }
            
            .basic-info {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .rank, .name, .gender, .phone {
                width: auto;
                flex: 1;
                min-width: calc(50% - 15px);
            }
            
            .expand-btn {
                order: 5;
                margin-left: auto;
            }
            
            .detail-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† ä¿¡æ¯å’¨è¯¢æ¦œ</h1>

        </div>
        
        <div class="filters">
            <div class="filter-group">
                <label for="provinceFilter">ç­›é€‰åœ°åŒºï¼š</label>
                <select id="provinceFilter">
                    <option value="all">å…¨éƒ¨åœ°åŒº</option>
                    <option value="åŒ—äº¬å¸‚">åŒ—äº¬å¸‚</option>
                    <option value="ä¸Šæµ·å¸‚">ä¸Šæµ·å¸‚</option>
                    <option value="å¹¿ä¸œçœ">å¹¿ä¸œçœ</option>
                    <option value="æµ™æ±Ÿçœ">æµ™æ±Ÿçœ</option>
                    <option value="æ±Ÿè‹çœ">æ±Ÿè‹çœ</option>
                    <option value="å››å·çœ">å››å·çœ</option>
                    <option value="æ¹–åŒ—çœ">æ¹–åŒ—çœ</option>
                    <option value="é™•è¥¿çœ">é™•è¥¿çœ</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="genderFilter">ç­›é€‰æ€§åˆ«ï¼š</label>
                <select id="genderFilter">
                    <option value="all">å…¨éƒ¨æ€§åˆ«</option>
                    <option value="ç”·">ç”·æ€§</option>
                    <option value="å¥³">å¥³æ€§</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="nameSearch">æœç´¢å§“åï¼š</label>
                <input type="text" id="nameSearch" placeholder="è¾“å…¥å§“åå…³é”®è¯...">
            </div>
            
            <button class="reset-btn" id="resetFilters">é‡ç½®ç­›é€‰</button>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <span>å½“å‰æ˜¾ç¤ºï¼š</span>
                <span class="stat-value" id="currentCount">0</span>
                <span>äºº</span>
            </div>
            <div class="stat-item">
                <span>æ€»äººæ•°ï¼š</span>
                <span class="stat-value" id="totalCount">0</span>
                <span>äºº</span>
            </div>
            <div class="stat-item">
                <span>å½“å‰åœ°åŒºï¼š</span>
                <span class="stat-value" id="currentRegion">å…¨éƒ¨åœ°åŒº</span>
            </div>
        </div>
        
        <div class="ranking-list" id="rankingList">
            <!-- æ’åæ¡ç›®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <!-- ç”¨æˆ·ç”³æŠ¥åŒºåŸŸ -->
        <div id="applicationSection" style="margin: 20px 30px; padding: 25px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: none;">
            <h2 style="margin-bottom: 20px; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">ğŸ“ ä¿¡æ¯ç”³æŠ¥</h2>
            
            <!-- æœªç™»å½•æç¤º -->
            <div id="applicationNotLogin" style="display: none; padding: 20px; background: #fff3cd; border-radius: 6px; border-left: 4px solid #ffc107;">
                <p style="margin: 0; color: #856404;">è¯·å…ˆç™»å½•åå†è¿›è¡Œç”³æŠ¥</p>
            </div>
            
            <!-- å·²ç”³æŠ¥çŠ¶æ€æ˜¾ç¤º -->
            <div id="applicationStatus" style="display: none; padding: 20px; background: #f8f9fa; border-radius: 6px; margin-bottom: 20px;">
                <h3 style="margin-top: 0; color: #2c3e50;">ç”³æŠ¥çŠ¶æ€</h3>
                <div id="applicationStatusContent"></div>
            </div>
            
            <!-- ç”³æŠ¥è¡¨å• -->
            <form id="applicationForm" style="display: none;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label for="applyName" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">å§“å <span style="color: #e74c3c;">*</span></label>
                        <input type="text" id="applyName" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                    </div>
                    
                    <div class="form-group">
                        <label for="applyGender" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">æ€§åˆ« <span style="color: #e74c3c;">*</span></label>
                        <select id="applyGender" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                            <option value="">è¯·é€‰æ‹©</option>
                            <option value="ç”·">ç”·</option>
                            <option value="å¥³">å¥³</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="applyPhone" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">ç”µè¯ <span style="color: #e74c3c;">*</span></label>
                        <input type="tel" id="applyPhone" required placeholder="11ä½æ‰‹æœºå·" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                    </div>
                    
                    <div class="form-group">
                        <label for="applyProvince" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">åœ°åŒº <span style="color: #e74c3c;">*</span></label>
                        <select id="applyProvince" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                            <option value="">è¯·é€‰æ‹©</option>
                            <option value="åŒ—äº¬å¸‚">åŒ—äº¬å¸‚</option>
                            <option value="ä¸Šæµ·å¸‚">ä¸Šæµ·å¸‚</option>
                            <option value="å¹¿ä¸œçœ">å¹¿ä¸œçœ</option>
                            <option value="æµ™æ±Ÿçœ">æµ™æ±Ÿçœ</option>
                            <option value="æ±Ÿè‹çœ">æ±Ÿè‹çœ</option>
                            <option value="å››å·çœ">å››å·çœ</option>
                            <option value="æ¹–åŒ—çœ">æ¹–åŒ—çœ</option>
                            <option value="é™•è¥¿çœ">é™•è¥¿çœ</option>
                            <option value="å¤©æ´¥å¸‚">å¤©æ´¥å¸‚</option>
                            <option value="é‡åº†å¸‚">é‡åº†å¸‚</option>
                            <option value="æ²³åŒ—çœ">æ²³åŒ—çœ</option>
                            <option value="å±±è¥¿çœ">å±±è¥¿çœ</option>
                            <option value="å†…è’™å¤è‡ªæ²»åŒº">å†…è’™å¤è‡ªæ²»åŒº</option>
                            <option value="è¾½å®çœ">è¾½å®çœ</option>
                            <option value="å‰æ—çœ">å‰æ—çœ</option>
                            <option value="é»‘é¾™æ±Ÿçœ">é»‘é¾™æ±Ÿçœ</option>
                            <option value="å®‰å¾½çœ">å®‰å¾½çœ</option>
                            <option value="ç¦å»ºçœ">ç¦å»ºçœ</option>
                            <option value="æ±Ÿè¥¿çœ">æ±Ÿè¥¿çœ</option>
                            <option value="å±±ä¸œçœ">å±±ä¸œçœ</option>
                            <option value="æ²³å—çœ">æ²³å—çœ</option>
                            <option value="æ¹–å—çœ">æ¹–å—çœ</option>
                            <option value="å¹¿è¥¿å£®æ—è‡ªæ²»åŒº">å¹¿è¥¿å£®æ—è‡ªæ²»åŒº</option>
                            <option value="æµ·å—çœ">æµ·å—çœ</option>
                            <option value="è´µå·çœ">è´µå·çœ</option>
                            <option value="äº‘å—çœ">äº‘å—çœ</option>
                            <option value="è¥¿è—è‡ªæ²»åŒº">è¥¿è—è‡ªæ²»åŒº</option>
                            <option value="ç”˜è‚ƒçœ">ç”˜è‚ƒçœ</option>
                            <option value="é’æµ·çœ">é’æµ·çœ</option>
                            <option value="å®å¤å›æ—è‡ªæ²»åŒº">å®å¤å›æ—è‡ªæ²»åŒº</option>
                            <option value="æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº">æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº</option>
                            <option value="å°æ¹¾çœ">å°æ¹¾çœ</option>
                            <option value="é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº">é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº</option>
                            <option value="æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº">æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="applyIntro" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">ç®€ä»‹ <span style="color: #666; font-weight: normal;">(å¯é€‰ï¼Œæœ€å¤š500å­—)</span></label>
                    <textarea id="applyIntro" rows="4" maxlength="500" placeholder="è¯·è¾“å…¥æ‚¨çš„ç®€ä»‹..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; font-family: inherit; resize: vertical;"></textarea>
                    <div style="text-align: right; margin-top: 5px; color: #666; font-size: 12px;">
                        <span id="introCharCount">0</span> / 500 å­—
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" id="cancelApplicationBtn" style="padding: 10px 20px; background: #95a5a6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">å–æ¶ˆ</button>
                    <button type="submit" id="submitApplicationBtn" style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600;">æäº¤ç”³æŠ¥</button>
                </div>
                
                <div id="applicationError" style="display: none; margin-top: 15px; padding: 12px; background: #f8d7da; color: #721c24; border-radius: 6px; border-left: 4px solid #dc3545;"></div>
            </form>
        </div>
        
        <div class="footer">
            <p>æ•°æ®æ¯å­£åº¦æ›´æ–°ä¸€æ¬¡ | æœ€åæ›´æ–°: 2024å¹´1æœˆ | å…±æ”¶å½• <span id="totalPeople">0</span> ä½ä¼˜ç§€äººæ‰</p>
        </div>
    </div>

    <script>
        // APIåŸºç¡€åœ°å€ï¼ˆä½¿ç”¨å…¨å±€å®šä¹‰çš„API_BASEï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä½¿ç”¨é»˜è®¤å€¼ï¼‰
        const RANKING_API_BASE = (typeof API_BASE !== 'undefined') ? API_BASE : 
            (window.location.protocol === 'file:' ? 'http://localhost:3000' : window.location.origin);
        
        // æ’è¡Œæ¦œæ•°æ®ï¼ˆä»APIåŠ è½½ï¼‰
        let rankingData = [];
        let allRankingData = []; // ä¿å­˜æ‰€æœ‰æ•°æ®ç”¨äºå‰ç«¯ç­›é€‰

        // åŠ è½½æ’è¡Œæ¦œæ•°æ®
        async function loadRankingData() {
            try {
                const rankingList = document.getElementById('rankingList');
                
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                rankingList.innerHTML = '<div class="no-results"><h3>åŠ è½½ä¸­...</h3></div>';
                
                // æ„å»ºæŸ¥è¯¢å‚æ•°
                const params = new URLSearchParams({
                    page: 1,
                    pageSize: 1000  // è·å–æ‰€æœ‰æ•°æ®ç”¨äºå‰ç«¯ç­›é€‰
                });
                
                // è°ƒç”¨APIè·å–æ•°æ®
                const response = await fetch(`${RANKING_API_BASE}/api/ranking/list?${params}`);
                const result = await response.json();
                
                if (result.success && result.data) {
                    rankingData = result.data.list || [];
                    allRankingData = rankingData; // ä¿å­˜å®Œæ•´æ•°æ®
                    
                    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                    const totalCount = result.data.pagination.total || rankingData.length;
                    document.getElementById('totalPeople').textContent = totalCount;
                    document.getElementById('totalCount').textContent = totalCount;
                    
                    // æ¸²æŸ“åˆ—è¡¨
                    renderRankingList(rankingData);
                } else {
                    throw new Error(result.message || 'è·å–æ•°æ®å¤±è´¥');
                }
            } catch (error) {
                console.error('åŠ è½½æ’è¡Œæ¦œæ•°æ®å¤±è´¥:', error);
                const rankingList = document.getElementById('rankingList');
                rankingList.innerHTML = `
                    <div class="no-results">
                        <h3>åŠ è½½å¤±è´¥</h3>
                        <p>${error.message || 'è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•'}</p>
                    </div>
                `;
                // è®¾ç½®é»˜è®¤å€¼
                document.getElementById('totalPeople').textContent = '0';
                document.getElementById('totalCount').textContent = '0';
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åŠ è½½æ•°æ®
            loadRankingData();
            
            // ç­›é€‰äº‹ä»¶ç›‘å¬
            document.getElementById('provinceFilter').addEventListener('change', applyFilters);
            document.getElementById('genderFilter').addEventListener('change', applyFilters);
            document.getElementById('nameSearch').addEventListener('input', applyFilters);
            document.getElementById('resetFilters').addEventListener('click', resetFilters);
            
            // åˆå§‹åŒ–ç”³æŠ¥åŠŸèƒ½
            initApplication();
        });
        
        // åˆå§‹åŒ–ç”³æŠ¥åŠŸèƒ½
        async function initApplication() {
            const applicationSection = document.getElementById('applicationSection');
            const userToken = localStorage.getItem('userToken');
            
            // æ˜¾ç¤ºç”³æŠ¥åŒºåŸŸ
            applicationSection.style.display = 'block';
            
            // æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€
            if (!userToken) {
                // æœªç™»å½•ï¼Œæ˜¾ç¤ºæç¤º
                document.getElementById('applicationNotLogin').style.display = 'block';
                document.getElementById('applicationForm').style.display = 'none';
                document.getElementById('applicationStatus').style.display = 'none';
                return;
            }
            
            // å·²ç™»å½•ï¼Œæ£€æŸ¥ç”³æŠ¥çŠ¶æ€
            await checkApplicationStatus();
        }
        
        // æ£€æŸ¥ç”³æŠ¥çŠ¶æ€
        async function checkApplicationStatus() {
            try {
                const userToken = localStorage.getItem('userToken');
                if (!userToken) return;
                
                const response = await fetch(`${RANKING_API_BASE}/api/ranking/application/status`, {
                    headers: {
                        'Authorization': `Bearer ${userToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (result.success) {
                    if (result.data.hasApplied) {
                        // å·²ç”³æŠ¥ï¼Œæ˜¾ç¤ºçŠ¶æ€
                        showApplicationStatus(result.data.application);
                        document.getElementById('applicationForm').style.display = 'none';
                    } else {
                        // æœªç”³æŠ¥ï¼Œæ˜¾ç¤ºè¡¨å•
                        document.getElementById('applicationForm').style.display = 'block';
                        document.getElementById('applicationStatus').style.display = 'none';
                        setupApplicationForm();
                    }
                }
            } catch (error) {
                console.error('æ£€æŸ¥ç”³æŠ¥çŠ¶æ€å¤±è´¥:', error);
                // æ£€æŸ¥å¤±è´¥æ—¶ä¹Ÿæ˜¾ç¤ºè¡¨å•ï¼ˆå…è®¸ç”¨æˆ·å°è¯•æäº¤ï¼‰
                document.getElementById('applicationForm').style.display = 'block';
                document.getElementById('applicationStatus').style.display = 'none';
                setupApplicationForm();
            }
        }
        
        // æ˜¾ç¤ºç”³æŠ¥çŠ¶æ€
        function showApplicationStatus(application) {
            const statusDiv = document.getElementById('applicationStatus');
            const statusContent = document.getElementById('applicationStatusContent');
            
            let statusText = '';
            let statusColor = '';
            if (application.status === 'pending') {
                statusText = 'å¾…å®¡æ ¸';
                statusColor = '#ffc107';
            } else if (application.status === 'approved') {
                statusText = 'å·²é€šè¿‡';
                statusColor = '#28a745';
            } else if (application.status === 'rejected') {
                statusText = 'å·²æ‹’ç»';
                statusColor = '#dc3545';
            }
            
            statusContent.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>çŠ¶æ€ï¼š</strong>
                    <span style="padding: 4px 12px; background: ${statusColor}; color: white; border-radius: 4px; font-weight: 600;">${statusText}</span>
                </div>
                <div style="margin-bottom: 10px;"><strong>å§“åï¼š</strong>${application.name}</div>
                <div style="margin-bottom: 10px;"><strong>æ€§åˆ«ï¼š</strong>${application.gender}</div>
                <div style="margin-bottom: 10px;"><strong>ç”µè¯ï¼š</strong>${application.phone}</div>
                <div style="margin-bottom: 10px;"><strong>åœ°åŒºï¼š</strong>${application.province}</div>
                ${application.intro ? `<div style="margin-bottom: 10px;"><strong>ç®€ä»‹ï¼š</strong>${application.intro}</div>` : ''}
                <div style="margin-bottom: 10px;"><strong>ç”³æŠ¥æ—¶é—´ï¼š</strong>${new Date(application.created_at).toLocaleString('zh-CN')}</div>
                ${application.reviewed_at ? `<div style="margin-bottom: 10px;"><strong>å®¡æ ¸æ—¶é—´ï¼š</strong>${new Date(application.reviewed_at).toLocaleString('zh-CN')}</div>` : ''}
                ${application.review_comment ? `<div style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 4px;"><strong>å®¡æ ¸å¤‡æ³¨ï¼š</strong>${application.review_comment}</div>` : ''}
            `;
            
            statusDiv.style.display = 'block';
        }
        
        // è®¾ç½®ç”³æŠ¥è¡¨å•
        function setupApplicationForm() {
            const form = document.getElementById('applicationForm');
            const introTextarea = document.getElementById('applyIntro');
            const charCount = document.getElementById('introCharCount');
            const cancelBtn = document.getElementById('cancelApplicationBtn');
            
            // ç®€ä»‹å­—æ•°ç»Ÿè®¡
            introTextarea.addEventListener('input', function() {
                const length = this.value.length;
                charCount.textContent = length;
                if (length > 500) {
                    charCount.style.color = '#dc3545';
                } else {
                    charCount.style.color = '#666';
                }
            });
            
            // å–æ¶ˆæŒ‰é’®ï¼ˆéšè—è¡¨å•ï¼Œä½†ä¿æŒåŒºåŸŸæ˜¾ç¤ºï¼‰
            cancelBtn.addEventListener('click', function() {
                form.style.display = 'none';
            });
            
            // è¡¨å•æäº¤
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                await submitApplication();
            });
        }
        
        // æäº¤ç”³æŠ¥
        async function submitApplication() {
            const submitBtn = document.getElementById('submitApplicationBtn');
            const errorDiv = document.getElementById('applicationError');
            const form = document.getElementById('applicationForm');
            
            // è·å–è¡¨å•æ•°æ®
            const name = document.getElementById('applyName').value.trim();
            const gender = document.getElementById('applyGender').value;
            const phone = document.getElementById('applyPhone').value.trim();
            const province = document.getElementById('applyProvince').value;
            const intro = document.getElementById('applyIntro').value.trim();
            
            // éªŒè¯æ•°æ®
            if (!name || !gender || !phone || !province) {
                errorDiv.textContent = 'è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹';
                errorDiv.style.display = 'block';
                return;
            }
            
            // éªŒè¯ç”µè¯æ ¼å¼
            const phoneRegex = /^1[3-9]\d{9}$/;
            if (!phoneRegex.test(phone.replace(/[-\s]/g, ''))) {
                errorDiv.textContent = 'è¯·è¾“å…¥æ­£ç¡®çš„11ä½æ‰‹æœºå·ç ';
                errorDiv.style.display = 'block';
                return;
            }
            
            // éªŒè¯ç®€ä»‹é•¿åº¦
            if (intro && intro.length > 500) {
                errorDiv.textContent = 'ç®€ä»‹æœ€å¤š500å­—';
                errorDiv.style.display = 'block';
                return;
            }
            
            // éšè—é”™è¯¯æç¤º
            errorDiv.style.display = 'none';
            
            // ç¦ç”¨æäº¤æŒ‰é’®
            submitBtn.disabled = true;
            submitBtn.textContent = 'æäº¤ä¸­...';
            
            try {
                const userToken = localStorage.getItem('userToken');
                if (!userToken) {
                    throw new Error('è¯·å…ˆç™»å½•');
                }
                
                const response = await fetch(`${RANKING_API_BASE}/api/ranking/apply`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${userToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name,
                        gender,
                        phone,
                        province,
                        intro: intro || null
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // æäº¤æˆåŠŸï¼Œé‡æ–°æ£€æŸ¥çŠ¶æ€
                    alert('ç”³æŠ¥æäº¤æˆåŠŸï¼ç­‰å¾…ç®¡ç†å‘˜å®¡æ ¸ã€‚');
                    form.reset();
                    document.getElementById('introCharCount').textContent = '0';
                    await checkApplicationStatus();
                } else {
                    throw new Error(result.message || 'æäº¤å¤±è´¥');
                }
            } catch (error) {
                console.error('æäº¤ç”³æŠ¥å¤±è´¥:', error);
                errorDiv.textContent = error.message || 'æäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
                errorDiv.style.display = 'block';
            } finally {
                // æ¢å¤æäº¤æŒ‰é’®
                submitBtn.disabled = false;
                submitBtn.textContent = 'æäº¤ç”³æŠ¥';
            }
        }

        // åº”ç”¨ç­›é€‰ï¼ˆå‰ç«¯ç­›é€‰ï¼Œä¿æŒåŸæœ‰äº¤äº’ä½“éªŒï¼‰
        function applyFilters() {
            const province = document.getElementById('provinceFilter').value;
            const gender = document.getElementById('genderFilter').value;
            const nameQuery = document.getElementById('nameSearch').value.toLowerCase();
            
            // æ›´æ–°å½“å‰åœ°åŒºæ˜¾ç¤º
            document.getElementById('currentRegion').textContent = province === 'all' ? 'å…¨éƒ¨åœ°åŒº' : province;
            
            // ç­›é€‰æ•°æ®ï¼ˆä½¿ç”¨allRankingDataç¡®ä¿ç­›é€‰æ‰€æœ‰æ•°æ®ï¼‰
            let filteredData = allRankingData.filter(person => {
                // åœ°åŒºç­›é€‰
                if (province !== 'all' && person.province !== province) return false;
                
                // æ€§åˆ«ç­›é€‰
                if (gender !== 'all' && person.gender !== gender) return false;
                
                // å§“åæœç´¢
                if (nameQuery && !person.name.toLowerCase().includes(nameQuery)) return false;
                
                return true;
            });
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            document.getElementById('currentCount').textContent = filteredData.length;
            
            // æ¸²æŸ“ç­›é€‰åçš„åˆ—è¡¨
            renderRankingList(filteredData);
        }

        // é‡ç½®ç­›é€‰
        function resetFilters() {
            document.getElementById('provinceFilter').value = 'all';
            document.getElementById('genderFilter').value = 'all';
            document.getElementById('nameSearch').value = '';
            
            document.getElementById('currentRegion').textContent = 'å…¨éƒ¨åœ°åŒº';
            document.getElementById('currentCount').textContent = allRankingData.length;
            
            renderRankingList(allRankingData);
        }

        // æ¸²æŸ“æ’ååˆ—è¡¨
        function renderRankingList(data) {
            const rankingList = document.getElementById('rankingList');
            
            if (data.length === 0) {
                rankingList.innerHTML = `
                    <div class="no-results">
                        <h3>æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ç»“æœ</h3>
                        <p>è¯·å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–æœç´¢å…³é”®è¯</p>
                    </div>
                `;
                return;
            }
            
            // æ•°æ®å·²ç»æŒ‰display_orderå’Œcreated_atæ’åºï¼ˆåç«¯æ’åºï¼‰ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨
            let html = '';
            
            data.forEach((person, index) => {
                const genderClass = person.gender === 'ç”·' ? 'male' : 'female';
                const intro = person.intro || 'æš‚æ— ç®€ä»‹';
                
                html += `
                    <div class="ranking-item" id="item-${person.id}">
                        <div class="basic-info" onclick="toggleDetails(${person.id})">
                            <div class="rank">${index + 1}</div>
                            <div class="name">${person.name}</div>
                            <div class="gender ${genderClass}">${person.gender}</div>
                            <div class="phone">${person.phone}</div>
                            <div class="expand-btn">â–¼</div>
                        </div>
                        <div class="detail-info">
                            <div class="detail-content">
                                <div class="detail-section">
                                    <h3>åœ°åŒº</h3>
                                    <p class="province">${person.province}</p>
                                </div>
                                <div class="detail-section">
                                    <h3>è‡ªæˆ‘ä»‹ç»</h3>
                                    <p class="intro">${intro}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            rankingList.innerHTML = html;
        }

        // åˆ‡æ¢è¯¦æƒ…æ˜¾ç¤º
        function toggleDetails(id) {
            const item = document.getElementById(`item-${id}`);
            const isExpanded = item.classList.contains('expanded');
            
            // å…³é—­æ‰€æœ‰å…¶ä»–å±•å¼€çš„é¡¹
            document.querySelectorAll('.ranking-item.expanded').forEach(el => {
                if (el.id !== `item-${id}`) {
                    el.classList.remove('expanded');
                }
            });
            
            // åˆ‡æ¢å½“å‰é¡¹
            if (!isExpanded) {
                item.classList.add('expanded');
            } else {
                item.classList.remove('expanded');
            }
        }

        // ä¸ºå…¨å±€å¯ç”¨
        window.toggleDetails = toggleDetails;
    </script>
</body>
</html>
</div>
        </section>
<!-- æ˜“ç»ç²¾å“è¯¾é¡µé¢ -->
    <style>
        /* ç¾¤èŠé¡µé¢æ ·å¼ */
        #qunliao {
            padding: 20px;
            min-height: 100vh;
        }
        
        #qunliao .contact-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        #qunliao .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        #qunliao .contact-card {
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        #qunliao .contact-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }
        
        #qunliao .card-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4a6ee0, #6a11cb);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        #qunliao .card-icon i {
            font-size: 36px;
            color: white;
        }
        
        #qunliao .card-title {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        #qunliao .card-content {
            width: 100%;
        }
        
        #qunliao .qr-container {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            border: 1px dashed #ddd;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #qunliao .qr-image {
            max-width: 200px;
            max-height: 200px;
            border-radius: 8px;
        }
        
        #qunliao .qr-placeholder {
            width: 200px;
            height: 200px;
            background-color: #e9ecef;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        #qunliao .qr-placeholder i {
            font-size: 48px;
            margin-bottom: 10px;
            color: #4a6ee0;
        }
        
        #qunliao .limit-notice {
            background-color: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            color: #856404;
            font-size: 0.9rem;
        }
        
        #qunliao .login-prompt {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            color: #0c5460;
            font-size: 0.9rem;
        }
        
        #qunliao .contact-info {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            text-align: left;
        }
        
        #qunliao .info-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        #qunliao .info-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        #qunliao .info-icon {
            width: 40px;
            height: 40px;
            background-color: #eef2ff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: #4a6ee0;
        }
        
        #qunliao .info-text {
            flex: 1;
        }
        
        #qunliao .info-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 3px;
        }
        
        #qunliao .info-value {
            font-size: 1.1rem;
            color: #2c3e50;
            font-weight: 500;
            word-break: break-all;
        }
        
        #qunliao .link-value {
            color: #4a6ee0;
            text-decoration: underline;
            cursor: pointer;
        }
        
        #qunliao .link-value:hover {
            color: #6a11cb;
        }
        
        #qunliao .empty-value {
            color: #aaa;
            font-style: italic;
        }
        
        #qunliao .link-button {
            display: inline-block;
            background: linear-gradient(135deg, #4a6ee0, #6a11cb);
            color: white;
            text-decoration: none;
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(74, 110, 224, 0.3);
            cursor: pointer;
            border: none;
        }
        
        #qunliao .link-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(74, 110, 224, 0.4);
        }
        
        #qunliao .link-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        @media (max-width: 768px) {
            #qunliao .contact-grid {
                grid-template-columns: 1fr;
            }
            
            #qunliao .card-title {
                font-size: 1.5rem;
            }
            
            #qunliao .contact-card {
                padding: 25px 20px;
            }
        }
        </style>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        
        <section id="qunliao" class="page-content">
            <div class="contact-container">
                <div class="contact-grid" id="contactGrid">
                    <!-- å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    <div style="text-align: center; padding: 40px; color: #666;">åŠ è½½ä¸­...</div>
                </div>
            </div>
        </section>
        
        <script>
        // ç¾¤èŠé¡µé¢JavaScriptåŠŸèƒ½
        (function() {
            const CONTACT_API_BASE = (typeof API_BASE !== 'undefined') ? API_BASE : 
                (window.location.protocol === 'file:' ? 'http://localhost:3000' : window.location.origin);
            
            let userToken = null;
            let accessStatus = null;
            
            // è·å–ç”¨æˆ·tokenï¼ˆå¦‚æœå·²ç™»å½•ï¼‰
            function getUserToken() {
                try {
                    // å°è¯•ä»localStorageè·å–token
                    const storedToken = localStorage.getItem('userToken');
                    if (storedToken) {
                        return storedToken;
                    }
                    // å°è¯•ä»sessionStorageè·å–token
                    const sessionToken = sessionStorage.getItem('userToken');
                    if (sessionToken) {
                        return sessionToken;
                    }
                    // å°è¯•ä»å…¨å±€å˜é‡è·å–token
                    if (typeof userToken !== 'undefined' && userToken) {
                        return userToken;
                    }
                } catch (e) {
                    console.warn('è·å–ç”¨æˆ·tokenå¤±è´¥:', e);
                }
                return null;
            }
            
            // åŠ è½½è”ç³»ä¿¡æ¯
            async function loadContactInfo() {
                const contactGrid = document.getElementById('contactGrid');
                if (!contactGrid) return;
                
                userToken = getUserToken();
                
                try {
                    // å¦‚æœå·²ç™»å½•ï¼Œè·å–è°ƒç”¨çŠ¶æ€
                    if (userToken) {
                        try {
                            const statusResponse = await fetch(`${CONTACT_API_BASE}/api/contact/access-status`, {
                                headers: {
                                    'Authorization': `Bearer ${userToken}`
                                }
                            });
                            if (statusResponse.ok) {
                                const statusData = await statusResponse.json();
                                if (statusData.success) {
                                    accessStatus = statusData.data;
                                }
                            }
                        } catch (e) {
                            console.warn('è·å–è°ƒç”¨çŠ¶æ€å¤±è´¥:', e);
                        }
                    }
                    
                    // åŠ è½½è”ç³»ä¿¡æ¯åˆ—è¡¨
                    const response = await fetch(`${CONTACT_API_BASE}/api/contact/list`, {
                        headers: userToken ? {
                            'Authorization': `Bearer ${userToken}`
                        } : {}
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        renderContactCards(data.data, contactGrid);
                    } else {
                        contactGrid.innerHTML = '<div style="text-align: center; padding: 40px; color: #e74c3c;">åŠ è½½å¤±è´¥ï¼š' + (data.message || 'è¯·ç¨åé‡è¯•') + '</div>';
                    }
                } catch (error) {
                    console.error('åŠ è½½è”ç³»ä¿¡æ¯å¤±è´¥:', error);
                    contactGrid.innerHTML = '<div style="text-align: center; padding: 40px; color: #e74c3c;">åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</div>';
                }
            }
            
            // æ¸²æŸ“è”ç³»ä¿¡æ¯å¡ç‰‡
            function renderContactCards(contactData, container) {
                const { qq, qq_group, baidu_pan, baidu_pan_link, wechat_qr, access_limit } = contactData;
                
                let html = '';
                
                // QQè”ç³»æ–¹å¼å¡ç‰‡
                if ((qq && qq.length > 0) || (qq_group && qq_group.length > 0)) {
                    // æ£€æŸ¥QQçš„é™åˆ¶çŠ¶æ€ï¼ˆQQå’ŒQQç¾¤å…±äº«åŒä¸€ä¸ªé™åˆ¶ï¼‰
                    const qqCanAccess = accessStatus && accessStatus.can_access && accessStatus.can_access.qq !== false;
                    const qqShowLimit = !qqCanAccess && userToken;
                    
                    html += `
            <div class="contact-card">
                <div class="card-icon">
                    <i class="fab fa-qq"></i>
                </div>
                <h2 class="card-title">QQè”ç³»</h2>
                <div class="card-content">
                    <p>æ¬¢è¿é€šè¿‡ä»¥ä¸‹QQå·æˆ–QQç¾¤ä¸æˆ‘è”ç³»</p>
                    <div class="contact-info">
                    `;
                    
                    if (qq && qq.length > 0) {
                        qq.forEach(item => {
                            const canAccess = item.can_access !== false;
                            const showLimit = !canAccess && userToken;
                            
                            html += `
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="info-text">
                                        <div class="info-label">${item.title || 'QQå·ç '}</div>
                                        ${canAccess ? `
                                            <div class="info-value" onclick="recordContactAccess('qq', ${item.id || 'null'});" style="cursor: pointer;">${item.value}</div>
                                        ` : `
                                            <div class="info-value empty-value">${showLimit ? '24å°æ—¶å†…ä»…å¯æŸ¥çœ‹ä¸€æ¬¡' : 'è¯·ç™»å½•åæŸ¥çœ‹'}</div>
                                        `}
                                        ${item.description ? `<small style="color: #999; font-size: 0.85rem;">${item.description}</small>` : ''}
                            </div>
                        </div>
                            `;
                        });
                    }
                    
                    if (qq_group && qq_group.length > 0) {
                        qq_group.forEach(item => {
                            const canAccess = item.can_access !== false;
                            const showLimit = !canAccess && userToken;
                            
                            html += `
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="info-text">
                                        <div class="info-label">${item.title || 'QQç¾¤å·'}</div>
                                        ${canAccess ? `
                                            <div class="info-value" onclick="recordContactAccess('qq_group', ${item.id || 'null'});" style="cursor: pointer;">${item.value}</div>
                                        ` : `
                                            <div class="info-value empty-value">${showLimit ? '24å°æ—¶å†…ä»…å¯æŸ¥çœ‹ä¸€æ¬¡' : 'è¯·ç™»å½•åæŸ¥çœ‹'}</div>
                                        `}
                                        ${item.description ? `<small style="color: #999; font-size: 0.85rem;">${item.description}</small>` : ''}
                            </div>
                        </div>
                            `;
                        });
                    }
                    
                    if (!userToken) {
                        html += `
                            <div class="login-prompt">
                                <i class="fas fa-info-circle"></i> è¯·å…ˆç™»å½•åæŸ¥çœ‹QQå·å’ŒQQç¾¤
                    </div>
                        `;
                    } else if (qqShowLimit) {
                        html += `
                            <div class="limit-notice">
                                <i class="fas fa-exclamation-triangle"></i> 24å°æ—¶å†…ä»…å¯æŸ¥çœ‹ä¸€æ¬¡
                            </div>
                        `;
                    }
                    
                    html += `
                </div>
            </div>
                        </div>
                    `;
                }
            
                // ç™¾åº¦ç½‘ç›˜å¡ç‰‡
                if ((baidu_pan && baidu_pan.length > 0) || (baidu_pan_link && baidu_pan_link.length > 0)) {
                    html += `
            <div class="contact-card">
                <div class="card-icon">
                    <i class="fas fa-cloud"></i>
                </div>
                <h2 class="card-title">èµ„æºåˆ†äº«</h2>
                <div class="card-content">
                    <p>è®¿é—®æˆ‘çš„ç™¾åº¦ç½‘ç›˜è·å–æ›´å¤šèµ„æºï¼Œæˆ–åŠ å…¥åˆ†äº«ç¾¤ç»„</p>
                    <div class="contact-info">
                    `;
                    
                    // ç™¾åº¦ç½‘ç›˜é“¾æ¥
                    if (baidu_pan_link && baidu_pan_link.length > 0) {
                        baidu_pan_link.forEach(item => {
                            const canAccess = item.can_access !== false;
                            const showLimit = !canAccess && userToken;
                            
                            html += `
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-link"></i>
                            </div>
                            <div class="info-text">
                                        <div class="info-label">${item.title || 'ç™¾åº¦ç½‘ç›˜é“¾æ¥'}</div>
                                        ${canAccess ? `
                                            <div class="info-value">
                                                <a href="${item.value}" target="_blank" class="link-value" onclick="recordContactAccess('baidu_pan_link', ${item.id || 'null'});">${item.value}</a>
                            </div>
                                        ` : `
                                            <div class="info-value empty-value">${showLimit ? '24å°æ—¶å†…ä»…å¯æŸ¥çœ‹ä¸€æ¬¡' : 'è¯·ç™»å½•åæŸ¥çœ‹'}</div>
                                        `}
                                        ${item.description ? `<small style="color: #999; font-size: 0.85rem;">${item.description}</small>` : ''}
                        </div>
                                </div>
                            `;
                        });
                    }
                    
                    // ç™¾åº¦ç½‘ç›˜ç¾¤å·
                    if (baidu_pan && baidu_pan.length > 0) {
                        baidu_pan.forEach(item => {
                            const canAccess = item.can_access !== false;
                            const showLimit = !canAccess && userToken;
                            
                            html += `
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-share-alt"></i>
                            </div>
                            <div class="info-text">
                                        <div class="info-label">${item.title || 'åˆ†äº«ç¾¤å·'}</div>
                                        ${canAccess ? `
                                            <div class="info-value" onclick="recordContactAccess('baidu_pan', ${item.id || 'null'});" style="cursor: pointer;">${item.value}</div>
                                        ` : `
                                            <div class="info-value empty-value">${showLimit ? '24å°æ—¶å†…ä»…å¯æŸ¥çœ‹ä¸€æ¬¡' : 'è¯·ç™»å½•åæŸ¥çœ‹'}</div>
                                        `}
                                        ${item.description ? `<small style="color: #999; font-size: 0.85rem;">${item.description}</small>` : ''}
                            </div>
                        </div>
                            `;
                        });
                    }
                    
                    if (!userToken) {
                        html += `
                            <div class="login-prompt">
                                <i class="fas fa-info-circle"></i> è¯·å…ˆç™»å½•åæŸ¥çœ‹ç½‘ç›˜é“¾æ¥å’Œç¾¤å·
                    </div>
                        `;
                    } else if (access_limit && access_limit.total_remaining !== undefined) {
                        if (access_limit.total_remaining === 0) {
                            html += `
                                <div class="limit-notice">
                                    <i class="fas fa-exclamation-triangle"></i> æ‚¨å·²è¾¾åˆ°è°ƒç”¨ä¸Šé™ï¼ˆæ¯ä¸ªç±»å‹24å°æ—¶å†…ä»…å¯æŸ¥çœ‹ä¸€æ¬¡ï¼‰
                                    </div>
                            `;
                        } else {
                            html += `
                                <div style="margin-top: 15px; padding: 10px; background: #e8f5e9; border-radius: 6px; color: #2e7d32; font-size: 0.9rem;">
                                    <i class="fas fa-info-circle"></i> å‰©ä½™å¯è°ƒç”¨æ¬¡æ•°ï¼š${access_limit.total_remaining}æ¬¡
            </div>
                            `;
                        }
                    }
                    
                    html += `
        </div>
                            </div>
                        </div>
                    `;
                }
                
                // å¾®ä¿¡äºŒç»´ç å¡ç‰‡
                if (wechat_qr && wechat_qr.length > 0) {
                    wechat_qr.forEach(item => {
                        const canAccess = item.can_access !== false;
                        const showLimit = !canAccess && userToken;
                        const fileUrl = item.file_url || (CONTACT_API_BASE + item.value);
                        
                        html += `
                            <div class="contact-card">
                                <div class="card-icon">
                                    <i class="fab fa-weixin"></i>
          </div>
                                <h2 class="card-title">${item.title || 'å¾®ä¿¡è”ç³»'}</h2>
                                <div class="card-content">
                                    <p>${item.description || 'æ‰«æä¸‹æ–¹äºŒç»´ç æ·»åŠ æˆ‘çš„å¾®ä¿¡ï¼Œè¯·å¤‡æ³¨æ¥æ„'}</p>
                                    <div class="qr-container">
                        `;
                        
                        if (canAccess) {
                            html += `
                                <img src="${fileUrl}" alt="å¾®ä¿¡äºŒç»´ç " class="qr-image" onclick="recordContactAccess('wechat_qr', ${item.id || 'null'});" style="cursor: pointer;">
                            `;
                        } else {
                            html += `
                                <div class="qr-placeholder">
                                    <i class="fas fa-qrcode"></i>
                                    <p>${showLimit ? '24å°æ—¶å†…ä»…å¯æŸ¥çœ‹ä¸€æ¬¡' : 'è¯·ç™»å½•åæŸ¥çœ‹'}</p>
                                </div>
                            `;
                        }
                        
                        html += `
                                    </div>
                        `;
                        
                        if (!userToken) {
                            html += `
                                <div class="login-prompt">
                                    <i class="fas fa-info-circle"></i> è¯·å…ˆç™»å½•åæŸ¥çœ‹äºŒç»´ç 
                                </div>
                            `;
                        } else if (showLimit) {
                            html += `
                                <div class="limit-notice">
                                    <i class="fas fa-exclamation-triangle"></i> 24å°æ—¶å†…ä»…å¯æŸ¥çœ‹ä¸€æ¬¡
                                </div>
                            `;
                        }
                        
                        html += `
                                </div>
                            </div>
                        `;
                    });
                }
                
                if (!html) {
                    html = '<div style="text-align: center; padding: 40px; color: #666;">æš‚æ— è”ç³»ä¿¡æ¯</div>';
                }
                
                container.innerHTML = html;
            }
            
            // è®°å½•è°ƒç”¨æ—¥å¿—
            async function recordContactAccess(contactType, contactId) {
                if (!userToken) {
                    alert('è¯·å…ˆç™»å½•');
                    return;
                }
                
                try {
                    const response = await fetch(`${CONTACT_API_BASE}/api/contact/access-log`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${userToken}`
                        },
                        body: JSON.stringify({
                            contact_type: contactType,
                            contact_id: contactId || null
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        // é‡æ–°åŠ è½½è”ç³»ä¿¡æ¯ä»¥æ›´æ–°çŠ¶æ€
                        loadContactInfo();
                    } else {
                        console.warn('è®°å½•è°ƒç”¨æ—¥å¿—å¤±è´¥:', data.message);
                    }
                } catch (error) {
                    console.error('è®°å½•è°ƒç”¨æ—¥å¿—å¤±è´¥:', error);
                }
            }
            
            // å°†å‡½æ•°æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸï¼ˆä¾›onclickä½¿ç”¨ï¼‰
            window.recordContactAccess = recordContactAccess;
            
            // é¡µé¢æ˜¾ç¤ºæ—¶åŠ è½½æ•°æ®
            const pageSelector = document.getElementById('pageSelector');
            if (pageSelector) {
                const originalChangeHandler = pageSelector.onchange;
                pageSelector.addEventListener('change', function() {
                    if (this.value === 'qunliao') {
                        setTimeout(loadContactInfo, 100);
                    }
                    if (originalChangeHandler) {
                        originalChangeHandler.call(this);
                    }
                });
            }
            
            // å¦‚æœå½“å‰é¡µé¢å·²ç»æ˜¯ç¾¤èŠé¡µé¢ï¼Œç«‹å³åŠ è½½
            if (document.getElementById('qunliao') && document.getElementById('qunliao').classList.contains('active')) {
                setTimeout(loadContactInfo, 100);
            }
        })();
    </script>
        <!-- æ˜“ç»ç²¾å“è¯¾é¡µé¢ -->
        <section id="statement" class="page-content">
            <h2>æ˜“ç»ç²¾å“è¯¾ç¨‹</h2>
            <div class="content-section">
                <span class="item-number">1</span>
                <h3>åŸºç¡€å…¥é—¨è¯¾ç¨‹</h3>
                <p>å‘¨æ˜“å“²å­¦åŸºç¡€ã€å…«å¦èµ·æºã€é˜´é˜³äº”è¡Œç†è®ºã€64å¦åŸºæœ¬å«ä¹‰</p>
            </div>
            <div class="content-section">
                <span class="item-number">2</span>
                <h3>è¿›é˜¶åº”ç”¨è¯¾ç¨‹</h3>
                <p>å åœæ–¹æ³•ã€å¦è±¡è§£æã€å®é™…æ¡ˆä¾‹åˆ†æã€å†³ç­–æŒ‡å¯¼</p>
            </div>
            <div class="content-section">
                <span class="item-number">3</span>
                <h3>å¤§å¸ˆç ”ä¿®è¯¾ç¨‹</h3>
                <p>æ·±å…¥å¤ç±ç ”ç©¶ã€ä¼ ç»Ÿæ–‡åŒ–èåˆã€ä¸ªäººå’¨è¯¢æŠ€å·§</p>
            </div>
        </section>
        <!-- å­¦ä¹ åŠ©æ‰‹é¡µé¢ -->
        <section id="divinatiob" class="page-content">





<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜“å­¦è¯¾ç¨‹å¹³å° - ç´«è–‡æ–—æ•°ã€å‘¨æ˜“64å¦ã€åœ°ç†å ªèˆ†</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e6ef;
        }
        
        .logo {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .logo i {
            color: #8e44ad;
            margin-right: 10px;
        }
        
        header h1 {
            color: #2c3e50;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        header p {
            color: #7f8c8d;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .video-section {
            flex: 1;
            min-width: 300px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }
        
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            background-color: #000;
        }
        
        .video-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .video-controls {
            /* éšè—è‡ªå®šä¹‰æ§åˆ¶æ ï¼Œåªä¿ç•™è§†é¢‘è‡ªå¸¦æ§åˆ¶ */
            display: none;
            align-items: center;
            padding: 12px 20px;
            background-color: #2c3e50;
            color: white;
        }
        
        .control-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            margin-right: 15px;
            transition: color 0.2s;
        }
        
        .control-btn:hover {
            color: #8e44ad;
        }
        
        .progress-container {
            flex-grow: 1;
            margin: 0 15px;
            height: 8px;
            background-color: #4a5f7a;
            border-radius: 4px;
            cursor: pointer;
            position: relative;
        }
        
        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: #8e44ad;
            border-radius: 4px;
        }
        
        .time-display {
            font-size: 0.9rem;
            min-width: 100px;
            text-align: center;
        }
        
        .speed-control {
            background-color: #34495e;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        
        .courses-section {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .courses-nav {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 20px;
        }
        
        .courses-nav h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e0e6ef;
            font-size: 1.5rem;
        }
        
        .course-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .course-tab {
            padding: 10px 20px;
            background-color: #f1f5f9;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            color: #4a5568;
        }
        
        .course-tab.active {
            background-color: #8e44ad;
            color: white;
        }
        
        .course-tab:hover:not(.active) {
            background-color: #e2e8f0;
        }
        
        .course-name {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .chapters-container {
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .chapter {
            margin-bottom: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .chapter-header {
            background-color: #f7fafc;
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s;
        }
        
        .chapter-header:hover {
            background-color: #edf2f7;
        }
        
        .chapter-title {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .toggle-icon {
            transition: transform 0.3s;
        }
        
        .chapter.active .toggle-icon {
            transform: rotate(90deg);
        }
        
        .lessons {
            display: none;
            padding: 10px 15px;
            background-color: #fff;
        }
        
        .chapter.active .lessons {
            display: block;
        }
        
        .lesson {
            padding: 10px 15px;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background-color 0.2s;
        }
        
        .lesson:hover {
            background-color: #f8fafc;
        }
        
        .lesson.active {
            background-color: #f3e8ff;
            color: #8e44ad;
            font-weight: 600;
        }
        
        .lesson:last-child {
            border-bottom: none;
        }
        
        .lesson-icon {
            margin-right: 10px;
            color: #8e44ad;
        }
        
        .lesson-title {
            flex-grow: 1;
        }
        
        .lesson-duration {
            font-size: 0.85rem;
            color: #718096;
        }
        
        .current-video-info {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 20px;
        }
        
        .current-video-info h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e0e6ef;
        }
        
        .video-id {
            font-family: monospace;
            background-color: #f1f5f9;
            padding: 5px 10px;
            border-radius: 4px;
            color: #2d3748;
        }
        
        .video-description {
            margin-top: 15px;
            line-height: 1.7;
            color: #4a5568;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            border-top: 1px solid #e0e6ef;
            margin-top: 20px;
        }
        
        /* å…¨å±æ ·å¼ */
        .video-section:-webkit-full-screen {
            width: 100%;
            height: 100%;
            background: black;
        }
        
        .video-section:-moz-full-screen {
            width: 100%;
            height: 100%;
            background: black;
        }
        
        .video-section:-ms-fullscreen {
            width: 100%;
            height: 100%;
            background: black;
        }
        
        .video-section:fullscreen {
            width: 100%;
            height: 100%;
            background: black;
        }
        
        .video-section:-webkit-full-screen .video-container {
            height: 100%;
            padding-bottom: 0;
        }
        
        .video-section:-moz-full-screen .video-container {
            height: 100%;
            padding-bottom: 0;
        }
        
        .video-section:-ms-fullscreen .video-container {
            height: 100%;
            padding-bottom: 0;
        }
        
        .video-section:fullscreen .video-container {
            height: 100%;
            padding-bottom: 0;
        }
        
        @media (max-width: 992px) {
            .main-content {
                flex-direction: column;
            }
            
            .video-section, .courses-section {
                width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .video-controls {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .progress-container {
                order: 3;
                flex-basis: 100%;
                margin-top: 10px;
            }
            
            .time-display {
                order: 2;
            }
            
            .course-tabs {
                justify-content: center;
            }
            
            .control-group {
                display: flex;
                order: 1;
                margin-bottom: 10px;
                width: 100%;
                justify-content: center;
            }
        }
        
        .control-group {
            display: flex;
            align-items: center;
        }
        
        .video-notice {
            background-color: #e8f4fd;
            border-left: 4px solid #3498db;
            padding: 12px 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            font-size: 0.95rem;
        }
        
        .video-notice i {
            color: #3498db;
            margin-right: 8px;
        }
        
        .video-error {
            background-color: #fde8e8;
            border-left: 4px solid #e53e3e;
            padding: 12px 15px;
            margin-top: 10px;
            border-radius: 4px;
            font-size: 0.95rem;
            display: none;
        }
        
        .video-error i {
            color: #e53e3e;
            margin-right: 8px;
        }
    </style>
</head>
<body>
             

        <div class="main-content">
            <section class="video-section" id="videoSection">
                <div class="video-container">
                    <video id="videoPlayer" class="video-player" controls playsinline>
                        <!-- åˆå§‹ä¸ºç©ºï¼Œç‚¹å‡»ç« èŠ‚ååŠ è½½æœ¬åœ°è§†é¢‘ -->
                        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒHTML5è§†é¢‘ï¼Œè¯·å‡çº§æµè§ˆå™¨ã€‚
                    </video>
                </div>
                
                <div class="video-controls">
                    <div class="control-group">
                        <button id="playPauseBtn" class="control-btn" title="æ’­æ”¾/æš‚åœ">
                            <i class="fas fa-play"></i>
                        </button>
                        <button id="muteBtn" class="control-btn" title="é™éŸ³/å–æ¶ˆé™éŸ³">
                            <i class="fas fa-volume-up"></i>
                        </button>
                        <button id="fullscreenBtn" class="control-btn" title="å…¨å±">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                    
                    <div class="progress-container" id="progressContainer">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    
                    <div class="time-display">
                        <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                    </div>
                    
                    <select id="speedControl" class="speed-control">
                        <option value="0.5">0.5x</option>
                        <option value="0.75">0.75x</option>
                        <option value="1" selected>1x</option>
                        <option value="1.25">1.25x</option>
                        <option value="1.5">1.5x</option>
                        <option value="2">2x</option>
                    </select>
                </div>
                
                <div class="video-error" id="videoError">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span id="errorMessage">è§†é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·ç¡®ä¿è§†é¢‘æ–‡ä»¶å­˜åœ¨ä¸”å‘½åæ­£ç¡®ã€‚</span>
                </div>
            </section>
            
            <section class="courses-section">
                <div class="courses-nav">
                    <div class="course-tabs">
                        <button class="course-tab active" data-course="ziwei">ç´«è–‡æ–—æ•°</button>
                        <button class="course-tab" data-course="zhouyi">å‘¨æ˜“64å¦</button>
                        <button class="course-tab" data-course="kanyu">åœ°ç†å ªèˆ†</button>
                        <button class="course-tab" data-course="other">å…¶ä»–å†…å®¹</button>
                    </div>
                    
                    <h3 class="course-name" id="currentCourseName">ç´«è–‡æ–—æ•°</h3>
                    
                    <div class="chapters-container" id="chaptersContainer">
                        <!-- ç« èŠ‚å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="current-video-info">
                    <h3>å½“å‰æ’­æ”¾</h3>
                    <p>è§†é¢‘æ–‡ä»¶: <span class="video-id" id="currentVideoId">ziwei0001.MP4</span></p>
                    <p>æ–‡ä»¶è·¯å¾„: <span class="video-id" id="videoPath">./ziwei0001.MP4</span></p>
                    <p class="video-description" id="videoDescription">ç´«è–‡æ–—æ•°å…¥é—¨ç¬¬ä¸€è®²ï¼šäº†è§£ç´«è–‡æ–—æ•°çš„åŸºæœ¬æ¦‚å¿µå’Œå†å²æ¸Šæºï¼ŒæŒæ¡å‘½ç›˜çš„åŸºæœ¬ç»“æ„ã€‚</p>
                </div>
            </section>
        </div>
            </div>

    <script>
        // è¯¾ç¨‹æ•°æ®
        const courses = {
            ziwei: {
                name: "ç´«è–‡æ–—æ•°",
                chapters: 10,
                lessonsPerChapter: 10,
                description: "ç´«è–‡æ–—æ•°æ˜¯ä¸­å›½ä¼ ç»Ÿå‘½ç†å­¦çš„é‡è¦æµæ´¾ï¼Œé€šè¿‡åˆ†ææ˜Ÿæ›œåˆ†å¸ƒæ¥é¢„æµ‹äººç”Ÿè¿åŠ¿ã€‚"
            },
            zhouyi: {
                name: "å‘¨æ˜“64å¦",
                chapters: 2,
                lessonsPerChapter: [1, 64], // ç¬¬ä¸€ç« 1èŠ‚ï¼Œç¬¬äºŒç« 64èŠ‚
                description: "ã€Šå‘¨æ˜“ã€‹æ˜¯ä¸­å›½å¤ä»£å“²å­¦ç»å…¸ï¼Œ64å¦è±¡å¾å®‡å®™ä¸‡ç‰©çš„å˜åŒ–è§„å¾‹ï¼ŒæŒ‡å¯¼äººç”Ÿå†³ç­–ã€‚"
            },
            kanyu: {
                name: "åœ°ç†å ªèˆ†",
                chapters: 10,
                lessonsPerChapter: 10,
                description: "åœ°ç†å ªèˆ†ï¼ˆé£æ°´å­¦ï¼‰ç ”ç©¶äººä¸ç¯å¢ƒçš„å…³ç³»ï¼Œå¯»æ±‚å’Œè°å…±ç”Ÿçš„å±…ä½ä¸å·¥ä½œç¯å¢ƒã€‚"
            },
            other: {
                name: "å…¶ä»–å†…å®¹",
                chapters: 10,
                lessonsPerChapter: 10,
                description: "åŒ…æ‹¬å¥‡é—¨éç”²ã€å…«å­—å‘½ç†ã€é¢ç›¸æ‰‹ç›¸ç­‰å…¶ä»–ä¼ ç»Ÿæ˜“å­¦çŸ¥è¯†ã€‚"
            }
        };
        
        // å½“å‰é€‰ä¸­çš„è¯¾ç¨‹å’Œç« èŠ‚
        let currentCourse = 'ziwei';
        let currentVideoId = 'ziwei0001';
        
        // è§†é¢‘æ’­æ”¾å™¨å…ƒç´ 
        const videoPlayer = document.getElementById('videoPlayer');
        const videoSection = document.getElementById('videoSection');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const muteBtn = document.getElementById('muteBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const progressBar = document.getElementById('progressBar');
        const progressContainer = document.getElementById('progressContainer');
        const currentTimeEl = document.getElementById('currentTime');
        const durationEl = document.getElementById('duration');
        const speedControl = document.getElementById('speedControl');
        const currentCourseName = document.getElementById('currentCourseName');
        const currentVideoIdEl = document.getElementById('currentVideoId');
        const videoPathEl = document.getElementById('videoPath');
        const videoDescription = document.getElementById('videoDescription');
        const chaptersContainer = document.getElementById('chaptersContainer');
        const videoError = document.getElementById('videoError');
        const errorMessage = document.getElementById('errorMessage');
        
        // è§†é¢‘æè¿°æ•°æ®
        const videoDescriptions = {
            ziwei0001: "ç´«è–‡æ–—æ•°å…¥é—¨ç¬¬ä¸€è®²ï¼šäº†è§£ç´«è–‡æ–—æ•°çš„åŸºæœ¬æ¦‚å¿µå’Œå†å²æ¸Šæºï¼ŒæŒæ¡å‘½ç›˜çš„åŸºæœ¬ç»“æ„ã€‚",
            ziwei0002: "ç´«è–‡æ–—æ•°ç¬¬äºŒè®²ï¼šè®¤è¯†åäºŒå®«ä½åŠå…¶è±¡å¾æ„ä¹‰ï¼Œäº†è§£å®«ä½ä¹‹é—´çš„ç›¸äº’å…³ç³»ã€‚",
            ziwei0011: "ç´«è–‡æ–—æ•°ç¬¬åä¸€è®²ï¼šæ·±å…¥è§£æå‘½å®«ä¸èº«å®«çš„åŒºåˆ«ä¸è”ç³»ï¼ŒæŒæ¡å…¶åˆ¤æ–­æ–¹æ³•ã€‚",
            zhouyi0001: "å‘¨æ˜“64å¦ç¬¬ä¸€è®²ï¼šå‘¨æ˜“çš„åŸºæœ¬æ¦‚å¿µä¸å“²å­¦æ€æƒ³ï¼Œå¦è±¡çš„ç»„æˆä¸è§£è¯»æ–¹æ³•ã€‚",
            zhouyi0002: "å‘¨æ˜“64å¦ç¬¬äºŒè®²ï¼šä¹¾å¦ä¸å¤å¦çš„æ·±åˆ»å«ä¹‰ï¼Œå¤©åœ°ä¹‹é“çš„è±¡å¾ä¸å¯ç¤ºã€‚",
            kanyu0001: "åœ°ç†å ªèˆ†ç¬¬ä¸€è®²ï¼šé£æ°´å­¦çš„åŸºæœ¬åŸç†ä¸å†å²å‘å±•ï¼Œç¯å¢ƒä¸äººçš„å…³ç³»ã€‚",
            kanyu0002: "åœ°ç†å ªèˆ†ç¬¬äºŒè®²ï¼šé¾™ã€ç©´ã€ç ‚ã€æ°´ã€å‘äº”å¤§è¦ç´ è§£æä¸åº”ç”¨ã€‚",
            other0001: "å…¶ä»–å†…å®¹ç¬¬ä¸€è®²ï¼šå¥‡é—¨éç”²å…¥é—¨ï¼Œäº†è§£å¥‡é—¨éç”²çš„åŸºæœ¬æ¡†æ¶ä¸åº”ç”¨èŒƒå›´ã€‚",
            other0002: "å…¶ä»–å†…å®¹ç¬¬äºŒè®²ï¼šå…«å­—å‘½ç†åŸºç¡€ï¼Œè®¤è¯†å¤©å¹²åœ°æ”¯ä¸äº”è¡Œç”Ÿå…‹å…³ç³»ã€‚"
        };
        
        // åˆå§‹åŒ–é¡µé¢
        function initPage() {
            // è®¾ç½®è¯¾ç¨‹æ ‡ç­¾ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.course-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // æ›´æ–°æ¿€æ´»çš„æ ‡ç­¾
                    document.querySelectorAll('.course-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // æ›´æ–°å½“å‰è¯¾ç¨‹
                    currentCourse = this.getAttribute('data-course');
                    currentCourseName.textContent = courses[currentCourse].name;
                    
                    // ç”Ÿæˆç« èŠ‚
                    generateChapters(currentCourse);
                    
                    // æ›´æ–°è§†é¢‘æè¿°
                    updateVideoDescription(courses[currentCourse].description);
                    
                    // é‡ç½®ä¸ºç¬¬ä¸€ç« ç¬¬ä¸€èŠ‚è¯¾
                    const firstLesson = document.querySelector(`.lesson[data-video-id="${currentCourse}0001"]`);
                    if (firstLesson) {
                        setActiveLesson(firstLesson);
                    }
                });
            });
            
            // ç”Ÿæˆåˆå§‹ç« èŠ‚ï¼ˆç´«è–‡æ–—æ•°ï¼‰
            generateChapters('ziwei');
            
            // è®¾ç½®ç¬¬ä¸€ä¸ªç« èŠ‚ä¸ºæ¿€æ´»çŠ¶æ€
            const firstChapter = document.querySelector('.chapter');
            if (firstChapter) {
                firstChapter.classList.add('active');
            }
            
            // è®¾ç½®ç¬¬ä¸€èŠ‚è¯¾ä¸ºæ¿€æ´»çŠ¶æ€
            const firstLesson = document.querySelector('.lesson');
            if (firstLesson) {
                setActiveLesson(firstLesson);
            }
            
            // åˆå§‹åŒ–è§†é¢‘æ’­æ”¾å™¨
            initVideoPlayer();
        }
        
        // ç”Ÿæˆç« èŠ‚å†…å®¹
        function generateChapters(courseId) {
            const course = courses[courseId];
            chaptersContainer.innerHTML = '';
            
            for (let chapter = 1; chapter <= course.chapters; chapter++) {
                // åˆ›å»ºç« èŠ‚å…ƒç´ 
                const chapterEl = document.createElement('div');
                chapterEl.className = 'chapter';
                chapterEl.innerHTML = `
                    <div class="chapter-header">
                        <div class="chapter-title">ç¬¬${chapter}ç«  ${getChapterTitle(courseId, chapter)}</div>
                        <div class="toggle-icon"><i class="fas fa-chevron-right"></i></div>
                    </div>
                    <div class="lessons">
                        ${generateLessons(courseId, chapter)}
                    </div>
                `;
                
                // æ·»åŠ ç« èŠ‚ç‚¹å‡»äº‹ä»¶
                const chapterHeader = chapterEl.querySelector('.chapter-header');
                chapterHeader.addEventListener('click', function() {
                    // åˆ‡æ¢ç« èŠ‚å±•å¼€çŠ¶æ€
                    const isActive = chapterEl.classList.contains('active');
                    document.querySelectorAll('.chapter').forEach(c => c.classList.remove('active'));
                    if (!isActive) {
                        chapterEl.classList.add('active');
                    }
                });
                
                chaptersContainer.appendChild(chapterEl);
            }
            
            // è®¾ç½®è¯¾ç¨‹ç¬¬ä¸€ç« èŠ‚ä¸ºå±•å¼€çŠ¶æ€
            const firstChapter = chaptersContainer.querySelector('.chapter');
            if (firstChapter) {
                firstChapter.classList.add('active');
            }
            
            // ä¸ºæ‰€æœ‰è¯¾ç¨‹å°èŠ‚æ·»åŠ ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.lesson').forEach(lesson => {
                lesson.addEventListener('click', function() {
                    setActiveLesson(this);
                });
            });
        }
        
        // ç”Ÿæˆè¯¾ç¨‹å°èŠ‚
        function generateLessons(courseId, chapter) {
            let lessonsHTML = '';
            const course = courses[courseId];
            // æ”¯æŒæ¯ä¸ªç« èŠ‚ä¸åŒæ•°é‡çš„è¯¾èŠ‚
            const lessonsPerChapter = Array.isArray(course.lessonsPerChapter) 
                ? course.lessonsPerChapter[chapter - 1] 
                : course.lessonsPerChapter;
            
            // è®¡ç®—èµ·å§‹ç¼–å·
            let startNum = 1;
            if (Array.isArray(course.lessonsPerChapter)) {
                // å¦‚æœæ¯ä¸ªç« èŠ‚è¯¾èŠ‚æ•°ä¸åŒï¼Œéœ€è¦ç´¯åŠ å‰é¢ç« èŠ‚çš„è¯¾èŠ‚æ•°
                for (let i = 0; i < chapter - 1; i++) {
                    startNum += course.lessonsPerChapter[i];
                }
            } else {
                startNum = (chapter - 1) * lessonsPerChapter + 1;
            }
            
            for (let i = 0; i < lessonsPerChapter; i++) {
                const lessonNum = startNum + i;
                // æ ¼å¼åŒ–ä¸º4ä½æ•°å­—ï¼Œå‰é¢è¡¥0
                const lessonId = lessonNum.toString().padStart(4, '0');
                const videoId = `${courseId}${lessonId}`;
                const lessonTitle = getLessonTitle(courseId, chapter, i+1);
                
                lessonsHTML += `
                    <div class="lesson" data-video-id="${videoId}">
                        <div class="lesson-icon"><i class="fas fa-play-circle"></i></div>
                        <div class="lesson-title">ç¬¬${i+1}èŠ‚ ${lessonTitle}</div>
                        <div class="lesson-duration">${getRandomDuration()}</div>
                    </div>
                `;
            }
            
            return lessonsHTML;
        }
        
        // è·å–ç« èŠ‚æ ‡é¢˜
        function getChapterTitle(courseId, chapter) {
            const chapterTitles = {
                ziwei: [
                    "ç´«è–‡æ–—æ•°åŸºç¡€æ¦‚å¿µ", "åäºŒå®«ä½è¯¦è§£", "åå››ä¸»æ˜Ÿè§£æ", "è¾…æ˜Ÿä¸æ‚æ›œ", "å››åŒ–æ˜Ÿçš„åº”ç”¨",
                    "å‘½ç›˜æ’ç›˜æ–¹æ³•", "å„å®«ä½å…³ç³»åˆ†æ", "æµå¹´ä¸å¤§è¿", "ç‰¹æ®Šæ ¼å±€è§£æ", "å®æˆ˜æ¡ˆä¾‹åˆ†æ"
                ],
                zhouyi: [
                    "ç®€è¿°", "64å¦è¯¦è§£"
                ],
                kanyu: [
                    "é£æ°´å­¦åŸºç¡€", "é¾™è„‰ä¸æ°”åœº", "æ°´æ³•ä¸æ°´å£", "ç ‚æ³•ä¸æ˜å ‚", "æœå‘ä¸åå±±",
                    "é˜³å®…é£æ°´", "é˜´å®…é£æ°´", "å…«å®…é£æ°´", "ç„ç©ºé£æ°´", "é£æ°´è°ƒæ•´å®ä¾‹"
                ],
                other: [
                    "å¥‡é—¨éç”²å…¥é—¨", "å…«å­—å‘½ç†åŸºç¡€", "é¢ç›¸å­¦å…¥é—¨", "æ‰‹ç›¸å­¦åŸºç¡€", "å…­çˆ»å åœ",
                    "å¤ªä¹™ç¥æ•°", "å…­å£¬ç¥è¯¾", "å§“åå­¦åŸºç¡€", "æ‹©æ—¥å­¦å…¥é—¨", "ä¼ ç»Ÿæ˜“å­¦ç»¼åˆåº”ç”¨"
                ]
            };
            
            return chapterTitles[courseId][chapter-1] || `ç¬¬${chapter}ç« `;
        }
        
        // è·å–è¯¾ç¨‹å°èŠ‚æ ‡é¢˜
        function getLessonTitle(courseId, chapter, lesson) {
            // 64å¦åç§°åˆ—è¡¨ï¼ˆæŒ‰æ ‡å‡†é¡ºåºï¼‰
            const zhouyi64GuaNames = [
                "ä¹¾ä¸ºå¤©", "å¤ä¸ºåœ°", "æ°´é›·å±¯", "å±±æ°´è’™", "æ°´å¤©éœ€", "å¤©æ°´è®¼", "åœ°æ°´å¸ˆ", "æ°´åœ°æ¯”",
                "é£å¤©å°ç•œ", "å¤©æ³½å±¥", "åœ°å¤©æ³°", "å¤©åœ°å¦", "å¤©ç«åŒäºº", "ç«å¤©å¤§æœ‰", "åœ°å±±è°¦", "é›·åœ°è±«",
                "æ³½é›·éš", "å±±é£è›Š", "åœ°æ³½ä¸´", "é£åœ°è§‚", "ç«é›·å™¬å—‘", "å±±ç«è´²", "å±±åœ°å‰¥", "åœ°é›·å¤",
                "å¤©é›·æ— å¦„", "å±±å¤©å¤§ç•œ", "å±±é›·é¢", "æ³½é£å¤§è¿‡", "åä¸ºæ°´", "ç¦»ä¸ºç«", "æ³½å±±å’¸", "é›·é£æ’",
                "å¤©å±±é", "é›·å¤©å¤§å£®", "ç«åœ°æ™‹", "åœ°ç«æ˜å¤·", "é£ç«å®¶äºº", "ç«æ³½ç½", "æ°´å±±è¹‡", "é›·æ°´è§£",
                "å±±æ³½æŸ", "é£é›·ç›Š", "æ³½å¤©å¤¬", "å¤©é£å§¤", "æ³½åœ°èƒ", "åœ°é£å‡", "æ³½æ°´å›°", "æ°´é£äº•",
                "æ³½ç«é©", "ç«é£é¼", "éœ‡ä¸ºé›·", "è‰®ä¸ºå±±", "é£å±±æ¸", "é›·æ³½å½’å¦¹", "é›·ç«ä¸°", "ç«å±±æ—…",
                "å·½ä¸ºé£", "å…‘ä¸ºæ³½", "é£æ°´æ¶£", "æ°´æ³½èŠ‚", "é£æ³½ä¸­å­š", "é›·å±±å°è¿‡", "æ°´ç«æ—¢æµ", "ç«æ°´æœªæµ"
            ];
            
            const lessonTitles = {
                ziwei: ["åŸºç¡€ä»‹ç»", "å†å²æ¸Šæº", "å‘½ç›˜ç»“æ„", "æ˜Ÿæ›œåˆ†ç±»", "å®«ä½å«ä¹‰", "å››åŒ–æ˜ŸåŸºç¡€", "å‘½å®«è§£æ", "èº«å®«è§£æ", "åäºŒå®«å…³ç³»", "æ¡ˆä¾‹åˆ†æ"],
                zhouyi: {
                    1: ["å‘¨æ˜“ç®€ä»‹"], // ç¬¬ä¸€ç« åªæœ‰1èŠ‚
                    2: zhouyi64GuaNames // ç¬¬äºŒç« 64èŠ‚
                },
                kanyu: ["é£æ°´æ¦‚å¿µ", "æ°”åœºç†è®º", "é¾™è„‰è¯†åˆ«", "æ°´æ³•åŸºç¡€", "ç ‚æ³•åŸç†", "æœå‘é€‰æ‹©", "å…«å®…ç†è®º", "ç„ç©ºåŸºç¡€", "é£æ°´è°ƒæ•´", "å®ä¾‹åˆ†æ"],
                other: ["å¥‡é—¨åŸºç¡€", "å…«å­—æ’ç›˜", "é¢ç›¸äº”å®˜", "æ‰‹ç›¸ä¸»çº¿", "å…­çˆ»èµ·å¦", "å¤ªä¹™æ’ç›˜", "å…­å£¬è¯¾å¼", "å§“åäº”è¡Œ", "æ‹©æ—¥åŸç†", "ç»¼åˆåº”ç”¨"]
            };
            
            // å¯¹äº zhouyiï¼Œéœ€è¦æ ¹æ®ç« èŠ‚è·å–æ ‡é¢˜
            if (courseId === 'zhouyi' && lessonTitles.zhouyi[chapter]) {
                return lessonTitles.zhouyi[chapter][lesson-1] || `ç¬¬${lesson}èŠ‚`;
            }
            
            // å…¶ä»–è¯¾ç¨‹ä½¿ç”¨åŸæœ‰é€»è¾‘
            const titles = Array.isArray(lessonTitles[courseId]) ? lessonTitles[courseId] : null;
            return titles ? (titles[lesson-1] || `ç¬¬${lesson}èŠ‚`) : `ç¬¬${lesson}èŠ‚`;
        }
        
        // è·å–éšæœºè§†é¢‘æ—¶é•¿
        function getRandomDuration() {
            const minutes = Math.floor(Math.random() * 10) + 8; // 8-17åˆ†é’Ÿ
            const seconds = Math.floor(Math.random() * 60);
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // è®¾ç½®æ¿€æ´»çš„è¯¾ç¨‹å°èŠ‚
        function setActiveLesson(lessonElement) {
            // ç§»é™¤æ‰€æœ‰æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.lesson').forEach(l => l.classList.remove('active'));
            
            // æ·»åŠ æ¿€æ´»çŠ¶æ€åˆ°å½“å‰è¯¾ç¨‹
            lessonElement.classList.add('active');
            
            // è·å–è§†é¢‘ID
            currentVideoId = lessonElement.getAttribute('data-video-id');
            
            // æ›´æ–°è§†é¢‘IDæ˜¾ç¤º
            currentVideoIdEl.textContent = `${currentVideoId}.MP4`;
            
            // æ›´æ–°è§†é¢‘è·¯å¾„æ˜¾ç¤º
            videoPathEl.textContent = `./${currentVideoId}.MP4`;
            
            // æ›´æ–°è§†é¢‘æè¿°
            const description = videoDescriptions[currentVideoId] || 
                               `æ­£åœ¨æ’­æ”¾ï¼š${courses[currentCourse].name} - ${lessonElement.querySelector('.lesson-title').textContent}`;
            videoDescription.textContent = description;
            
            // éšè—é”™è¯¯ä¿¡æ¯
            videoError.style.display = 'none';
            
            // åŠ è½½æœ¬åœ°è§†é¢‘æ–‡ä»¶
            loadLocalVideo(currentVideoId);
            
            // é‡ç½®æ’­æ”¾å™¨
            videoPlayer.currentTime = 0;
            progressBar.style.width = '0%';
            currentTimeEl.textContent = formatTime(0);
        }
        
        // åŠ è½½æœ¬åœ°è§†é¢‘ - ç®€åŒ–çš„ç›´æ¥åŠ è½½æ–¹æ³•
        function loadLocalVideo(videoId) {
            // ç›´æ¥è®¾ç½®è§†é¢‘æº
            const videoUrl = `${videoId}.MP4`;
            videoPlayer.src = videoUrl;
            
            // åŠ è½½è§†é¢‘
            videoPlayer.load();
            
            // å°è¯•æ’­æ”¾è§†é¢‘
            const playPromise = videoPlayer.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                }).catch(error => {
                    console.log("è‡ªåŠ¨æ’­æ”¾å¤±è´¥ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’", error);
                    playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                });
            }
        }
        
        // æ›´æ–°è§†é¢‘æè¿°
        function updateVideoDescription(description) {
            videoDescription.textContent = description;
        }
        
        // åˆå§‹åŒ–è§†é¢‘æ’­æ”¾å™¨
        function initVideoPlayer() {
            // æ’­æ”¾/æš‚åœæŒ‰é’®
            playPauseBtn.addEventListener('click', () => {
                if (videoPlayer.paused) {
                    videoPlayer.play();
                    playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                } else {
                    videoPlayer.pause();
                    playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                }
            });
            
            // é™éŸ³æŒ‰é’®
            muteBtn.addEventListener('click', () => {
                videoPlayer.muted = !videoPlayer.muted;
                muteBtn.innerHTML = videoPlayer.muted ? 
                    '<i class="fas fa-volume-mute"></i>' : 
                    '<i class="fas fa-volume-up"></i>';
            });
            
            // å…¨å±æŒ‰é’®
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            
            // æ£€æµ‹å…¨å±å˜åŒ–
            document.addEventListener('fullscreenchange', updateFullscreenButton);
            document.addEventListener('webkitfullscreenchange', updateFullscreenButton);
            document.addEventListener('mozfullscreenchange', updateFullscreenButton);
            document.addEventListener('MSFullscreenChange', updateFullscreenButton);
            
            // è¿›åº¦æ¡æ§åˆ¶
            progressContainer.addEventListener('click', (e) => {
                const rect = progressContainer.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                videoPlayer.currentTime = percent * videoPlayer.duration;
            });
            
            // å€é€Ÿæ§åˆ¶
            speedControl.addEventListener('change', () => {
                videoPlayer.playbackRate = parseFloat(speedControl.value);
            });
            
            // è§†é¢‘æ—¶é—´æ›´æ–°
            videoPlayer.addEventListener('timeupdate', () => {
                const percent = (videoPlayer.currentTime / videoPlayer.duration) * 100;
                progressBar.style.width = `${percent}%`;
                currentTimeEl.textContent = formatTime(videoPlayer.currentTime);
            });
            
            // è§†é¢‘åŠ è½½å®Œæˆ
            videoPlayer.addEventListener('loadedmetadata', () => {
                durationEl.textContent = formatTime(videoPlayer.duration);
            });
            
            // è§†é¢‘æ’­æ”¾ç»“æŸ
            videoPlayer.addEventListener('ended', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                progressBar.style.width = '100%';
            });
            
            // è§†é¢‘æ’­æ”¾çŠ¶æ€å˜åŒ–
            videoPlayer.addEventListener('play', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            });
            
            videoPlayer.addEventListener('pause', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            });
            
            // è§†é¢‘é”™è¯¯å¤„ç†
            videoPlayer.addEventListener('error', function() {
                videoError.style.display = 'block';
                errorMessage.textContent = `æ— æ³•åŠ è½½è§†é¢‘ ${currentVideoId}.MP4ï¼Œè¯·ç¡®ä¿æ–‡ä»¶å­˜åœ¨ä¸”ä¸HTMLæ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚`;
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            });
            
            // è§†é¢‘åŠ è½½å¼€å§‹
            videoPlayer.addEventListener('loadstart', function() {
                videoError.style.display = 'none';
            });
        }
        
        // åˆ‡æ¢å…¨å±
        function toggleFullscreen() {
            if (!document.fullscreenElement &&    // æ ‡å‡†
                !document.webkitFullscreenElement && // Safari
                !document.mozFullScreenElement && // Firefox
                !document.msFullscreenElement) { // IE/Edge
                
                if (videoSection.requestFullscreen) {
                    videoSection.requestFullscreen();
                } else if (videoSection.webkitRequestFullscreen) {
                    videoSection.webkitRequestFullscreen();
                } else if (videoSection.mozRequestFullScreen) {
                    videoSection.mozRequestFullScreen();
                } else if (videoSection.msRequestFullscreen) {
                    videoSection.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }
        
        // æ›´æ–°å…¨å±æŒ‰é’®çŠ¶æ€
        function updateFullscreenButton() {
            if (document.fullscreenElement ||
                document.webkitFullscreenElement ||
                document.mozFullScreenElement ||
                document.msFullscreenElement) {
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                fullscreenBtn.title = 'é€€å‡ºå…¨å±';
            } else {
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                fullscreenBtn.title = 'å…¨å±';
            }
        }
        
        // æ ¼å¼åŒ–æ—¶é—´æ˜¾ç¤º
        function formatTime(seconds) {
            if (isNaN(seconds)) return "0:00";
            
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
    
    <!-- é¡µé¢å¯¼èˆªç®­å¤´æŒ‰é’® -->
    <div class="page-nav-arrows">
        <button id="pageNavArrowLeft" class="page-nav-arrow page-nav-arrow-left" title="ä¸Šä¸€é¡µ">â€¹</button>
        <button id="pageNavArrowRight" class="page-nav-arrow page-nav-arrow-right" title="ä¸‹ä¸€é¡µ">â€º</button>
    </div>
    
    <script>
        // é¡µé¢å¯¼èˆªç®­å¤´åŠŸèƒ½
        (function() {
            var pageSelector = document.getElementById('pageSelector');
            var arrowLeft = document.getElementById('pageNavArrowLeft');
            var arrowRight = document.getElementById('pageNavArrowRight');
            
            if(!pageSelector || !arrowLeft || !arrowRight) {
                console.warn('é¡µé¢å¯¼èˆªç®­å¤´å…ƒç´ æœªæ‰¾åˆ°');
                return;
            }
            
            // è·å–æ‰€æœ‰é¡µé¢é€‰é¡¹
            function getAllPages() {
                var pages = [];
                if(pageSelector && pageSelector.options) {
                    for(var i = 0; i < pageSelector.options.length; i++) {
                        var option = pageSelector.options[i];
                        if(option.value) {
                            pages.push(option.value);
                        }
                    }
                }
                return pages;
            }
            
            // è·å–å½“å‰é¡µé¢ç´¢å¼•
            function getCurrentPageIndex() {
                var pages = getAllPages();
                var currentPage = pageSelector.value;
                return pages.indexOf(currentPage);
            }
            
            // æ›´æ–°ç®­å¤´æŒ‰é’®çŠ¶æ€ï¼ˆå¾ªç¯åˆ‡æ¢ï¼Œä¸éœ€è¦ç¦ç”¨ï¼‰
            function updateArrowButtons() {
                // å¾ªç¯åˆ‡æ¢æ¨¡å¼ä¸‹ï¼Œç®­å¤´å§‹ç»ˆå¯ç”¨
                arrowLeft.disabled = false;
                arrowRight.disabled = false;
            }
            
            // åˆ‡æ¢åˆ°ä¸Šä¸€é¡µï¼ˆæ”¯æŒå¾ªç¯ï¼šç¬¬ä¸€é¡µæ—¶è·³è½¬åˆ°æœ€åä¸€é¡µï¼‰
            function goToPreviousPage() {
                var pages = getAllPages();
                if(pages.length === 0) return;
                
                var currentIndex = getCurrentPageIndex();
                var previousIndex;
                
                // å¦‚æœå½“å‰æ˜¯ç¬¬ä¸€é¡µï¼Œè·³è½¬åˆ°æœ€åä¸€é¡µï¼ˆå¾ªç¯ï¼‰
                if(currentIndex <= 0) {
                    previousIndex = pages.length - 1;
                } else {
                    previousIndex = currentIndex - 1;
                }
                
                var previousPage = pages[previousIndex];
                pageSelector.value = previousPage;
                // è§¦å‘changeäº‹ä»¶ä»¥æ‰§è¡Œé¡µé¢åˆ‡æ¢
                var event = new Event('change', { bubbles: true });
                pageSelector.dispatchEvent(event);
            }
            
            // åˆ‡æ¢åˆ°ä¸‹ä¸€é¡µï¼ˆæ”¯æŒå¾ªç¯ï¼šæœ€åä¸€é¡µæ—¶è·³è½¬åˆ°ç¬¬ä¸€é¡µï¼‰
            function goToNextPage() {
                var pages = getAllPages();
                if(pages.length === 0) return;
                
                var currentIndex = getCurrentPageIndex();
                var nextIndex;
                
                // å¦‚æœå½“å‰æ˜¯æœ€åä¸€é¡µï¼Œè·³è½¬åˆ°ç¬¬ä¸€é¡µï¼ˆå¾ªç¯ï¼‰
                if(currentIndex >= pages.length - 1) {
                    nextIndex = 0;
                } else {
                    nextIndex = currentIndex + 1;
                }
                
                var nextPage = pages[nextIndex];
                pageSelector.value = nextPage;
                // è§¦å‘changeäº‹ä»¶ä»¥æ‰§è¡Œé¡µé¢åˆ‡æ¢
                var event = new Event('change', { bubbles: true });
                pageSelector.dispatchEvent(event);
            }
            
            // ç»‘å®šç‚¹å‡»äº‹ä»¶
            arrowLeft.addEventListener('click', function() {
                goToPreviousPage();
            });
            
            arrowRight.addEventListener('click', function() {
                goToNextPage();
            });
            
            // ç›‘å¬é¡µé¢é€‰æ‹©å™¨å˜åŒ–ï¼Œæ›´æ–°ç®­å¤´çŠ¶æ€
            pageSelector.addEventListener('change', function() {
                // å»¶è¿Ÿæ›´æ–°ï¼Œç¡®ä¿é¡µé¢åˆ‡æ¢å®Œæˆ
                setTimeout(function() {
                    updateArrowButtons();
                }, 100);
            });
            
            // åˆå§‹åŒ–ç®­å¤´çŠ¶æ€
            setTimeout(function() {
                updateArrowButtons();
            }, 500);
            
            // é¡µé¢å¯è§æ€§å˜åŒ–æ—¶ä¹Ÿæ›´æ–°ï¼ˆå¤„ç†æµè§ˆå™¨æ ‡ç­¾åˆ‡æ¢ï¼‰
            document.addEventListener('visibilitychange', function() {
                if(!document.hidden) {
                    setTimeout(function() {
                        updateArrowButtons();
                    }, 100);
                }
            });
        })();
    </script>
</body>
</html>




            </div>
        </section>





        <!-- å­¦ä¹ åŠ©æ‰‹é¡µé¢ -->
        <section id="statemena" class="page-content active">
              <!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜“ç»æ¨å‘½ - å¤©çºªç»ˆæåŸè‘—ç‰ˆ</title>
    <!-- å°è¯•åŠ è½½æœ¬åœ°lunar.jsæ–‡ä»¶ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä»CDNåŠ è½½ -->
    <script>
        // #region agent log
        // æ£€æŸ¥lunar.jsåŠ è½½çŠ¶æ€
        var lunarJsLoaded = false;
        var checkLunarJs = function() {
            var hasSolar = typeof Solar !== 'undefined';
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:lunar.js-check',message:'lunar.jsåŠ è½½çŠ¶æ€æ£€æŸ¥',data:{typeofSolar:typeof Solar,hasSolar:hasSolar,triedLocal:true},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
            if(!hasSolar && !lunarJsLoaded) {
                // å¦‚æœæœ¬åœ°åŠ è½½å¤±è´¥ï¼Œå°è¯•ä»CDNåŠ è½½
                var script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/lunar-javascript@1.2.37/lunar.js';
                script.onload = function() {
                    lunarJsLoaded = true;
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:lunar.js',message:'lunar.js CDNåŠ è½½æˆåŠŸ',data:{typeofSolar:typeof Solar},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
                };
                script.onerror = function() {
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:lunar.js',message:'lunar.js CDNåŠ è½½å¤±è´¥',data:{error:'CDNåŠ è½½è¶…æ—¶æˆ–å¤±è´¥'},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
                };
                document.head.appendChild(script);
            }
        };
        
        // å…ˆå°è¯•åŠ è½½æœ¬åœ°æ–‡ä»¶
        var localScript = document.createElement('script');
        localScript.src = 'lunar.js';
        localScript.onload = function() {
            lunarJsLoaded = true;
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:lunar.js',message:'lunar.jsæœ¬åœ°åŠ è½½æˆåŠŸ',data:{typeofSolar:typeof Solar},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
            checkLunarJs();
        };
        localScript.onerror = function() {
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:lunar.js',message:'lunar.jsæœ¬åœ°æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°è¯•CDN',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
            checkLunarJs();
        };
        document.head.appendChild(localScript);
        
        // å»¶è¿Ÿæ£€æŸ¥ï¼Œç¡®ä¿è„šæœ¬åŠ è½½å®Œæˆ
        setTimeout(checkLunarJs, 3000);
        // #endregion
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --blue: #1677ff; --bg: #f0f2f5; --card: #fff; --text: #333; --red: #ff4d4f; --border: #e5e7eb; }
        body { font-family: "Microsoft YaHei", sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; line-height: 1.5; width: 100%; }
        html, body { width: 100%; margin: 0; padding: 0; }
        .container { max-width: none; width: 100%; margin: 0; padding: 20px; box-sizing: border-box; }
        .panel { background: var(--card); border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; }
        .panel-head { font-size: 18px; font-weight: bold; border-bottom: 1px solid var(--border); padding-bottom: 12px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; color: #1f1f1f; }
        .mingli-panel { padding: 4px 20px 3px 20px !important; margin-bottom: 0px !important; }
        .mingli-panel .panel-head { padding-bottom: 2px !important; margin-bottom: 0 !important; font-size: 16px !important; }
        .input-row { display: flex; flex-wrap: wrap; gap: 10px; align-items: flex-end; }
        .input-group { display: flex; flex-direction: column; }
        .input-group label { font-size: 12px; color: #666; margin-bottom: 5px; }
        .input-row input[type="number"], .input-row select { 
            padding: 8px 10px; 
            border: 1px solid #d9d9d9; 
            border-radius: 4px; 
            width: 90px !important; 
            min-width: 90px !important; 
            max-width: 90px !important; 
            outline: none; 
            box-sizing: border-box; 
            font-size: 14px;
            height: 36px;
        }
        .btn { padding: 8px 20px; border: none; border-radius: 4px; cursor: pointer; color: #fff; font-weight: bold; font-size: 14px; transition: 0.2s; }
        .btn-primary { background: var(--blue); }
        .btn-primary:hover { background: #4096ff; }
        .btn-green { background: #52c41a; }
        .bz-table { width: 100%; border-collapse: collapse; text-align: center; border: 1px solid #f0f0f0; }
        .bz-table th { background: #fafafa; padding: 10px; color: #666; border: 1px solid #f0f0f0; }
        .bz-table td { padding: 15px; border: 1px solid #f0f0f0; font-size: 16px; }
        .ganzhi { font-weight: bold; font-size: 22px; display: block; margin-bottom: 5px; }
        .sum-info { background: #e6f7ff; color: #096dd9; padding: 10px; text-align: center; margin-top: 10px; border-radius: 4px; font-weight: bold; }
        .gua-area { display: flex; justify-content: center; gap: 40px; flex-wrap: wrap; }
        .gua-box { width: 220px; border: 1px solid #f0f0f0; background: #fafafa; border-radius: 8px; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .gua-name { font-size: 20px; font-weight: bold; color: var(--red); margin-bottom: 15px; border-bottom: 2px solid #ffccc7; width: 100%; text-align: center; padding-bottom: 10px; }
        .yao-stack { display: flex; flex-direction: column; gap: 6px; width: 100px; }
        .yao-line { height: 18px; display: flex; justify-content: space-between; position: relative; }
        .yang { width: 100%; height: 100%; background: #333; border-radius: 2px; }
        .yin-group { width: 100%; height: 100%; display: flex; justify-content: space-between; }
        .yin-part { width: 42%; height: 100%; background: #333; border-radius: 2px; }
        .is-yt .yang, .is-yt .yin-part { background: var(--red); }
        .yt-text { position: absolute; right: -65px; top: 0; color: var(--red); font-size: 12px; font-weight: bold; line-height: 18px; }
        .idx-text { position: absolute; left: -30px; top: 0; color: #ccc; font-size: 12px; line-height: 18px; }
        .dy-container { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
        .dy-card { background: #fff; border: 1px solid #e0e0e0; padding: 8px 15px; border-radius: 4px; text-align: center; min-width: 80px; }
        .dy-title { font-size: 12px; color: #999; margin-bottom: 2px; }
        .dy-range { font-weight: bold; color: var(--blue); font-size: 14px; }
        .flow-panel { background: #f0f9ff; border: 1px solid #bae7ff; }
        .flow-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px; }
        .flow-item { background: #fff; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #e6f7ff; box-shadow: 0 2px 6px rgba(0,0,0,0.02); }
        .flow-label { font-size: 12px; color: #888; margin-bottom: 5px; font-weight: bold; }
        .flow-val { font-size: 18px; font-weight: bold; color: #333; }
        .flow-extra { font-size: 11px; color: #666; margin-top: 5px; line-height: 1.4; }
        .flow-time { font-size: 10px; color: #999; margin-top: 3px; }
        .debug-info { background: #f9f9f9; border-left: 0px solid #ccc; padding: 10px; margin: 10px 0; font-size: 12px; color: #666; }
    </style>
</head>
<body>


<div class="chat-header">
                    <ul style="margin-left: 60px; margin-bottom: 15px;height: 4vh">
                <li>å…ˆä½¿ç”¨å‘¨æ˜“æ’ç›˜ç³»ç»Ÿè¿›è¡Œæ’å¦</li>
                <li>å†ä½¿ç”¨64å¦åˆ†æç³»ç»Ÿè¿›è¡Œåˆ†æ</li>
            </ul>

                </div>
            <h2><p> å‘¨æ˜“æ’ç›˜ç³»ç»Ÿ</h2></p>
 
  <!-- å‘½ä¾‹ç®¡ç†æ¨¡å— -->
  <div class="container" style="margin-bottom: 0px;">
    <div class="panel mingli-panel">
        <div class="panel-head">
            <span>å‘½ä¾‹ç®¡ç†</span>
            <div style="display: flex; gap: 10px; align-items: center;">
                <button id="startChartingBtn" class="btn btn-primary" onclick="showChartingForm()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">å¼€å§‹<br>æ’ç›˜</button>
                <button class="btn btn-primary" onclick="showMingliDialog()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">ä¿å­˜<br>å‘½ä¾‹</button>
                <button class="btn btn-primary" onclick="showMingliList()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">é€‰æ‹©<br>å‘½ä¾‹</button>
                <button class="btn btn-primary" onclick="exportMingliData()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">å¯¼å‡º<br>æ•°æ®</button>
                <input type="file" id="mingliImportFile" accept=".json" style="display: none;" onchange="importMingliData(event)">
                <button class="btn btn-primary" onclick="document.getElementById('mingliImportFile').click()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">å¯¼å…¥<br>æ•°æ®</button>
                <button class="btn btn-primary" onclick="downloadMingli()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">ä¸‹è½½<br>å‘½ä¾‹</button>
            </div>
        </div>
    </div>
  </div>

  <div id="chartingPanelContainer" class="container" style="margin-top: 0px; display: none;">
    <div class="panel" style="margin-top: 0px;">
        <div class="panel-head">
            <span> å‘½é€ æ’ç›˜ </span>
        </div>
        <div id="chartingFormContainer" style="display: none;">
            <div class="input-row">
                <div class="input-group"><label>å…¬å†å¹´</label><input type="number" id="y" value="2000"></div>
                <div class="input-group"><label>æœˆ</label><select id="m"></select></div>
                <div class="input-group"><label>æ—¥</label><select id="d"></select></div>
                <div class="input-group"><label>æ—¶</label><input type="number" id="h" value="0"></div>
                <div class="input-group"><label>åˆ†</label><input type="number" id="min" value="1"></div>
                <div class="input-group"><label>æ€§åˆ«</label><select id="sex"><option value="1">ç”·</option><option value="0">å¥³</option></select></div>
                <div class="input-group"><label>ç»åº¦</label><input type="number" id="lon" value="120.0"></div>
            </div>
            <div style="width: 100%; margin-top: 10px;">
                <div class="input-group" style="position: relative; width: 100%;">
                    <label>å‡ºç”Ÿåœ°</label>
                    <div style="display: flex; gap: 5px; margin-bottom: 5px;">
                        <select id="province-select" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="">è¯·é€‰æ‹©çœä»½</option>
                        </select>
                        <select id="city-select" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" disabled>
                            <option value="">è¯·é€‰æ‹©åŸå¸‚</option>
                        </select>
                    </div>
                    <input type="text" id="city-input" placeholder="æˆ–ç›´æ¥è¾“å…¥åŸå¸‚åç§°æœç´¢" autocomplete="off" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    <div id="city-dropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ddd; border-radius: 4px; max-height: 300px; overflow-y: auto; z-index: 1000; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-top: 2px;"></div>
                </div>
            </div>
            <div style="width: 100%; margin-top: 10px;">
                <div class="input-group" style="position: relative; width: 100%;">
                    <label>å‡ºç”Ÿåœ°ï¼ˆå›½å¤–ï¼‰</label>
                    <div style="display: flex; gap: 5px; margin-bottom: 5px;">
                        <select id="continent-select" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="">è¯·é€‰æ‹©å¤§æ´²</option>
                        </select>
                        <select id="country-select" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" disabled>
                            <option value="">è¯·é€‰æ‹©å›½å®¶</option>
                        </select>
                        <select id="foreign-city-select" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" disabled>
                            <option value="">è¯·é€‰æ‹©åŸå¸‚</option>
                        </select>
                    </div>
                    <input type="text" id="foreign-city-input" placeholder="æˆ–ç›´æ¥è¾“å…¥åŸå¸‚åç§°æœç´¢" autocomplete="off" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    <div id="foreign-city-dropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ddd; border-radius: 4px; max-height: 300px; overflow-y: auto; z-index: 1000; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-top: 2px;"></div>
                </div>
            </div>
            <div style="width: 100%; margin-top: 15px; text-align: center;">
                <button class="btn btn-primary" onclick="calcMain()" style="background:#4CAF50; color:white; padding: 10px 30px; font-size: 16px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">æ‰§è¡Œæ’ç›˜</button>
            </div>
        </div>
    </div>

    <div id="result-view" style="display:none;">
        <div class="panel">
            <div class="panel-head">2. å››æŸ±å…«å­—ä¸æ•°ç†</div>
            <div style="font-size:12px; color:#666; margin-bottom:10px;">çœŸå¤ªé˜³æ—¶: <span id="txt-time"></span> | èŠ‚æ°”: <span id="txt-jie"></span></div>
            <table class="bz-table">
                <thead><tr><th>å¹´æŸ±</th><th>æœˆæŸ±</th><th>æ—¥æŸ±</th><th>æ—¶æŸ±</th></tr></thead>
                <tbody id="bz-body"></tbody>
            </table>
            <div class="sum-info">åœ°æ•°ï¼š<span id="val-dishu"></span> | å¤©æ•°ï¼š<span id="val-tianshu"></span></div>
        </div>

        <div class="panel">
            <div class="panel-head">3. å‘½å¦ (å…ˆå¤© / åå¤©)</div>
            <div class="gua-area">
                <div class="gua-box">
                    <div class="gua-name" id="n-xt">--</div>
                    <div id="g-xt" class="yao-stack"></div>
                </div>
                <div class="gua-box">
                    <div class="gua-name" id="n-ht">--</div>
                    <div id="g-ht" class="yao-stack"></div>
                </div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-head">4. å¤§è¿æµè½¬</div>
            <div id="dy-area" class="dy-container"></div>
        </div>

        <div class="panel flow-panel">
            <div class="panel-head" style="border-bottom-color:#91d5ff; color:#003a8c;">
                <span>5. ä»»æ„æ—¶åˆ»æµè¿æ¨ç®—</span>
                <p><button class="btn btn-primary" onclick="calcFlow()">åˆ·æ–°æµè¿</button></p>
            </div>
            <div class="input-row">
                <div class="input-group"><label>æŸ¥å¹´</label><input type="number" id="cy"></div>
                <div class="input-group"><label>æœˆ</label><select id="cm"></select></div>
                <div class="input-group"><label>æ—¥</label><select id="cd"></select></div>
                <div class="input-group"><label>æ—¶</label><input type="number" id="ch"></div>
                <div class="input-group"><label>åˆ†</label><input type="number" id="cmin"></div>
                <div class="input-group"><label>&nbsp;</label><button class="btn btn-green" onclick="setNow()">å½“å‰æ—¶é—´</button></div>
            </div>
            <div class="flow-grid">
                <div class="flow-item">
                    <div class="flow-label">æµå¹´ï¼ˆå¤©çºªç®—æ³•ï¼‰</div>
                    <div class="flow-val" id="fv-y">--</div>
                    <div id="g-ly" class="yao-stack" style="margin: 10px auto;"></div>
                    <div class="flow-extra" id="fd-y"></div>
                </div>
                <div class="flow-item">
                    <div class="flow-label">æµæœˆï¼ˆå¤©çºªç®—æ³•ï¼‰</div>
                    <div class="flow-val" id="fv-m">--</div>
                    <div id="g-lm" class="yao-stack" style="margin: 10px auto;"></div>
                    <div class="flow-extra" id="fd-m"></div>
                    <div class="flow-time" id="ft-m"></div>
                </div>
                <div class="flow-item">
                    <div class="flow-label">æµæ—¥ï¼ˆæ–°è§„åˆ™ï¼‰</div>
                    <div class="flow-val" id="fv-d">--</div>
                    <div id="g-ld" class="yao-stack" style="margin: 10px auto;"></div>
                    <div class="flow-extra" id="fd-d"></div>
                    <div class="flow-time" id="ft-d"></div>
                </div>
                </div>
            <div id="debug-info" class="debug-info" style="display:none;"></div>
        </div>
    </div>
</div>

<script>
// ==================== å‘½ä¾‹ç®¡ç†åŠŸèƒ½ ====================
// å‘½ä¾‹æ•°æ®ç»“æ„ï¼š{id, name, year, month, day, hour, minute, sex, lon, category, createTime}

// è·å–æ‰€æœ‰å‘½ä¾‹
function getAllMingli() {
    var data = localStorage.getItem('mingliDatabase');
    return data ? JSON.parse(data) : [];
}

// ä¿å­˜æ‰€æœ‰å‘½ä¾‹
function saveAllMingli(mingliList) {
    localStorage.setItem('mingliDatabase', JSON.stringify(mingliList));
}

// æ·»åŠ å‘½ä¾‹
function addMingli(mingli) {
    var list = getAllMingli();
    mingli.id = Date.now().toString();
    mingli.createTime = new Date().toISOString();
    list.push(mingli);
    saveAllMingli(list);
    return mingli.id;
}

// åˆ é™¤å‘½ä¾‹
function deleteMingli(id) {
    var list = getAllMingli();
    list = list.filter(function(item) { return item.id !== id; });
    saveAllMingli(list);
}

// æ˜¾ç¤ºä¿å­˜å‘½ä¾‹å¯¹è¯æ¡†
function showMingliDialog() {
    var dialog = document.createElement('div');
    dialog.id = 'mingliSaveDialog';
    dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
    
    var content = document.createElement('div');
    content.style.cssText = 'background: #f5f3ef; border: 2px solid #8b6f47; border-radius: 8px; padding: 25px; min-width: 400px; max-width: 500px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative;';
    
    var html = '<div style="margin-bottom: 15px;">';
    html += '<label style="display: block; margin-bottom: 8px; color: #5c4a37; font-weight: bold;">è¯·è¾“å…¥å§“å:</label>';
    html += '<input type="text" id="mingliNameInput" style="width: 100%; padding: 8px; border: 1px solid #8b6f47; border-radius: 4px; background: white; font-size: 14px; box-sizing: border-box;" placeholder="è¯·è¾“å…¥å§“å" autofocus>';
    html += '</div>';
    
    html += '<div style="margin-bottom: 20px;">';
    html += '<label style="display: block; margin-bottom: 8px; color: #5c4a37; font-weight: bold;">è¯·é€‰æ‹©åˆ†ç±»:</label>';
    html += '<select id="mingliCategorySelect" style="width: 100%; padding: 8px; border: 1px solid #8b6f47; border-radius: 4px; background: white; font-size: 14px; box-sizing: border-box;">';
    html += '<option value="è‡ªå·±">è‡ªå·±</option>';
    html += '<option value="æœ‹å‹">æœ‹å‹</option>';
    html += '<option value="å®¶äºº">å®¶äºº</option>';
    html += '<option value="åäºº">åäºº</option>';
    html += '<option value="å®¢æˆ·">å®¢æˆ·</option>';
    html += '<option value="å…¶ä»–">å…¶ä»–</option>';
    html += '</select>';
    html += '</div>';
    
    html += '<div style="display: flex; gap: 10px; justify-content: flex-end;">';
    html += '<button onclick="document.getElementById(\'mingliSaveDialog\').remove();" style="padding: 8px 20px; background: #d4c4a8; color: #5c4a37; border: 1px solid #8b6f47; border-radius: 4px; cursor: pointer; font-size: 14px;">å–æ¶ˆ</button>';
    html += '<button onclick="saveMingliFromDialog();" style="padding: 8px 20px; background: #8b6f47; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">ç¡®å®š</button>';
    html += '</div>';
    
    content.innerHTML = html + '<button onclick="document.getElementById(\'mingliSaveDialog\').remove();" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #8b6f47; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 16px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center;">Ã—</button>';
    
    dialog.appendChild(content);
    document.body.appendChild(dialog);
    
    // ç‚¹å‡»èƒŒæ™¯å…³é—­
    dialog.onclick = function(e) {
        if(e.target === dialog) {
            dialog.remove();
        }
    };
    
    // å›è½¦é”®ä¿å­˜
    document.getElementById('mingliNameInput').onkeypress = function(e) {
        if(e.key === 'Enter') {
            saveMingliFromDialog();
        }
    };
}

// ä»å¯¹è¯æ¡†ä¿å­˜å‘½ä¾‹
function saveMingliFromDialog() {
    var nameInput = document.getElementById('mingliNameInput');
    var categorySelect = document.getElementById('mingliCategorySelect');
    
    if(!nameInput || !nameInput.value || nameInput.value.trim() === '') {
        showMingliMessage('å§“åä¸èƒ½ä¸ºç©º');
        return;
    }
    
    var year = parseInt(document.getElementById('y').value);
    var month = parseInt(document.getElementById('m').value);
    var day = parseInt(document.getElementById('d').value);
    var hour = parseInt(document.getElementById('h').value);
    var minute = parseInt(document.getElementById('min').value);
    var sex = document.getElementById('sex').value;
    var lon = parseFloat(document.getElementById('lon').value);
    
    // éªŒè¯æ•°æ®å®Œæ•´æ€§
    if(isNaN(year) || year < 1900 || year > 2100) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´ä»½ï¼ˆ1900-2100ï¼‰');
        return;
    }
    if(isNaN(month) || month < 1 || month > 12) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„æœˆä»½ï¼ˆ1-12ï¼‰');
        return;
    }
    if(isNaN(day) || day < 1 || day > 31) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„æ—¥æœŸï¼ˆ1-31ï¼‰');
        return;
    }
    if(isNaN(hour) || hour < 0 || hour > 23) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„å°æ—¶ï¼ˆ0-23ï¼‰');
        return;
    }
    if(isNaN(minute) || minute < 0 || minute > 59) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„åˆ†é’Ÿï¼ˆ0-59ï¼‰');
        return;
    }
    if(!sex || (sex !== '1' && sex !== '0')) {
        showMingliMessage('è¯·é€‰æ‹©æ€§åˆ«');
        return;
    }
    if(isNaN(lon) || lon < -180 || lon > 180) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„ç»åº¦ï¼ˆ-180åˆ°180ï¼‰');
        return;
    }
    
    // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒçš„å‘½ä¾‹ï¼ˆå§“åã€å¹´æœˆæ—¥æ—¶åˆ†ç›¸åŒï¼‰
    var existingList = getAllMingli();
    var duplicate = existingList.find(function(item) {
        return item.name === nameInput.value.trim() &&
               item.year === year &&
               item.month === month &&
               item.day === day &&
               item.hour === hour &&
               item.minute === minute;
    });
    
    if(duplicate) {
        var confirmMsg = 'å·²å­˜åœ¨ç›¸åŒçš„å‘½ä¾‹ï¼ˆ' + duplicate.name + 'ï¼‰ï¼Œæ˜¯å¦ä»è¦ä¿å­˜ï¼Ÿ';
        if(!confirm(confirmMsg)) {
            return;
        }
    }
    
    var mingli = {
        name: nameInput.value.trim(),
        year: year,
        month: month,
        day: day,
        hour: hour,
        minute: minute,
        sex: sex,
        lon: lon,
        category: categorySelect ? categorySelect.value : 'å…¶ä»–'
    };
    
    try {
        var id = addMingli(mingli);
        document.getElementById('mingliSaveDialog').remove();
        showMingliMessage('å‘½ä¾‹å·²ä¿å­˜ï¼ID: ' + id);
    } catch(err) {
        showMingliMessage('ä¿å­˜å¤±è´¥: ' + err.message);
    }
}

// æ˜¾ç¤ºæ¶ˆæ¯å¯¹è¯æ¡†
function showMingliMessage(msg) {
    var dialog = document.createElement('div');
    dialog.id = 'mingliMessageDialog';
    dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10001; display: flex; align-items: center; justify-content: center;';
    
    var content = document.createElement('div');
    content.style.cssText = 'background: #f5f3ef; border: 2px solid #8b6f47; border-radius: 8px; padding: 25px; min-width: 300px; max-width: 400px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative; text-align: center;';
    
    var closeDialog = function() {
        var d = document.getElementById('mingliMessageDialog');
        if(d) d.remove();
    };
    
    content.innerHTML = '<div style="color: #5c4a37; font-size: 16px; margin-bottom: 20px;">' + msg + '</div>' +
        '<button id="mingliMsgConfirmBtn" style="padding: 8px 30px; background: #8b6f47; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">ç¡®å®š</button>' +
        '<button id="mingliMsgCloseBtn" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #8b6f47; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 18px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center; transition: color 0.2s;" onmouseover="this.style.color=\'#5c4a37\';" onmouseout="this.style.color=\'#8b6f47\';">Ã—</button>';
    
    dialog.appendChild(content);
    document.body.appendChild(dialog);
    
    // ç»‘å®šæŒ‰é’®äº‹ä»¶
    var confirmBtn = content.querySelector('#mingliMsgConfirmBtn');
    var closeBtn = content.querySelector('#mingliMsgCloseBtn');
    if(confirmBtn) confirmBtn.onclick = closeDialog;
    if(closeBtn) closeBtn.onclick = closeDialog;
    
    dialog.onclick = function(e) {
        if(e.target === dialog) {
            closeDialog();
        }
    };
}

// æ˜¾ç¤ºå‘½ä¾‹åˆ—è¡¨å¯¹è¯æ¡†
function showMingliList() {
    var list = getAllMingli();
    if(list.length === 0) {
        showMingliMessage('æš‚æ— ä¿å­˜çš„å‘½ä¾‹');
        return;
    }
    
    // æŒ‰åˆ†ç±»åˆ†ç»„
    var grouped = {};
    list.forEach(function(item) {
        if(!grouped[item.category]) {
            grouped[item.category] = [];
        }
        grouped[item.category].push(item);
    });
    
    var dialog = document.createElement('div');
    dialog.id = 'mingliListDialog';
    dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
    
    var content = document.createElement('div');
    content.style.cssText = 'background: #f5f3ef; border: 2px solid #8b6f47; border-radius: 8px; padding: 15px; min-width: 360px; max-width: 50%; max-height: 80vh; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative; display: flex; flex-direction: column;';
    
    var html = '<div style="margin-bottom: 15px; border-bottom: 2px solid #8b6f47; padding-bottom: 10px;">';
    html += '<h3 style="margin: 0; color: #5c4a37; font-size: 18px; font-weight: bold;">é€‰æ‹©å‘½ä¾‹</h3>';
    html += '</div>';
    
    html += '<div style="flex: 1; overflow-y: auto; padding-right: 5px;">';
    
    var categories = ['è‡ªå·±', 'æœ‹å‹', 'å®¶äºº', 'åäºº', 'å®¢æˆ·', 'å…¶ä»–'];
    categories.forEach(function(cat) {
        if(grouped[cat] && grouped[cat].length > 0) {
            html += '<div style="margin-bottom: 20px;">';
            html += '<h4 style="color: #8b6f47; margin: 10px 0 8px 0; font-size: 15px; font-weight: bold;">' + cat + '</h4>';
            grouped[cat].forEach(function(item) {
                // æ£€æŸ¥å½“å‰é¡µé¢ç±»å‹
                var ziweiSection = document.getElementById('ziwei');
                var isZiweiPage = ziweiSection && (ziweiSection.classList.contains('active') || window.getComputedStyle(ziweiSection).display !== 'none');
                var loadFunc = isZiweiPage ? 'loadMingliZiwei' : 'loadMingli';
                html += '<div style="padding: 8px 10px; margin: 5px 0; border: 1px solid #d4c4a8; border-radius: 4px; cursor: pointer; background: white; display: flex; align-items: center; justify-content: space-between; gap: 4px; transition: background 0.2s;" onmouseover="this.style.background=\'#f0ebe0\';" onmouseout="this.style.background=\'white\';" onclick="' + loadFunc + '(\'' + item.id + '\'); document.getElementById(\'mingliListDialog\').remove();">';
                html += '<div style="flex: 1; color: #5c4a37; font-size: 14px; min-width: 0; max-width: calc(100% - 50px);">';
                html += '<strong style="color: #8b6f47; margin-right: 4px;">' + item.name + '</strong>';
                html += item.year + 'å¹´' + item.month + 'æœˆ' + item.day + 'æ—¥ ' + item.hour + 'æ—¶' + item.minute + 'åˆ† ';
                html += (item.sex === '1' ? 'ç”·' : 'å¥³') + ' ';
                html += 'ç»åº¦:' + item.lon;
                html += '</div>';
                html += '<button onclick="event.stopPropagation(); deleteMingliConfirm(\'' + item.id + '\');" style="width: auto; height: 24px; background: #c0392b; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px; flex-shrink: 0; margin-left: 0; transition: background 0.2s; display: flex; align-items: center; justify-content: center; padding: 0 6px; line-height: 1; min-width: auto;" onmouseover="this.style.background=\'#a93226\';" onmouseout="this.style.background=\'#c0392b\';">åˆ é™¤</button>';
                html += '</div>';
            });
            html += '</div>';
        }
    });
    
    html += '</div>';
    
    content.innerHTML = html + '<button id="mingliListCloseBtn" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #8b6f47; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 18px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center; transition: color 0.2s;" onmouseover="this.style.color=\'#5c4a37\';" onmouseout="this.style.color=\'#8b6f47\';">Ã—</button>';
    
    dialog.appendChild(content);
    document.body.appendChild(dialog);
    
    // ç»‘å®šå…³é—­æŒ‰é’®äº‹ä»¶
    var closeBtn = content.querySelector('#mingliListCloseBtn');
    if(closeBtn) {
        closeBtn.onclick = function() {
            dialog.remove();
        };
    }
    
    // ç‚¹å‡»èƒŒæ™¯å…³é—­
    dialog.onclick = function(e) {
        if(e.target === dialog) {
            dialog.remove();
        }
    };
}

// åŠ è½½å‘½ä¾‹
function loadMingli(id) {
    var list = getAllMingli();
    var mingli = list.find(function(item) { return item.id === id; });
    if(!mingli) {
        showMingliMessage('å‘½ä¾‹ä¸å­˜åœ¨');
        return;
    }
    
    // åŠ è½½æ•°æ®åˆ°è¡¨å•
    var yEl = document.getElementById('y');
    var mEl = document.getElementById('m');
    var dEl = document.getElementById('d');
    var hEl = document.getElementById('h');
    var minEl = document.getElementById('min');
    var sexEl = document.getElementById('sex');
    var lonEl = document.getElementById('lon');
    
    if(yEl) yEl.value = mingli.year;
    if(mEl) mEl.value = mingli.month;
    if(dEl) dEl.value = mingli.day;
    if(hEl) hEl.value = mingli.hour;
    if(minEl) minEl.value = mingli.minute;
    if(sexEl) sexEl.value = mingli.sex;
    if(lonEl) lonEl.value = mingli.lon;
    
    showMingliMessage('å·²åŠ è½½å‘½ä¾‹: ' + mingli.name);
    
    // è‡ªåŠ¨è§¦å‘æ’ç›˜
    setTimeout(function() {
        if(typeof calcMain === 'function') {
            try {
                calcMain();
                showMingliMessage('å‘½ä¾‹å·²åŠ è½½å¹¶è‡ªåŠ¨æ’ç›˜: ' + mingli.name);
            } catch(err) {
                console.error('è‡ªåŠ¨æ’ç›˜å¤±è´¥:', err);
                showMingliMessage('å‘½ä¾‹å·²åŠ è½½ï¼Œä½†è‡ªåŠ¨æ’ç›˜å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨ç‚¹å‡»æ’ç›˜');
            }
        } else {
            showMingliMessage('å‘½ä¾‹å·²åŠ è½½ï¼Œè¯·æ‰‹åŠ¨ç‚¹å‡»"å¼€å§‹æ’ç›˜"æŒ‰é’®');
        }
    }, 300);
}

// ç¡®è®¤åˆ é™¤å‘½ä¾‹
function deleteMingliConfirm(id) {
    var list = getAllMingli();
    var mingli = list.find(function(item) { return item.id === id; });
    if(!mingli) return;
    
    var dialog = document.createElement('div');
    dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10002; display: flex; align-items: center; justify-content: center;';
    
    var content = document.createElement('div');
    content.style.cssText = 'background: #f5f3ef; border: 2px solid #8b6f47; border-radius: 8px; padding: 25px; min-width: 350px; max-width: 400px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative;';
    
    dialog.id = 'mingliDeleteDialog';
    var closeDeleteDialog = function() {
        var d = document.getElementById('mingliDeleteDialog');
        if(d) d.remove();
    };
    var confirmDelete = function() {
        deleteMingli(id);
        var listDialog = document.getElementById('mingliListDialog');
        if(listDialog) listDialog.remove();
        closeDeleteDialog();
        setTimeout(function(){showMingliList();}, 100);
    };
    
    content.innerHTML = '<div style="color: #5c4a37; font-size: 16px; margin-bottom: 20px; text-align: center;">ç¡®å®šè¦åˆ é™¤å‘½ä¾‹<br><strong style="color: #8b6f47;">"' + mingli.name + '"</strong><br>å—ï¼Ÿ</div>' +
        '<div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">' +
        '<button id="mingliDeleteCancelBtn" style="padding: 8px 16px; background: #d4c4a8; color: #5c4a37; border: 1px solid #8b6f47; border-radius: 4px; cursor: pointer; font-size: 14px; min-width: 80px; box-sizing: border-box;">å–æ¶ˆ</button>' +
        '<button id="mingliDeleteConfirmBtn" style="padding: 8px 16px; background: #c0392b; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold; min-width: 80px; box-sizing: border-box;">ç¡®å®šåˆ é™¤</button>' +
        '</div>' +
        '<button id="mingliDeleteCloseBtn" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #8b6f47; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 18px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center; transition: color 0.2s;" onmouseover="this.style.color=\'#5c4a37\';" onmouseout="this.style.color=\'#8b6f47\';">Ã—</button>';
    
    dialog.appendChild(content);
    document.body.appendChild(dialog);
    
    // ç»‘å®šæŒ‰é’®äº‹ä»¶
    var cancelBtn = content.querySelector('#mingliDeleteCancelBtn');
    var confirmBtn = content.querySelector('#mingliDeleteConfirmBtn');
    var closeBtn = content.querySelector('#mingliDeleteCloseBtn');
    if(cancelBtn) cancelBtn.onclick = closeDeleteDialog;
    if(confirmBtn) confirmBtn.onclick = confirmDelete;
    if(closeBtn) closeBtn.onclick = closeDeleteDialog;
    
    dialog.onclick = function(e) {
        if(e.target === dialog) {
            closeDeleteDialog();
        }
    };
}

// å¯¼å‡ºæ•°æ®
function exportMingliData() {
    var data = getAllMingli();
    if(data.length === 0) {
        showMingliMessage('æ²¡æœ‰å¯å¯¼å‡ºçš„æ•°æ®');
        return;
    }
    
    try {
        // æ·»åŠ å¯¼å‡ºå…ƒæ•°æ®
        var exportData = {
            version: '1.0',
            exportTime: new Date().toISOString(),
            totalCount: data.length,
            data: data
        };
        
        // æŒ‰åˆ†ç±»ç»Ÿè®¡
        var categoryStats = {};
        data.forEach(function(item) {
            var cat = item.category || 'å…¶ä»–';
            categoryStats[cat] = (categoryStats[cat] || 0) + 1;
        });
        exportData.categoryStats = categoryStats;
        
        var json = JSON.stringify(exportData, null, 2);
        var blob = new Blob(['\ufeff' + json], { type: 'application/json;charset=utf-8' });
        var url = URL.createObjectURL(blob);
        var a = document.createElement('a');
        a.href = url;
        
        // æ”¹è¿›æ–‡ä»¶å‘½åï¼šåŒ…å«æ—¥æœŸæ—¶é—´å’Œæ•°é‡
        var now = new Date();
        var dateStr = now.getFullYear() + 
                     String(now.getMonth() + 1).padStart(2, '0') + 
                     String(now.getDate()).padStart(2, '0') + '_' +
                     String(now.getHours()).padStart(2, '0') + 
                     String(now.getMinutes()).padStart(2, '0');
        a.download = 'å‘½ä¾‹æ•°æ®åº“_' + dateStr + '_å…±' + data.length + 'æ¡.json';
        
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showMingliMessage('æ•°æ®å·²å¯¼å‡ºï¼å…± ' + data.length + ' æ¡å‘½ä¾‹');
    } catch(err) {
        console.error('å¯¼å‡ºå¤±è´¥:', err);
        showMingliMessage('å¯¼å‡ºå¤±è´¥: ' + err.message);
    }
}

// å¯¼å…¥æ•°æ®
function importMingliData(event) {
    var file = event.target.files[0];
    if(!file) return;
    
    // æ£€æŸ¥æ–‡ä»¶ç±»å‹
    if(!file.name.toLowerCase().endsWith('.json')) {
        showMingliMessage('è¯·é€‰æ‹©JSONæ ¼å¼çš„æ–‡ä»¶');
        event.target.value = '';
        return;
    }
    
    var reader = new FileReader();
    reader.onload = function(e) {
        try {
            var imported = JSON.parse(e.target.result);
            
            // æ”¯æŒæ–°æ ¼å¼ï¼ˆåŒ…å«dataå­—æ®µï¼‰å’Œæ—§æ ¼å¼ï¼ˆç›´æ¥æ˜¯æ•°ç»„ï¼‰
            var dataArray = null;
            if(imported && Array.isArray(imported)) {
                dataArray = imported;
            } else if(imported && imported.data && Array.isArray(imported.data)) {
                dataArray = imported.data;
            } else {
                showMingliMessage('å¯¼å…¥æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼šæ–‡ä»¶å¿…é¡»æ˜¯å‘½ä¾‹æ•°ç»„æˆ–åŒ…å«dataå­—æ®µçš„å¯¹è±¡');
                event.target.value = '';
                return;
            }
            
            if(dataArray.length === 0) {
                showMingliMessage('å¯¼å…¥æ–‡ä»¶ä¸ºç©º');
                event.target.value = '';
                return;
            }
            
            // éªŒè¯æ•°æ®æœ‰æ•ˆæ€§
            var validData = [];
            var invalidCount = 0;
            var errors = [];
            
            dataArray.forEach(function(item, index) {
                // æ£€æŸ¥å¿…éœ€å­—æ®µ
                if(!item || typeof item !== 'object') {
                    invalidCount++;
                    errors.push('ç¬¬' + (index + 1) + 'æ¡ï¼šä¸æ˜¯æœ‰æ•ˆå¯¹è±¡');
                    return;
                }
                
                var requiredFields = ['name', 'year', 'month', 'day', 'hour', 'minute', 'sex', 'lon'];
                var missingFields = [];
                requiredFields.forEach(function(field) {
                    if(item[field] === undefined || item[field] === null || item[field] === '') {
                        missingFields.push(field);
                    }
                });
                
                if(missingFields.length > 0) {
                    invalidCount++;
                    errors.push('ç¬¬' + (index + 1) + 'æ¡ï¼ˆ' + (item.name || 'æœªçŸ¥') + 'ï¼‰ï¼šç¼ºå°‘å­—æ®µ ' + missingFields.join(', '));
                    return;
                }
                
                // éªŒè¯æ•°æ®ç±»å‹å’ŒèŒƒå›´
                var year = parseInt(item.year);
                var month = parseInt(item.month);
                var day = parseInt(item.day);
                var hour = parseInt(item.hour);
                var minute = parseInt(item.minute);
                var lon = parseFloat(item.lon);
                
                if(isNaN(year) || year < 1900 || year > 2100 ||
                   isNaN(month) || month < 1 || month > 12 ||
                   isNaN(day) || day < 1 || day > 31 ||
                   isNaN(hour) || hour < 0 || hour > 23 ||
                   isNaN(minute) || minute < 0 || minute > 59 ||
                   isNaN(lon) || lon < -180 || lon > 180 ||
                   (item.sex !== '1' && item.sex !== '0')) {
                    invalidCount++;
                    errors.push('ç¬¬' + (index + 1) + 'æ¡ï¼ˆ' + item.name + 'ï¼‰ï¼šæ•°æ®èŒƒå›´æ— æ•ˆ');
                    return;
                }
                
                validData.push(item);
            });
            
            if(validData.length === 0) {
                showMingliMessage('æ²¡æœ‰æœ‰æ•ˆæ•°æ®å¯å¯¼å…¥ã€‚é”™è¯¯è¯¦æƒ…ï¼š\n' + errors.slice(0, 5).join('\n') + (errors.length > 5 ? '\n...' : ''));
                event.target.value = '';
                return;
            }
            
            // æ£€æŸ¥é‡å¤æ•°æ®
            var existing = getAllMingli();
            var existingKeys = {};
            existing.forEach(function(item) {
                var key = item.name + '_' + item.year + '_' + item.month + '_' + item.day + '_' + item.hour + '_' + item.minute;
                existingKeys[key] = true;
            });
            
            var newCount = 0;
            var duplicateCount = 0;
            validData.forEach(function(item) {
                var key = item.name + '_' + item.year + '_' + item.month + '_' + item.day + '_' + item.hour + '_' + item.minute;
                if(!existingKeys[key]) {
                    newCount++;
                } else {
                    duplicateCount++;
                }
            });
            
            var dialog = document.createElement('div');
            dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10002; display: flex; align-items: center; justify-content: center;';
            
            var content = document.createElement('div');
            content.style.cssText = 'background: #f5f3ef; border: 2px solid #8b6f47; border-radius: 8px; padding: 25px; min-width: 400px; max-width: 500px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative;';
            
            dialog.id = 'mingliImportDialog';
            var closeImportDialog = function() {
                var d = document.getElementById('mingliImportDialog');
                if(d) d.remove();
                // æ¸…é™¤ä¸¤ä¸ªå¯èƒ½çš„æ–‡ä»¶è¾“å…¥æ¡†
                var fileInput = document.getElementById('mingliImportFile');
                if(fileInput) fileInput.value = '';
                var fileInputZiwei = document.getElementById('mingliImportFileZiwei');
                if(fileInputZiwei) fileInputZiwei.value = '';
            };
            var confirmImport = function() {
                doImportMingliData(validData, newCount, duplicateCount, invalidCount);
                closeImportDialog();
            };
            
            var messageHtml = '<div style="color: #5c4a37; font-size: 14px; margin-bottom: 20px; line-height: 1.6;">';
            messageHtml += '<div style="text-align: center; margin-bottom: 10px; font-size: 16px; font-weight: bold;">å¯¼å…¥é¢„è§ˆ</div>';
            messageHtml += '<div>æ€»æ•°æ®ï¼š' + dataArray.length + ' æ¡</div>';
            messageHtml += '<div style="color: #27ae60;">æœ‰æ•ˆæ•°æ®ï¼š' + validData.length + ' æ¡</div>';
            if(newCount > 0) {
                messageHtml += '<div style="color: #2980b9;">æ–°å¢ï¼š' + newCount + ' æ¡</div>';
            }
            if(duplicateCount > 0) {
                messageHtml += '<div style="color: #f39c12;">é‡å¤ï¼š' + duplicateCount + ' æ¡ï¼ˆå°†è·³è¿‡ï¼‰</div>';
            }
            if(invalidCount > 0) {
                messageHtml += '<div style="color: #e74c3c;">æ— æ•ˆï¼š' + invalidCount + ' æ¡</div>';
            }
            if(errors.length > 0 && errors.length <= 3) {
                messageHtml += '<div style="margin-top: 10px; font-size: 12px; color: #999;">' + errors.join('<br>') + '</div>';
            }
            messageHtml += '</div>';
            
            content.innerHTML = messageHtml +
                '<div style="display: flex; gap: 10px; justify-content: center;">' +
                '<button id="mingliImportCancelBtn" style="padding: 8px 20px; background: #d4c4a8; color: #5c4a37; border: 1px solid #8b6f47; border-radius: 4px; cursor: pointer; font-size: 14px;">å–æ¶ˆ</button>' +
                '<button id="mingliImportConfirmBtn" style="padding: 8px 20px; background: #8b6f47; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">ç¡®å®šå¯¼å…¥</button>' +
                '</div>' +
                '<button id="mingliImportCloseBtn" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #8b6f47; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 18px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center; transition: color 0.2s;" onmouseover="this.style.color=\'#5c4a37\';" onmouseout="this.style.color=\'#8b6f47\';">Ã—</button>';
            
            dialog.appendChild(content);
            document.body.appendChild(dialog);
            
            // ç»‘å®šæŒ‰é’®äº‹ä»¶
            var cancelBtn = content.querySelector('#mingliImportCancelBtn');
            var confirmBtn = content.querySelector('#mingliImportConfirmBtn');
            var closeBtn = content.querySelector('#mingliImportCloseBtn');
            if(cancelBtn) cancelBtn.onclick = closeImportDialog;
            if(confirmBtn) confirmBtn.onclick = confirmImport;
            if(closeBtn) closeBtn.onclick = closeImportDialog;
            
            dialog.onclick = function(e) {
                if(e.target === dialog) {
                    closeImportDialog();
                }
            };
        } catch(err) {
            console.error('å¯¼å…¥å¤±è´¥:', err);
            showMingliMessage('å¯¼å…¥å¤±è´¥: ' + err.message + '\nè¯·ç¡®ä¿æ–‡ä»¶æ˜¯æœ‰æ•ˆçš„JSONæ ¼å¼');
            event.target.value = '';
        }
    };
    
    reader.onerror = function() {
        showMingliMessage('æ–‡ä»¶è¯»å–å¤±è´¥');
        event.target.value = '';
    };
    
    reader.readAsText(file, 'UTF-8');
}

// æ‰§è¡Œå¯¼å…¥æ•°æ®
function doImportMingliData(imported, newCount, duplicateCount, invalidCount) {
    try {
        var existing = getAllMingli();
        var existingKeys = {};
        existing.forEach(function(item) {
            var key = item.name + '_' + item.year + '_' + item.month + '_' + item.day + '_' + item.hour + '_' + item.minute;
            existingKeys[key] = true;
        });
        
        var addedCount = 0;
        var skippedCount = 0;
        
        // åˆå¹¶æ•°æ®ï¼ˆé¿å…é‡å¤ï¼‰
        imported.forEach(function(item) {
            var key = item.name + '_' + item.year + '_' + item.month + '_' + item.day + '_' + item.hour + '_' + item.minute;
            if(!existingKeys[key]) {
                // å¦‚æœå¯¼å…¥çš„æ•°æ®æ²¡æœ‰IDï¼Œç”Ÿæˆæ–°ID
                if(!item.id) {
                    item.id = Date.now().toString() + '_' + Math.random().toString(36).substr(2, 9);
                }
                // å¦‚æœå¯¼å…¥çš„æ•°æ®æ²¡æœ‰åˆ›å»ºæ—¶é—´ï¼Œæ·»åŠ å½“å‰æ—¶é—´
                if(!item.createTime) {
                    item.createTime = new Date().toISOString();
                }
                // å¦‚æœæ²¡æœ‰åˆ†ç±»ï¼Œè®¾ç½®é»˜è®¤åˆ†ç±»
                if(!item.category) {
                    item.category = 'å…¶ä»–';
                }
                existing.push(item);
                existingKeys[key] = true;
                addedCount++;
            } else {
                skippedCount++;
            }
        });
        
        saveAllMingli(existing);
        // æ¸…é™¤ä¸¤ä¸ªå¯èƒ½çš„æ–‡ä»¶è¾“å…¥æ¡†
        var fileInput = document.getElementById('mingliImportFile');
        if(fileInput) fileInput.value = '';
        var fileInputZiwei = document.getElementById('mingliImportFileZiwei');
        if(fileInputZiwei) fileInputZiwei.value = '';
        
        var message = 'æ•°æ®å·²å¯¼å…¥ï¼';
        if(addedCount > 0) {
            message += 'æ–°å¢ ' + addedCount + ' æ¡';
        }
        if(skippedCount > 0) {
            message += 'ï¼Œè·³è¿‡é‡å¤ ' + skippedCount + ' æ¡';
        }
        message += 'ï¼Œå½“å‰å…± ' + existing.length + ' æ¡å‘½ä¾‹';
        showMingliMessage(message);
    } catch(err) {
        console.error('å¯¼å…¥æ‰§è¡Œå¤±è´¥:', err);
        showMingliMessage('å¯¼å…¥æ‰§è¡Œå¤±è´¥: ' + err.message);
    }
}

// ==================== ä¸‹è½½å‘½ä¾‹åŠŸèƒ½ ====================
function downloadMingli() {
    try {
        // æ£€æŸ¥æ˜¯å¦æœ‰æ’ç›˜ç»“æœ
        var resultView = document.getElementById('result-view');
        var hasResult = resultView && resultView.style.display !== 'none' && resultView.innerHTML && resultView.innerHTML.trim() !== '';
        
        if(!hasResult) {
            // å¦‚æœæ²¡æœ‰æ’ç›˜ï¼Œå…ˆè‡ªåŠ¨æ’ç›˜
            if(typeof calcMain === 'function') {
                showMingliMessage('æ­£åœ¨è‡ªåŠ¨æ’ç›˜ï¼Œè¯·ç¨å€™...');
                calcMain();
                // ç­‰å¾…æ’ç›˜å®Œæˆï¼ˆå¢åŠ ç­‰å¾…æ—¶é—´ç¡®ä¿å†…å®¹æ¸²æŸ“å®Œæˆï¼‰
                setTimeout(function() {
                    // å†æ¬¡æ£€æŸ¥æ˜¯å¦æœ‰ç»“æœ
                    var checkResult = document.getElementById('result-view');
                    if(checkResult && checkResult.style.display !== 'none' && checkResult.innerHTML && checkResult.innerHTML.trim() !== '') {
                        generateAndDownloadMingli();
                    } else {
                        showMingliMessage('æ’ç›˜æœªå®Œæˆï¼Œè¯·ç¨åå†è¯•æˆ–æ‰‹åŠ¨ç‚¹å‡»æ’ç›˜');
                    }
                }, 2000);
            } else {
                showMingliMessage('æ— æ³•è‡ªåŠ¨æ’ç›˜ï¼Œè¯·å…ˆæ‰‹åŠ¨ç‚¹å‡»"å¼€å§‹æ’ç›˜"æŒ‰é’®è¿›è¡Œæ’ç›˜');
            }
        } else {
            generateAndDownloadMingli();
        }
    } catch(err) {
        console.error('ä¸‹è½½å‘½ä¾‹å¤±è´¥:', err);
        showMingliMessage('ä¸‹è½½å¤±è´¥: ' + err.message);
    }
}

function generateAndDownloadMingli() {
    try {
        // æ£€æŸ¥æ˜¯å¦æœ‰æ’ç›˜ç»“æœ
        var resultView = document.getElementById('result-view');
        if(!resultView || resultView.style.display === 'none' || !resultView.innerHTML || resultView.innerHTML.trim() === '') {
            showMingliMessage('æ²¡æœ‰æ’ç›˜ç»“æœï¼Œè¯·å…ˆè¿›è¡Œæ’ç›˜æ“ä½œ');
            return;
        }
        
        // æ˜¾ç¤ºæ ¼å¼é€‰æ‹©å¯¹è¯æ¡†
        var dialog = document.createElement('div');
        dialog.id = 'downloadFormatDialog';
        dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10002; display: flex; align-items: center; justify-content: center;';
        
        var content = document.createElement('div');
        content.style.cssText = 'background: #f5f3ef; border: 2px solid #8b6f47; border-radius: 8px; padding: 25px; min-width: 400px; max-width: 500px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative;';
        
        var closeDialog = function() {
            var d = document.getElementById('downloadFormatDialog');
            if(d) d.remove();
        };
        
        var startDownload = function() {
            closeDialog();
            try {
                downloadAsWord();
            } catch(err) {
                console.error('ä¸‹è½½å¤±è´¥:', err);
                showMingliMessage('ä¸‹è½½å¤±è´¥: ' + err.message);
            }
        };
        
        // è·å–å½“å‰å‘½ä¾‹ä¿¡æ¯ç”¨äºæ–‡ä»¶å‘½å
        var name = '';
        var yEl = document.getElementById('y');
        var mEl = document.getElementById('m');
        var dEl = document.getElementById('d');
        if(yEl && mEl && dEl) {
            name = yEl.value + 'å¹´' + mEl.value + 'æœˆ' + dEl.value + 'æ—¥';
        }
        
        content.innerHTML = '<div style="color: #5c4a37; font-size: 16px; margin-bottom: 20px; text-align: center;">è¯·é€‰æ‹©ä¸‹è½½æ ¼å¼</div>' +
            '<div style="color: #666; font-size: 12px; margin-bottom: 15px; text-align: center;">' + (name ? 'å‘½ä¾‹ï¼š' + name : '') + '</div>' +
            '<div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 20px;">' +
            '<button id="downloadWordBtn" style="padding: 10px 25px; background: #8b6f47; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold; transition: background 0.2s;" onmouseover="this.style.background=\'#6b5437\';" onmouseout="this.style.background=\'#8b6f47\';">ä¸‹è½½Wordæ–‡æ¡£</button>' +
            '</div>' +
            '<button id="downloadCloseBtn" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #8b6f47; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 18px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center; transition: color 0.2s;" onmouseover="this.style.color=\'#5c4a37\';" onmouseout="this.style.color=\'#8b6f47\';">Ã—</button>';
        
        dialog.appendChild(content);
        document.body.appendChild(dialog);
        
        // ç»‘å®šæŒ‰é’®äº‹ä»¶
        var wordBtn = content.querySelector('#downloadWordBtn');
        var closeBtn = content.querySelector('#downloadCloseBtn');
        
        if(wordBtn) wordBtn.onclick = startDownload;
        if(closeBtn) closeBtn.onclick = closeDialog;
        
        dialog.onclick = function(e) {
            if(e.target === dialog) {
                closeDialog();
            }
        };
        
        // ESCé”®å…³é—­
        var escHandler = function(e) {
            if(e.key === 'Escape') {
                closeDialog();
                document.removeEventListener('keydown', escHandler);
            }
        };
        document.addEventListener('keydown', escHandler);
    } catch(err) {
        console.error('ç”Ÿæˆä¸‹è½½å¯¹è¯æ¡†å¤±è´¥:', err);
        showMingliMessage('æ“ä½œå¤±è´¥: ' + err.message);
    }
}

function downloadAsPDF() {
    try {
        // #region agent log
        var existingContainer = document.getElementById('pdf-temp-container');
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsPDF',message:'PDFç”Ÿæˆå¼€å§‹',data:{timestamp:Date.now(),hasExistingContainer:!!existingContainer},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
        // #endregion
        // æ¸…ç†å¯èƒ½å­˜åœ¨çš„æ—§å®¹å™¨
        if(existingContainer && existingContainer.parentNode) {
            existingContainer.parentNode.removeChild(existingContainer);
        }
        showMingliMessage('æ­£åœ¨ç”ŸæˆPDFï¼Œè¯·ç¨å€™...');
        
        // æ”¶é›†æ‰€æœ‰å†…å®¹
        var content = collectAllContent();
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsPDF',message:'å†…å®¹æ”¶é›†å®Œæˆ',data:{contentLength:content?content.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
        // #endregion
        
        if(!content || content.trim() === '') {
            showMingliMessage('æ²¡æœ‰å¯ä¸‹è½½çš„å†…å®¹ï¼Œè¯·å…ˆè¿›è¡Œæ’ç›˜');
            return;
        }
        
        // è½¬æ¢æ‰€æœ‰å¦å›¾ä¸ºå›¾ç‰‡
        convertGuaImagesInContent(content).then(function(convertedContent) {
            // #region agent log
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsPDF',message:'å¦å›¾è½¬æ¢å®Œæˆ',data:{convertedLength:convertedContent?convertedContent.length:0,hasImages:convertedContent?convertedContent.indexOf('<img')>=0:false},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            // åˆ›å»ºä¸´æ—¶å®¹å™¨ - ä½¿ç”¨å¯è§çš„æ–¹å¼ä»¥ä¾¿html2canvasæ­£ç¡®æ¸²æŸ“
            var tempDiv = document.createElement('div');
            tempDiv.id = 'pdf-temp-container';
            // å°†å®¹å™¨æ”¾åœ¨å¯è§ä½ç½®ï¼Œä½¿ç”¨å›ºå®šå®šä½ï¼Œä½†ç§»åˆ°å±å¹•å¤–
            // ä½¿ç”¨A4çº¸å¼ å°ºå¯¸ï¼š210mm x 297mmï¼Œè½¬æ¢ä¸ºåƒç´ çº¦794px x 1123px
            tempDiv.style.cssText = 'position: fixed; top: 0; left: -2000px; width: 794px; min-height: 1123px; padding: 40px; ' +
                'font-family: "Microsoft YaHei", "SimHei", sans-serif; font-size: 12pt; line-height: 1.6; ' +
                'color: #333; background: white; z-index: 99999; overflow: visible; ' +
                'box-sizing: border-box; visibility: visible; display: block; ' +
                'opacity: 1;'; // ç¡®ä¿ä¸é€æ˜
            tempDiv.innerHTML = convertedContent;
            document.body.appendChild(tempDiv);
            
            // #region agent log
            var imgCount = tempDiv.querySelectorAll('img').length;
            var yaoStackCount = tempDiv.querySelectorAll('.yao-stack').length;
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsPDF',message:'ä¸´æ—¶å®¹å™¨åˆ›å»º',data:{imgCount:imgCount,yaoStackCount:yaoStackCount,hasMissingImg:convertedContent?convertedContent.indexOf('è€å¸ˆåŠ©ç†å¾®ä¿¡ç ')>=0:false},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
            // #endregion
            
            // å¼ºåˆ¶é‡æ’å’Œé‡ç»˜ï¼Œç¡®ä¿å†…å®¹æ¸²æŸ“
            var forceReflow = tempDiv.offsetHeight;
            tempDiv.style.display = 'block';
            
            // è°ƒè¯•ï¼šæ£€æŸ¥å†…å®¹
            console.log('è½¬æ¢åçš„å†…å®¹é•¿åº¦:', convertedContent.length);
            console.log('å†…å®¹é¢„è§ˆï¼ˆå‰500å­—ç¬¦ï¼‰:', convertedContent.substring(0, 500));
            console.log('ä¸´æ—¶divå·²åˆ›å»ºï¼ŒoffsetWidth:', tempDiv.offsetWidth, 'offsetHeight:', tempDiv.offsetHeight);
            
            if(convertedContent.length < 100) {
                console.error('å†…å®¹å¤ªå°‘ï¼Œå¯èƒ½æ˜¯æ”¶é›†å¤±è´¥');
                console.error('å®Œæ•´å†…å®¹:', convertedContent);
                if(tempDiv.parentNode) document.body.removeChild(tempDiv);
                showMingliMessage('å†…å®¹ä¸ºç©ºï¼Œæ— æ³•ç”ŸæˆPDFã€‚è¯·å…ˆè¿›è¡Œæ’ç›˜ã€‚');
                return;
            }
            
            // ç­‰å¾…å†…å®¹æ¸²æŸ“ï¼Œå¢åŠ ç­‰å¾…æ—¶é—´ç¡®ä¿æ‰€æœ‰å†…å®¹éƒ½å·²åŠ è½½
            setTimeout(function() {
                // å†æ¬¡æ£€æŸ¥å†…å®¹
                console.log('ç­‰å¾…åæ£€æŸ¥ - tempDiv.innerHTMLé•¿åº¦:', tempDiv.innerHTML ? tempDiv.innerHTML.length : 0);
                console.log('ç­‰å¾…åæ£€æŸ¥ - tempDiv.offsetWidth:', tempDiv.offsetWidth, 'offsetHeight:', tempDiv.offsetHeight);
                console.log('ç­‰å¾…åæ£€æŸ¥ - tempDiv.scrollWidth:', tempDiv.scrollWidth, 'scrollHeight:', tempDiv.scrollHeight);
                
                // æ£€æŸ¥tempDivæ˜¯å¦æœ‰å†…å®¹
                if(!tempDiv.innerHTML || tempDiv.innerHTML.trim() === '' || tempDiv.innerHTML.trim().length < 100) {
                    console.error('tempDivå†…å®¹ä¸ºç©ºæˆ–å¤ªå°‘');
                    if(tempDiv.parentNode) document.body.removeChild(tempDiv);
                    showMingliMessage('å†…å®¹ä¸ºç©ºï¼Œæ— æ³•ç”ŸæˆPDFã€‚è¯·å…ˆè¿›è¡Œæ’ç›˜ã€‚');
                    return;
                }
            
            // ç¡®ä¿æ‰€æœ‰å›¾ç‰‡éƒ½å·²åŠ è½½
            var images = tempDiv.querySelectorAll('img');
            var imagesLoaded = 0;
            var totalImages = images.length;
            
            if(totalImages > 0) {
                images.forEach(function(img) {
                    if(img.complete) {
                        imagesLoaded++;
                    } else {
                        img.onload = function() {
                            imagesLoaded++;
                            if(imagesLoaded === totalImages) {
                                generatePDF();
                            }
                        };
                        img.onerror = function() {
                            imagesLoaded++;
                            if(imagesLoaded === totalImages) {
                                generatePDF();
                            }
                        };
                    }
                });
                if(imagesLoaded === totalImages) {
                    generatePDF();
                }
            } else {
                generatePDF();
            }
            
                function generatePDF() {
                    // å…ˆç¡®ä¿å®¹å™¨åœ¨å¯è§ä½ç½®ï¼ˆä¸´æ—¶ç§»åˆ°å¯è§ä½ç½®ï¼‰
                    var originalLeft = tempDiv.style.left;
                    tempDiv.style.left = '0';
                    tempDiv.style.top = '0';
                    tempDiv.style.position = 'absolute';
                    
                    // å¼ºåˆ¶é‡æ’
                    var forceReflow = tempDiv.offsetHeight;
                    
                    // ç­‰å¾…ä¸€å¸§ï¼Œç¡®ä¿æ¸²æŸ“å®Œæˆ
                    requestAnimationFrame(function() {
                    // é…ç½®PDFé€‰é¡¹
                    var opt = {
                        margin: [10, 10, 10, 10],
                        filename: 'å‘½ä¾‹åˆ†æ_' + new Date().toISOString().slice(0, 10) + '.pdf',
                        image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { 
                        scale: 2, 
                        useCORS: false, // ä¸ä½¿ç”¨CORSï¼Œé¿å…è·¨åŸŸé—®é¢˜
                        logging: false,
                        letterRendering: true,
                        allowTaint: false, // ä¸å…è®¸æ±¡æŸ“canvasï¼Œé¿å…å®‰å…¨é”™è¯¯
                        backgroundColor: '#ffffff',
                        width: tempDiv.scrollWidth || tempDiv.offsetWidth || 794,
                        height: tempDiv.scrollHeight || tempDiv.offsetHeight || 1123,
                        windowWidth: tempDiv.scrollWidth || tempDiv.offsetWidth || 794,
                        windowHeight: tempDiv.scrollHeight || tempDiv.offsetHeight || 1123,
                        x: 0,
                        y: 0,
                        scrollX: 0,
                        scrollY: 0,
                        onclone: function(clonedDoc) {
                            // åœ¨å…‹éš†çš„æ–‡æ¡£ä¸­ï¼Œç¡®ä¿ä¸´æ—¶å®¹å™¨å¯è§ä¸”å†…å®¹å®Œæ•´
                            var clonedDiv = clonedDoc.getElementById('pdf-temp-container');
                            if(clonedDiv) {
                                clonedDiv.style.position = 'absolute';
                                clonedDiv.style.left = '0';
                                clonedDiv.style.top = '0';
                                clonedDiv.style.visibility = 'visible';
                                clonedDiv.style.opacity = '1';
                                clonedDiv.style.display = 'block';
                                
                                // ç¡®ä¿æ‰€æœ‰detailsæ ‡ç­¾éƒ½å±•å¼€
                                var details = clonedDiv.querySelectorAll('details');
                                details.forEach(function(d) {
                                    d.setAttribute('open', 'open');
                                });
                                
                                // ç§»é™¤æ‰€æœ‰ç¼ºå¤±çš„å›¾ç‰‡ï¼Œé¿å…canvasæ±¡æŸ“
                                var imgs = clonedDiv.querySelectorAll('img');
                                var removedCount = 0;
                                imgs.forEach(function(img) {
                                    // æ£€æŸ¥å›¾ç‰‡æ˜¯å¦åŠ è½½å¤±è´¥æˆ–æ˜¯å¦æ˜¯å·²çŸ¥ç¼ºå¤±çš„å›¾ç‰‡
                                    if(!img.complete || img.naturalWidth === 0 || 
                                       (img.src && (img.src.indexOf('è€å¸ˆåŠ©ç†å¾®ä¿¡ç ') >= 0 || img.src.indexOf('è‘£å¾·é¾™') >= 0))) {
                                        // ç§»é™¤ç¼ºå¤±çš„å›¾ç‰‡
                                        var placeholder = clonedDoc.createElement('span');
                                        placeholder.textContent = '[å›¾ç‰‡]';
                                        placeholder.style.cssText = 'color: #999; font-style: italic;';
                                        if(img.parentNode) {
                                            img.parentNode.replaceChild(placeholder, img);
                                            removedCount++;
                                        }
                                    }
                                });
                                // #region agent log
                                try {
                                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsPDF:onclone',message:'ç§»é™¤ç¼ºå¤±å›¾ç‰‡',data:{totalImgs:imgs.length,removedCount:removedCount},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                                } catch(e) {}
                                // #endregion
                            }
                        }
                    },
                        jsPDF: { 
                            unit: 'mm', 
                            format: 'a4', 
                            orientation: 'portrait',
                            compress: true
                        },
                        pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
                    };
                    
                    // ç”ŸæˆPDF
                    if(typeof html2pdf !== 'undefined') {
                        console.log('å¼€å§‹ç”ŸæˆPDFï¼Œå®¹å™¨å°ºå¯¸:', tempDiv.offsetWidth, 'x', tempDiv.offsetHeight);
                        console.log('å®¹å™¨scrollå°ºå¯¸:', tempDiv.scrollWidth, 'x', tempDiv.scrollHeight);
                        console.log('å®¹å™¨å†…å®¹é•¿åº¦:', tempDiv.innerHTML.length);
                        // #region agent log
                        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsPDF',message:'å¼€å§‹ç”ŸæˆPDF',data:{width:tempDiv.offsetWidth,height:tempDiv.offsetHeight,scrollWidth:tempDiv.scrollWidth,scrollHeight:tempDiv.scrollHeight,contentLength:tempDiv.innerHTML.length},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                        // #endregion
                        
                        html2pdf().set(opt).from(tempDiv).save().then(function() {
                            console.log('PDFç”ŸæˆæˆåŠŸ');
                            // #region agent log
                            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsPDF',message:'PDFç”ŸæˆæˆåŠŸ',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
                            // #endregion
                            // æ¢å¤åŸå§‹ä½ç½®
                            tempDiv.style.left = originalLeft;
                            if(tempDiv.parentNode) document.body.removeChild(tempDiv);
                            showMingliMessage('PDFä¸‹è½½å®Œæˆï¼');
                        }).catch(function(err) {
                            console.error('PDFç”Ÿæˆé”™è¯¯:', err);
                            console.error('é”™è¯¯å †æ ˆ:', err.stack);
                            // #region agent log
                            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsPDF',message:'PDFç”Ÿæˆå¤±è´¥',data:{error:err.message,errorType:err.name,isSecurityError:err.name==='SecurityError'},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                            // #endregion
                            // æ¢å¤åŸå§‹ä½ç½®
                            tempDiv.style.left = originalLeft;
                            if(tempDiv.parentNode) document.body.removeChild(tempDiv);
                            showMingliMessage('PDFç”Ÿæˆå¤±è´¥: ' + (err.message || 'æœªçŸ¥é”™è¯¯'));
                        });
                    } else {
                        console.error('html2pdfåº“æœªåŠ è½½');
                        tempDiv.style.left = originalLeft;
                        if(tempDiv.parentNode) document.body.removeChild(tempDiv);
                        showMingliMessage('PDFåº“æœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                        }
                    });
                }
            }, 2000); // å¢åŠ ç­‰å¾…æ—¶é—´åˆ°2ç§’ï¼Œç¡®ä¿å›¾ç‰‡åŠ è½½å®Œæˆ
        }).catch(function(err) {
            console.error('è½¬æ¢å¦å›¾å¤±è´¥:', err);
            showMingliMessage('PDFç”Ÿæˆå¤±è´¥: è½¬æ¢å¦å›¾æ—¶å‡ºé”™ - ' + err.message);
        });
    } catch(err) {
        console.error('PDFç”Ÿæˆå¼‚å¸¸:', err);
        showMingliMessage('PDFç”Ÿæˆå¤±è´¥: ' + err.message);
    }
}

function downloadAsWord() {
    try {
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsWord',message:'Wordç”Ÿæˆå¼€å§‹',data:{timestamp:Date.now()},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
        // #endregion
        showMingliMessage('æ­£åœ¨ç”ŸæˆWordæ–‡æ¡£ï¼Œè¯·ç¨å€™...');
        
        // æ£€æŸ¥64å¦åˆ†æç³»ç»Ÿæ˜¯å¦æœ‰å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰åˆ™è‡ªåŠ¨ç”Ÿæˆ
        var outElement = document.getElementById('out');
        var needsGenerate = false;
        if(!outElement || !outElement.innerHTML || outElement.innerHTML.trim() === '' || 
           outElement.innerHTML.indexOf('è¯·é€‰æ‹©å¦è±¡åç‚¹å‡»ç”Ÿæˆ') >= 0) {
            // æ£€æŸ¥æ˜¯å¦æœ‰é€‰æ‹©çš„å¦
            var hasSelectedGua = false;
            for(var step = 1; step <= 5; step++) {
                var selectId = 'in1_' + step;
                var selectEl = document.getElementById(selectId);
                if(selectEl && selectEl.value) {
                    hasSelectedGua = true;
                    break;
                }
            }
            if(hasSelectedGua && typeof window.gen === 'function') {
                needsGenerate = true;
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsWord',message:'è‡ªåŠ¨ç”Ÿæˆ64å¦åˆ†æ',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                window.gen();
                // ç­‰å¾…ç”Ÿæˆå®Œæˆ
                setTimeout(function() {
                    // æ”¶é›†æ‰€æœ‰å†…å®¹
                    var content = collectAllContent();
                    processWordContent(content);
                }, 500);
                return;
            }
        }
        
        // æ”¶é›†æ‰€æœ‰å†…å®¹
        var content = collectAllContent();
        processWordContent(content);
    } catch(err) {
        showMingliMessage('Wordæ–‡æ¡£ç”Ÿæˆå¤±è´¥: ' + err.message);
    }
}

function processWordContent(content) {
    try {
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsWord',message:'å†…å®¹æ”¶é›†å®Œæˆ',data:{contentLength:content?content.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
        // #endregion
        
        // è½¬æ¢æ‰€æœ‰å¦å›¾ä¸ºå›¾ç‰‡ï¼ˆWordæ–‡æ¡£ä¹Ÿéœ€è¦å›¾ç‰‡ï¼‰
        convertGuaImagesInContent(content).then(function(convertedContent) {
            // #region agent log
            var imgCount = (convertedContent.match(/<img/g) || []).length;
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:downloadAsWord',message:'å¦å›¾è½¬æ¢å®Œæˆ',data:{convertedLength:convertedContent?convertedContent.length:0,imgCount:imgCount},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            // ç§»é™¤HTMLæ–‡æ¡£æ ‡ç­¾ï¼ˆWordæ–‡æ¡£ä¸éœ€è¦å®Œæ•´çš„HTMLç»“æ„ï¼‰
            var bodyContent = convertedContent;
            if(bodyContent.indexOf('<body>') >= 0) {
                var bodyStart = bodyContent.indexOf('<body>') + 6;
                var bodyEnd = bodyContent.indexOf('</body>');
                if(bodyEnd > bodyStart) {
                    bodyContent = bodyContent.substring(bodyStart, bodyEnd);
                }
            }
            
            // åˆ›å»ºWordæ–‡æ¡£HTML
            var htmlContent = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>å‘½ä¾‹åˆ†æ</title>' +
                '<style>body { font-family: "Microsoft YaHei", sans-serif; font-size: 12pt; line-height: 1.6; color: #333; padding: 20px; position: relative; }' +
                'h1, h2, h3 { color: #5c4a37; } table { border-collapse: collapse; width: 100%; margin: 10px 0; }' +
                'td, th { border: 1px solid #ddd; padding: 8px; text-align: center; }' +
                'th { background-color: #f5f3ef; } .gua-box { margin: 15px 0; }' +
                'img { max-width: 100%; height: auto; display: block; margin: 10px auto; }' +
                '.yao-stack { display: flex; flex-direction: column; gap: 6px; width: 100px; margin: 15px auto; }' +
                '.yao-line { height: 18px; display: flex; justify-content: space-between; align-items: center; }' +
                '.yang { width: 100%; height: 12px; background: #333; border-radius: 2px; }' +
                '.yin-group { width: 100%; height: 12px; display: flex; justify-content: space-between; gap: 8px; }' +
                '.yin-part { flex: 1; background: #333; border-radius: 2px; }' +
                '.idx-text { width: 30px; text-align: right; font-size: 11pt; margin-right: 10px; color: #666; }' +
                '/* Wordæ–‡æ¡£æ°´å° */' +
                'body::before { content: "é’å²›è‘£å¾·é¾™è€å¸ˆ 15166397157"; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); font-size: 72px; color: rgba(139, 69, 19, 0.15); z-index: 9999; pointer-events: none; white-space: nowrap; font-weight: bold; letter-spacing: 12px; }' +
                '</style></head><body>' +
                bodyContent + '</body></html>';
            
            // åˆ›å»ºBlobå¹¶ä¸‹è½½
            var blob = new Blob(['\ufeff', htmlContent], { type: 'application/msword' });
            var url = URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = 'å‘½ä¾‹åˆ†æ_' + new Date().toISOString().slice(0, 10) + '.doc';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showMingliMessage('Wordæ–‡æ¡£ä¸‹è½½å®Œæˆï¼');
        }).catch(function(err) {
            console.error('Wordæ–‡æ¡£ç”Ÿæˆå¤±è´¥:', err);
            showMingliMessage('Wordæ–‡æ¡£ç”Ÿæˆå¤±è´¥: ' + err.message);
        });
    } catch(err) {
        showMingliMessage('Wordæ–‡æ¡£ç”Ÿæˆå¤±è´¥: ' + err.message);
    }
}

// è½¬æ¢å†…å®¹ä¸­çš„æ‰€æœ‰å¦å›¾ä¸ºå›¾ç‰‡
function convertGuaImagesInContent(htmlContent) {
    return new Promise(function(resolve) {
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertGuaImagesInContent',message:'å¼€å§‹è½¬æ¢å¦å›¾',data:{htmlLength:htmlContent?htmlContent.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
        // #endregion
        // åˆ›å»ºä¸€ä¸ªä¸´æ—¶å®¹å™¨
        var tempDiv = document.createElement('div');
        tempDiv.innerHTML = htmlContent;
        tempDiv.style.cssText = 'position: absolute; left: -9999px; width: 800px; background: white;';
        document.body.appendChild(tempDiv);
        
        // å…ˆç§»é™¤æ‰€æœ‰ç¼ºå¤±çš„å›¾ç‰‡ï¼Œé¿å…canvasæ±¡æŸ“
        var allImages = tempDiv.querySelectorAll('img');
        var removedImgCount = 0;
        allImages.forEach(function(img) {
            // ä¸ºå›¾ç‰‡æ·»åŠ é”™è¯¯å¤„ç†
            if(img.src && img.src.indexOf('data:') !== 0) {
                // ébase64å›¾ç‰‡ï¼Œæ£€æŸ¥æ˜¯å¦å¯èƒ½ç¼ºå¤±
                if(img.src.indexOf('è€å¸ˆåŠ©ç†å¾®ä¿¡ç ') >= 0 || img.src.indexOf('è‘£å¾·é¾™') >= 0) {
                    // ç›´æ¥ç§»é™¤å·²çŸ¥ç¼ºå¤±çš„å›¾ç‰‡
                    var placeholder = document.createElement('span');
                    placeholder.textContent = '[å›¾ç‰‡]';
                    placeholder.style.cssText = 'color: #999; font-style: italic; display: inline-block; padding: 5px;';
                    if(img.parentNode) {
                        img.parentNode.replaceChild(placeholder, img);
                        removedImgCount++;
                    }
                } else {
                    img.onerror = function() {
                        // å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶ï¼Œç§»é™¤è¯¥å›¾ç‰‡æˆ–æ›¿æ¢ä¸ºå ä½ç¬¦
                        var placeholder = document.createElement('span');
                        placeholder.textContent = '[å›¾ç‰‡ç¼ºå¤±]';
                        placeholder.style.cssText = 'color: #999; font-style: italic; display: inline-block; padding: 5px;';
                        if(img.parentNode) {
                            img.parentNode.replaceChild(placeholder, img);
                        }
                    };
                }
            }
        });
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertGuaImagesInContent',message:'ç§»é™¤ç¼ºå¤±å›¾ç‰‡',data:{totalImages:allImages.length,removedCount:removedImgCount},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
        // #endregion
        
        // æŸ¥æ‰¾æ‰€æœ‰å¦å›¾å…ƒç´ ï¼ˆåŒ…æ‹¬.yao-stackç±»ï¼‰
        var placeholders = tempDiv.querySelectorAll('.yao-stack');
        var promises = [];
        
        if(placeholders.length === 0) {
            // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œç›´æ¥è¿”å›åŸå†…å®¹
            var result = tempDiv.innerHTML;
            document.body.removeChild(tempDiv);
            // #region agent log
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertGuaImagesInContent',message:'æœªæ‰¾åˆ°å¦å›¾',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            resolve(result);
            return;
        }
        
        console.log('æ‰¾åˆ°', placeholders.length, 'ä¸ªå¦å›¾éœ€è¦è½¬æ¢');
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertGuaImagesInContent',message:'æ‰¾åˆ°å¦å›¾',data:{count:placeholders.length},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
        // #endregion
        
        placeholders.forEach(function(placeholder, index) {
            // ç¡®ä¿å…ƒç´ æœ‰æ­£ç¡®çš„æ ·å¼
            if(!placeholder.style.cssText || placeholder.style.cssText.trim() === '') {
                placeholder.style.cssText = 'display: flex; flex-direction: column; gap: 6px; width: 100px; margin: 15px auto;';
            }
            
            var promise = convertElementToImage(placeholder);
            promises.push(promise.then(function(imgData) {
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertGuaImagesInContent',message:'å¦å›¾è½¬æ¢ç»“æœ',data:{index:index+1,hasData:!!imgData,dataLength:imgData?imgData.length:0,isBase64:imgData?imgData.indexOf('data:image')===0:false},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                if(imgData && imgData.length > 100 && imgData.indexOf('data:image') === 0) { // ç¡®ä¿æœ‰å®é™…æ•°æ®ä¸”æ˜¯base64å›¾ç‰‡
                    var img = document.createElement('img');
                    img.src = imgData;
                    img.style.cssText = 'max-width: 150px; height: auto; margin: 15px auto; display: block;';
                    img.alt = 'å¦å›¾';
                    if(placeholder.parentNode) {
                        placeholder.parentNode.replaceChild(img, placeholder);
                    }
                    console.log('å¦å›¾', index + 1, 'è½¬æ¢æˆåŠŸï¼Œå›¾ç‰‡å¤§å°:', imgData.length, 'å­—ç¬¦');
                } else {
                    console.warn('å¦å›¾', index + 1, 'è½¬æ¢å¤±è´¥ï¼ˆæ•°æ®æ— æ•ˆï¼‰ï¼Œä¿ç•™åŸHTML');
                }
            }).catch(function(err) {
                console.error('å¦å›¾', index + 1, 'è½¬æ¢å‡ºé”™:', err);
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertGuaImagesInContent',message:'å¦å›¾è½¬æ¢é”™è¯¯',data:{index:index+1,error:err.message},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
            }));
        });
        
        Promise.all(promises).then(function() {
            var result = tempDiv.innerHTML;
            document.body.removeChild(tempDiv);
            resolve(result);
        }).catch(function(err) {
            console.error('è½¬æ¢å¦å›¾å¤±è´¥:', err);
            var result = tempDiv.innerHTML;
            document.body.removeChild(tempDiv);
            resolve(result);
        });
    });
}

// å°†å…ƒç´ è½¬æ¢ä¸ºbase64å›¾ç‰‡
function convertElementToImage(element) {
    return new Promise(function(resolve) {
        // #region agent log
        var elementHtml = element?element.innerHTML:'';
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertElementToImage',message:'å¼€å§‹è½¬æ¢å•ä¸ªå¦å›¾',data:{hasElement:!!element,htmlLength:elementHtml?elementHtml.length:0,hasHtml2canvas:typeof html2canvas!=='undefined'},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
        // #endregion
        if(!element || !element.innerHTML || element.innerHTML.trim() === '') {
            resolve('');
            return;
        }
        
        // åˆ›å»ºä¸´æ—¶å®¹å™¨ï¼Œå¤åˆ¶å…ƒç´ åŠå…¶æ ·å¼
        var tempDiv = document.createElement('div');
        tempDiv.style.cssText = 'position: absolute; left: -9999px; width: 150px; background: white; padding: 15px; display: block;';
        
        // å¤åˆ¶å…ƒç´ çš„HTMLå’Œæ ·å¼
        var clonedElement = element.cloneNode(true);
                clonedElement.style.cssText = element.style.cssText || 'display: flex; flex-direction: column; gap: 6px; width: 100px; margin: 15px auto;';
        tempDiv.appendChild(clonedElement);
        document.body.appendChild(tempDiv);
        
        // å¼ºåˆ¶é‡æ’ï¼Œç­‰å¾…æ¸²æŸ“
        var forceReflow = tempDiv.offsetHeight;
        
        // ç­‰å¾…ä¸€å¸§ç¡®ä¿æ¸²æŸ“å®Œæˆ
        setTimeout(function() {
            if(typeof html2canvas !== 'undefined') {
                html2canvas(tempDiv, {
                    scale: 1, // é™ä½åˆ†è¾¨ç‡ï¼Œå‡å°å›¾ç‰‡å¤§å°
                    backgroundColor: '#ffffff',
                    width: tempDiv.scrollWidth || 200,
                    height: tempDiv.scrollHeight || 200,
                    useCORS: true, // ä½¿ç”¨CORSï¼Œå…è®¸è·¨åŸŸå›¾ç‰‡
                    allowTaint: true, // å…è®¸æ±¡æŸ“canvasï¼ˆå› ä¸ºå¦å›¾æ˜¯çº¯HTMLï¼Œæ²¡æœ‰å¤–éƒ¨å›¾ç‰‡ï¼‰
                    logging: false,
                    letterRendering: true,
                    removeContainer: false
                }).then(function(canvas) {
                    try {
                        var imgData = canvas.toDataURL('image/png', 0.8);
                        // #region agent log
                        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertElementToImage',message:'å¦å›¾è½¬æ¢æˆåŠŸ',data:{imgDataLength:imgData?imgData.length:0,isBase64:imgData?imgData.indexOf('data:image')===0:false},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
                        // #endregion
                        document.body.removeChild(tempDiv);
                        resolve(imgData);
                    } catch(err) {
                        console.warn('å¦å›¾è½¬æ¢å¤±è´¥ï¼ˆtoDataURLé”™è¯¯ï¼‰:', err);
                        // #region agent log
                        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertElementToImage',message:'toDataURLé”™è¯¯',data:{error:err.message,errorType:err.name,isSecurityError:err.name==='SecurityError'},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                        // #endregion
                        document.body.removeChild(tempDiv);
                        resolve(''); // å¤±è´¥æ—¶è¿”å›ç©º
                    }
                }).catch(function(err) {
                    console.warn('å¦å›¾è½¬æ¢å¤±è´¥ï¼ˆhtml2canvasé”™è¯¯ï¼‰:', err);
                    // #region agent log
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:convertElementToImage',message:'html2canvasé”™è¯¯',data:{error:err.message,errorType:err.name},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
                    // #endregion
                    document.body.removeChild(tempDiv);
                    resolve(''); // å¤±è´¥æ—¶è¿”å›ç©º
                });
            } else {
                document.body.removeChild(tempDiv);
                resolve(''); // html2canvasæœªåŠ è½½
            }
        }, 200); // å¢åŠ ç­‰å¾…æ—¶é—´
    });
}

// å°†å¦å›¾å…ƒç´ è½¬æ¢ä¸ºbase64å›¾ç‰‡ï¼ˆåŒæ­¥ç‰ˆæœ¬ï¼Œç”¨äºæ”¶é›†å†…å®¹æ—¶ï¼‰
function convertGuaElementToImageHtml(element) {
    if(!element || !element.innerHTML || element.innerHTML.trim() === '') {
        return '';
    }
    
    // åˆ›å»ºä¸€ä¸ªä¸´æ—¶å®¹å™¨æ¥æ¸²æŸ“å¦å›¾
    var tempDiv = document.createElement('div');
    tempDiv.style.cssText = 'position: absolute; left: -9999px; width: 200px; background: white; padding: 20px; display: block;';
    tempDiv.innerHTML = element.innerHTML;
    document.body.appendChild(tempDiv);
    
    // å¼ºåˆ¶é‡æ’
    var forceReflow = tempDiv.offsetHeight;
    
    // ä½¿ç”¨html2canvasè½¬æ¢ä¸ºå›¾ç‰‡
    if(typeof html2canvas !== 'undefined') {
        try {
            // åŒæ­¥æ–¹å¼ï¼šä½¿ç”¨canvasç›´æ¥è½¬æ¢
            var canvas = document.createElement('canvas');
            var ctx = canvas.getContext('2d');
            canvas.width = tempDiv.scrollWidth || 200;
            canvas.height = tempDiv.scrollHeight || 200;
            
            // ä½¿ç”¨html2canvaså¼‚æ­¥è½¬æ¢ï¼Œä½†è¿™é‡Œæˆ‘ä»¬éœ€è¦åŒæ­¥è¿”å›
            // æ‰€ä»¥å…ˆè¿”å›å ä½ç¬¦ï¼Œå®é™…è½¬æ¢åœ¨ä¸‹è½½æ—¶è¿›è¡Œ
            var placeholder = '<div class="gua-image-placeholder" data-gua-html="' + 
                element.innerHTML.replace(/"/g, '&quot;').replace(/'/g, '&#39;') + 
                '" style="width: 200px; height: 150px; background: #f0f0f0; border: 1px solid #ddd; margin: 15px auto; display: flex; align-items: center; justify-content: center; color: #999;">å¦å›¾åŠ è½½ä¸­...</div>';
            
            document.body.removeChild(tempDiv);
            return placeholder;
        } catch(err) {
            console.warn('å¦å›¾è½¬æ¢å¤±è´¥:', err);
            document.body.removeChild(tempDiv);
            return element.outerHTML; // å¤±è´¥æ—¶è¿”å›åŸå§‹HTML
        }
    } else {
        document.body.removeChild(tempDiv);
        return element.outerHTML; // html2canvasæœªåŠ è½½æ—¶è¿”å›åŸå§‹HTML
    }
}

function collectAllContent() {
    // åˆ›å»ºå®Œæ•´çš„HTMLæ–‡æ¡£ç»“æ„
    var html = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>å‘½ä¾‹åˆ†ææŠ¥å‘Š</title>';
    
    // é¦–å…ˆæ”¶é›†"å‘ŠåŒå¿—ä¹¦"å’Œ"ä¸šåŠ¡é¡¹ç›®åŠè¯¾ç¨‹"å†…å®¹
    var announcementContent = '';
    var announcementSections = document.querySelectorAll('#announcement');
    if(announcementSections.length >= 2) {
        // ç¬¬ä¸€å—ï¼šå‘ŠåŒå¿—ä¹¦
        var firstSection = announcementSections[0];
        if(firstSection) {
            var firstSectionHtml = firstSection.innerHTML;
            // ç§»é™¤å›¾ç‰‡ï¼Œé¿å…åŠ è½½é—®é¢˜
            firstSectionHtml = firstSectionHtml.replace(/<img[^>]*>/gi, '');
            announcementContent += '<div style="margin-bottom: 40px; padding: 20px; border-bottom: 2px solid #ddd;">';
            announcementContent += '<div style="color: #8B4513; font-size: 1.2rem; text-align: center; margin-bottom: 20px;">"ä¸ºä¸–ç•Œä¹‹å¤§åŒè€Œç ”è¯»å¹¶è·µè¡Œã€Šæ˜“ç»ã€‹"</div>';
            announcementContent += firstSectionHtml;
            announcementContent += '</div>';
        }
        // ç¬¬äºŒå—ï¼šä¸šåŠ¡é¡¹ç›®åŠè¯¾ç¨‹
        var secondSection = announcementSections[1];
        if(secondSection) {
            var secondSectionHtml = secondSection.innerHTML;
            // ç§»é™¤å›¾ç‰‡ï¼Œé¿å…åŠ è½½é—®é¢˜
            secondSectionHtml = secondSectionHtml.replace(/<img[^>]*>/gi, '');
            announcementContent += '<div style="margin-bottom: 40px; padding: 20px; border-bottom: 2px solid #ddd;">';
            announcementContent += secondSectionHtml;
            announcementContent += '</div>';
        }
    }
    
    // æ·»åŠ åŸºæœ¬æ ·å¼ï¼ŒåŒ…æ‹¬å¦è±¡æ¸²æŸ“æ‰€éœ€çš„æ ·å¼
    // æ³¨æ„ï¼šç§»é™¤å¯èƒ½å¯¼è‡´canvasæ±¡æŸ“çš„å›¾ç‰‡å¼•ç”¨
    html += '<style>body { font-family: "Microsoft YaHei", "SimHei", sans-serif; font-size: 12pt; line-height: 1.6; color: #333; } ' +
            'h1, h2, h3, h4 { color: #5c4a37; margin-top: 20px; margin-bottom: 15px; } ' +
            'table { border-collapse: collapse; width: 100%; margin: 15px 0; } ' +
            'td, th { border: 1px solid #ddd; padding: 8px; text-align: center; } ' +
            'th { background-color: #f5f3ef; font-weight: bold; } ' +
            '.gua-box { margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; } ' +
            '.yao-stack { display: flex; flex-direction: column; gap: 6px; width: 100px; margin: 15px auto; } ' +
            '.yao-line { height: 18px; display: flex; justify-content: space-between; position: relative; align-items: center; } ' +
            '.yang { width: 100%; height: 100%; background: #333; border-radius: 2px; min-height: 12px; } ' +
            '.yin-group { width: 100%; height: 100%; display: flex; justify-content: space-between; gap: 8px; min-height: 12px; } ' +
            '.yin-part { flex: 1; background: #333; border-radius: 2px; } ' +
            '.idx-text { width: 30px; text-align: right; font-size: 11pt; margin-right: 10px; color: #666; } ' +
            '.is-yt .yang, .is-yt .yin-part { background: #d32f2f; } ' +
            '.res-col { margin: 20px 0; } ' +
            '.res-t { font-size: 18px; font-weight: bold; color: #5c4a37; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #ddd; } ' +
            '.card { margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9; } ' +
            '.c-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #ddd; } ' +
            '.c-name { font-size: 18px; font-weight: bold; color: #5c4a37; } ' +
            '.c-step { font-size: 12px; color: #999; background: #f0f0f0; padding: 2px 8px; border-radius: 4px; } ' +
            '.c-body { margin-top: 10px; padding: 10px; background: white; border-radius: 4px; } ' +
            '/* PDFæ–‡æ¡£æ°´å° */' +
            'body::before { content: "é’å²›è‘£å¾·é¾™è€å¸ˆ 15166397157"; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); font-size: 72px; color: rgba(139, 69, 19, 0.15); z-index: 9999; pointer-events: none; white-space: nowrap; font-weight: bold; letter-spacing: 12px; }</style></head><body>';
    
    // åœ¨æœ€å‰é¢æ·»åŠ "å‘ŠåŒå¿—ä¹¦"å’Œ"ä¸šåŠ¡é¡¹ç›®åŠè¯¾ç¨‹"å†…å®¹
    if(announcementContent) {
        html += '<div style="page-break-after: always; margin-bottom: 40px;">' + announcementContent + '</div>';
    }
    
    // 1. æ ‡é¢˜
    var now = new Date();
    var dateStr = now.getFullYear() + 'å¹´' + (now.getMonth() + 1) + 'æœˆ' + now.getDate() + 'æ—¥ ' +
                  now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
    html += '<h1 style="text-align: center; color: #5c4a37; margin-bottom: 30px;">å‘½ä¾‹åˆ†ææŠ¥å‘Š</h1>';
    html += '<p style="text-align: center; color: #666; margin-bottom: 30px;">ç”Ÿæˆæ—¶é—´ï¼š' + dateStr + '</p>';
    
    // 2. åŸºæœ¬ä¿¡æ¯
    html += '<h2>ä¸€ã€åŸºæœ¬ä¿¡æ¯</h2>';
    var y = document.getElementById('y') ? document.getElementById('y').value : '';
    var m = document.getElementById('m') ? document.getElementById('m').value : '';
    var d = document.getElementById('d') ? document.getElementById('d').value : '';
    var h = document.getElementById('h') ? document.getElementById('h').value : '';
    var min = document.getElementById('min') ? document.getElementById('min').value : '';
    var sex = document.getElementById('sex') ? (document.getElementById('sex').value === '1' ? 'ç”·' : 'å¥³') : '';
    var lon = document.getElementById('lon') ? document.getElementById('lon').value : '';
    var city = document.getElementById('city-input') ? document.getElementById('city-input').value : '';
    var foreignCity = document.getElementById('foreign-city-input') ? document.getElementById('foreign-city-input').value : '';
    
    html += '<table><tr><th>é¡¹ç›®</th><th>å†…å®¹</th></tr>';
    html += '<tr><td>å…¬å†å¹´</td><td>' + y + 'å¹´</td></tr>';
    html += '<tr><td>æœˆæ—¥</td><td>' + m + 'æœˆ' + d + 'æ—¥</td></tr>';
    html += '<tr><td>æ—¶åˆ†</td><td>' + h + 'æ—¶' + min + 'åˆ†</td></tr>';
    html += '<tr><td>æ€§åˆ«</td><td>' + sex + '</td></tr>';
    html += '<tr><td>ç»åº¦</td><td>' + lon + '</td></tr>';
    if(city) html += '<tr><td>å‡ºç”Ÿåœ°ï¼ˆå›½å†…ï¼‰</td><td>' + city + '</td></tr>';
    if(foreignCity) html += '<tr><td>å‡ºç”Ÿåœ°ï¼ˆå›½å¤–ï¼‰</td><td>' + foreignCity + '</td></tr>';
    html += '</table>';
    
    // 3. å››æŸ±å…«å­— - æ”¶é›†å®Œæ•´çš„è¡¨æ ¼ç»“æ„
    var bzTable = document.querySelector('table');
    var bzBody = document.getElementById('bz-body');
    if(bzTable || (bzBody && bzBody.innerHTML)) {
        html += '<h2>äºŒã€å››æŸ±å…«å­—ä¸æ•°ç†</h2>';
        var txtTime = document.getElementById('txt-time') ? document.getElementById('txt-time').innerText : '';
        var txtJie = document.getElementById('txt-jie') ? document.getElementById('txt-jie').innerText : '';
        if(txtTime || txtJie) {
            html += '<p>çœŸå¤ªé˜³æ—¶: ' + txtTime + ' | èŠ‚æ°”: ' + txtJie + '</p>';
        }
        // å¦‚æœæ‰¾åˆ°å®Œæ•´çš„è¡¨æ ¼ï¼Œä½¿ç”¨è¡¨æ ¼ï¼›å¦åˆ™åªä½¿ç”¨tbody
        if(bzTable && bzTable.outerHTML) {
            html += bzTable.outerHTML;
        } else if(bzBody) {
            // æ„å»ºå®Œæ•´çš„è¡¨æ ¼
            html += '<table style="border-collapse: collapse; width: 100%; margin: 15px 0;">';
            html += '<thead><tr><th>å¹´æŸ±</th><th>æœˆæŸ±</th><th>æ—¥æŸ±</th><th>æ—¶æŸ±</th></tr></thead>';
            html += bzBody.outerHTML;
            html += '</table>';
        }
        var valTianshu = document.getElementById('val-tianshu') ? document.getElementById('val-tianshu').innerText : '';
        var valDishu = document.getElementById('val-dishu') ? document.getElementById('val-dishu').innerText : '';
        if(valTianshu || valDishu) {
            html += '<p>åœ°æ•°ï¼š' + valDishu + ' | å¤©æ•°ï¼š' + valTianshu + '</p>';
        }
    }
    
    // 4. å‘½å¦ - æ”¶é›†å®Œæ•´çš„å¦åŒºåŸŸï¼Œå¹¶å°†å¦å›¾è½¬æ¢ä¸ºå ä½ç¬¦
    var guaArea = document.querySelector('.gua-area');
    if(guaArea && guaArea.innerHTML) {
        html += '<h2>ä¸‰ã€å‘½å¦ (å…ˆå¤© / åå¤©)</h2>';
        // ç›´æ¥ä½¿ç”¨æ•´ä¸ªgua-areaçš„HTMLï¼Œç¡®ä¿åŒ…å«æ‰€æœ‰æ ·å¼å’Œç»“æ„
        var guaAreaHtml = guaArea.innerHTML;
        
        // ä¿ç•™åŸå§‹HTMLï¼Œä¸åœ¨è¿™é‡Œè½¬æ¢å ä½ç¬¦
        // å¦å›¾å°†åœ¨convertGuaImagesInContentä¸­ç»Ÿä¸€è½¬æ¢ä¸ºå›¾ç‰‡
        
        // è½¬æ¢æ ·å¼ç±»ä¸ºå†…è”æ ·å¼
        guaAreaHtml = guaAreaHtml.replace(/class="gua-box"/g, 'style="margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; text-align: center;"');
        guaAreaHtml = guaAreaHtml.replace(/class="gua-name"/g, 'style="font-size: 18px; font-weight: bold; color: #5c4a37; margin-bottom: 10px;"');
        html += '<div style="display: flex; gap: 30px; justify-content: center; margin: 20px 0; flex-wrap: wrap;">' + guaAreaHtml + '</div>';
    } else {
        // å¤‡ç”¨æ–¹æ¡ˆï¼šå•ç‹¬æ”¶é›†
        var nXt = document.getElementById('n-xt') ? document.getElementById('n-xt').innerText : '';
        var nHt = document.getElementById('n-ht') ? document.getElementById('n-ht').innerText : '';
        var gXt = document.getElementById('g-xt') ? document.getElementById('g-xt') : null;
        var gHt = document.getElementById('g-ht') ? document.getElementById('g-ht') : null;
        if(nXt || nHt) {
            html += '<h2>ä¸‰ã€å‘½å¦ (å…ˆå¤© / åå¤©)</h2>';
            html += '<div style="display: flex; gap: 30px; justify-content: center; margin: 20px 0;">';
            if(nXt && gXt) {
                // ä¿ç•™åŸå§‹HTMLï¼Œåœ¨ä¸‹è½½æ—¶ç»Ÿä¸€è½¬æ¢ä¸ºå›¾ç‰‡
                html += '<div class="gua-box"><h3>å…ˆå¤©å¦</h3><p><strong>' + nXt + '</strong></p>' + gXt.innerHTML + '</div>';
            }
            if(nHt && gHt) {
                // ä¿ç•™åŸå§‹HTMLï¼Œåœ¨ä¸‹è½½æ—¶ç»Ÿä¸€è½¬æ¢ä¸ºå›¾ç‰‡
                html += '<div class="gua-box"><h3>åå¤©å¦</h3><p><strong>' + nHt + '</strong></p>' + gHt.innerHTML + '</div>';
            }
            html += '</div>';
        }
    }
    
    // 5. å¤§è¿æµè½¬ - æ”¶é›†å®Œæ•´çš„å¤§è¿åŒºåŸŸ
    var dyArea = document.getElementById('dy-area');
    if(dyArea && dyArea.innerHTML) {
        html += '<h2>å››ã€å¤§è¿æµè½¬</h2>';
        // æ”¶é›†å®Œæ•´çš„å¤§è¿HTMLï¼ŒåŒ…æ‹¬æ‰€æœ‰å¡ç‰‡
        var dyHtml = dyArea.innerHTML;
        // è½¬æ¢æ ·å¼ç±»ä¸ºå†…è”æ ·å¼
        dyHtml = dyHtml.replace(/class="dy-card"/g, 'style="display: inline-block; margin: 10px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9; min-width: 150px; text-align: center;"');
        dyHtml = dyHtml.replace(/class="dy-title"/g, 'style="font-size: 16px; font-weight: bold; color: #5c4a37; margin-bottom: 5px;"');
        dyHtml = dyHtml.replace(/class="dy-range"/g, 'style="font-size: 14px; color: #666;"');
        html += '<div style="margin: 20px 0;">' + dyHtml + '</div>';
    }
    
    // 6. æµè¿æ¨ç®— - ç›´æ¥æ”¶é›†æ•´ä¸ªflow-gridåŒºåŸŸï¼Œç¡®ä¿ä¸é—æ¼ä»»ä½•å†…å®¹
    html += '<h2>äº”ã€ä»»æ„æ—¶åˆ»æµè¿æ¨ç®—</h2>';
    var flowGrid = document.querySelector('.flow-grid');
    var hasFlowContent = false;
    
    if(flowGrid && flowGrid.innerHTML && flowGrid.innerHTML.trim() !== '') {
        // ç›´æ¥æ”¶é›†æ•´ä¸ªflow-gridçš„HTMLï¼Œç¡®ä¿åŒ…å«æ‰€æœ‰å†…å®¹
        var flowHtml = flowGrid.innerHTML;
        
        // ç§»é™¤å¯èƒ½å¯¼è‡´canvasæ±¡æŸ“çš„å›¾ç‰‡
        var tempFlowDiv = document.createElement('div');
        tempFlowDiv.innerHTML = flowHtml;
        // ç§»é™¤æ‰€æœ‰å¯èƒ½ç¼ºå¤±çš„å›¾ç‰‡
        var flowImgs = tempFlowDiv.querySelectorAll('img');
        flowImgs.forEach(function(img) {
            if(img.src && img.src.indexOf('data:') !== 0 && img.src.indexOf('è€å¸ˆåŠ©ç†å¾®ä¿¡ç ') >= 0) {
                // ç§»é™¤ç¼ºå¤±çš„å¾®ä¿¡ç å›¾ç‰‡
                var placeholder = document.createElement('span');
                placeholder.textContent = '[å›¾ç‰‡]';
                placeholder.style.cssText = 'color: #999; font-style: italic;';
                if(img.parentNode) {
                    img.parentNode.replaceChild(placeholder, img);
                }
            }
        });
        flowHtml = tempFlowDiv.innerHTML;
        
        // è½¬æ¢æ ·å¼ç±»ä¸ºå†…è”æ ·å¼
        flowHtml = flowHtml.replace(/class="flow-item"/g, 'style="background: #fff; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #e6f7ff; box-shadow: 0 2px 6px rgba(0,0,0,0.02); margin: 10px 0;"');
        flowHtml = flowHtml.replace(/class="flow-label"/g, 'style="font-size: 12px; color: #888; margin-bottom: 5px; font-weight: bold;"');
        flowHtml = flowHtml.replace(/class="flow-val"/g, 'style="font-size: 18px; font-weight: bold; color: #333; margin: 10px 0;"');
        flowHtml = flowHtml.replace(/class="flow-extra"/g, 'style="font-size: 12px; color: #666; margin-top: 10px;"');
        flowHtml = flowHtml.replace(/class="flow-time"/g, 'style="font-size: 11px; color: #888; margin-top: 5px;"');
        
        html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">' + flowHtml + '</div>';
        hasFlowContent = true;
    } else {
        // å¤‡ç”¨æ–¹æ¡ˆï¼šé€ä¸ªæ”¶é›†æµè¿ä¿¡æ¯
        // æµå¹´
        var fvY = document.getElementById('fv-y') ? document.getElementById('fv-y').innerText : '';
        var gLy = document.getElementById('g-ly') ? document.getElementById('g-ly').innerHTML : '';
        var fdY = document.getElementById('fd-y') ? document.getElementById('fd-y').innerText : '';
        if(fvY && fvY !== '--') {
            hasFlowContent = true;
            html += '<div style="margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9;">';
            html += '<h3>æµå¹´ï¼ˆå¤©çºªç®—æ³•ï¼‰</h3>';
            html += '<p style="font-size: 16px; font-weight: bold; color: #5c4a37; margin: 10px 0;">' + fvY + '</p>';
            if(gLy) html += '<div style="margin: 15px 0;">' + gLy + '</div>';
            if(fdY) html += '<p style="color: #666; margin-top: 10px;">' + fdY + '</p>';
            html += '</div>';
        }
        
        // æµæœˆ
        var fvM = document.getElementById('fv-m') ? document.getElementById('fv-m').innerText : '';
        var gLm = document.getElementById('g-lm') ? document.getElementById('g-lm').innerHTML : '';
        var fdM = document.getElementById('fd-m') ? document.getElementById('fd-m').innerText : '';
        var ftM = document.getElementById('ft-m') ? document.getElementById('ft-m').innerText : '';
        if(fvM && fvM !== '--') {
            hasFlowContent = true;
            html += '<div style="margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9;">';
            html += '<h3>æµæœˆï¼ˆå¤©çºªç®—æ³•ï¼‰</h3>';
            html += '<p style="font-size: 16px; font-weight: bold; color: #5c4a37; margin: 10px 0;">' + fvM + '</p>';
            if(gLm) html += '<div style="margin: 15px 0;">' + gLm + '</div>';
            if(fdM) html += '<p style="color: #666; margin-top: 10px;">' + fdM + '</p>';
            if(ftM) html += '<p style="color: #888; font-size: 12px; margin-top: 5px;">' + ftM + '</p>';
            html += '</div>';
        }
        
        // æµæ—¥
        var fvD = document.getElementById('fv-d') ? document.getElementById('fv-d').innerText : '';
        var gLd = document.getElementById('g-ld') ? document.getElementById('g-ld').innerHTML : '';
        var fdD = document.getElementById('fd-d') ? document.getElementById('fd-d').innerText : '';
        var ftD = document.getElementById('ft-d') ? document.getElementById('ft-d').innerText : '';
        if(fvD && fvD !== '--') {
            hasFlowContent = true;
            html += '<div style="margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9;">';
            html += '<h3>æµæ—¥ï¼ˆæ–°è§„åˆ™ï¼‰</h3>';
            html += '<p style="font-size: 16px; font-weight: bold; color: #5c4a37; margin: 10px 0;">' + fvD + '</p>';
            if(gLd) html += '<div style="margin: 15px 0;">' + gLd + '</div>';
            if(fdD) html += '<p style="color: #666; margin-top: 10px;">' + fdD + '</p>';
            if(ftD) html += '<p style="color: #888; font-size: 12px; margin-top: 5px;">' + ftD + '</p>';
            html += '</div>';
        }
        
        // æµåˆ†ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
        var fvF = document.getElementById('fv-f') ? document.getElementById('fv-f').innerText : '';
        var gLf = document.getElementById('g-lf') ? document.getElementById('g-lf').innerHTML : '';
        var fdF = document.getElementById('fd-f') ? document.getElementById('fd-f').innerText : '';
        var ftF = document.getElementById('ft-f') ? document.getElementById('ft-f').innerText : '';
        if(fvF && fvF !== '--') {
            hasFlowContent = true;
            html += '<div style="margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9;">';
            html += '<h3>æµåˆ†</h3>';
            html += '<p style="font-size: 16px; font-weight: bold; color: #5c4a37; margin: 10px 0;">' + fvF + '</p>';
            if(gLf) html += '<div style="margin: 15px 0;">' + gLf + '</div>';
            if(fdF) html += '<p style="color: #666; margin-top: 10px;">' + fdF + '</p>';
            if(ftF) html += '<p style="color: #888; font-size: 12px; margin-top: 5px;">' + ftF + '</p>';
            html += '</div>';
        }
    }
    
    if(!hasFlowContent) {
        html += '<p style="color: #999; font-style: italic;">æš‚æ— æµè¿æ¨ç®—å†…å®¹</p>';
    }
    
    // 7. 64å¦åˆ†æç³»ç»Ÿå†…å®¹ - ä»outå…ƒç´ è·å–å®Œæ•´å†…å®¹ï¼Œæˆ–ä»é€‰æ‹©æ¡†ç”Ÿæˆ
    html += '<h2>å…­ã€64å¦åˆ†æç³»ç»Ÿ</h2>';
    var hasGuaAnalysis = false;
    
    // é¦–å…ˆå°è¯•ä»outå…ƒç´ è·å–å·²æ˜¾ç¤ºçš„å†…å®¹
    var outElement = document.getElementById('out');
    if(outElement && outElement.innerHTML && outElement.innerHTML.trim() !== '') {
        // åˆ›å»ºä¸€ä¸ªä¸´æ—¶å®¹å™¨æ¥å¤„ç†detailsæ ‡ç­¾
        var tempContainer = document.createElement('div');
        tempContainer.innerHTML = outElement.innerHTML;
        
        // å±•å¼€æ‰€æœ‰detailsæ ‡ç­¾ - ç¡®ä¿æ‰€æœ‰å†…å®¹éƒ½å¯è§
        var detailsElements = tempContainer.querySelectorAll('details');
        var detailsArray = Array.from(detailsElements); // è½¬æ¢ä¸ºæ•°ç»„ï¼Œé¿å…åœ¨éå†æ—¶ä¿®æ”¹DOMå¯¼è‡´çš„é—®é¢˜
        
        detailsArray.forEach(function(details) {
            // åˆ›å»ºä¸€ä¸ªæ–°çš„divæ¥æ›¿æ¢details
            var newDiv = document.createElement('div');
            newDiv.style.cssText = 'margin: 15px 0; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; background: #fafafa;';
            
            // è·å–summaryå†…å®¹
            var summary = details.querySelector('summary');
            if(summary) {
                var h4 = document.createElement('h4');
                h4.style.cssText = 'margin: 0 0 10px 0; color: #5c4a37; font-weight: bold; font-size: 16px;';
                h4.innerHTML = summary.innerHTML;
                newDiv.appendChild(h4);
            }
            
            // è·å–detailså†…çš„æ‰€æœ‰å…¶ä»–å†…å®¹ï¼ˆåŒ…æ‹¬æ‰€æœ‰å­å…ƒç´ ï¼‰
            var contentDiv = document.createElement('div');
            contentDiv.style.cssText = 'margin-top: 10px; padding: 10px; background: white; border-radius: 4px;';
            
            // å¤åˆ¶detailsçš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼ˆé™¤äº†summaryï¼‰
            var childNodes = details.childNodes;
            for(var i = 0; i < childNodes.length; i++) {
                var node = childNodes[i];
                if(node.nodeType === 1 && node.tagName !== 'SUMMARY') { // å…ƒç´ èŠ‚ç‚¹ä¸”ä¸æ˜¯summary
                    contentDiv.appendChild(node.cloneNode(true));
                } else if(node.nodeType === 3) { // æ–‡æœ¬èŠ‚ç‚¹
                    var textNode = document.createTextNode(node.textContent);
                    contentDiv.appendChild(textNode);
                }
            }
            
            newDiv.appendChild(contentDiv);
            
            // æ›¿æ¢details
            if(details.parentNode) {
                details.parentNode.replaceChild(newDiv, details);
            }
        });
        
        // ä¸åœ¨è¿™é‡Œè½¬æ¢å¦å›¾ï¼Œä¿ç•™åŸå§‹HTMLï¼Œåœ¨ä¸‹è½½æ—¶ç»Ÿä¸€è½¬æ¢
        var outContent = tempContainer.innerHTML;
        // æ¸…ç†æ ·å¼ç±»ï¼Œè½¬æ¢ä¸ºå†…è”æ ·å¼
        outContent = outContent.replace(/<div class="card">/g, '<div style="margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9;">');
        outContent = outContent.replace(/<div class="c-head">/g, '<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #ddd;">');
        outContent = outContent.replace(/<span class="c-name">/g, '<span style="font-size: 18px; font-weight: bold; color: #5c4a37;">');
        outContent = outContent.replace(/<span class="c-step">/g, '<span style="font-size: 12px; color: #999; background: #f0f0f0; padding: 2px 8px; border-radius: 4px;">');
        outContent = outContent.replace(/<div class="c-body">/g, '<div style="margin-top: 10px; padding: 10px; background: white; border-radius: 4px;">');
        outContent = outContent.replace(/<div class="res-col">/g, '<div style="margin: 20px 0;">');
        outContent = outContent.replace(/<div class="res-t">/g, '<div style="font-size: 18px; font-weight: bold; color: #5c4a37; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #ddd;">');
        
        html += outContent;
        hasGuaAnalysis = true;
    } else {
        // å¦‚æœoutå…ƒç´ ä¸ºç©ºï¼Œä»é€‰æ‹©æ¡†ç”Ÿæˆå†…å®¹
        for(var step = 1; step <= 5; step++) {
            var selectId = 'in1_' + step;
            var selectEl = document.getElementById(selectId);
            if(selectEl && selectEl.value) {
                var guaId = selectEl.value;
                var guaName = selectEl.options[selectEl.selectedIndex].text;
                var analysisContent = getGuaAnalysisContent(guaId);
                if(analysisContent) {
                    html += '<div style="margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9;">';
                    html += '<h3>ç¬¬' + step + 'æ­¥ï¼š' + guaName + '</h3>';
                    html += analysisContent;
                    html += '</div>';
                    hasGuaAnalysis = true;
                }
            }
        }
    }
    
    if(!hasGuaAnalysis) {
        html += '<p style="color: #999; font-style: italic;">æš‚æ— 64å¦åˆ†æå†…å®¹</p>';
    }
    
    // ç¡®ä¿è‡³å°‘æœ‰æ ‡é¢˜å’ŒåŸºæœ¬ä¿¡æ¯
    if(html.length < 200) {
        console.warn('æ”¶é›†çš„å†…å®¹å¤ªå°‘ï¼Œå¯èƒ½å­˜åœ¨é—®é¢˜');
        // å³ä½¿å†…å®¹å°‘ï¼Œä¹Ÿè¿”å›åŸºæœ¬ç»“æ„ï¼Œé¿å…å®Œå…¨ç©ºç™½
        if(html.length < 100) {
            html += '<p style="color: #999; font-style: italic; text-align: center; margin-top: 50px;">' +
                    'æç¤ºï¼šè¯·å…ˆè¿›è¡Œæ’ç›˜æ“ä½œï¼Œç„¶åå†ä¸‹è½½å‘½ä¾‹æŠ¥å‘Šã€‚</p>';
        }
    }
    
    // é—­åˆHTMLæ–‡æ¡£
    html += '</body></html>';
    
    // è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
    console.log('========== å†…å®¹æ”¶é›†å®Œæˆ ==========');
    console.log('æ”¶é›†åˆ°çš„å†…å®¹æ€»é•¿åº¦:', html.length);
    console.log('å†…å®¹é¢„è§ˆï¼ˆå‰1000å­—ç¬¦ï¼‰:', html.substring(0, 1000));
    console.log('å†…å®¹é¢„è§ˆï¼ˆå1000å­—ç¬¦ï¼‰:', html.substring(Math.max(0, html.length - 1000)));
    
    // æ£€æŸ¥å„éƒ¨åˆ†æ˜¯å¦å­˜åœ¨
    var sections = {
        'åŸºæœ¬ä¿¡æ¯': html.indexOf('ä¸€ã€åŸºæœ¬ä¿¡æ¯') >= 0,
        'å››æŸ±å…«å­—': html.indexOf('äºŒã€å››æŸ±å…«å­—') >= 0,
        'å‘½å¦': html.indexOf('ä¸‰ã€å‘½å¦') >= 0,
        'å¤§è¿æµè½¬': html.indexOf('å››ã€å¤§è¿æµè½¬') >= 0,
        'æµè¿æ¨ç®—': html.indexOf('äº”ã€ä»»æ„æ—¶åˆ»æµè¿æ¨ç®—') >= 0,
        '64å¦åˆ†æ': html.indexOf('å…­ã€64å¦åˆ†æç³»ç»Ÿ') >= 0
    };
    console.log('å„éƒ¨åˆ†å­˜åœ¨æƒ…å†µ:', sections);
    
    // æ£€æŸ¥64å¦åˆ†æå†…å®¹
    if(html.indexOf('å…­ã€64å¦åˆ†æç³»ç»Ÿ') >= 0) {
        var guaCount = (html.match(/ç¬¬\d+æ­¥/g) || []).length;
        console.log('64å¦åˆ†æç³»ç»ŸåŒ…å«çš„å¦æ•°é‡:', guaCount);
        var detailsCount = (html.match(/<h4>/g) || []).length;
        console.log('åŒ…å«çš„è¯¦æƒ…éƒ¨åˆ†æ•°é‡:', detailsCount);
    }
    
    return html;
}

function getGuaAnalysisContent(guaId) {
    // è·å–å¦åˆ†æå†…å®¹ï¼Œéœ€è¦è®¿é—®å…¨å±€çš„DBå˜é‡
    try {
        // å°è¯•ä»å…¨å±€å˜é‡DBè·å–ï¼ˆè¿™æ˜¯64å¦åˆ†æç³»ç»Ÿä½¿ç”¨çš„æ•°æ®æºï¼‰
        var guaData = null;
        if(typeof DB !== 'undefined' && DB[guaId]) {
            guaData = DB[guaId];
        } else if(typeof window !== 'undefined' && window.DB && window.DB[guaId]) {
            guaData = window.DB[guaId];
        }
        
        if(!guaData) {
            console.warn('æœªæ‰¾åˆ°å¦ID ' + guaId + ' çš„æ•°æ®');
            return '';
        }
        
        var html = '';
        // è·å–å¦è±¡å¹¶ç”Ÿæˆå¦å›¾
        try {
            if(guaData.n) {
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:getGuaAnalysisContent',message:'å¼€å§‹ç”Ÿæˆ64å¦å¦å›¾',data:{guaId:guaId,guaName:guaData.n},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'F'})}).catch(()=>{});
                // #endregion
                const yaos = getGuaYaosByName(guaData.n);
                if(yaos) {
                    const yuantang = getDefaultYuantangFor64Gua(yaos);
                    const guaDiagramHtml = renderGuaHtml(yaos, yuantang);
                    // #region agent log
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:getGuaAnalysisContent',message:'64å¦å¦å›¾ç”Ÿæˆç»“æœ',data:{guaId:guaId,hasYaos:!!yaos,hasDiagramHtml:!!guaDiagramHtml,diagramLength:guaDiagramHtml?guaDiagramHtml.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'F'})}).catch(()=>{});
                    // #endregion
                    if(guaDiagramHtml) {
                        html += '<div style="margin: 15px 0;">' + guaDiagramHtml + '</div>';
                    }
                } else {
                    // #region agent log
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:getGuaAnalysisContent',message:'æ— æ³•è·å–å¦çˆ»',data:{guaId:guaId,guaName:guaData.n},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'F'})}).catch(()=>{});
                    // #endregion
                }
            }
        } catch(e) {
            console.warn('ç”Ÿæˆå¦è±¡å¤±è´¥:', e);
            // #region agent log
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:getGuaAnalysisContent',message:'ç”Ÿæˆå¦è±¡å¼‚å¸¸',data:{guaId:guaId,error:e.message},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'F'})}).catch(()=>{});
            // #endregion
        }
        
        if(guaData.t) html += '<h4>1. å¦å›¾è§£æ</h4><div>' + guaData.t + '</div>';
        if(guaData.x) html += '<h4>2. å¦ä¹‰å¦è¾</h4><div>' + guaData.x + '</div>';
        if(guaData.d) html += '<h4>3. åœ°ç†æ–¹ä½å›¾</h4><div>' + guaData.d + '</div>';
        if(guaData.u) html += '<h4>4. åœ°ç†è§£æ</h4><div>' + guaData.u + '</div>';
        if(guaData.h) html += '<h4>5. å…ˆå¤©å¦</h4><div>' + guaData.h + '</div>';
        if(guaData.a) html += '<h4>6. åå¤©å¦</h4><div>' + guaData.a + '</div>';
        if(guaData.b) html += '<h4>7. æµå¹´å¦</h4><div>' + guaData.b + '</div>';
        if(guaData.e) html += '<h4>8. å¦è§£â€”å®˜è¿</h4><div>' + guaData.e + '</div>';
        if(guaData.f) html += '<h4>9. å¦è§£â€”è´¢è¿</h4><div>' + guaData.f + '</div>';
        if(guaData.g) html += '<h4>10. å¦è§£â€”å©šå§»</h4><div>' + guaData.g + '</div>';
        if(guaData.l) html += '<h4>11. å¦è§£â€”è€ƒè¯•</h4><div>' + guaData.l + '</div>';
        if(guaData.m) html += '<h4>12. å¦è§£â€”ç–¾ç—…</h4><div>' + guaData.m + '</div>';
        if(guaData.z) html += '<h4>13. å¦è§£â€”å…¶ä»–</h4><div>' + guaData.z + '</div>';
        
        return html;
    } catch(err) {
        console.error('è·å–å¦åˆ†æå†…å®¹å¤±è´¥:', err);
        return '';
    }
}

// ==================== ç´«è–‡æ–—æ•°ä¸“ç”¨å‘½ä¾‹ç®¡ç†åŠŸèƒ½ ====================

// æ˜¾ç¤ºä¿å­˜å‘½ä¾‹å¯¹è¯æ¡†ï¼ˆç´«è–‡æ–—æ•°ï¼‰
function showMingliDialogZiwei() {
    var dialog = document.createElement('div');
    dialog.id = 'mingliSaveDialogZiwei';
    dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
    
    var content = document.createElement('div');
    content.style.cssText = 'background: #f5f3ef; border: 2px solid #8b6f47; border-radius: 8px; padding: 25px; min-width: 400px; max-width: 500px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative;';
    
    var html = '<div style="margin-bottom: 15px;">';
    html += '<label style="display: block; margin-bottom: 8px; color: #5c4a37; font-weight: bold;">è¯·è¾“å…¥å§“å:</label>';
    var nameEl = document.getElementById('name');
    var nameValue = nameEl ? nameEl.value : '';
    html += '<input type="text" id="mingliNameInputZiwei" style="width: 100%; padding: 8px; border: 1px solid #8b6f47; border-radius: 4px; background: white; font-size: 14px; box-sizing: border-box;" placeholder="è¯·è¾“å…¥å§“å" value="' + (nameValue || '') + '" autofocus>';
    html += '</div>';
    
    html += '<div style="margin-bottom: 20px;">';
    html += '<label style="display: block; margin-bottom: 8px; color: #5c4a37; font-weight: bold;">è¯·é€‰æ‹©åˆ†ç±»:</label>';
    html += '<select id="mingliCategorySelectZiwei" style="width: 100%; padding: 8px; border: 1px solid #8b6f47; border-radius: 4px; background: white; font-size: 14px; box-sizing: border-box;">';
    html += '<option value="è‡ªå·±">è‡ªå·±</option>';
    html += '<option value="æœ‹å‹">æœ‹å‹</option>';
    html += '<option value="å®¶äºº">å®¶äºº</option>';
    html += '<option value="åäºº">åäºº</option>';
    html += '<option value="å®¢æˆ·">å®¢æˆ·</option>';
    html += '<option value="å…¶ä»–">å…¶ä»–</option>';
    html += '</select>';
    html += '</div>';
    
    html += '<div style="display: flex; gap: 10px; justify-content: flex-end;">';
    html += '<button onclick="document.getElementById(\'mingliSaveDialogZiwei\').remove();" style="padding: 8px 20px; background: #d4c4a8; color: #5c4a37; border: 1px solid #8b6f47; border-radius: 4px; cursor: pointer; font-size: 14px;">å–æ¶ˆ</button>';
    html += '<button onclick="saveMingliFromDialogZiwei();" style="padding: 8px 20px; background: #8b6f47; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">ç¡®å®š</button>';
    html += '</div>';
    
    content.innerHTML = html + '<button onclick="document.getElementById(\'mingliSaveDialogZiwei\').remove();" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #8b6f47; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 16px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center;">Ã—</button>';
    
    dialog.appendChild(content);
    document.body.appendChild(dialog);
    
    // ç‚¹å‡»èƒŒæ™¯å…³é—­
    dialog.onclick = function(e) {
        if(e.target === dialog) {
            dialog.remove();
        }
    };
    
    // å›è½¦é”®ä¿å­˜
    var nameInput = document.getElementById('mingliNameInputZiwei');
    if(nameInput) {
        nameInput.onkeypress = function(e) {
            if(e.key === 'Enter') {
                saveMingliFromDialogZiwei();
            }
        };
    }
}

// ä»å¯¹è¯æ¡†ä¿å­˜å‘½ä¾‹ï¼ˆç´«è–‡æ–—æ•°ï¼‰
function saveMingliFromDialogZiwei() {
    var nameInput = document.getElementById('mingliNameInputZiwei');
    var categorySelect = document.getElementById('mingliCategorySelectZiwei');
    
    if(!nameInput || !nameInput.value || nameInput.value.trim() === '') {
        showMingliMessage('å§“åä¸èƒ½ä¸ºç©º');
        return;
    }
    
    // ä»ç´«è–‡æ–—æ•°çš„è¾“å…¥å­—æ®µè·å–æ•°æ®
    var birthDateEl = document.getElementById('birth-date');
    var genderEl = document.getElementById('gender');
    
    if(!birthDateEl || !birthDateEl.value) {
        showMingliMessage('è¯·å…ˆè¾“å…¥å‡ºç”Ÿæ—¥æœŸ');
        return;
    }
    
    // è§£ædatetime-localæ ¼å¼ï¼šYYYY-MM-DDTHH:mm
    var birthDate = new Date(birthDateEl.value);
    if(isNaN(birthDate.getTime())) {
        showMingliMessage('å‡ºç”Ÿæ—¥æœŸæ ¼å¼é”™è¯¯');
        return;
    }
    
    var year = birthDate.getFullYear();
    var month = birthDate.getMonth() + 1;
    var day = birthDate.getDate();
    var hour = birthDate.getHours();
    var minute = birthDate.getMinutes();
    var sex = genderEl ? genderEl.value : '1';
    
    // è·å–ç»åº¦ï¼ˆå¦‚æœæœ‰çš„è¯ï¼Œç´«è–‡æ–—æ•°å¯èƒ½æ²¡æœ‰ç»åº¦è¾“å…¥ï¼Œä½¿ç”¨é»˜è®¤å€¼ï¼‰
    var lonEl = document.getElementById('lon');
    var lon = lonEl ? parseFloat(lonEl.value) : 120.0;
    if(isNaN(lon)) lon = 120.0;
    
    // éªŒè¯æ•°æ®å®Œæ•´æ€§
    if(isNaN(year) || year < 1900 || year > 2100) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´ä»½ï¼ˆ1900-2100ï¼‰');
        return;
    }
    if(isNaN(month) || month < 1 || month > 12) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„æœˆä»½ï¼ˆ1-12ï¼‰');
        return;
    }
    if(isNaN(day) || day < 1 || day > 31) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„æ—¥æœŸï¼ˆ1-31ï¼‰');
        return;
    }
    if(isNaN(hour) || hour < 0 || hour > 23) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„å°æ—¶ï¼ˆ0-23ï¼‰');
        return;
    }
    if(isNaN(minute) || minute < 0 || minute > 59) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„åˆ†é’Ÿï¼ˆ0-59ï¼‰');
        return;
    }
    if(!sex || (sex !== '1' && sex !== '0')) {
        showMingliMessage('è¯·é€‰æ‹©æ€§åˆ«');
        return;
    }
    if(isNaN(lon) || lon < -180 || lon > 180) {
        showMingliMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„ç»åº¦ï¼ˆ-180åˆ°180ï¼‰');
        return;
    }
    
    // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒçš„å‘½ä¾‹
    var existingList = getAllMingli();
    var duplicate = existingList.find(function(item) {
        return item.name === nameInput.value.trim() &&
               item.year === year &&
               item.month === month &&
               item.day === day &&
               item.hour === hour &&
               item.minute === minute;
    });
    
    if(duplicate) {
        var confirmMsg = 'å·²å­˜åœ¨ç›¸åŒçš„å‘½ä¾‹ï¼ˆ' + duplicate.name + 'ï¼‰ï¼Œæ˜¯å¦ä»è¦ä¿å­˜ï¼Ÿ';
        if(!confirm(confirmMsg)) {
            return;
        }
    }
    
    var mingli = {
        name: nameInput.value.trim(),
        year: year,
        month: month,
        day: day,
        hour: hour,
        minute: minute,
        sex: sex,
        lon: lon,
        category: categorySelect ? categorySelect.value : 'å…¶ä»–',
        type: 'ziwei' // æ ‡è®°ä¸ºç´«è–‡æ–—æ•°ç±»å‹
    };
    
    try {
        var id = addMingli(mingli);
        document.getElementById('mingliSaveDialogZiwei').remove();
        showMingliMessage('å‘½ä¾‹å·²ä¿å­˜ï¼ID: ' + id);
    } catch(err) {
        showMingliMessage('ä¿å­˜å¤±è´¥: ' + err.message);
    }
}

// åŠ è½½å‘½ä¾‹åˆ°ç´«è–‡æ–—æ•°é¡µé¢
function loadMingliZiwei(id) {
    // #region agent log
    fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:loadMingliZiwei',message:'å‡½æ•°å¼€å§‹æ‰§è¡Œ',data:{id:id},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
    // #endregion
    
    var list = getAllMingli();
    var mingli = list.find(function(item) { return item.id === id; });
    if(!mingli) {
        showMingliMessage('å‘½ä¾‹ä¸å­˜åœ¨');
        return;
    }
    
    // #region agent log
    fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:loadMingliZiwei',message:'æ‰¾åˆ°å‘½ä¾‹æ•°æ®',data:{name:mingli.name,year:mingli.year,month:mingli.month,day:mingli.day,hour:mingli.hour,minute:mingli.minute},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
    // #endregion
    
    // åŠ è½½æ•°æ®åˆ°ç´«è–‡æ–—æ•°è¡¨å•
    var nameEl = document.getElementById('name');
    var genderEl = document.getElementById('gender');
    var birthDateEl = document.getElementById('birth-date');
    
    // #region agent log
    fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:loadMingliZiwei',message:'æ£€æŸ¥è¡¨å•å…ƒç´ ',data:{hasNameEl:!!nameEl,hasGenderEl:!!genderEl,hasBirthDateEl:!!birthDateEl},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
    // #endregion
    
    if(nameEl) nameEl.value = mingli.name || '';
    if(genderEl) genderEl.value = mingli.sex || '1';
    
    // å°†å¹´æœˆæ—¥æ—¶åˆ†è½¬æ¢ä¸ºdatetime-localæ ¼å¼ï¼šYYYY-MM-DDTHH:mm
    var dateValue = null;
    if(birthDateEl) {
        var year = mingli.year || 2000;
        var month = String(mingli.month || 1).padStart(2, '0');
        var day = String(mingli.day || 1).padStart(2, '0');
        var hour = String(mingli.hour || 0).padStart(2, '0');
        var minute = String(mingli.minute || 0).padStart(2, '0');
        dateValue = year + '-' + month + '-' + day + 'T' + hour + ':' + minute;
        birthDateEl.value = dateValue;
        
        // #region agent log
        fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:loadMingliZiwei',message:'è®¾ç½®æ—¥æœŸå€¼',data:{dateValue:dateValue,actualValue:birthDateEl.value},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
        // #endregion
    }
    
    // å¦‚æœæœ‰ç»åº¦å­—æ®µï¼Œä¹ŸåŠ è½½
    var lonEl = document.getElementById('lon');
    if(lonEl) lonEl.value = mingli.lon || 120.0;
    
    showMingliMessage('å·²åŠ è½½å‘½ä¾‹: ' + mingli.name);
    
    // è‡ªåŠ¨è§¦å‘æ’ç›˜
    setTimeout(function() {
        // #region agent log
        fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:loadMingliZiwei',message:'setTimeoutå›è°ƒæ‰§è¡Œ',data:{typeofZW:typeof ZW,hasZWCalc:typeof ZW !== 'undefined' && typeof ZW.calc === 'function',typeofSolar:typeof Solar,typeofLunar:typeof Lunar},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'E'})}).catch(()=>{});
        // #endregion
        
        if(typeof ZW !== 'undefined' && typeof ZW.calc === 'function') {
            try {
                // #region agent log
                fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:loadMingliZiwei',message:'å‡†å¤‡è°ƒç”¨ZW.calc',data:{birthDateValue:birthDateEl ? birthDateEl.value : null,genderValue:genderEl ? genderEl.value : null},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'F'})}).catch(()=>{});
                // #endregion
                
                ZW.calc();
                
                // #region agent log
                fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:loadMingliZiwei',message:'ZW.calcè°ƒç”¨æˆåŠŸ',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'G'})}).catch(()=>{});
                // #endregion
                
                showMingliMessage('å‘½ä¾‹å·²åŠ è½½å¹¶è‡ªåŠ¨æ’ç›˜: ' + mingli.name);
            } catch(err) {
                console.error('è‡ªåŠ¨æ’ç›˜å¤±è´¥:', err);
                
                // #region agent log
                fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:loadMingliZiwei',message:'ZW.calcè°ƒç”¨å¤±è´¥',data:{error:err.message,errorStack:err.stack,errorName:err.name},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'H'})}).catch(()=>{});
                // #endregion
                
                showMingliMessage('å‘½ä¾‹å·²åŠ è½½ï¼Œä½†è‡ªåŠ¨æ’ç›˜å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨åˆ·æ–°æ’ç›˜');
            }
        } else {
            // #region agent log
            fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:loadMingliZiwei',message:'ZWæˆ–ZW.calcæœªå®šä¹‰',data:{typeofZW:typeof ZW,hasZWCalc:typeof ZW !== 'undefined' && typeof ZW.calc === 'function'},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'I'})}).catch(()=>{});
            // #endregion
            
            showMingliMessage('å‘½ä¾‹å·²åŠ è½½ï¼Œè¯·æ‰‹åŠ¨åˆ·æ–°æ’ç›˜');
        }
    }, 300);
}

// ä¸‹è½½å‘½ä¾‹ï¼ˆç´«è–‡æ–—æ•°ï¼‰
function downloadMingliZiwei() {
    try {
        // æ£€æŸ¥æ˜¯å¦æœ‰æ’ç›˜ç»“æœï¼ˆæ£€æŸ¥grid-boxæ˜¯å¦æœ‰å†…å®¹ï¼‰
        var gridBox = document.getElementById('grid-box');
        var hasResult = gridBox && gridBox.innerHTML && gridBox.innerHTML.trim() !== '';
        
        if(!hasResult) {
            showMingliMessage('æ²¡æœ‰æ’ç›˜ç»“æœï¼Œè¯·å…ˆè¿›è¡Œæ’ç›˜æ“ä½œ');
            return;
        }
        
        // æ˜¾ç¤ºæ ¼å¼é€‰æ‹©å¯¹è¯æ¡†
        var dialog = document.createElement('div');
        dialog.id = 'downloadFormatDialogZiwei';
        dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10002; display: flex; align-items: center; justify-content: center;';
        
        var content = document.createElement('div');
        content.style.cssText = 'background: #f5f3ef; border: 2px solid #8b6f47; border-radius: 8px; padding: 25px; min-width: 400px; max-width: 500px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative;';
        
        var closeDialog = function() {
            var d = document.getElementById('downloadFormatDialogZiwei');
            if(d) d.remove();
        };
        
        var startDownload = function() {
            closeDialog();
            try {
                downloadAsWordZiwei();
            } catch(err) {
                console.error('ä¸‹è½½å¤±è´¥:', err);
                showMingliMessage('ä¸‹è½½å¤±è´¥: ' + err.message);
            }
        };
        
        // è·å–å½“å‰å‘½ä¾‹ä¿¡æ¯ç”¨äºæ–‡ä»¶å‘½å
        var nameEl = document.getElementById('name');
        var name = nameEl ? nameEl.value : '';
        
        content.innerHTML = '<div style="color: #5c4a37; font-size: 16px; margin-bottom: 20px; text-align: center;">è¯·é€‰æ‹©ä¸‹è½½æ ¼å¼</div>' +
            '<div style="color: #666; font-size: 12px; margin-bottom: 15px; text-align: center;">' + (name ? 'å‘½ä¾‹ï¼š' + name : '') + '</div>' +
            '<div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 20px;">' +
            '<button id="downloadWordBtnZiwei" style="padding: 10px 25px; background: #8b6f47; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold; transition: background 0.2s;" onmouseover="this.style.background=\'#6b5437\';" onmouseout="this.style.background=\'#8b6f47\';">ä¸‹è½½Wordæ–‡æ¡£</button>' +
            '</div>' +
            '<button id="downloadCloseBtnZiwei" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #8b6f47; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 18px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center; transition: color 0.2s;" onmouseover="this.style.color=\'#5c4a37\';" onmouseout="this.style.color=\'#8b6f47\';">Ã—</button>';
        
        dialog.appendChild(content);
        document.body.appendChild(dialog);
        
        // ç»‘å®šæŒ‰é’®äº‹ä»¶
        var wordBtn = content.querySelector('#downloadWordBtnZiwei');
        var closeBtn = content.querySelector('#downloadCloseBtnZiwei');
        
        if(wordBtn) wordBtn.onclick = startDownload;
        if(closeBtn) closeBtn.onclick = closeDialog;
        
        dialog.onclick = function(e) {
            if(e.target === dialog) {
                closeDialog();
            }
        };
        
        // ESCé”®å…³é—­
        var escHandler = function(e) {
            if(e.key === 'Escape') {
                closeDialog();
                document.removeEventListener('keydown', escHandler);
            }
        };
        document.addEventListener('keydown', escHandler);
    } catch(err) {
        console.error('ç”Ÿæˆä¸‹è½½å¯¹è¯æ¡†å¤±è´¥:', err);
        showMingliMessage('æ“ä½œå¤±è´¥: ' + err.message);
    }
}

// ä¸‹è½½Wordæ–‡æ¡£ï¼ˆç´«è–‡æ–—æ•°ï¼‰
function downloadAsWordZiwei() {
    try {
        showMingliMessage('æ­£åœ¨ç”ŸæˆWordæ–‡æ¡£ï¼Œè¯·ç¨å€™...');
        
        // æ£€æŸ¥html2canvasæ˜¯å¦å¯ç”¨
        if(typeof html2canvas === 'undefined') {
            showMingliMessage('æˆªå›¾åŠŸèƒ½éœ€è¦html2canvasåº“ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            return;
        }
        
        // æ”¶é›†ç´«è–‡æ–—æ•°é¡µé¢å†…å®¹
        var ziweiSection = document.getElementById('ziwei');
        if(!ziweiSection) {
            showMingliMessage('æœªæ‰¾åˆ°ç´«è–‡æ–—æ•°é¡µé¢å†…å®¹');
            return;
        }
        
        var gridBox = document.getElementById('grid-box');
        if(!gridBox) {
            showMingliMessage('æœªæ‰¾åˆ°å‘½ç›˜åŒºåŸŸ');
            return;
        }
        
        // æ£€æŸ¥æµè¿æ˜¯å¦å˜åŠ¨
        var selYr = document.getElementById('sel-yr');
        var selDa = document.getElementById('sel-da');
        var selMo = document.getElementById('sel-mo');
        var selDy = document.getElementById('sel-dy');
        var selHr = document.getElementById('sel-hr');
        
        // è·å–å½“å‰æµè¿å€¼
        var currentYr = selYr ? selYr.value : '';
        var currentDa = selDa ? selDa.value : '';
        var currentMo = selMo ? selMo.value : '';
        var currentDy = selDy ? selDy.value : '';
        var currentHr = selHr ? selHr.value : '';
        
        // è·å–å‡ºç”Ÿå¹´ä»½ï¼Œåˆ¤æ–­æµå¹´æ˜¯å¦å˜åŠ¨ï¼ˆå¦‚æœæµå¹´ä¸æ˜¯å‡ºç”Ÿå¹´ä»½ï¼Œè¯´æ˜æµè¿å˜åŠ¨äº†ï¼‰
        var birthDateEl = document.getElementById('birth-date');
        var birthYear = null;
        if(birthDateEl && birthDateEl.value) {
            birthYear = new Date(birthDateEl.value).getFullYear();
        }
        
        // åˆ¤æ–­æµè¿æ˜¯å¦å˜åŠ¨ï¼šå¦‚æœæµå¹´ä¸æ˜¯å‡ºç”Ÿå¹´ä»½ï¼Œæˆ–è€…å¤§é™/æœˆ/æ—¥/æ—¶æœ‰å€¼ï¼Œè¯´æ˜æµè¿å˜åŠ¨äº†
        var hasFlowChanged = false;
        var flowInfo = '';
        var flowParts = [];
        
        // æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•æµè¿å˜åŠ¨
        if((currentYr && currentYr !== '' && currentYr !== String(birthYear)) || 
           (currentDa && currentDa !== '') || 
           (currentMo && currentMo !== '') || 
           (currentDy && currentDy !== '') || 
           (currentHr && currentHr !== '')) {
            hasFlowChanged = true;
            
            // å§‹ç»ˆåŒ…å«å¤§é™å’Œæµå¹´ï¼ˆå¦‚æœæœ‰å€¼ï¼‰
            if(currentDa && currentDa !== '') {
                flowParts.push('å¤§é™ï¼š' + currentDa);
            }
            if(currentYr && currentYr !== '') {
                flowParts.push('æµå¹´ï¼š' + currentYr + 'å¹´');
            }
            if(currentMo && currentMo !== '') {
                flowParts.push('æµæœˆï¼š' + currentMo + 'æœˆ');
            }
            if(currentDy && currentDy !== '') {
                flowParts.push('æµæ—¥ï¼š' + currentDy + 'æ—¥');
            }
            if(currentHr && currentHr !== '') {
                flowParts.push('æµæ—¶ï¼š' + currentHr);
            }
            
            // ç»„åˆæµè¿ä¿¡æ¯
            flowInfo = flowParts.join('ï¼Œ');
        }
        
        // æˆªå›¾å‡½æ•°
        var captureChart = function(element, options) {
            return new Promise(function(resolve, reject) {
                html2canvas(element, {
                    backgroundColor: '#ffffff',
                    scale: 1.5,  // é™ä½åˆ†è¾¨ç‡ï¼Œå‡å°å›¾ç‰‡å¤§å°
                    logging: false,
                    useCORS: true,
                    allowTaint: false,
                    width: element.offsetWidth,
                    height: element.offsetHeight,
                    windowWidth: element.offsetWidth,
                    windowHeight: element.offsetHeight
                }).then(function(canvas) {
                    // å¦‚æœå›¾ç‰‡å¤ªå¤§ï¼Œå¯ä»¥å‹ç¼©
                    var imgData = canvas.toDataURL('image/png', 0.9);
                    resolve(imgData);
                }).catch(function(err) {
                    reject(err);
                });
            });
        };
        
        // å¼€å§‹ç”Ÿæˆæ–‡æ¡£
        var generateDocument = function() {
            if(hasFlowChanged) {
                // æµè¿å·²å˜åŠ¨ï¼Œéœ€è¦ä¸¤å¼ æˆªå›¾ï¼šæœ¬å‘½ç›˜å’Œæµè¿ç›˜
                // å…ˆä¿å­˜å½“å‰æµè¿å€¼
                var savedYr = currentYr;
                var savedDa = currentDa;
                var savedMo = currentMo;
                var savedDy = currentDy;
                var savedHr = currentHr;
                
                // å…ˆæˆªå›¾å½“å‰æµè¿ç›˜
                captureChart(gridBox).then(function(flowImage) {
                    // æ¢å¤æœ¬å‘½ç›˜çŠ¶æ€ï¼ˆå°†æµå¹´è®¾ç½®ä¸ºå‡ºç”Ÿå¹´ä»½ï¼Œæ¸…ç©ºå…¶ä»–æµè¿ï¼‰
                    if(selYr && birthYear) {
                        selYr.value = birthYear;
                        if(typeof ZW !== 'undefined' && typeof ZW.updateFlow === 'function') {
                            ZW.updateFlow('yr');
                        }
                    }
                    if(selDa) selDa.value = '';
                    if(selMo) selMo.value = '';
                    if(selDy) selDy.value = '';
                    if(selHr) selHr.value = '';
                    
                    // ç­‰å¾…æœ¬å‘½ç›˜æ›´æ–°
                    setTimeout(function() {
                        // æˆªå›¾æœ¬å‘½ç›˜
                        captureChart(gridBox).then(function(benmingImage) {
                            // æ¢å¤æµè¿çŠ¶æ€
                            if(selYr && savedYr) selYr.value = savedYr;
                            if(selDa && savedDa) selDa.value = savedDa;
                            if(selMo && savedMo) selMo.value = savedMo;
                            if(selDy && savedDy) selDy.value = savedDy;
                            if(selHr && savedHr) selHr.value = savedHr;
                            
                            // æ¢å¤æµè¿æ˜¾ç¤º
                            if(typeof ZW !== 'undefined' && typeof ZW.updateFlow === 'function') {
                                if(savedYr) ZW.updateFlow('yr');
                                else if(savedDa) ZW.updateFlow('da');
                                else if(savedMo) ZW.updateFlow('mo');
                                else if(savedDy) ZW.updateFlow('dy');
                                else if(savedHr) ZW.updateFlow('hr');
                            }
                            
                            // ç”Ÿæˆæ–‡æ¡£
                            createWordDocument(benmingImage, flowImage, flowInfo);
                        }).catch(function(err) {
                            console.error('æœ¬å‘½ç›˜æˆªå›¾å¤±è´¥:', err);
                            // æ¢å¤æµè¿çŠ¶æ€
                            if(selYr && savedYr) selYr.value = savedYr;
                            if(selDa && savedDa) selDa.value = savedDa;
                            if(selMo && savedMo) selMo.value = savedMo;
                            if(selDy && savedDy) selDy.value = savedDy;
                            if(selHr && savedHr) selHr.value = savedHr;
                            if(typeof ZW !== 'undefined' && typeof ZW.updateFlow === 'function') {
                                if(savedYr) ZW.updateFlow('yr');
                            }
                            // å³ä½¿æœ¬å‘½ç›˜æˆªå›¾å¤±è´¥ï¼Œä¹Ÿç”Ÿæˆæ–‡æ¡£ï¼ˆåªåŒ…å«æµè¿ç›˜ï¼‰
                            createWordDocument(null, flowImage, flowInfo);
                        });
                    }, 800);
                }).catch(function(err) {
                    console.error('æµè¿ç›˜æˆªå›¾å¤±è´¥:', err);
                    showMingliMessage('æµè¿ç›˜æˆªå›¾å¤±è´¥: ' + err.message);
                });
            } else {
                // æ²¡æœ‰æµè¿å˜åŠ¨ï¼Œåªæˆªå›¾æœ¬å‘½ç›˜
                captureChart(gridBox).then(function(benmingImage) {
                    createWordDocument(benmingImage, null, null);
                }).catch(function(err) {
                    console.error('æœ¬å‘½ç›˜æˆªå›¾å¤±è´¥:', err);
                    showMingliMessage('æˆªå›¾å¤±è´¥: ' + err.message);
                });
            }
        };
        
        // åˆ›å»ºWordæ–‡æ¡£
        var createWordDocument = function(benmingImage, flowImage, flowInfoText) {
            // åˆ›å»ºWordæ–‡æ¡£HTML
            var htmlContent = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>ç´«è–‡æ–—æ•°å‘½ä¾‹åˆ†æ</title>' +
                '<style>body { font-family: "Microsoft YaHei", sans-serif; font-size: 16pt; line-height: 1.8; color: #333; padding: 30px; position: relative; }' +
                'h1 { font-size: 28pt; color: #5c4a37; margin-bottom: 20px; }' +
                'h2 { font-size: 22pt; color: #5c4a37; margin-top: 30px; margin-bottom: 15px; }' +
                'h3 { font-size: 18pt; color: #5c4a37; }' +
                'p { font-size: 16pt; margin: 10px 0; }' +
                'table { border-collapse: collapse; width: 100%; margin: 15px 0; font-size: 16pt; }' +
                'td, th { border: 2px solid #ddd; padding: 12px; text-align: center; font-size: 16pt; }' +
                'th { background-color: #f5f3ef; font-weight: bold; font-size: 17pt; }' +
                '.gua-box { margin: 15px 0; }' +
                'img { max-width: 75%; height: auto; display: block; margin: 20px auto; page-break-inside: avoid; }' +
                '.chart-image { margin: 30px 0; text-align: center; }' +
                '.chart-title { font-size: 20pt; font-weight: bold; color: #5c4a37; margin: 15px 0; text-align: center; }' +
                '.center-info { font-size: 15pt; line-height: 1.8; }' +
                '.center-info div { margin: 8px 0; }' +
                '.center-info span { font-size: 15pt; }' +
                '/* Wordæ–‡æ¡£æ°´å° */' +
                'body::before { content: "é’å²›è‘£å¾·é¾™è€å¸ˆ 15166397157"; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); font-size: 72px; color: rgba(139, 69, 19, 0.15); z-index: 9999; pointer-events: none; white-space: nowrap; font-weight: bold; letter-spacing: 12px; }' +
                '</style></head><body>';
            
            // æ·»åŠ æ ‡é¢˜
            var now = new Date();
            var dateStr = now.getFullYear() + 'å¹´' + (now.getMonth() + 1) + 'æœˆ' + now.getDate() + 'æ—¥ ' +
                          now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
            htmlContent += '<h1 style="text-align: center; color: #5c4a37; margin-bottom: 30px;">ç´«è–‡æ–—æ•°å‘½ä¾‹åˆ†ææŠ¥å‘Š</h1>';
            htmlContent += '<p style="text-align: center; color: #666; margin-bottom: 30px; font-size: 16pt;">ç”Ÿæˆæ—¶é—´ï¼š' + dateStr + '</p>';
            
            // æ·»åŠ åŸºæœ¬ä¿¡æ¯
            var nameEl = document.getElementById('name');
            var genderEl = document.getElementById('gender');
            var birthDateEl = document.getElementById('birth-date');
            
            htmlContent += '<h2>ä¸€ã€åŸºæœ¬ä¿¡æ¯</h2>';
            htmlContent += '<table><tr><th>é¡¹ç›®</th><th>å†…å®¹</th></tr>';
            if(nameEl && nameEl.value) {
                htmlContent += '<tr><td>å§“å</td><td>' + nameEl.value + '</td></tr>';
            }
            if(genderEl) {
                htmlContent += '<tr><td>æ€§åˆ«</td><td>' + (genderEl.value === '1' ? 'ç”·' : 'å¥³') + '</td></tr>';
            }
            if(birthDateEl && birthDateEl.value) {
                var birthDate = new Date(birthDateEl.value);
                htmlContent += '<tr><td>å‡ºç”Ÿæ—¥æœŸ</td><td>' + birthDate.getFullYear() + 'å¹´' + (birthDate.getMonth() + 1) + 'æœˆ' + birthDate.getDate() + 'æ—¥ ' + 
                              birthDate.getHours() + 'æ—¶' + birthDate.getMinutes() + 'åˆ†</td></tr>';
            }
            htmlContent += '</table>';
            
            // æ·»åŠ å‘½ç›˜ä¿¡æ¯ï¼ˆåŒ…å«æˆªå›¾ï¼‰
            htmlContent += '<h2>äºŒã€å‘½ç›˜ä¿¡æ¯</h2>';
            
            // æ·»åŠ ä¸­å®«ä¿¡æ¯
            var centerZone = ziweiSection.querySelector('.center-zone');
            if(centerZone) {
                htmlContent += '<div class="center-info" style="margin: 20px 0; padding: 20px; background: #f9f9f9; border: 2px solid #ddd; border-radius: 4px; font-size: 15pt;">';
                htmlContent += centerZone.innerHTML;
                htmlContent += '</div>';
            }
            
            // æ·»åŠ æœ¬å‘½ç›˜æˆªå›¾
            htmlContent += '<div class="chart-image">';
            htmlContent += '<div class="chart-title">æœ¬å‘½ç›˜</div>';
            htmlContent += '<img src="' + benmingImage + '" alt="æœ¬å‘½ç›˜" style="max-width: 75%; height: auto;" />';
            htmlContent += '</div>';
            
            // å¦‚æœæµè¿å˜åŠ¨ï¼Œæ·»åŠ æµè¿ä¿¡æ¯å’Œæµè¿ç›˜æˆªå›¾
            if(hasFlowChanged && flowImage) {
                htmlContent += '<h2>ä¸‰ã€æµè¿ä¿¡æ¯</h2>';
                if(flowInfoText) {
                    htmlContent += '<p style="font-size: 17pt; color: #666; margin: 15px 0; font-weight: bold;"><strong>æµè¿æ—¶é—´ï¼š</strong>' + flowInfoText + '</p>';
                }
                
                htmlContent += '<div class="chart-image">';
                htmlContent += '<div class="chart-title">æµè¿ç›˜</div>';
                htmlContent += '<img src="' + flowImage + '" alt="æµè¿ç›˜" style="max-width: 75%; height: auto;" />';
                htmlContent += '</div>';
            }
            
            htmlContent += '</body></html>';
            
            // åˆ›å»ºBlobå¹¶ä¸‹è½½
            var blob = new Blob(['\ufeff', htmlContent], { type: 'application/msword' });
            var url = URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            var name = nameEl && nameEl.value ? nameEl.value : 'å‘½ä¾‹';
            var fileName = 'ç´«è–‡æ–—æ•°_' + name + '_' + new Date().toISOString().slice(0, 10) + '.doc';
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showMingliMessage('Wordæ–‡æ¡£ä¸‹è½½å®Œæˆï¼');
        };
        
        // å¼€å§‹ç”Ÿæˆ
        generateDocument();
        
    } catch(err) {
        console.error('Wordæ–‡æ¡£ç”Ÿæˆå¤±è´¥:', err);
        showMingliMessage('Wordæ–‡æ¡£ç”Ÿæˆå¤±è´¥: ' + err.message);
    }
}


// ==================== å‘½ä¾‹ç®¡ç†åŠŸèƒ½ç»“æŸ ====================

var GAN_VAL = {'ç”²':6,'ä¹™':2,'ä¸™':8,'ä¸':7,'æˆŠ':1,'å·±':9,'åºš':3,'è¾›':4,'å£¬':6,'ç™¸':2};
var ZHI_VAL = {'å­':[1,6],'ä¸‘':[5,10],'å¯…':[3,8],'å¯':[3,8],'è¾°':[5,10],'å·³':[2,7],'åˆ':[2,7],'æœª':[5,10],'ç”³':[4,9],'é…‰':[4,9],'æˆŒ':[5,10],'äº¥':[1,6]};
var GUA_BITS = {'ä¹¾':[1,1,1],'å…‘':[1,1,0],'ç¦»':[1,0,1],'éœ‡':[1,0,0],'å·½':[0,1,1],'å':[0,1,0],'è‰®':[0,0,1],'å¤':[0,0,0]};
var GUA_MAP = {1:'å',2:'å¤',3:'éœ‡',4:'å·½',5:'è‰®',6:'ä¹¾',7:'å…‘',8:'è‰®',9:'ç¦»'};
var GUA_NAMES = {'ä¹¾ä¹¾':'ä¹¾ä¸ºå¤©','ä¹¾å…‘':'å¤©æ³½å±¥','ä¹¾ç¦»':'å¤©ç«åŒäºº','ä¹¾éœ‡':'å¤©é›·æ— å¦„','ä¹¾å·½':'å¤©é£å§¤','ä¹¾å':'å¤©æ°´è®¼','ä¹¾è‰®':'å¤©å±±é¯','ä¹¾å¤':'å¤©åœ°å¦','å…‘ä¹¾':'æ³½å¤©å¤¬','å…‘å…‘':'å…‘ä¸ºæ³½','å…‘ç¦»':'æ³½ç«é©','å…‘éœ‡':'æ³½é›·éš','å…‘å·½':'æ³½é£å¤§è¿‡','å…‘å':'æ³½æ°´å›°','å…‘è‰®':'æ³½å±±å’¸','å…‘å¤':'æ³½åœ°èƒ','ç¦»ä¹¾':'ç«å¤©å¤§æœ‰','ç¦»å…‘':'ç«æ³½ç½','ç¦»ç¦»':'ç¦»ä¸ºç«','ç¦»éœ‡':'ç«é›·å™¬å—‘','ç¦»å·½':'ç«é£é¼','ç¦»å':'ç«æ°´æœªæµ','ç¦»è‰®':'ç«å±±æ—…','ç¦»å¤':'ç«åœ°æ™‹','éœ‡ä¹¾':'é›·å¤©å¤§å£®','éœ‡å…‘':'é›·æ³½å½’å¦¹','éœ‡ç¦»':'é›·ç«ä¸°','éœ‡éœ‡':'éœ‡ä¸ºé›·','éœ‡å·½':'é›·é£æ’','éœ‡å':'é›·æ°´è§£','éœ‡è‰®':'é›·å±±å°è¿‡','éœ‡å¤':'é›·åœ°è±«','å·½ä¹¾':'é£å¤©å°ç•œ','å·½å…‘':'é£æ³½ä¸­å­š','å·½ç¦»':'é£ç«å®¶äºº','å·½éœ‡':'é£é›·ç›Š','å·½å·½':'å·½ä¸ºé£','å·½å':'é£æ°´æ¶£','å·½è‰®':'é£å±±æ¸','å·½å¤':'é£åœ°è§‚','åä¹¾':'æ°´å¤©éœ€','åå…‘':'æ°´æ³½èŠ‚','åç¦»':'æ°´ç«æ—¢æµ','åéœ‡':'æ°´é›·å±¯','åå·½':'æ°´é£äº•','åå':'åä¸ºæ°´','åè‰®':'æ°´å±±è¹‡','åå¤':'æ°´åœ°æ¯”','è‰®ä¹¾':'å±±å¤©å¤§ç•œ','è‰®å…‘':'å±±æ³½æŸ','è‰®ç¦»':'å±±ç«è´²','è‰®éœ‡':'å±±é›·é¢','è‰®å·½':'å±±é£è›Š','è‰®å':'å±±æ°´è’™','è‰®è‰®':'è‰®ä¸ºå±±','è‰®å¤':'å±±åœ°å‰¥','å¤ä¹¾':'åœ°å¤©æ³°','å¤å…‘':'åœ°æ³½ä¸´','å¤ç¦»':'åœ°ç«æ˜å¤·','å¤éœ‡':'åœ°é›·å¤','å¤å·½':'åœ°é£å‡','å¤å':'åœ°æ°´å¸ˆ','å¤è‰®':'åœ°å±±è°¦','å¤å¤':'å¤ä¸ºåœ°'};
var JIEQI_MONTH_MAP = {'ç«‹æ˜¥':1,'æƒŠè›°':2,'æ¸…æ˜':3,'ç«‹å¤':4,'èŠ’ç§':5,'å°æš‘':6,'ç«‹ç§‹':7,'ç™½éœ²':8,'å¯’éœ²':9,'ç«‹å†¬':10,'å¤§é›ª':11,'å°å¯’':12};
var YANG_ZHI = ['å­','å¯…','è¾°','åˆ','ç”³','æˆŒ'];
var YIN_ZHI = ['ä¸‘','å¯','å·³','æœª','é…‰','äº¥'];
var ALL_ZHI = ['å­','ä¸‘','å¯…','å¯','è¾°','å·³','åˆ','æœª','ç”³','é…‰','æˆŒ','äº¥'];
var YAO_NAMES = ['åˆ','äºŒ','ä¸‰','å››','äº”','ä¸Š'];
var GAN_NAMES = ['ç”²','ä¹™','ä¸™','ä¸','æˆŠ','å·±','åºš','è¾›','å£¬','ç™¸'];

// ==================== æ—¶æŸ±è®¡ç®—éªŒè¯å’Œçº é”™æœºåˆ¶ ====================
// ä½¿ç”¨"äº”é¼ é"è§„åˆ™è®¡ç®—æ—¶æŸ±å¤©å¹²
function calculateTimeGanByWuShuDun(dayGan, timeZhi) {
    // äº”é¼ éå£è¯€ï¼š
    // ç”²å·±è¿˜ç”Ÿç”²ï¼ˆç”²æ—¥ã€å·±æ—¥å­æ—¶ä¸ºç”²å­ï¼‰
    // ä¹™åºšä¸™ä½œåˆï¼ˆä¹™æ—¥ã€åºšæ—¥å­æ—¶ä¸ºä¸™å­ï¼‰
    // ä¸™è¾›ä»æˆŠèµ·ï¼ˆä¸™æ—¥ã€è¾›æ—¥å­æ—¶ä¸ºæˆŠå­ï¼‰
    // ä¸å£¬åºšå­å±…ï¼ˆä¸æ—¥ã€å£¬æ—¥å­æ—¶ä¸ºåºšå­ï¼‰
    // æˆŠç™¸ä½•æ–¹å‘ï¼Œå£¬å­æ˜¯çœŸé€”ï¼ˆæˆŠæ—¥ã€ç™¸æ—¥å­æ—¶ä¸ºå£¬å­ï¼‰
    
    var ziGanMap = {
        'ç”²': 0,  // ç”²æ—¥å­æ—¶ä¸ºç”²å­ï¼ˆç´¢å¼•0ï¼‰
        'å·±': 0,  // å·±æ—¥å­æ—¶ä¸ºç”²å­ï¼ˆç´¢å¼•0ï¼‰
        'ä¹™': 2,  // ä¹™æ—¥å­æ—¶ä¸ºä¸™å­ï¼ˆç´¢å¼•2ï¼‰
        'åºš': 2,  // åºšæ—¥å­æ—¶ä¸ºä¸™å­ï¼ˆç´¢å¼•2ï¼‰
        'ä¸™': 4,  // ä¸™æ—¥å­æ—¶ä¸ºæˆŠå­ï¼ˆç´¢å¼•4ï¼‰
        'è¾›': 4,  // è¾›æ—¥å­æ—¶ä¸ºæˆŠå­ï¼ˆç´¢å¼•4ï¼‰
        'ä¸': 6,  // ä¸æ—¥å­æ—¶ä¸ºåºšå­ï¼ˆç´¢å¼•6ï¼‰
        'å£¬': 6,  // å£¬æ—¥å­æ—¶ä¸ºåºšå­ï¼ˆç´¢å¼•6ï¼‰
        'æˆŠ': 8,  // æˆŠæ—¥å­æ—¶ä¸ºå£¬å­ï¼ˆç´¢å¼•8ï¼‰
        'ç™¸': 8   // ç™¸æ—¥å­æ—¶ä¸ºå£¬å­ï¼ˆç´¢å¼•8ï¼‰
    };
    
    var ziGanIndex = ziGanMap[dayGan];
    if(ziGanIndex === undefined) {
        console.warn('æ— æ³•æ ¹æ®æ—¥å¹²è®¡ç®—æ—¶å¹²ï¼Œæ—¥å¹²ï¼š', dayGan);
        return null;
    }
    
    // è·å–æ—¶è¾°åœ¨åœ°æ”¯ä¸­çš„ç´¢å¼•
    var zhiIndex = ALL_ZHI.indexOf(timeZhi);
    if(zhiIndex === -1) {
        console.warn('æ— æ•ˆçš„æ—¶è¾°åœ°æ”¯ï¼š', timeZhi);
        return null;
    }
    
    // ä»å­æ—¶å¼€å§‹ï¼Œæ¯è¿‡ä¸€ä¸ªæ—¶è¾°ï¼Œå¤©å¹²ç´¢å¼•+1
    var ganIndex = (ziGanIndex + zhiIndex) % 10;
    return GAN_NAMES[ganIndex];
}

// éªŒè¯å’Œçº é”™æ—¶æŸ±å¤©å¹²
function verifyAndCorrectTimeGan(dayGan, timeGan, timeZhi) {
    // è®¡ç®—æ­£ç¡®çš„æ—¶æŸ±å¤©å¹²
    var correctTimeGan = calculateTimeGanByWuShuDun(dayGan, timeZhi);
    
    // å¦‚æœè®¡ç®—ç»“æœä¸åº“ç»“æœä¸ä¸€è‡´ï¼Œä½¿ç”¨æ­£ç¡®ç»“æœ
    if(correctTimeGan && correctTimeGan !== timeGan) {
        console.warn('æ—¶æŸ±å¤©å¹²è®¡ç®—é”™è¯¯ï¼');
        console.warn('æ—¥æŸ±ï¼š', dayGan);
        console.warn('æ—¶è¾°ï¼š', timeZhi);
        console.warn('åº“è®¡ç®—ç»“æœï¼š', timeGan + timeZhi);
        console.warn('æ­£ç¡®ç»“æœï¼š', correctTimeGan + timeZhi);
        console.warn('å·²è‡ªåŠ¨çº é”™');
        return correctTimeGan;
    }
    
    // éªŒè¯å¤©å¹²åœ°æ”¯ç»„åˆæ˜¯å¦æœ‰æ•ˆ
    if(GAN_NAMES.indexOf(timeGan) < 0 || ALL_ZHI.indexOf(timeZhi) < 0) {
        console.error('æ—¶æŸ±å¤©å¹²åœ°æ”¯ç»„åˆæ— æ•ˆï¼š', timeGan + timeZhi);
        if(correctTimeGan) {
            return correctTimeGan;
        }
    }
    
    // éªŒè¯æ—¥å¹²ä¸æ—¶å¹²çš„å…³ç³»
    var expectedGan = calculateTimeGanByWuShuDun(dayGan, timeZhi);
    if(expectedGan && expectedGan !== timeGan) {
        console.warn('æ—¥å¹²ä¸æ—¶å¹²å…³ç³»éªŒè¯å¤±è´¥ï¼Œä½¿ç”¨äº”é¼ éè®¡ç®—ç»“æœ');
        return expectedGan;
    }
    
    return timeGan;
}

var G = null;

// ==================== åŸå¸‚æ•°æ®åº“ï¼ˆå›½å†…æ‰€æœ‰åœ°çº§å¸‚ï¼ŒåŒ…æ‹¬å°æ¹¾çœï¼‰====================
var CITY_DATABASE = [
    // åŒ—äº¬å¸‚
    {name: 'åŒ—äº¬', province: 'åŒ—äº¬å¸‚', longitude: 116.4074},
    // å¤©æ´¥å¸‚
    {name: 'å¤©æ´¥', province: 'å¤©æ´¥å¸‚', longitude: 117.2008},
    // æ²³åŒ—çœ
    {name: 'çŸ³å®¶åº„', province: 'æ²³åŒ—çœ', longitude: 114.5149},
    {name: 'å”å±±', province: 'æ²³åŒ—çœ', longitude: 118.1802},
    {name: 'ç§¦çš‡å²›', province: 'æ²³åŒ—çœ', longitude: 119.6005},
    {name: 'é‚¯éƒ¸', province: 'æ²³åŒ—çœ', longitude: 114.5391},
    {name: 'é‚¢å°', province: 'æ²³åŒ—çœ', longitude: 114.5048},
    {name: 'ä¿å®š', province: 'æ²³åŒ—çœ', longitude: 115.4648},
    {name: 'å¼ å®¶å£', province: 'æ²³åŒ—çœ', longitude: 114.8875},
    {name: 'æ‰¿å¾·', province: 'æ²³åŒ—çœ', longitude: 117.9634},
    {name: 'æ²§å·', province: 'æ²³åŒ—çœ', longitude: 116.8388},
    {name: 'å»ŠåŠ', province: 'æ²³åŒ—çœ', longitude: 116.6838},
    {name: 'è¡¡æ°´', province: 'æ²³åŒ—çœ', longitude: 115.6702},
    // å±±è¥¿çœ
    {name: 'å¤ªåŸ', province: 'å±±è¥¿çœ', longitude: 112.5489},
    {name: 'å¤§åŒ', province: 'å±±è¥¿çœ', longitude: 113.3001},
    {name: 'é˜³æ³‰', province: 'å±±è¥¿çœ', longitude: 113.5804},
    {name: 'é•¿æ²»', province: 'å±±è¥¿çœ', longitude: 113.1163},
    {name: 'æ™‹åŸ', province: 'å±±è¥¿çœ', longitude: 112.8513},
    {name: 'æœ”å·', province: 'å±±è¥¿çœ', longitude: 112.4328},
    {name: 'æ™‹ä¸­', province: 'å±±è¥¿çœ', longitude: 112.7527},
    {name: 'è¿åŸ', province: 'å±±è¥¿çœ', longitude: 111.0069},
    {name: 'å¿»å·', province: 'å±±è¥¿çœ', longitude: 112.7341},
    {name: 'ä¸´æ±¾', province: 'å±±è¥¿çœ', longitude: 111.5189},
    {name: 'å•æ¢', province: 'å±±è¥¿çœ', longitude: 111.1443},
    // å†…è’™å¤è‡ªæ²»åŒº
    {name: 'å‘¼å’Œæµ©ç‰¹', province: 'å†…è’™å¤è‡ªæ²»åŒº', longitude: 111.7519},
    {name: 'åŒ…å¤´', province: 'å†…è’™å¤è‡ªæ²»åŒº', longitude: 109.8404},
    {name: 'ä¹Œæµ·', province: 'å†…è’™å¤è‡ªæ²»åŒº', longitude: 106.7942},
    {name: 'èµ¤å³°', province: 'å†…è’™å¤è‡ªæ²»åŒº', longitude: 118.8868},
    {name: 'é€šè¾½', province: 'å†…è’™å¤è‡ªæ²»åŒº', longitude: 122.2631},
    {name: 'é„‚å°”å¤šæ–¯', province: 'å†…è’™å¤è‡ªæ²»åŒº', longitude: 109.7811},
    {name: 'å‘¼ä¼¦è´å°”', province: 'å†…è’™å¤è‡ªæ²»åŒº', longitude: 119.7658},
    {name: 'å·´å½¦æ·–å°”', province: 'å†…è’™å¤è‡ªæ²»åŒº', longitude: 107.3877},
    {name: 'ä¹Œå…°å¯Ÿå¸ƒ', province: 'å†…è’™å¤è‡ªæ²»åŒº', longitude: 113.1338},
    // è¾½å®çœ
    {name: 'æ²ˆé˜³', province: 'è¾½å®çœ', longitude: 123.4315},
    {name: 'å¤§è¿', province: 'è¾½å®çœ', longitude: 121.6147},
    {name: 'éå±±', province: 'è¾½å®çœ', longitude: 122.9946},
    {name: 'æŠšé¡º', province: 'è¾½å®çœ', longitude: 123.9572},
    {name: 'æœ¬æºª', province: 'è¾½å®çœ', longitude: 123.7669},
    {name: 'ä¸¹ä¸œ', province: 'è¾½å®çœ', longitude: 124.3847},
    {name: 'é”¦å·', province: 'è¾½å®çœ', longitude: 121.1270},
    {name: 'è¥å£', province: 'è¾½å®çœ', longitude: 122.2354},
    {name: 'é˜œæ–°', province: 'è¾½å®çœ', longitude: 121.6701},
    {name: 'è¾½é˜³', province: 'è¾½å®çœ', longitude: 123.2369},
    {name: 'ç›˜é”¦', province: 'è¾½å®çœ', longitude: 122.0707},
    {name: 'é“å²­', province: 'è¾½å®çœ', longitude: 123.8423},
    {name: 'æœé˜³', province: 'è¾½å®çœ', longitude: 120.4504},
    {name: 'è‘«èŠ¦å²›', province: 'è¾½å®çœ', longitude: 120.8364},
    // å‰æ—çœ
    {name: 'é•¿æ˜¥', province: 'å‰æ—çœ', longitude: 125.3235},
    {name: 'å‰æ—', province: 'å‰æ—çœ', longitude: 126.5496},
    {name: 'å››å¹³', province: 'å‰æ—çœ', longitude: 124.3504},
    {name: 'è¾½æº', province: 'å‰æ—çœ', longitude: 125.1436},
    {name: 'é€šåŒ–', province: 'å‰æ—çœ', longitude: 125.9365},
    {name: 'ç™½å±±', province: 'å‰æ—çœ', longitude: 126.4243},
    {name: 'æ¾åŸ', province: 'å‰æ—çœ', longitude: 124.8252},
    {name: 'ç™½åŸ', province: 'å‰æ—çœ', longitude: 122.8387},
    // é»‘é¾™æ±Ÿçœ
    {name: 'å“ˆå°”æ»¨', province: 'é»‘é¾™æ±Ÿçœ', longitude: 126.5358},
    {name: 'é½é½å“ˆå°”', province: 'é»‘é¾™æ±Ÿçœ', longitude: 123.9182},
    {name: 'é¸¡è¥¿', province: 'é»‘é¾™æ±Ÿçœ', longitude: 130.9694},
    {name: 'é¹¤å²—', province: 'é»‘é¾™æ±Ÿçœ', longitude: 130.2974},
    {name: 'åŒé¸­å±±', province: 'é»‘é¾™æ±Ÿçœ', longitude: 131.1591},
    {name: 'å¤§åº†', province: 'é»‘é¾™æ±Ÿçœ', longitude: 125.1031},
    {name: 'ä¼Šæ˜¥', province: 'é»‘é¾™æ±Ÿçœ', longitude: 128.8994},
    {name: 'ä½³æœ¨æ–¯', province: 'é»‘é¾™æ±Ÿçœ', longitude: 130.3616},
    {name: 'ä¸ƒå°æ²³', province: 'é»‘é¾™æ±Ÿçœ', longitude: 131.0031},
    {name: 'ç‰¡ä¸¹æ±Ÿ', province: 'é»‘é¾™æ±Ÿçœ', longitude: 129.6332},
    {name: 'é»‘æ²³', province: 'é»‘é¾™æ±Ÿçœ', longitude: 127.4990},
    {name: 'ç»¥åŒ–', province: 'é»‘é¾™æ±Ÿçœ', longitude: 126.9929},
    {name: 'å¤§å…´å®‰å²­', province: 'é»‘é¾™æ±Ÿçœ', longitude: 124.7115},
    // ä¸Šæµ·å¸‚
    {name: 'ä¸Šæµ·', province: 'ä¸Šæµ·å¸‚', longitude: 121.4737},
    // æ±Ÿè‹çœ
    {name: 'å—äº¬', province: 'æ±Ÿè‹çœ', longitude: 118.7969},
    {name: 'æ— é”¡', province: 'æ±Ÿè‹çœ', longitude: 120.3124},
    {name: 'å¾å·', province: 'æ±Ÿè‹çœ', longitude: 117.2838},
    {name: 'å¸¸å·', province: 'æ±Ÿè‹çœ', longitude: 119.9739},
    {name: 'è‹å·', province: 'æ±Ÿè‹çœ', longitude: 120.5853},
    {name: 'å—é€š', province: 'æ±Ÿè‹çœ', longitude: 120.8943},
    {name: 'è¿äº‘æ¸¯', province: 'æ±Ÿè‹çœ', longitude: 119.1788},
    {name: 'æ·®å®‰', province: 'æ±Ÿè‹çœ', longitude: 119.0153},
    {name: 'ç›åŸ', province: 'æ±Ÿè‹çœ', longitude: 120.1614},
    {name: 'æ‰¬å·', province: 'æ±Ÿè‹çœ', longitude: 119.4129},
    {name: 'é•‡æ±Ÿ', province: 'æ±Ÿè‹çœ', longitude: 119.4548},
    {name: 'æ³°å·', province: 'æ±Ÿè‹çœ', longitude: 119.9152},
    {name: 'å®¿è¿', province: 'æ±Ÿè‹çœ', longitude: 118.2752},
    // æµ™æ±Ÿçœ
    {name: 'æ­å·', province: 'æµ™æ±Ÿçœ', longitude: 120.1551},
    {name: 'å®æ³¢', province: 'æµ™æ±Ÿçœ', longitude: 121.5440},
    {name: 'æ¸©å·', province: 'æµ™æ±Ÿçœ', longitude: 120.6994},
    {name: 'å˜‰å…´', province: 'æµ™æ±Ÿçœ', longitude: 120.7509},
    {name: 'æ¹–å·', province: 'æµ™æ±Ÿçœ', longitude: 120.0868},
    {name: 'ç»å…´', province: 'æµ™æ±Ÿçœ', longitude: 120.5820},
    {name: 'é‡‘å', province: 'æµ™æ±Ÿçœ', longitude: 119.6474},
    {name: 'è¡¢å·', province: 'æµ™æ±Ÿçœ', longitude: 118.8590},
    {name: 'èˆŸå±±', province: 'æµ™æ±Ÿçœ', longitude: 122.2072},
    {name: 'å°å·', province: 'æµ™æ±Ÿçœ', longitude: 121.4208},
    {name: 'ä¸½æ°´', province: 'æµ™æ±Ÿçœ', longitude: 119.9228},
    // å®‰å¾½çœ
    {name: 'åˆè‚¥', province: 'å®‰å¾½çœ', longitude: 117.2272},
    {name: 'èŠœæ¹–', province: 'å®‰å¾½çœ', longitude: 118.3765},
    {name: 'èšŒåŸ ', province: 'å®‰å¾½çœ', longitude: 117.3647},
    {name: 'æ·®å—', province: 'å®‰å¾½çœ', longitude: 116.9999},
    {name: 'é©¬éå±±', province: 'å®‰å¾½çœ', longitude: 118.5079},
    {name: 'æ·®åŒ—', province: 'å®‰å¾½çœ', longitude: 116.7948},
    {name: 'é“œé™µ', province: 'å®‰å¾½çœ', longitude: 117.8121},
    {name: 'å®‰åº†', province: 'å®‰å¾½çœ', longitude: 117.0536},
    {name: 'é»„å±±', province: 'å®‰å¾½çœ', longitude: 118.3370},
    {name: 'æ»å·', province: 'å®‰å¾½çœ', longitude: 118.3084},
    {name: 'é˜œé˜³', province: 'å®‰å¾½çœ', longitude: 115.8197},
    {name: 'å®¿å·', province: 'å®‰å¾½çœ', longitude: 116.9784},
    {name: 'å…­å®‰', province: 'å®‰å¾½çœ', longitude: 116.5078},
    {name: 'äº³å·', province: 'å®‰å¾½çœ', longitude: 115.7789},
    {name: 'æ± å·', province: 'å®‰å¾½çœ', longitude: 117.4892},
    {name: 'å®£åŸ', province: 'å®‰å¾½çœ', longitude: 118.7588},
    // ç¦å»ºçœ
    {name: 'ç¦å·', province: 'ç¦å»ºçœ', longitude: 119.2965},
    {name: 'å¦é—¨', province: 'ç¦å»ºçœ', longitude: 118.1109},
    {name: 'è†ç”°', province: 'ç¦å»ºçœ', longitude: 119.0078},
    {name: 'ä¸‰æ˜', province: 'ç¦å»ºçœ', longitude: 117.6350},
    {name: 'æ³‰å·', province: 'ç¦å»ºçœ', longitude: 118.6759},
    {name: 'æ¼³å·', province: 'ç¦å»ºçœ', longitude: 117.6618},
    {name: 'å—å¹³', province: 'ç¦å»ºçœ', longitude: 118.1779},
    {name: 'é¾™å²©', province: 'ç¦å»ºçœ', longitude: 117.0179},
    {name: 'å®å¾·', province: 'ç¦å»ºçœ', longitude: 119.5271},
    // æ±Ÿè¥¿çœ
    {name: 'å—æ˜Œ', province: 'æ±Ÿè¥¿çœ', longitude: 115.8581},
    {name: 'æ™¯å¾·é•‡', province: 'æ±Ÿè¥¿çœ', longitude: 117.2147},
    {name: 'èä¹¡', province: 'æ±Ÿè¥¿çœ', longitude: 113.8522},
    {name: 'ä¹æ±Ÿ', province: 'æ±Ÿè¥¿çœ', longitude: 115.9928},
    {name: 'æ–°ä½™', province: 'æ±Ÿè¥¿çœ', longitude: 114.9173},
    {name: 'é¹°æ½­', province: 'æ±Ÿè¥¿çœ', longitude: 117.0692},
    {name: 'èµ£å·', province: 'æ±Ÿè¥¿çœ', longitude: 114.9350},
    {name: 'å‰å®‰', province: 'æ±Ÿè¥¿çœ', longitude: 114.9864},
    {name: 'å®œæ˜¥', province: 'æ±Ÿè¥¿çœ', longitude: 114.3911},
    {name: 'æŠšå·', province: 'æ±Ÿè¥¿çœ', longitude: 116.3582},
    {name: 'ä¸Šé¥¶', province: 'æ±Ÿè¥¿çœ', longitude: 117.9712},
    // å±±ä¸œçœ
    {name: 'æµå—', province: 'å±±ä¸œçœ', longitude: 117.0009},
    {name: 'é’å²›', province: 'å±±ä¸œçœ', longitude: 120.3552},
    {name: 'æ·„åš', province: 'å±±ä¸œçœ', longitude: 118.0549},
    {name: 'æ£åº„', province: 'å±±ä¸œçœ', longitude: 117.3237},
    {name: 'ä¸œè¥', province: 'å±±ä¸œçœ', longitude: 118.6748},
    {name: 'çƒŸå°', province: 'å±±ä¸œçœ', longitude: 121.3914},
    {name: 'æ½åŠ', province: 'å±±ä¸œçœ', longitude: 119.1071},
    {name: 'æµå®', province: 'å±±ä¸œçœ', longitude: 116.5871},
    {name: 'æ³°å®‰', province: 'å±±ä¸œçœ', longitude: 117.0886},
    {name: 'å¨æµ·', province: 'å±±ä¸œçœ', longitude: 122.1214},
    {name: 'æ—¥ç…§', province: 'å±±ä¸œçœ', longitude: 119.5269},
    {name: 'ä¸´æ²‚', province: 'å±±ä¸œçœ', longitude: 118.3264},
    {name: 'å¾·å·', province: 'å±±ä¸œçœ', longitude: 116.3575},
    {name: 'èŠåŸ', province: 'å±±ä¸œçœ', longitude: 115.9854},
    {name: 'æ»¨å·', province: 'å±±ä¸œçœ', longitude: 118.0169},
    {name: 'èæ³½', province: 'å±±ä¸œçœ', longitude: 115.4694},
    // æ²³å—çœ
    {name: 'éƒ‘å·', province: 'æ²³å—çœ', longitude: 113.6254},
    {name: 'å¼€å°', province: 'æ²³å—çœ', longitude: 114.3076},
    {name: 'æ´›é˜³', province: 'æ²³å—çœ', longitude: 112.4540},
    {name: 'å¹³é¡¶å±±', province: 'æ²³å—çœ', longitude: 113.1927},
    {name: 'å®‰é˜³', province: 'æ²³å—çœ', longitude: 114.3924},
    {name: 'é¹¤å£', province: 'æ²³å—çœ', longitude: 114.2954},
    {name: 'æ–°ä¹¡', province: 'æ²³å—çœ', longitude: 113.9268},
    {name: 'ç„¦ä½œ', province: 'æ²³å—çœ', longitude: 113.2418},
    {name: 'æ¿®é˜³', province: 'æ²³å—çœ', longitude: 115.0293},
    {name: 'è®¸æ˜Œ', province: 'æ²³å—çœ', longitude: 113.8526},
    {name: 'æ¼¯æ²³', province: 'æ²³å—çœ', longitude: 114.0168},
    {name: 'ä¸‰é—¨å³¡', province: 'æ²³å—çœ', longitude: 111.2001},
    {name: 'å—é˜³', province: 'æ²³å—çœ', longitude: 112.5283},
    {name: 'å•†ä¸˜', province: 'æ²³å—çœ', longitude: 115.6564},
    {name: 'ä¿¡é˜³', province: 'æ²³å—çœ', longitude: 114.0910},
    {name: 'å‘¨å£', province: 'æ²³å—çœ', longitude: 114.6969},
    {name: 'é©»é©¬åº—', province: 'æ²³å—çœ', longitude: 114.0223},
    {name: 'æµæº', province: 'æ²³å—çœ', longitude: 112.6019},
    // æ¹–åŒ—çœ
    {name: 'æ­¦æ±‰', province: 'æ¹–åŒ—çœ', longitude: 114.3162},
    {name: 'é»„çŸ³', province: 'æ¹–åŒ—çœ', longitude: 115.0389},
    {name: 'åå °', province: 'æ¹–åŒ—çœ', longitude: 110.7879},
    {name: 'å®œæ˜Œ', province: 'æ¹–åŒ—çœ', longitude: 111.2865},
    {name: 'è¥„é˜³', province: 'æ¹–åŒ—çœ', longitude: 112.1441},
    {name: 'é„‚å·', province: 'æ¹–åŒ—çœ', longitude: 114.8948},
    {name: 'è†é—¨', province: 'æ¹–åŒ—çœ', longitude: 112.1993},
    {name: 'å­æ„Ÿ', province: 'æ¹–åŒ—çœ', longitude: 113.9266},
    {name: 'è†å·', province: 'æ¹–åŒ—çœ', longitude: 112.2397},
    {name: 'é»„å†ˆ', province: 'æ¹–åŒ—çœ', longitude: 114.8723},
    {name: 'å’¸å®', province: 'æ¹–åŒ—çœ', longitude: 114.3225},
    {name: 'éšå·', province: 'æ¹–åŒ—çœ', longitude: 113.3825},
    {name: 'æ©æ–½', province: 'æ¹–åŒ—çœ', longitude: 109.4867},
    {name: 'ä»™æ¡ƒ', province: 'æ¹–åŒ—çœ', longitude: 113.4540},
    {name: 'æ½œæ±Ÿ', province: 'æ¹–åŒ—çœ', longitude: 112.8969},
    {name: 'å¤©é—¨', province: 'æ¹–åŒ—çœ', longitude: 113.1659},
    {name: 'ç¥å†œæ¶', province: 'æ¹–åŒ—çœ', longitude: 110.6715},
    // æ¹–å—çœ
    {name: 'é•¿æ²™', province: 'æ¹–å—çœ', longitude: 112.9388},
    {name: 'æ ªæ´²', province: 'æ¹–å—çœ', longitude: 113.1340},
    {name: 'æ¹˜æ½­', province: 'æ¹–å—çœ', longitude: 112.9440},
    {name: 'è¡¡é˜³', province: 'æ¹–å—çœ', longitude: 112.5719},
    {name: 'é‚µé˜³', province: 'æ¹–å—çœ', longitude: 111.4677},
    {name: 'å²³é˜³', province: 'æ¹–å—çœ', longitude: 113.1289},
    {name: 'å¸¸å¾·', province: 'æ¹–å—çœ', longitude: 111.6985},
    {name: 'å¼ å®¶ç•Œ', province: 'æ¹–å—çœ', longitude: 110.4792},
    {name: 'ç›Šé˜³', province: 'æ¹–å—çœ', longitude: 112.3550},
    {name: 'éƒ´å·', province: 'æ¹–å—çœ', longitude: 113.0147},
    {name: 'æ°¸å·', province: 'æ¹–å—çœ', longitude: 111.6122},
    {name: 'æ€€åŒ–', province: 'æ¹–å—çœ', longitude: 109.9782},
    {name: 'å¨„åº•', province: 'æ¹–å—çœ', longitude: 111.9964},
    // å¹¿ä¸œçœ
    {name: 'å¹¿å·', province: 'å¹¿ä¸œçœ', longitude: 113.2644},
    {name: 'éŸ¶å…³', province: 'å¹¿ä¸œçœ', longitude: 113.5972},
    {name: 'æ·±åœ³', province: 'å¹¿ä¸œçœ', longitude: 114.0579},
    {name: 'ç æµ·', province: 'å¹¿ä¸œçœ', longitude: 113.5767},
    {name: 'æ±•å¤´', province: 'å¹¿ä¸œçœ', longitude: 116.6819},
    {name: 'ä½›å±±', province: 'å¹¿ä¸œçœ', longitude: 113.1214},
    {name: 'æ±Ÿé—¨', province: 'å¹¿ä¸œçœ', longitude: 113.0819},
    {name: 'æ¹›æ±Ÿ', province: 'å¹¿ä¸œçœ', longitude: 110.3647},
    {name: 'èŒ‚å', province: 'å¹¿ä¸œçœ', longitude: 110.9254},
    {name: 'è‚‡åº†', province: 'å¹¿ä¸œçœ', longitude: 112.4650},
    {name: 'æƒ å·', province: 'å¹¿ä¸œçœ', longitude: 114.4160},
    {name: 'æ¢…å·', province: 'å¹¿ä¸œçœ', longitude: 116.1222},
    {name: 'æ±•å°¾', province: 'å¹¿ä¸œçœ', longitude: 115.3751},
    {name: 'æ²³æº', province: 'å¹¿ä¸œçœ', longitude: 114.6978},
    {name: 'é˜³æ±Ÿ', province: 'å¹¿ä¸œçœ', longitude: 111.9822},
    {name: 'æ¸…è¿œ', province: 'å¹¿ä¸œçœ', longitude: 113.0560},
    {name: 'ä¸œè', province: 'å¹¿ä¸œçœ', longitude: 113.7518},
    {name: 'ä¸­å±±', province: 'å¹¿ä¸œçœ', longitude: 113.3927},
    {name: 'æ½®å·', province: 'å¹¿ä¸œçœ', longitude: 116.6226},
    {name: 'æ­é˜³', province: 'å¹¿ä¸œçœ', longitude: 116.3728},
    {name: 'äº‘æµ®', province: 'å¹¿ä¸œçœ', longitude: 112.0445},
    // å¹¿è¥¿å£®æ—è‡ªæ²»åŒº
    {name: 'å—å®', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 108.3200},
    {name: 'æŸ³å·', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 109.4280},
    {name: 'æ¡‚æ—', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 110.2992},
    {name: 'æ¢§å·', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 111.2791},
    {name: 'åŒ—æµ·', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 109.1201},
    {name: 'é˜²åŸæ¸¯', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 108.3544},
    {name: 'é’¦å·', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 108.6541},
    {name: 'è´µæ¸¯', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 109.5989},
    {name: 'ç‰æ—', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 110.1544},
    {name: 'ç™¾è‰²', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 106.6163},
    {name: 'è´ºå·', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 111.5666},
    {name: 'æ²³æ± ', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 108.0856},
    {name: 'æ¥å®¾', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 109.2297},
    {name: 'å´‡å·¦', province: 'å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', longitude: 107.3647},
    // æµ·å—çœ
    {name: 'æµ·å£', province: 'æµ·å—çœ', longitude: 110.3308},
    {name: 'ä¸‰äºš', province: 'æµ·å—çœ', longitude: 109.5119},
    {name: 'ä¸‰æ²™', province: 'æµ·å—çœ', longitude: 112.3387},
    {name: 'å„‹å·', province: 'æµ·å—çœ', longitude: 109.5807},
    // é‡åº†å¸‚
    {name: 'é‡åº†', province: 'é‡åº†å¸‚', longitude: 106.5516},
    // å››å·çœ
    {name: 'æˆéƒ½', province: 'å››å·çœ', longitude: 104.0665},
    {name: 'è‡ªè´¡', province: 'å››å·çœ', longitude: 104.7784},
    {name: 'æ”€æèŠ±', province: 'å››å·çœ', longitude: 101.7186},
    {name: 'æ³¸å·', province: 'å››å·çœ', longitude: 105.4433},
    {name: 'å¾·é˜³', province: 'å››å·çœ', longitude: 104.3979},
    {name: 'ç»µé˜³', province: 'å››å·çœ', longitude: 104.6790},
    {name: 'å¹¿å…ƒ', province: 'å››å·çœ', longitude: 105.8298},
    {name: 'é‚å®', province: 'å››å·çœ', longitude: 105.5929},
    {name: 'å†…æ±Ÿ', province: 'å››å·çœ', longitude: 105.0584},
    {name: 'ä¹å±±', province: 'å››å·çœ', longitude: 103.7657},
    {name: 'å—å……', province: 'å››å·çœ', longitude: 106.1107},
    {name: 'çœ‰å±±', province: 'å››å·çœ', longitude: 103.8317},
    {name: 'å®œå®¾', province: 'å››å·çœ', longitude: 104.6432},
    {name: 'å¹¿å®‰', province: 'å››å·çœ', longitude: 106.6333},
    {name: 'è¾¾å·', province: 'å››å·çœ', longitude: 107.5023},
    {name: 'é›…å®‰', province: 'å››å·çœ', longitude: 103.0133},
    {name: 'å·´ä¸­', province: 'å››å·çœ', longitude: 106.7537},
    {name: 'èµ„é˜³', province: 'å››å·çœ', longitude: 104.6419},
    // è´µå·çœ
    {name: 'è´µé˜³', province: 'è´µå·çœ', longitude: 106.6302},
    {name: 'å…­ç›˜æ°´', province: 'è´µå·çœ', longitude: 104.8304},
    {name: 'éµä¹‰', province: 'è´µå·çœ', longitude: 106.9272},
    {name: 'å®‰é¡º', province: 'è´µå·çœ', longitude: 105.9462},
    {name: 'æ¯•èŠ‚', province: 'è´µå·çœ', longitude: 105.2850},
    {name: 'é“œä»', province: 'è´µå·çœ', longitude: 109.1916},
    // äº‘å—çœ
    {name: 'æ˜†æ˜', province: 'äº‘å—çœ', longitude: 102.7123},
    {name: 'æ›²é–', province: 'äº‘å—çœ', longitude: 103.7962},
    {name: 'ç‰æºª', province: 'äº‘å—çœ', longitude: 102.5439},
    {name: 'ä¿å±±', province: 'äº‘å—çœ', longitude: 99.1618},
    {name: 'æ˜­é€š', province: 'äº‘å—çœ', longitude: 103.7172},
    {name: 'ä¸½æ±Ÿ', province: 'äº‘å—çœ', longitude: 100.2277},
    {name: 'æ™®æ´±', province: 'äº‘å—çœ', longitude: 100.9660},
    {name: 'ä¸´æ²§', province: 'äº‘å—çœ', longitude: 100.0869},
    {name: 'çº¢æ²³', province: 'äº‘å—çœ', longitude: 103.3840},
    {name: 'æ–‡å±±', province: 'äº‘å—çœ', longitude: 104.2442},
    {name: 'è¥¿åŒç‰ˆçº³', province: 'äº‘å—çœ', longitude: 100.7979},
    {name: 'å¤§ç†', province: 'äº‘å—çœ', longitude: 100.2676},
    {name: 'å¾·å®', province: 'äº‘å—çœ', longitude: 98.5844},
    {name: 'æ€’æ±Ÿ', province: 'äº‘å—çœ', longitude: 98.8543},
    {name: 'è¿ªåº†', province: 'äº‘å—çœ', longitude: 99.7022},
    // è¥¿è—è‡ªæ²»åŒº
    {name: 'æ‹‰è¨', province: 'è¥¿è—è‡ªæ²»åŒº', longitude: 91.1145},
    {name: 'æ—¥å–€åˆ™', province: 'è¥¿è—è‡ªæ²»åŒº', longitude: 88.8806},
    {name: 'æ˜Œéƒ½', province: 'è¥¿è—è‡ªæ²»åŒº', longitude: 97.1728},
    {name: 'æ—èŠ', province: 'è¥¿è—è‡ªæ²»åŒº', longitude: 94.3614},
    {name: 'å±±å—', province: 'è¥¿è—è‡ªæ²»åŒº', longitude: 91.7731},
    {name: 'é‚£æ›²', province: 'è¥¿è—è‡ªæ²»åŒº', longitude: 92.0512},
    {name: 'é˜¿é‡Œ', province: 'è¥¿è—è‡ªæ²»åŒº', longitude: 80.1055},
    // é™•è¥¿çœ
    {name: 'è¥¿å®‰', province: 'é™•è¥¿çœ', longitude: 108.9398},
    {name: 'é“œå·', province: 'é™•è¥¿çœ', longitude: 108.9796},
    {name: 'å®é¸¡', province: 'é™•è¥¿çœ', longitude: 107.2379},
    {name: 'å’¸é˜³', province: 'é™•è¥¿çœ', longitude: 108.7093},
    {name: 'æ¸­å—', province: 'é™•è¥¿çœ', longitude: 109.4897},
    {name: 'å»¶å®‰', province: 'é™•è¥¿çœ', longitude: 109.4897},
    {name: 'æ±‰ä¸­', province: 'é™•è¥¿çœ', longitude: 107.0233},
    {name: 'æ¦†æ—', province: 'é™•è¥¿çœ', longitude: 109.7346},
    {name: 'å®‰åº·', province: 'é™•è¥¿çœ', longitude: 109.0293},
    {name: 'å•†æ´›', province: 'é™•è¥¿çœ', longitude: 109.9402},
    // ç”˜è‚ƒçœ
    {name: 'å…°å·', province: 'ç”˜è‚ƒçœ', longitude: 103.8343},
    {name: 'å˜‰å³ªå…³', province: 'ç”˜è‚ƒçœ', longitude: 98.2894},
    {name: 'é‡‘æ˜Œ', province: 'ç”˜è‚ƒçœ', longitude: 102.1880},
    {name: 'ç™½é“¶', province: 'ç”˜è‚ƒçœ', longitude: 104.1386},
    {name: 'å¤©æ°´', province: 'ç”˜è‚ƒçœ', longitude: 105.7249},
    {name: 'æ­¦å¨', province: 'ç”˜è‚ƒçœ', longitude: 102.6347},
    {name: 'å¼ æ–', province: 'ç”˜è‚ƒçœ', longitude: 100.4498},
    {name: 'å¹³å‡‰', province: 'ç”˜è‚ƒçœ', longitude: 106.6652},
    {name: 'é…’æ³‰', province: 'ç”˜è‚ƒçœ', longitude: 98.4944},
    {name: 'åº†é˜³', province: 'ç”˜è‚ƒçœ', longitude: 107.6436},
    {name: 'å®šè¥¿', province: 'ç”˜è‚ƒçœ', longitude: 104.6263},
    {name: 'é™‡å—', province: 'ç”˜è‚ƒçœ', longitude: 104.9214},
    // é’æµ·çœ
    {name: 'è¥¿å®', province: 'é’æµ·çœ', longitude: 101.7782},
    {name: 'æµ·ä¸œ', province: 'é’æµ·çœ', longitude: 102.1043},
    {name: 'æµ·åŒ—', province: 'é’æµ·çœ', longitude: 100.9009},
    {name: 'é»„å—', province: 'é’æµ·çœ', longitude: 102.0199},
    {name: 'æµ·å—', province: 'é’æµ·çœ', longitude: 100.6195},
    {name: 'æœæ´›', province: 'é’æµ·çœ', longitude: 100.2447},
    {name: 'ç‰æ ‘', province: 'é’æµ·çœ', longitude: 97.0086},
    {name: 'æµ·è¥¿', province: 'é’æµ·çœ', longitude: 97.3708},
    // å®å¤å›æ—è‡ªæ²»åŒº
    {name: 'é“¶å·', province: 'å®å¤å›æ—è‡ªæ²»åŒº', longitude: 106.2309},
    {name: 'çŸ³å˜´å±±', province: 'å®å¤å›æ—è‡ªæ²»åŒº', longitude: 106.3833},
    {name: 'å´å¿ ', province: 'å®å¤å›æ—è‡ªæ²»åŒº', longitude: 106.1994},
    {name: 'å›ºåŸ', province: 'å®å¤å›æ—è‡ªæ²»åŒº', longitude: 106.2426},
    {name: 'ä¸­å«', province: 'å®å¤å›æ—è‡ªæ²»åŒº', longitude: 105.1968},
    // æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº
    {name: 'ä¹Œé²æœ¨é½', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 87.6168},
    {name: 'å…‹æ‹‰ç›ä¾', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 84.8739},
    {name: 'åé²ç•ª', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 89.1895},
    {name: 'å“ˆå¯†', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 93.5149},
    {name: 'å–€ä»€', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 75.9891},
    {name: 'å’Œç”°', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 79.9222},
    {name: 'é˜¿å…‹è‹', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 80.2606},
    {name: 'é˜¿å›¾ä»€', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 76.1734},
    {name: 'åº“å°”å‹’', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 86.1453},
    {name: 'æ˜Œå‰', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 87.3082},
    {name: 'åšä¹', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 82.0722},
    {name: 'ä¼Šå®', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 81.3179},
    {name: 'å¡”åŸ', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 82.9798},
    {name: 'é˜¿å‹’æ³°', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 88.1318},
    {name: 'çŸ³æ²³å­', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 86.0806},
    {name: 'é˜¿æ‹‰å°”', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 81.2859},
    {name: 'å›¾æœ¨èˆ’å…‹', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 79.0773},
    {name: 'äº”å®¶æ¸ ', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 87.5391},
    {name: 'åŒ—å±¯', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 87.8249},
    {name: 'é“é—¨å…³', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 85.5012},
    {name: 'åŒæ²³', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 82.3537},
    {name: 'å¯å…‹è¾¾æ‹‰', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 80.6358},
    {name: 'æ˜†ç‰', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 79.2874},
    {name: 'èƒ¡æ¨æ²³', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 84.8276},
    {name: 'æ–°æ˜Ÿ', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 93.4126},
    {name: 'ç™½æ¨', province: 'æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº', longitude: 84.8276},
    // å°æ¹¾çœ
    {name: 'å°åŒ—', province: 'å°æ¹¾çœ', longitude: 121.5654},
    {name: 'æ–°åŒ—', province: 'å°æ¹¾çœ', longitude: 121.4656},
    {name: 'æ¡ƒå›­', province: 'å°æ¹¾çœ', longitude: 121.3010},
    {name: 'å°ä¸­', province: 'å°æ¹¾çœ', longitude: 120.6739},
    {name: 'å°å—', province: 'å°æ¹¾çœ', longitude: 120.2133},
    {name: 'é«˜é›„', province: 'å°æ¹¾çœ', longitude: 120.3013},
    {name: 'åŸºéš†', province: 'å°æ¹¾çœ', longitude: 121.7462},
    {name: 'æ–°ç«¹', province: 'å°æ¹¾çœ', longitude: 120.9688},
    {name: 'å˜‰ä¹‰', province: 'å°æ¹¾çœ', longitude: 120.4521},
    {name: 'å®œå…°', province: 'å°æ¹¾çœ', longitude: 121.7535},
    {name: 'è‹—æ —', province: 'å°æ¹¾çœ', longitude: 120.8189},
    {name: 'å½°åŒ–', province: 'å°æ¹¾çœ', longitude: 120.5417},
    {name: 'å—æŠ•', province: 'å°æ¹¾çœ', longitude: 120.6870},
    {name: 'äº‘æ—', province: 'å°æ¹¾çœ', longitude: 120.5272},
    {name: 'å±ä¸œ', province: 'å°æ¹¾çœ', longitude: 120.4879},
    {name: 'å°ä¸œ', province: 'å°æ¹¾çœ', longitude: 121.1444},
    {name: 'èŠ±è²', province: 'å°æ¹¾çœ', longitude: 121.6010},
    {name: 'æ¾æ¹–', province: 'å°æ¹¾çœ', longitude: 119.5664}
];

// ==================== å›½å¤–åŸå¸‚æ•°æ®åº“ï¼ˆåŒ…å«æ‰€æœ‰å›½å®¶é¦–éƒ½å’Œä¸»è¦åŸå¸‚ï¼‰====================
var FOREIGN_CITY_DATABASE = [
    // äºšæ´²
    {continent: 'äºšæ´²', country: 'æ—¥æœ¬', city: 'ä¸œäº¬', longitude: 139.6917, isCapital: true},
    {continent: 'äºšæ´²', country: 'æ—¥æœ¬', city: 'å¤§é˜ª', longitude: 135.5023, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ—¥æœ¬', city: 'æ¨ªæ»¨', longitude: 139.6380, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ—¥æœ¬', city: 'åå¤å±‹', longitude: 136.9066, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ—¥æœ¬', city: 'äº¬éƒ½', longitude: 135.7530, isCapital: false},
    {continent: 'äºšæ´²', country: 'éŸ©å›½', city: 'é¦–å°”', longitude: 126.9780, isCapital: true},
    {continent: 'äºšæ´²', country: 'éŸ©å›½', city: 'é‡œå±±', longitude: 129.0756, isCapital: false},
    {continent: 'äºšæ´²', country: 'éŸ©å›½', city: 'å¤§é‚±', longitude: 128.5911, isCapital: false},
    {continent: 'äºšæ´²', country: 'æœé²œ', city: 'å¹³å£¤', longitude: 125.7625, isCapital: true},
    {continent: 'äºšæ´²', country: 'è’™å¤', city: 'ä¹Œå…°å·´æ‰˜', longitude: 106.9057, isCapital: true},
    {continent: 'äºšæ´²', country: 'è¶Šå—', city: 'æ²³å†…', longitude: 105.8342, isCapital: true},
    {continent: 'äºšæ´²', country: 'è¶Šå—', city: 'èƒ¡å¿—æ˜å¸‚', longitude: 106.6297, isCapital: false},
    {continent: 'äºšæ´²', country: 'è€æŒ', city: 'ä¸‡è±¡', longitude: 102.6331, isCapital: true},
    {continent: 'äºšæ´²', country: 'æŸ¬åŸ”å¯¨', city: 'é‡‘è¾¹', longitude: 104.9160, isCapital: true},
    {continent: 'äºšæ´²', country: 'æ³°å›½', city: 'æ›¼è°·', longitude: 100.5018, isCapital: true},
    {continent: 'äºšæ´²', country: 'æ³°å›½', city: 'æ¸…è¿ˆ', longitude: 98.9853, isCapital: false},
    {continent: 'äºšæ´²', country: 'ç¼…ç”¸', city: 'å†…æ¯”éƒ½', longitude: 96.1299, isCapital: true},
    {continent: 'äºšæ´²', country: 'ç¼…ç”¸', city: 'ä»°å…‰', longitude: 96.1561, isCapital: false},
    {continent: 'äºšæ´²', country: 'é©¬æ¥è¥¿äºš', city: 'å‰éš†å¡', longitude: 101.6869, isCapital: true},
    {continent: 'äºšæ´²', country: 'é©¬æ¥è¥¿äºš', city: 'æ§ŸåŸ', longitude: 100.3327, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ–°åŠ å¡', city: 'æ–°åŠ å¡', longitude: 103.8198, isCapital: true},
    {continent: 'äºšæ´²', country: 'å°åº¦å°¼è¥¿äºš', city: 'é›…åŠ è¾¾', longitude: 106.8451, isCapital: true},
    {continent: 'äºšæ´²', country: 'å°åº¦å°¼è¥¿äºš', city: 'æ³—æ°´', longitude: 112.7521, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ–‡è±', city: 'æ–¯é‡Œå·´åŠ æ¹¾å¸‚', longitude: 114.9398, isCapital: true},
    {continent: 'äºšæ´²', country: 'è²å¾‹å®¾', city: 'é©¬å°¼æ‹‰', longitude: 120.9842, isCapital: true},
    {continent: 'äºšæ´²', country: 'è²å¾‹å®¾', city: 'å®¿åŠ¡', longitude: 123.8854, isCapital: false},
    {continent: 'äºšæ´²', country: 'ä¸œå¸æ±¶', city: 'å¸åŠ›', longitude: 125.5736, isCapital: true},
    {continent: 'äºšæ´²', country: 'å°åº¦', city: 'æ–°å¾·é‡Œ', longitude: 77.2090, isCapital: true},
    {continent: 'äºšæ´²', country: 'å°åº¦', city: 'å­Ÿä¹°', longitude: 72.8777, isCapital: false},
    {continent: 'äºšæ´²', country: 'å°åº¦', city: 'ç­åŠ ç½—å°”', longitude: 77.5946, isCapital: false},
    {continent: 'äºšæ´²', country: 'å°åº¦', city: 'åŠ å°”å„ç­”', longitude: 88.3639, isCapital: false},
    {continent: 'äºšæ´²', country: 'å·´åŸºæ–¯å¦', city: 'ä¼Šæ–¯å…°å ¡', longitude: 73.0479, isCapital: true},
    {continent: 'äºšæ´²', country: 'å·´åŸºæ–¯å¦', city: 'å¡æ‹‰å¥‡', longitude: 67.0011, isCapital: false},
    {continent: 'äºšæ´²', country: 'å·´åŸºæ–¯å¦', city: 'æ‹‰åˆå°”', longitude: 74.3587, isCapital: false},
    {continent: 'äºšæ´²', country: 'å­ŸåŠ æ‹‰å›½', city: 'è¾¾å¡', longitude: 90.4125, isCapital: true},
    {continent: 'äºšæ´²', country: 'æ–¯é‡Œå…°å¡', city: 'ç§‘ä¼¦å¡', longitude: 79.8612, isCapital: true},
    {continent: 'äºšæ´²', country: 'é©¬å°”ä»£å¤«', city: 'é©¬ç´¯', longitude: 73.5089, isCapital: true},
    {continent: 'äºšæ´²', country: 'å°¼æ³Šå°”', city: 'åŠ å¾·æ»¡éƒ½', longitude: 85.3240, isCapital: true},
    {continent: 'äºšæ´²', country: 'ä¸ä¸¹', city: 'å»·å¸ƒ', longitude: 89.6390, isCapital: true},
    {continent: 'äºšæ´²', country: 'é˜¿å¯Œæ±—', city: 'å–€å¸ƒå°”', longitude: 69.2075, isCapital: true},
    {continent: 'äºšæ´²', country: 'ä¼Šæœ—', city: 'å¾·é»‘å…°', longitude: 51.3890, isCapital: true},
    {continent: 'äºšæ´²', country: 'ä¼Šæœ—', city: 'ä¼Šæ–¯æ³•ç½•', longitude: 51.6750, isCapital: false},
    {continent: 'äºšæ´²', country: 'ä¼Šæ‹‰å…‹', city: 'å·´æ ¼è¾¾', longitude: 44.3661, isCapital: true},
    {continent: 'äºšæ´²', country: 'ç§‘å¨ç‰¹', city: 'ç§‘å¨ç‰¹åŸ', longitude: 47.9774, isCapital: true},
    {continent: 'äºšæ´²', country: 'æ²™ç‰¹é˜¿æ‹‰ä¼¯', city: 'åˆ©é›…å¾—', longitude: 46.6753, isCapital: true},
    {continent: 'äºšæ´²', country: 'æ²™ç‰¹é˜¿æ‹‰ä¼¯', city: 'å‰è¾¾', longitude: 39.1829, isCapital: false},
    {continent: 'äºšæ´²', country: 'å·´æ—', city: 'éº¦çº³éº¦', longitude: 50.5577, isCapital: true},
    {continent: 'äºšæ´²', country: 'å¡å¡”å°”', city: 'å¤šå“ˆ', longitude: 51.5310, isCapital: true},
    {continent: 'äºšæ´²', country: 'é˜¿è”é…‹', city: 'é˜¿å¸ƒæ‰æ¯”', longitude: 54.3773, isCapital: true},
    {continent: 'äºšæ´²', country: 'é˜¿è”é…‹', city: 'è¿ªæ‹œ', longitude: 55.2708, isCapital: false},
    {continent: 'äºšæ´²', country: 'é˜¿æ›¼', city: 'é©¬æ–¯å–€ç‰¹', longitude: 58.4078, isCapital: true},
    {continent: 'äºšæ´²', country: 'ä¹Ÿé—¨', city: 'è¨é‚£', longitude: 44.2067, isCapital: true},
    {continent: 'äºšæ´²', country: 'çº¦æ—¦', city: 'å®‰æ›¼', longitude: 35.9306, isCapital: true},
    {continent: 'äºšæ´²', country: 'é»å·´å«©', city: 'è´é²ç‰¹', longitude: 35.5018, isCapital: true},
    {continent: 'äºšæ´²', country: 'å™åˆ©äºš', city: 'å¤§é©¬å£«é©', longitude: 36.2765, isCapital: true},
    {continent: 'äºšæ´²', country: 'ä»¥è‰²åˆ—', city: 'è€¶è·¯æ’’å†·', longitude: 35.2137, isCapital: true},
    {continent: 'äºšæ´²', country: 'ä»¥è‰²åˆ—', city: 'ç‰¹æ‹‰ç»´å¤«', longitude: 34.7818, isCapital: false},
    {continent: 'äºšæ´²', country: 'å·´å‹’æ–¯å¦', city: 'æ‹‰å§†å®‰æ‹‰', longitude: 35.2062, isCapital: true},
    {continent: 'äºšæ´²', country: 'åœŸè€³å…¶', city: 'å®‰å¡æ‹‰', longitude: 32.8597, isCapital: true},
    {continent: 'äºšæ´²', country: 'åœŸè€³å…¶', city: 'ä¼Šæ–¯å¦å¸ƒå°”', longitude: 28.9784, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ ¼é²å‰äºš', city: 'ç¬¬æ¯”åˆ©æ–¯', longitude: 44.8271, isCapital: true},
    {continent: 'äºšæ´²', country: 'äºšç¾å°¼äºš', city: 'åŸƒé‡Œæ¸©', longitude: 44.5035, isCapital: true},
    {continent: 'äºšæ´²', country: 'é˜¿å¡æ‹œç–†', city: 'å·´åº“', longitude: 49.8671, isCapital: true},
    {continent: 'äºšæ´²', country: 'å“ˆè¨å…‹æ–¯å¦', city: 'é˜¿æ–¯å¡”çº³', longitude: 71.4306, isCapital: true},
    {continent: 'äºšæ´²', country: 'å“ˆè¨å…‹æ–¯å¦', city: 'é˜¿æ‹‰æœ¨å›¾', longitude: 76.9126, isCapital: false},
    {continent: 'äºšæ´²', country: 'ä¹Œå…¹åˆ«å…‹æ–¯å¦', city: 'å¡”ä»€å¹²', longitude: 69.2401, isCapital: true},
    {continent: 'äºšæ´²', country: 'åœŸåº“æ›¼æ–¯å¦', city: 'é˜¿ä»€å“ˆå·´å¾·', longitude: 58.3833, isCapital: true},
    {continent: 'äºšæ´²', country: 'å¡”å‰å…‹æ–¯å¦', city: 'æœå°šåˆ«', longitude: 68.7738, isCapital: true},
    {continent: 'äºšæ´²', country: 'å‰å°”å‰æ–¯æ–¯å¦', city: 'æ¯”ä»€å‡¯å…‹', longitude: 74.5698, isCapital: true},
    
    // æ¬§æ´²
    {continent: 'æ¬§æ´²', country: 'ä¿„ç½—æ–¯', city: 'è«æ–¯ç§‘', longitude: 37.6173, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ä¿„ç½—æ–¯', city: 'åœ£å½¼å¾—å ¡', longitude: 30.3159, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è‹±å›½', city: 'ä¼¦æ•¦', longitude: -0.1278, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'è‹±å›½', city: 'æ›¼å½»æ–¯ç‰¹', longitude: -2.2426, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è‹±å›½', city: 'ä¼¯æ˜ç¿°', longitude: -1.8998, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ³•å›½', city: 'å·´é»', longitude: 2.3522, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æ³•å›½', city: 'é©¬èµ›', longitude: 5.3698, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ³•å›½', city: 'é‡Œæ˜‚', longitude: 4.8357, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å¾·å›½', city: 'æŸæ—', longitude: 13.4050, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'å¾·å›½', city: 'æ…•å°¼é»‘', longitude: 11.5820, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å¾·å›½', city: 'æ±‰å ¡', longitude: 9.9937, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ„å¤§åˆ©', city: 'ç½—é©¬', longitude: 12.4964, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æ„å¤§åˆ©', city: 'ç±³å…°', longitude: 9.1900, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ„å¤§åˆ©', city: 'é‚£ä¸å‹’æ–¯', longitude: 14.2681, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è¥¿ç­ç‰™', city: 'é©¬å¾·é‡Œ', longitude: -3.7038, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'è¥¿ç­ç‰™', city: 'å·´å¡ç½—é‚£', longitude: 2.1734, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è‘¡è„ç‰™', city: 'é‡Œæ–¯æœ¬', longitude: -9.1393, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'å¸Œè…Š', city: 'é›…å…¸', longitude: 23.7275, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'è·å…°', city: 'é˜¿å§†æ–¯ç‰¹ä¸¹', longitude: 4.9041, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'è·å…°', city: 'é¹¿ç‰¹ä¸¹', longitude: 4.4777, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ¯”åˆ©æ—¶', city: 'å¸ƒé²å¡å°”', longitude: 4.3517, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ç‘å£«', city: 'ä¼¯å°”å°¼', longitude: 7.4474, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ç‘å£«', city: 'è‹é»ä¸–', longitude: 8.5417, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å¥¥åœ°åˆ©', city: 'ç»´ä¹Ÿçº³', longitude: 16.3738, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ç‘å…¸', city: 'æ–¯å¾·å“¥å°”æ‘©', longitude: 18.0686, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æŒªå¨', city: 'å¥¥æ–¯é™†', longitude: 10.7522, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ä¸¹éº¦', city: 'å“¥æœ¬å“ˆæ ¹', longitude: 12.5683, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'èŠ¬å…°', city: 'èµ«å°”è¾›åŸº', longitude: 24.9458, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'å†°å²›', city: 'é›·å…‹é›…æœªå…‹', longitude: -21.8278, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'çˆ±å°”å…°', city: 'éƒ½æŸæ—', longitude: -6.2603, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æ³¢å…°', city: 'åæ²™', longitude: 21.0122, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æ·å…‹', city: 'å¸ƒæ‹‰æ ¼', longitude: 14.4378, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æ–¯æ´›ä¼å…‹', city: 'å¸ƒæ‹‰è¿ªæ–¯æ‹‰å‘', longitude: 17.1077, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'åŒˆç‰™åˆ©', city: 'å¸ƒè¾¾ä½©æ–¯', longitude: 19.0402, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ç½—é©¬å°¼äºš', city: 'å¸ƒåŠ å‹’æ–¯ç‰¹', longitude: 26.0969, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ä¿åŠ åˆ©äºš', city: 'ç´¢è²äºš', longitude: 23.3219, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'å¡å°”ç»´äºš', city: 'è´å°”æ ¼è±å¾·', longitude: 20.4489, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'å…‹ç½—åœ°äºš', city: 'è¨æ ¼å‹’å¸ƒ', longitude: 15.9819, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æ–¯æ´›æ–‡å°¼äºš', city: 'å¢å¸ƒå°”é›…é‚£', longitude: 14.5058, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æ³¢é»‘', city: 'è¨æ‹‰çƒ­çª', longitude: 18.4131, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'åŒ—é©¬å…¶é¡¿', city: 'æ–¯ç§‘æ™®é‡Œ', longitude: 21.4333, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'é˜¿å°”å·´å°¼äºš', city: 'åœ°æ‹‰é‚£', longitude: 19.8186, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ä¹Œå…‹å…°', city: 'åŸºè¾…', longitude: 30.5234, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ç™½ä¿„ç½—æ–¯', city: 'æ˜æ–¯å…‹', longitude: 27.5615, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'ç«‹é™¶å®›', city: 'ç»´å°”çº½æ–¯', longitude: 25.2797, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æ‹‰è„±ç»´äºš', city: 'é‡ŒåŠ ', longitude: 24.1052, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'çˆ±æ²™å°¼äºš', city: 'å¡”æ—', longitude: 24.7536, isCapital: true},
    {continent: 'æ¬§æ´²', country: 'æ‘©å°”å¤šç“¦', city: 'åŸºå¸Œè®·ä¹Œ', longitude: 28.8575, isCapital: true},
    
    // éæ´²
    {continent: 'éæ´²', country: 'åŸƒåŠ', city: 'å¼€ç½—', longitude: 31.2357, isCapital: true},
    {continent: 'éæ´²', country: 'åŸƒåŠ', city: 'äºšå†å±±å¤§', longitude: 29.9158, isCapital: false},
    {continent: 'éæ´²', country: 'åˆ©æ¯”äºš', city: 'çš„é»æ³¢é‡Œ', longitude: 13.1913, isCapital: true},
    {continent: 'éæ´²', country: 'çªå°¼æ–¯', city: 'çªå°¼æ–¯', longitude: 10.1815, isCapital: true},
    {continent: 'éæ´²', country: 'é˜¿å°”åŠåˆ©äºš', city: 'é˜¿å°”åŠå°”', longitude: 3.0588, isCapital: true},
    {continent: 'éæ´²', country: 'æ‘©æ´›å“¥', city: 'æ‹‰å·´ç‰¹', longitude: -6.8498, isCapital: true},
    {continent: 'éæ´²', country: 'æ‘©æ´›å“¥', city: 'å¡è¨å¸ƒå…°å¡', longitude: -7.5898, isCapital: false},
    {continent: 'éæ´²', country: 'è‹ä¸¹', city: 'å–€åœŸç©†', longitude: 32.5599, isCapital: true},
    {continent: 'éæ´²', country: 'åŸƒå¡ä¿„æ¯”äºš', city: 'äºšçš„æ–¯äºšè´å·´', longitude: 38.7469, isCapital: true},
    {continent: 'éæ´²', country: 'è‚¯å°¼äºš', city: 'å†…ç½—æ¯•', longitude: 36.8219, isCapital: true},
    {continent: 'éæ´²', country: 'å¦æ¡‘å°¼äºš', city: 'è¾¾ç´¯æ–¯è¨æ‹‰å§†', longitude: 39.2083, isCapital: true},
    {continent: 'éæ´²', country: 'ä¹Œå¹²è¾¾', city: 'åå¸•æ‹‰', longitude: 32.5822, isCapital: true},
    {continent: 'éæ´²', country: 'å¢æ—ºè¾¾', city: 'åŸºåŠ åˆ©', longitude: 30.0619, isCapital: true},
    {continent: 'éæ´²', country: 'åˆšæœ(é‡‘)', city: 'é‡‘æ²™è¨', longitude: 15.2663, isCapital: true},
    {continent: 'éæ´²', country: 'åˆšæœ(å¸ƒ)', city: 'å¸ƒæ‹‰æŸ´ç»´å°”', longitude: 15.2832, isCapital: true},
    {continent: 'éæ´²', country: 'åŠ è“¬', city: 'åˆ©ä¼¯ç»´å°”', longitude: 9.4673, isCapital: true},
    {continent: 'éæ´²', country: 'å–€éº¦éš†', city: 'é›…æ¸©å¾—', longitude: 11.5021, isCapital: true},
    {continent: 'éæ´²', country: 'å°¼æ—¥åˆ©äºš', city: 'é˜¿å¸ƒè´¾', longitude: 7.4951, isCapital: true},
    {continent: 'éæ´²', country: 'å°¼æ—¥åˆ©äºš', city: 'æ‹‰å„æ–¯', longitude: 3.3792, isCapital: false},
    {continent: 'éæ´²', country: 'åŠ çº³', city: 'é˜¿å…‹æ‹‰', longitude: -0.1869, isCapital: true},
    {continent: 'éæ´²', country: 'ç§‘ç‰¹è¿ªç“¦', city: 'äºšç©†è‹å…‹ç½—', longitude: -5.2893, isCapital: true},
    {continent: 'éæ´²', country: 'å¡å†…åŠ å°”', city: 'è¾¾å–€å°”', longitude: -17.4677, isCapital: true},
    {continent: 'éæ´²', country: 'é©¬é‡Œ', city: 'å·´é©¬ç§‘', longitude: -8.0029, isCapital: true},
    {continent: 'éæ´²', country: 'å¸ƒåŸºçº³æ³•ç´¢', city: 'ç“¦åŠ æœå¤', longitude: -1.5197, isCapital: true},
    {continent: 'éæ´²', country: 'å°¼æ—¥å°”', city: 'å°¼äºšç¾', longitude: 2.1058, isCapital: true},
    {continent: 'éæ´²', country: 'ä¹å¾—', city: 'æ©è´¾æ¢…çº³', longitude: 15.0442, isCapital: true},
    {continent: 'éæ´²', country: 'å—é', city: 'æ¯”å‹’é™€åˆ©äºš', longitude: 28.2293, isCapital: true},
    {continent: 'éæ´²', country: 'å—é', city: 'å¼€æ™®æ•¦', longitude: 18.4241, isCapital: false},
    {continent: 'éæ´²', country: 'å—é', city: 'çº¦ç¿°å†…æ–¯å ¡', longitude: 28.0473, isCapital: false},
    {continent: 'éæ´²', country: 'æ´¥å·´å¸ƒéŸ¦', city: 'å“ˆæ‹‰é›·', longitude: 31.0333, isCapital: true},
    {continent: 'éæ´²', country: 'åšèŒ¨ç“¦çº³', city: 'å“ˆåšç½—å†…', longitude: 25.9157, isCapital: true},
    {continent: 'éæ´²', country: 'çº³ç±³æ¯”äºš', city: 'æ¸©å¾—å’Œå…‹', longitude: 17.0832, isCapital: true},
    {continent: 'éæ´²', country: 'å®‰å“¥æ‹‰', city: 'ç½—å®‰è¾¾', longitude: 13.2344, isCapital: true},
    {continent: 'éæ´²', country: 'èµæ¯”äºš', city: 'å¢è¨å¡', longitude: 28.3228, isCapital: true},
    {continent: 'éæ´²', country: 'è«æ¡‘æ¯”å…‹', city: 'é©¬æ™®æ‰˜', longitude: 32.5739, isCapital: true},
    {continent: 'éæ´²', country: 'é©¬è¾¾åŠ æ–¯åŠ ', city: 'å¡”é‚£é‚£åˆ©ä½›', longitude: 47.5361, isCapital: true},
    {continent: 'éæ´²', country: 'æ¯›é‡Œæ±‚æ–¯', city: 'è·¯æ˜“æ¸¯', longitude: 57.5522, isCapital: true},
    
    // åŒ—ç¾æ´²
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'åç››é¡¿', longitude: -77.0369, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'çº½çº¦', longitude: -74.0060, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'æ´›æ‰çŸ¶', longitude: -118.2437, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'èŠåŠ å“¥', longitude: -87.6298, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'ä¼‘æ–¯é¡¿', longitude: -95.3698, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'æ—§é‡‘å±±', longitude: -122.4194, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'åŠ æ‹¿å¤§', city: 'æ¸¥å¤ªå', longitude: -75.6972, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'åŠ æ‹¿å¤§', city: 'å¤šä¼¦å¤š', longitude: -79.3832, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'åŠ æ‹¿å¤§', city: 'æ¸©å“¥å', longitude: -123.1216, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'åŠ æ‹¿å¤§', city: 'è’™ç‰¹åˆ©å°”', longitude: -73.5673, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'å¢¨è¥¿å“¥', city: 'å¢¨è¥¿å“¥åŸ', longitude: -99.1332, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'å¢¨è¥¿å“¥', city: 'ç“œè¾¾æ‹‰å“ˆæ‹‰', longitude: -103.3496, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'å¤å·´', city: 'å“ˆç“¦é‚£', longitude: -82.3666, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'ç‰™ä¹°åŠ ', city: 'é‡‘æ–¯æ•¦', longitude: -76.7936, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'æµ·åœ°', city: 'å¤ªå­æ¸¯', longitude: -72.3350, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'å¤šç±³å°¼åŠ ', city: 'åœ£å¤šæ˜å„', longitude: -69.9312, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'å“¥æ–¯è¾¾é»åŠ ', city: 'åœ£ä½•å¡', longitude: -84.0907, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'å·´æ‹¿é©¬', city: 'å·´æ‹¿é©¬åŸ', longitude: -79.5199, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'å±åœ°é©¬æ‹‰', city: 'å±åœ°é©¬æ‹‰åŸ', longitude: -90.5069, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'æ´ªéƒ½æ‹‰æ–¯', city: 'ç‰¹å¤è¥¿åŠ å°”å·´', longitude: -87.2044, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'å°¼åŠ æ‹‰ç“œ', city: 'é©¬é‚£ç“œ', longitude: -86.2514, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'è¨å°”ç“¦å¤š', city: 'åœ£è¨å°”ç“¦å¤š', longitude: -89.1872, isCapital: true},
    {continent: 'åŒ—ç¾æ´²', country: 'ä¼¯åˆ©å…¹', city: 'è´å°”è«æ½˜', longitude: -88.7670, isCapital: true},
    
    // å—ç¾æ´²
    {continent: 'å—ç¾æ´²', country: 'å·´è¥¿', city: 'å·´è¥¿åˆ©äºš', longitude: -47.8825, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'å·´è¥¿', city: 'åœ£ä¿ç½—', longitude: -46.6333, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'å·´è¥¿', city: 'é‡Œçº¦çƒ­å†…å¢', longitude: -43.1729, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'é˜¿æ ¹å»·', city: 'å¸ƒå®œè¯ºæ–¯è‰¾åˆ©æ–¯', longitude: -58.3816, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'æ™ºåˆ©', city: 'åœ£åœ°äºšå“¥', longitude: -70.6483, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'ç§˜é²', city: 'åˆ©é©¬', longitude: -77.0428, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'å“¥ä¼¦æ¯”äºš', city: 'æ³¢å“¥å¤§', longitude: -74.0721, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'å§”å†…ç‘æ‹‰', city: 'åŠ æ‹‰åŠ æ–¯', longitude: -66.9036, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'å„ç“œå¤šå°”', city: 'åŸºå¤š', longitude: -78.4678, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'ç»åˆ©ç»´äºš', city: 'æ‹‰å·´æ–¯', longitude: -68.1193, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'å·´æ‹‰åœ­', city: 'äºšæ¾æ£®', longitude: -57.5759, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'ä¹Œæ‹‰åœ­', city: 'è’™å¾—ç»´çš„äºš', longitude: -56.1645, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'åœ­äºšé‚£', city: 'ä¹”æ²»æ•¦', longitude: -58.1551, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'è‹é‡Œå—', city: 'å¸•æ‹‰é©¬é‡Œåš', longitude: -55.1678, isCapital: true},
    {continent: 'å—ç¾æ´²', country: 'æ³•å±åœ­äºšé‚£', city: 'å¡å®´', longitude: -52.3333, isCapital: true},
    
    // å¤§æ´‹æ´²
    {continent: 'å¤§æ´‹æ´²', country: 'æ¾³å¤§åˆ©äºš', city: 'å ªåŸ¹æ‹‰', longitude: 149.1300, isCapital: true},
    {continent: 'å¤§æ´‹æ´²', country: 'æ¾³å¤§åˆ©äºš', city: 'æ‚‰å°¼', longitude: 151.2093, isCapital: false},
    {continent: 'å¤§æ´‹æ´²', country: 'æ¾³å¤§åˆ©äºš', city: 'å¢¨å°”æœ¬', longitude: 144.9631, isCapital: false},
    {continent: 'å¤§æ´‹æ´²', country: 'æ–°è¥¿å…°', city: 'æƒ çµé¡¿', longitude: 174.7762, isCapital: true},
    {continent: 'å¤§æ´‹æ´²', country: 'æ–°è¥¿å…°', city: 'å¥¥å…‹å…°', longitude: 174.7633, isCapital: false},
    {continent: 'å¤§æ´‹æ´²', country: 'å·´å¸ƒäºšæ–°å‡ å†…äºš', city: 'è«å°”å…¹æ¯”æ¸¯', longitude: 147.1800, isCapital: true},
    {continent: 'å¤§æ´‹æ´²', country: 'æ–æµ', city: 'è‹ç“¦', longitude: 178.4501, isCapital: true},
    {continent: 'å¤§æ´‹æ´²', country: 'æ±¤åŠ ', city: 'åŠªåº“é˜¿æ´›æ³•', longitude: -175.1982, isCapital: true},
    {continent: 'å¤§æ´‹æ´²', country: 'è¨æ‘©äºš', city: 'é˜¿çš®äºš', longitude: -171.7514, isCapital: true},
    {continent: 'å¤§æ´‹æ´²', country: 'ç“¦åŠªé˜¿å›¾', city: 'ç»´æ‹‰æ¸¯', longitude: 166.9592, isCapital: true},
    {continent: 'å¤§æ´‹æ´²', country: 'æ–°å–€é‡Œå¤šå°¼äºš', city: 'åŠªç¾é˜¿', longitude: 166.4590, isCapital: true},
    {continent: 'å¤§æ´‹æ´²', country: 'æ¾³å¤§åˆ©äºš', city: 'å¸ƒé‡Œæ–¯ç­', longitude: 153.0251, isCapital: false},
    {continent: 'å¤§æ´‹æ´²', country: 'æ¾³å¤§åˆ©äºš', city: 'ç€æ–¯', longitude: 115.8605, isCapital: false},
    {continent: 'å¤§æ´‹æ´²', country: 'æ¾³å¤§åˆ©äºš', city: 'é˜¿å¾·è±å¾·', longitude: 138.6007, isCapital: false},
    
    // è¡¥å……äºšæ´²çŸ¥ååŸå¸‚
    {continent: 'äºšæ´²', country: 'ä¸­å›½', city: 'é¦™æ¸¯', longitude: 114.1694, isCapital: false},
    {continent: 'äºšæ´²', country: 'ä¸­å›½', city: 'æ¾³é—¨', longitude: 113.5491, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ—¥æœ¬', city: 'ç¦å†ˆ', longitude: 130.4017, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ—¥æœ¬', city: 'æœ­å¹Œ', longitude: 141.3544, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ—¥æœ¬', city: 'ç¥æˆ·', longitude: 135.1950, isCapital: false},
    {continent: 'äºšæ´²', country: 'éŸ©å›½', city: 'ä»å·', longitude: 126.7052, isCapital: false},
    {continent: 'äºšæ´²', country: 'éŸ©å›½', city: 'å…‰å·', longitude: 126.8536, isCapital: false},
    {continent: 'äºšæ´²', country: 'å°åº¦', city: 'æµ·å¾·æ‹‰å·´', longitude: 78.4867, isCapital: false},
    {continent: 'äºšæ´²', country: 'å°åº¦', city: 'é‡‘å¥ˆ', longitude: 80.2707, isCapital: false},
    {continent: 'äºšæ´²', country: 'å°åº¦', city: 'æµ¦é‚£', longitude: 73.8567, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ³°å›½', city: 'æ™®å‰', longitude: 98.3983, isCapital: false},
    {continent: 'äºšæ´²', country: 'é©¬æ¥è¥¿äºš', city: 'é©¬å…­ç”²', longitude: 102.2510, isCapital: false},
    {continent: 'äºšæ´²', country: 'å°åº¦å°¼è¥¿äºš', city: 'å·´å˜å²›', longitude: 115.1889, isCapital: false},
    {continent: 'äºšæ´²', country: 'å°åº¦å°¼è¥¿äºš', city: 'ä¸‡éš†', longitude: 107.6186, isCapital: false},
    {continent: 'äºšæ´²', country: 'è²å¾‹å®¾', city: 'è¾¾æ²ƒ', longitude: 125.6122, isCapital: false},
    {continent: 'äºšæ´²', country: 'è¶Šå—', city: 'å²˜æ¸¯', longitude: 108.2208, isCapital: false},
    {continent: 'äºšæ´²', country: 'åœŸè€³å…¶', city: 'ä¼Šå…¹å¯†å°”', longitude: 27.1428, isCapital: false},
    {continent: 'äºšæ´²', country: 'åœŸè€³å…¶', city: 'å®‰å¡”åˆ©äºš', longitude: 30.7133, isCapital: false},
    {continent: 'äºšæ´²', country: 'ä»¥è‰²åˆ—', city: 'æµ·æ³•', longitude: 34.9896, isCapital: false},
    {continent: 'äºšæ´²', country: 'é˜¿è”é…‹', city: 'æ²™è¿¦', longitude: 55.3911, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ²™ç‰¹é˜¿æ‹‰ä¼¯', city: 'éº¦åŠ ', longitude: 39.8579, isCapital: false},
    {continent: 'äºšæ´²', country: 'æ²™ç‰¹é˜¿æ‹‰ä¼¯', city: 'éº¦åœ°é‚£', longitude: 39.6142, isCapital: false},
    {continent: 'äºšæ´²', country: 'ä¼Šæœ—', city: 'è®¾æ‹‰å­', longitude: 52.5314, isCapital: false},
    {continent: 'äºšæ´²', country: 'ä¼Šæœ—', city: 'é©¬ä»€å“ˆå¾·', longitude: 59.6062, isCapital: false},
    
    // è¡¥å……æ¬§æ´²çŸ¥ååŸå¸‚
    {continent: 'æ¬§æ´²', country: 'è‹±å›½', city: 'åˆ©ç‰©æµ¦', longitude: -2.9916, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è‹±å›½', city: 'çˆ±ä¸å ¡', longitude: -3.1883, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è‹±å›½', city: 'æ ¼æ‹‰æ–¯å“¥', longitude: -4.2514, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ³•å›½', city: 'å°¼æ–¯', longitude: 7.2619, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ³•å›½', city: 'å›¾å¢å…¹', longitude: 1.4442, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ³•å›½', city: 'æ³¢å°”å¤š', longitude: -0.5792, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ³•å›½', city: 'é‡Œå°”', longitude: 3.0573, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å¾·å›½', city: 'æ³•å…°å…‹ç¦', longitude: 8.6821, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å¾·å›½', city: 'ç§‘éš†', longitude: 6.9603, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å¾·å›½', city: 'æ–¯å›¾åŠ ç‰¹', longitude: 9.1815, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å¾·å›½', city: 'æœå¡å°”å¤šå¤«', longitude: 6.7735, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ„å¤§åˆ©', city: 'å¨å°¼æ–¯', longitude: 12.3155, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ„å¤§åˆ©', city: 'ä½›ç½—ä¼¦è¨', longitude: 11.2558, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ„å¤§åˆ©', city: 'éƒ½çµ', longitude: 7.6869, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ„å¤§åˆ©', city: 'çƒ­é‚£äºš', longitude: 8.9463, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è¥¿ç­ç‰™', city: 'ç“¦ä¼¦è¥¿äºš', longitude: -0.3774, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è¥¿ç­ç‰™', city: 'å¡ç»´åˆ©äºš', longitude: -5.9845, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è¥¿ç­ç‰™', city: 'æ ¼æ‹‰çº³è¾¾', longitude: -3.5986, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è·å…°', city: 'æµ·ç‰™', longitude: 4.3007, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è·å…°', city: 'ä¹Œå¾—å‹’æ”¯', longitude: 5.1214, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ¯”åˆ©æ—¶', city: 'å®‰ç‰¹å«æ™®', longitude: 4.4025, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ¯”åˆ©æ—¶', city: 'æ ¹ç‰¹', longitude: 3.7174, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'ç‘å£«', city: 'æ—¥å†…ç“¦', longitude: 6.1432, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'ç‘å£«', city: 'å·´å¡å°”', longitude: 7.5886, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å¥¥åœ°åˆ©', city: 'è¨å°”èŒ¨å ¡', longitude: 13.0550, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'ç‘å…¸', city: 'å“¥å¾·å ¡', longitude: 11.9746, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'ç‘å…¸', city: 'é©¬å°”é»˜', longitude: 13.0007, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æŒªå¨', city: 'å‘å°”æ ¹', longitude: 5.3230, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'ä¸¹éº¦', city: 'å¥¥èƒ¡æ–¯', longitude: 10.2039, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å¸Œè…Š', city: 'å¡è¨æ´›å°¼åŸº', longitude: 22.9444, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'è‘¡è„ç‰™', city: 'æ³¢å°”å›¾', longitude: -8.6291, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'ä¿„ç½—æ–¯', city: 'æ–°è¥¿ä¼¯åˆ©äºš', longitude: 82.9346, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'ä¿„ç½—æ–¯', city: 'å¶å¡æ·ç³å ¡', longitude: 60.6122, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'ä¿„ç½—æ–¯', city: 'ä¸‹è¯ºå¤«å“¥ç½—å¾·', longitude: 44.0020, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ³¢å…°', city: 'å…‹æ‹‰ç§‘å¤«', longitude: 19.9445, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ³¢å…°', city: 'æ ¼ä½†æ–¯å…‹', longitude: 18.6466, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'æ·å…‹', city: 'å¸ƒå°”è¯º', longitude: 16.6068, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'åŒˆç‰™åˆ©', city: 'å¾·å¸ƒå‹’æ£®', longitude: 21.6210, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'ç½—é©¬å°¼äºš', city: 'å…‹å¢æ—¥', longitude: 23.5800, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å…‹ç½—åœ°äºš', city: 'æœå¸ƒç½—å¤«å°¼å…‹', longitude: 18.0944, isCapital: false},
    {continent: 'æ¬§æ´²', country: 'å…‹ç½—åœ°äºš', city: 'æ–¯æ™®åˆ©ç‰¹', longitude: 16.4402, isCapital: false},
    
    // è¡¥å……åŒ—ç¾æ´²çŸ¥ååŸå¸‚
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'è´¹åŸ', longitude: -75.1652, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'å‡¤å‡°åŸ', longitude: -112.0740, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'åœ£å®‰ä¸œå°¼å¥¥', longitude: -98.4936, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'åœ£åœ°äºšå“¥', longitude: -117.1611, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'è¾¾æ‹‰æ–¯', longitude: -96.7970, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'åœ£ä½•å¡', longitude: -121.8863, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'å¥¥æ–¯æ±€', longitude: -97.7431, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'æ°å…‹é€Šç»´å°”', longitude: -81.6557, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'æ—§é‡‘å±±', longitude: -122.4194, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'å“¥ä¼¦å¸ƒ', longitude: -82.9988, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'å¤æ´›ç‰¹', longitude: -80.8431, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'è¥¿é›…å›¾', longitude: -122.3321, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'ä¸¹ä½›', longitude: -104.9903, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'æ³¢å£«é¡¿', longitude: -71.0589, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'åº•ç‰¹å¾‹', longitude: -83.0458, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'æ‹‰æ–¯ç»´åŠ æ–¯', longitude: -115.1398, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'è¿ˆé˜¿å¯†', longitude: -80.1918, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'ç¾å›½', city: 'äºšç‰¹å…°å¤§', longitude: -84.3880, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'åŠ æ‹¿å¤§', city: 'å¡å°”åŠ é‡Œ', longitude: -114.0719, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'åŠ æ‹¿å¤§', city: 'åŸƒå¾·è’™é¡¿', longitude: -113.4909, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'åŠ æ‹¿å¤§', city: 'æ¸©å°¼ä¼¯', longitude: -97.1385, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'åŠ æ‹¿å¤§', city: 'é­åŒ—å…‹', longitude: -71.2080, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'å¢¨è¥¿å“¥', city: 'è’™ç‰¹é›·', longitude: -100.3161, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'å¢¨è¥¿å“¥', city: 'æ™®åŸƒå¸ƒæ‹‰', longitude: -98.2063, isCapital: false},
    {continent: 'åŒ—ç¾æ´²', country: 'å¤å·´', city: 'åœ£åœ°äºšå“¥', longitude: -75.8153, isCapital: false},
    
    // è¡¥å……å—ç¾æ´²çŸ¥ååŸå¸‚
    {continent: 'å—ç¾æ´²', country: 'å·´è¥¿', city: 'è¨å°”ç“¦å¤š', longitude: -38.4813, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'å·´è¥¿', city: 'ç¦å¡”é›·è¨', longitude: -38.5247, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'å·´è¥¿', city: 'è´æ´›å¥¥é‡Œè—ç‰¹', longitude: -43.9378, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'å·´è¥¿', city: 'åº“é‡Œè’‚å·´', longitude: -49.2733, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'é˜¿æ ¹å»·', city: 'ç§‘å°”å¤šç“¦', longitude: -64.1811, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'é˜¿æ ¹å»·', city: 'ç½—è¨é‡Œå¥¥', longitude: -60.6393, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'æ™ºåˆ©', city: 'ç“¦å°”å¸•è±ç´¢', longitude: -71.6167, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'ç§˜é²', city: 'åº“æ–¯ç§‘', longitude: -71.9675, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'ç§˜é²', city: 'é˜¿é›·åŸºå¸•', longitude: -71.5350, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'å“¥ä¼¦æ¯”äºš', city: 'éº¦å¾·æ—', longitude: -75.5636, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'å“¥ä¼¦æ¯”äºš', city: 'å¡åˆ©', longitude: -76.5220, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'å§”å†…ç‘æ‹‰', city: 'é©¬æ‹‰å¼€æ³¢', longitude: -71.6125, isCapital: false},
    {continent: 'å—ç¾æ´²', country: 'å„ç“œå¤šå°”', city: 'ç“œäºšåŸºå°”', longitude: -79.8882, isCapital: false},
    
    // è¡¥å……éæ´²çŸ¥ååŸå¸‚
    {continent: 'éæ´²', country: 'åŸƒåŠ', city: 'å¢å…‹ç´¢', longitude: 32.6396, isCapital: false},
    {continent: 'éæ´²', country: 'å—é', city: 'å¾·ç­', longitude: 31.0292, isCapital: false},
    {continent: 'éæ´²', country: 'æ‘©æ´›å“¥', city: 'é©¬æ‹‰å–€ä»€', longitude: -7.9811, isCapital: false},
    {continent: 'éæ´²', country: 'æ‘©æ´›å“¥', city: 'éæ–¯', longitude: -4.9778, isCapital: false},
    {continent: 'éæ´²', country: 'è‚¯å°¼äºš', city: 'è’™å·´è¨', longitude: 39.6682, isCapital: false},
    {continent: 'éæ´²', country: 'å¦æ¡‘å°¼äºš', city: 'æ¡‘ç»™å·´å°”', longitude: 39.1943, isCapital: false},
    {continent: 'éæ´²', country: 'å¡å†…åŠ å°”', city: 'åœ£è·¯æ˜“', longitude: -16.4894, isCapital: false},
    {continent: 'éæ´²', country: 'åŠ çº³', city: 'åº“é©¬è¥¿', longitude: -1.6244, isCapital: false},
    {continent: 'éæ´²', country: 'å°¼æ—¥åˆ©äºš', city: 'å¡è¯º', longitude: 8.5167, isCapital: false},
    {continent: 'éæ´²', country: 'å°¼æ—¥åˆ©äºš', city: 'ä¼Šå·´ä¸¹', longitude: 3.8964, isCapital: false},
    {continent: 'éæ´²', country: 'åŸƒå¡ä¿„æ¯”äºš', city: 'è´¡å¾·å°”', longitude: 37.4667, isCapital: false},
    {continent: 'éæ´²', country: 'æ´¥å·´å¸ƒéŸ¦', city: 'å¸ƒæ‹‰ç“¦çº¦', longitude: 28.5903, isCapital: false}
];

// ==================== åŸå¸‚é€‰æ‹©åŠŸèƒ½ ====================
function initCitySelector() {
    var cityInput = document.getElementById('city-input');
    var cityDropdown = document.getElementById('city-dropdown');
    var provinceSelect = document.getElementById('province-select');
    var citySelect = document.getElementById('city-select');
    var lonInput = document.getElementById('lon');
    
    if(!cityInput || !cityDropdown || !lonInput || !provinceSelect || !citySelect) return;
    
    var selectedIndex = -1;
    var filteredCities = [];
    
    // è·å–æ‰€æœ‰çœä»½åˆ—è¡¨
    function getAllProvinces() {
        var provinces = [];
        var provinceSet = new Set();
        CITY_DATABASE.forEach(function(city) {
            if(!provinceSet.has(city.province)) {
                provinceSet.add(city.province);
                provinces.push(city.province);
            }
        });
        return provinces.sort();
    }
    
    // æ ¹æ®çœä»½è·å–åŸå¸‚åˆ—è¡¨
    function getCitiesByProvince(province) {
        if(!province) return [];
        return CITY_DATABASE.filter(function(city) {
            return city.province === province;
        }).sort(function(a, b) {
            return a.name.localeCompare(b.name);
        });
    }
    
    // åˆå§‹åŒ–çœä»½ä¸‹æ‹‰æ¡†
    var provinces = getAllProvinces();
    provinces.forEach(function(province) {
        var option = document.createElement('option');
        option.value = province;
        option.textContent = province;
        provinceSelect.appendChild(option);
    });
    
    // çœä»½é€‰æ‹©å˜åŒ–äº‹ä»¶
    provinceSelect.addEventListener('change', function() {
        var selectedProvince = this.value;
        citySelect.innerHTML = '<option value="">è¯·é€‰æ‹©åŸå¸‚</option>';
        
        if(selectedProvince) {
            citySelect.disabled = false;
            var cities = getCitiesByProvince(selectedProvince);
            cities.forEach(function(city) {
                var option = document.createElement('option');
                option.value = city.name;
                option.textContent = city.name;
                option.setAttribute('data-longitude', city.longitude);
                citySelect.appendChild(option);
            });
        } else {
            citySelect.disabled = true;
        }
    });
    
    // åŸå¸‚é€‰æ‹©å˜åŒ–äº‹ä»¶
    citySelect.addEventListener('change', function() {
        var selectedCityName = this.value;
        if(selectedCityName) {
            var selectedProvince = provinceSelect.value;
            var cities = getCitiesByProvince(selectedProvince);
            var selectedCity = cities.find(function(city) {
                return city.name === selectedCityName;
            });
            
            if(selectedCity) {
                cityInput.value = selectedCity.province + ' ' + selectedCity.name;
                lonInput.value = selectedCity.longitude.toFixed(4);
            }
        }
    });
    
    // è¿‡æ»¤åŸå¸‚
    function filterCities(keyword) {
        if(!keyword || keyword.trim() === '') {
            return [];
        }
        keyword = keyword.trim().toLowerCase();
        return CITY_DATABASE.filter(function(city) {
            return city.name.toLowerCase().indexOf(keyword) >= 0 || 
                   city.province.toLowerCase().indexOf(keyword) >= 0 ||
                   (city.province + city.name).toLowerCase().indexOf(keyword) >= 0;
        }).slice(0, 50); // æœ€å¤šæ˜¾ç¤º50ä¸ªç»“æœ
    }
    
    // æ˜¾ç¤ºä¸‹æ‹‰åˆ—è¡¨
    function showDropdown(cities) {
        if(cities.length === 0) {
            cityDropdown.style.display = 'none';
            return;
        }
        
        cityDropdown.innerHTML = '';
        filteredCities = cities;
        selectedIndex = -1;
        
        cities.forEach(function(city, index) {
            var item = document.createElement('div');
            item.style.cssText = 'padding: 8px 12px; cursor: pointer; border-bottom: 1px solid #f0f0f0;';
            item.innerHTML = '<strong>' + city.name + '</strong> <span style="color: #999; font-size: 12px;">' + city.province + '</span>';
            
            item.onmouseenter = function() {
                item.style.backgroundColor = '#f5f5f5';
            };
            item.onmouseleave = function() {
                item.style.backgroundColor = 'white';
            };
            item.onclick = function() {
                selectCity(city);
            };
            
            cityDropdown.appendChild(item);
        });
        
        cityDropdown.style.display = 'block';
    }
    
    // é€‰æ‹©åŸå¸‚
    function selectCity(city) {
        cityInput.value = city.province + ' ' + city.name;
        lonInput.value = city.longitude.toFixed(4);
        cityDropdown.style.display = 'none';
        selectedIndex = -1;
        
        // åŒæ­¥æ›´æ–°ä¸‹æ‹‰æ¡†é€‰æ‹©
        provinceSelect.value = city.province;
        if(provinceSelect.value) {
            // è§¦å‘çœä»½é€‰æ‹©äº‹ä»¶ä»¥æ›´æ–°åŸå¸‚åˆ—è¡¨
            var event = new Event('change');
            provinceSelect.dispatchEvent(event);
            // è®¾ç½®åŸå¸‚é€‰æ‹©
            setTimeout(function() {
                citySelect.value = city.name;
            }, 0);
        }
    }
    
    // è¾“å…¥äº‹ä»¶
    cityInput.addEventListener('input', function(e) {
        var keyword = e.target.value;
        var cities = filterCities(keyword);
        showDropdown(cities);
    });
    
    // é”®ç›˜äº‹ä»¶
    cityInput.addEventListener('keydown', function(e) {
        if(cityDropdown.style.display === 'none') return;
        
        var items = cityDropdown.children;
        if(items.length === 0) return;
        
        if(e.key === 'ArrowDown') {
            e.preventDefault();
            selectedIndex = (selectedIndex + 1) % items.length;
            items[selectedIndex].scrollIntoView({block: 'nearest'});
            items[selectedIndex].style.backgroundColor = '#e3f2fd';
            if(selectedIndex > 0) {
                items[selectedIndex - 1].style.backgroundColor = 'white';
            } else {
                items[items.length - 1].style.backgroundColor = 'white';
            }
        } else if(e.key === 'ArrowUp') {
            e.preventDefault();
            selectedIndex = selectedIndex <= 0 ? items.length - 1 : selectedIndex - 1;
            items[selectedIndex].scrollIntoView({block: 'nearest'});
            items[selectedIndex].style.backgroundColor = '#e3f2fd';
            if(selectedIndex < items.length - 1) {
                items[selectedIndex + 1].style.backgroundColor = 'white';
            } else {
                items[0].style.backgroundColor = 'white';
            }
        } else if(e.key === 'Enter') {
            e.preventDefault();
            if(selectedIndex >= 0 && selectedIndex < filteredCities.length) {
                selectCity(filteredCities[selectedIndex]);
            }
        } else if(e.key === 'Escape') {
            cityDropdown.style.display = 'none';
            selectedIndex = -1;
        }
    });
    
    // ç‚¹å‡»å¤–éƒ¨å…³é—­ä¸‹æ‹‰åˆ—è¡¨
    document.addEventListener('click', function(e) {
        if(!cityInput.contains(e.target) && !cityDropdown.contains(e.target)) {
            cityDropdown.style.display = 'none';
        }
    });
}

// ==================== å›½å¤–åŸå¸‚é€‰æ‹©åŠŸèƒ½ ====================
function initForeignCitySelector() {
    var foreignCityInput = document.getElementById('foreign-city-input');
    var foreignCityDropdown = document.getElementById('foreign-city-dropdown');
    var continentSelect = document.getElementById('continent-select');
    var countrySelect = document.getElementById('country-select');
    var foreignCitySelect = document.getElementById('foreign-city-select');
    var lonInput = document.getElementById('lon');
    
    if(!foreignCityInput || !foreignCityDropdown || !lonInput || !continentSelect || !countrySelect || !foreignCitySelect) return;
    
    var selectedIndex = -1;
    var filteredCities = [];
    
    // è·å–æ‰€æœ‰å¤§æ´²åˆ—è¡¨
    function getAllContinents() {
        var continents = [];
        var continentSet = new Set();
        FOREIGN_CITY_DATABASE.forEach(function(city) {
            if(!continentSet.has(city.continent)) {
                continentSet.add(city.continent);
                continents.push(city.continent);
            }
        });
        return continents.sort();
    }
    
    // æ ¹æ®å¤§æ´²è·å–å›½å®¶åˆ—è¡¨
    function getCountriesByContinent(continent) {
        if(!continent) return [];
        var countries = [];
        var countrySet = new Set();
        FOREIGN_CITY_DATABASE.forEach(function(city) {
            if(city.continent === continent && !countrySet.has(city.country)) {
                countrySet.add(city.country);
                countries.push(city.country);
            }
        });
        return countries.sort();
    }
    
    // æ ¹æ®å¤§æ´²å’Œå›½å®¶è·å–åŸå¸‚åˆ—è¡¨
    function getCitiesByContinentAndCountry(continent, country) {
        if(!continent || !country) return [];
        return FOREIGN_CITY_DATABASE.filter(function(city) {
            return city.continent === continent && city.country === country;
        }).sort(function(a, b) {
            // é¦–éƒ½ä¼˜å…ˆæ˜¾ç¤º
            if(a.isCapital && !b.isCapital) return -1;
            if(!a.isCapital && b.isCapital) return 1;
            return a.city.localeCompare(b.city);
        });
    }
    
    // åˆå§‹åŒ–å¤§æ´²ä¸‹æ‹‰æ¡†
    var continents = getAllContinents();
    continents.forEach(function(continent) {
        var option = document.createElement('option');
        option.value = continent;
        option.textContent = continent;
        continentSelect.appendChild(option);
    });
    
    // å¤§æ´²é€‰æ‹©å˜åŒ–äº‹ä»¶
    continentSelect.addEventListener('change', function() {
        var selectedContinent = this.value;
        countrySelect.innerHTML = '<option value="">è¯·é€‰æ‹©å›½å®¶</option>';
        foreignCitySelect.innerHTML = '<option value="">è¯·é€‰æ‹©åŸå¸‚</option>';
        
        if(selectedContinent) {
            countrySelect.disabled = false;
            var countries = getCountriesByContinent(selectedContinent);
            countries.forEach(function(country) {
                var option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                countrySelect.appendChild(option);
            });
        } else {
            countrySelect.disabled = true;
            foreignCitySelect.disabled = true;
        }
    });
    
    // å›½å®¶é€‰æ‹©å˜åŒ–äº‹ä»¶
    countrySelect.addEventListener('change', function() {
        var selectedCountry = this.value;
        var selectedContinent = continentSelect.value;
        foreignCitySelect.innerHTML = '<option value="">è¯·é€‰æ‹©åŸå¸‚</option>';
        
        if(selectedCountry && selectedContinent) {
            foreignCitySelect.disabled = false;
            var cities = getCitiesByContinentAndCountry(selectedContinent, selectedCountry);
            cities.forEach(function(city) {
                var option = document.createElement('option');
                option.value = city.city;
                option.textContent = city.isCapital ? city.city + ' (é¦–éƒ½)' : city.city;
                option.setAttribute('data-longitude', city.longitude);
                foreignCitySelect.appendChild(option);
            });
        } else {
            foreignCitySelect.disabled = true;
        }
    });
    
    // åŸå¸‚é€‰æ‹©å˜åŒ–äº‹ä»¶
    foreignCitySelect.addEventListener('change', function() {
        var selectedCityName = this.value;
        if(selectedCityName) {
            var selectedContinent = continentSelect.value;
            var selectedCountry = countrySelect.value;
            var cities = getCitiesByContinentAndCountry(selectedContinent, selectedCountry);
            var selectedCity = cities.find(function(city) {
                return city.city === selectedCityName;
            });
            
            if(selectedCity) {
                foreignCityInput.value = selectedCity.continent + ' ' + selectedCity.country + ' ' + selectedCity.city;
                lonInput.value = selectedCity.longitude.toFixed(4);
            }
        }
    });
    
    // è¿‡æ»¤åŸå¸‚
    function filterForeignCities(keyword) {
        if(!keyword || keyword.trim() === '') {
            return [];
        }
        keyword = keyword.trim().toLowerCase();
        return FOREIGN_CITY_DATABASE.filter(function(city) {
            return city.city.toLowerCase().indexOf(keyword) >= 0 || 
                   city.country.toLowerCase().indexOf(keyword) >= 0 ||
                   city.continent.toLowerCase().indexOf(keyword) >= 0 ||
                   (city.continent + ' ' + city.country + ' ' + city.city).toLowerCase().indexOf(keyword) >= 0;
        }).slice(0, 50); // æœ€å¤šæ˜¾ç¤º50ä¸ªç»“æœ
    }
    
    // æ˜¾ç¤ºä¸‹æ‹‰åˆ—è¡¨
    function showForeignDropdown(cities) {
        if(cities.length === 0) {
            foreignCityDropdown.style.display = 'none';
            return;
        }
        
        foreignCityDropdown.innerHTML = '';
        filteredCities = cities;
        selectedIndex = -1;
        
        cities.forEach(function(city, index) {
            var item = document.createElement('div');
            item.style.cssText = 'padding: 8px 12px; cursor: pointer; border-bottom: 1px solid #f0f0f0;';
            var capitalLabel = city.isCapital ? ' <span style="color: #ff6b6b; font-size: 11px;">[é¦–éƒ½]</span>' : '';
            item.innerHTML = '<strong>' + city.city + '</strong>' + capitalLabel + ' <span style="color: #999; font-size: 12px;">' + city.country + ', ' + city.continent + '</span>';
            
            item.onmouseenter = function() {
                item.style.backgroundColor = '#f5f5f5';
            };
            item.onmouseleave = function() {
                item.style.backgroundColor = 'white';
            };
            item.onclick = function() {
                selectForeignCity(city);
            };
            
            foreignCityDropdown.appendChild(item);
        });
        
        foreignCityDropdown.style.display = 'block';
    }
    
    // é€‰æ‹©åŸå¸‚
    function selectForeignCity(city) {
        foreignCityInput.value = city.continent + ' ' + city.country + ' ' + city.city;
        lonInput.value = city.longitude.toFixed(4);
        foreignCityDropdown.style.display = 'none';
        selectedIndex = -1;
        
        // åŒæ­¥æ›´æ–°ä¸‹æ‹‰æ¡†é€‰æ‹©
        continentSelect.value = city.continent;
        if(continentSelect.value) {
            // è§¦å‘å¤§æ´²é€‰æ‹©äº‹ä»¶ä»¥æ›´æ–°å›½å®¶åˆ—è¡¨
            var event1 = new Event('change');
            continentSelect.dispatchEvent(event1);
            // è®¾ç½®å›½å®¶é€‰æ‹©
            setTimeout(function() {
                countrySelect.value = city.country;
                if(countrySelect.value) {
                    // è§¦å‘å›½å®¶é€‰æ‹©äº‹ä»¶ä»¥æ›´æ–°åŸå¸‚åˆ—è¡¨
                    var event2 = new Event('change');
                    countrySelect.dispatchEvent(event2);
                    // è®¾ç½®åŸå¸‚é€‰æ‹©
                    setTimeout(function() {
                        foreignCitySelect.value = city.city;
                    }, 0);
                }
            }, 0);
        }
    }
    
    // è¾“å…¥äº‹ä»¶
    foreignCityInput.addEventListener('input', function(e) {
        var keyword = e.target.value;
        var cities = filterForeignCities(keyword);
        showForeignDropdown(cities);
    });
    
    // é”®ç›˜äº‹ä»¶
    foreignCityInput.addEventListener('keydown', function(e) {
        if(foreignCityDropdown.style.display === 'none') return;
        
        var items = foreignCityDropdown.children;
        if(items.length === 0) return;
        
        if(e.key === 'ArrowDown') {
            e.preventDefault();
            selectedIndex = (selectedIndex + 1) % items.length;
            items[selectedIndex].scrollIntoView({block: 'nearest'});
            items[selectedIndex].style.backgroundColor = '#e3f2fd';
            if(selectedIndex > 0) {
                items[selectedIndex - 1].style.backgroundColor = 'white';
            } else {
                items[items.length - 1].style.backgroundColor = 'white';
            }
        } else if(e.key === 'ArrowUp') {
            e.preventDefault();
            selectedIndex = selectedIndex <= 0 ? items.length - 1 : selectedIndex - 1;
            items[selectedIndex].scrollIntoView({block: 'nearest'});
            items[selectedIndex].style.backgroundColor = '#e3f2fd';
            if(selectedIndex < items.length - 1) {
                items[selectedIndex + 1].style.backgroundColor = 'white';
            } else {
                items[0].style.backgroundColor = 'white';
            }
        } else if(e.key === 'Enter') {
            e.preventDefault();
            if(selectedIndex >= 0 && selectedIndex < filteredCities.length) {
                selectForeignCity(filteredCities[selectedIndex]);
            }
        } else if(e.key === 'Escape') {
            foreignCityDropdown.style.display = 'none';
            selectedIndex = -1;
        }
    });
    
    // ç‚¹å‡»å¤–éƒ¨å…³é—­ä¸‹æ‹‰åˆ—è¡¨
    document.addEventListener('click', function(e) {
        if(!foreignCityInput.contains(e.target) && !foreignCityDropdown.contains(e.target)) {
            foreignCityDropdown.style.display = 'none';
        }
    });
}

window.onload = function() {
    var ms = [document.getElementById('m'), document.getElementById('cm')];
    var ds = [document.getElementById('d'), document.getElementById('cd')];
    for(var i = 1; i <= 12; i++) {
        for(var j = 0; j < ms.length; j++) ms[j].add(new Option(i + 'æœˆ', i));
    }
    for(var i = 1; i <= 31; i++) {
        for(var j = 0; j < ds.length; j++) ds[j].add(new Option(i + 'æ—¥', i));
    }
    document.getElementById('m').value = 1;
    document.getElementById('d').value = 1;
    setNow();
    // åˆå§‹åŒ–åŸå¸‚é€‰æ‹©å™¨
    initCitySelector();
    // åˆå§‹åŒ–å›½å¤–åŸå¸‚é€‰æ‹©å™¨
    initForeignCitySelector();
};

function setNow() {
    var n = new Date();
    document.getElementById('cy').value = n.getFullYear();
    document.getElementById('cm').value = n.getMonth() + 1;
    document.getElementById('cd').value = n.getDate();
    document.getElementById('ch').value = n.getHours();
    document.getElementById('cmin').value = n.getMinutes();
}

// æ ¹æ®å¹´ä»½è·å–å¤©å¹²
function getGanFromYear(year) {
    var ganIdx = (year - 4) % 10;
    return GAN_NAMES[ganIdx];
}

// ==================== æŒ‰ç…§æœ€æ–°è§„åˆ™çš„å…ƒå ‚è®¡ç®—å‡½æ•° ====================
function calcYuanTang(yaos, timeZhi, birthYear, isMale, lunarMonth) {
    // æ–‡æ¡£è§„åˆ™ï¼š
    // é˜³æ—¶ï¼šå­ã€ä¸‘ã€å¯…ã€å¯ã€è¾°ã€å·³
    // é˜´æ—¶ï¼šåˆã€æœªã€ç”³ã€é…‰ã€æˆŒã€äº¥
    
    var yangTime = ['å­','ä¸‘','å¯…','å¯','è¾°','å·³'];
    var yinTime = ['åˆ','æœª','ç”³','é…‰','æˆŒ','äº¥'];
    
    var isYangTime = yangTime.indexOf(timeZhi) >= 0;
    
    // è·å–æ—¶è¾°åœ¨å¯¹åº”åˆ—è¡¨ä¸­çš„ç´¢å¼•
    var timeIdx;
    if(isYangTime) {
        timeIdx = yangTime.indexOf(timeZhi);  // é˜³æ—¶ä»å­æ—¶(0)å¼€å§‹
    } else {
        timeIdx = yinTime.indexOf(timeZhi);   // é˜´æ—¶ä»åˆæ—¶(0)å¼€å§‹
    }
    
    console.log("å…ƒå ‚è®¡ç®—è°ƒè¯•ä¿¡æ¯ï¼š");
    console.log("æ—¶è¾°:", timeZhi, "é˜³æ—¶?", isYangTime);
    console.log("å¦çˆ»:", yaos);
    console.log("æ—¶è¾°ç´¢å¼•:", timeIdx);
    
    // ========== ç‰¹æ®Šæƒ…å†µå¤„ç†ï¼šå…¨é˜³çˆ»æˆ–å…¨é˜´çˆ» ==========
    var yangYaoCount = yaos.filter(y => y === 1).length;
    var yinYaoCount = 6 - yangYaoCount;
    
    // æ£€æŸ¥æ˜¯å¦ä¸ºå…¨é˜³çˆ»ï¼ˆä¹¾å¦ï¼‰æˆ–å…¨é˜´çˆ»ï¼ˆå¤å¦ï¼‰
    var isAllYang = yangYaoCount === 6;
    var isAllYin = yinYaoCount === 6;
    
    if(isAllYang || isAllYin) {
        console.log("ç‰¹æ®Šæƒ…å†µï¼šå…¨", isAllYang ? "é˜³" : "é˜´", "çˆ»å¦");
        return handleAllSameYao(isAllYang, isYangTime, timeIdx, birthYear, isMale, lunarMonth);
    }
    
    // ========== æ­£å¸¸æƒ…å†µå¤„ç† ==========
    // æŒ‰ç…§æœ€æ–°è§„åˆ™ï¼š
    // 1. é˜³æ—¶ç”Ÿäººï¼šå–æœ¬å¦é˜³çˆ»ï¼Œä»å­æ—¶æ•°èµ·
    // 2. é˜´æ—¶ç”Ÿäººï¼šå–æœ¬å¦é˜´çˆ»ï¼Œä»åˆæ—¶æ•°èµ·
    // 3. æ•°å®Œç›®æ ‡çˆ»åï¼Œç»§ç»­æ•°éç›®æ ‡çˆ»ï¼ˆç‰¹æ®Šæƒ…å†µé™¤å¤–ï¼‰
    
    return handleNormalCase(yaos, isYangTime, timeIdx, yangYaoCount);
}

// ==================== å¤„ç†æ­£å¸¸æƒ…å†µ ====================
function handleNormalCase(yaos, isYangTime, timeIdx, yangYaoCount) {
    var yinYaoCount = 6 - yangYaoCount;
    
    // æ‰¾å‡ºç›®æ ‡çˆ»å’Œéç›®æ ‡çˆ»çš„ä½ç½®
    var targetYaoPositions = [];  // ç›®æ ‡çˆ»ä½ç½®ï¼ˆé˜³æ—¶ï¼šé˜³çˆ»ï¼Œé˜´æ—¶ï¼šé˜´çˆ»ï¼‰
    var otherYaoPositions = [];   // éç›®æ ‡çˆ»ä½ç½®ï¼ˆé˜³æ—¶ï¼šé˜´çˆ»ï¼Œé˜´æ—¶ï¼šé˜³çˆ»ï¼‰
    
    for(var i = 0; i < 6; i++) {
        var yaoPos = i + 1;
        if(isYangTime) {
            // é˜³æ—¶ç”Ÿäººï¼šç›®æ ‡çˆ»æ˜¯é˜³çˆ»
            if(yaos[i] === 1) {
                targetYaoPositions.push(yaoPos);
            } else {
                otherYaoPositions.push(yaoPos);
            }
        } else {
            // é˜´æ—¶ç”Ÿäººï¼šç›®æ ‡çˆ»æ˜¯é˜´çˆ»
            if(yaos[i] === 0) {
                targetYaoPositions.push(yaoPos);
            } else {
                otherYaoPositions.push(yaoPos);
            }
        }
    }
    
    console.log("ç›®æ ‡çˆ»ä½ç½®:", targetYaoPositions);
    console.log("éç›®æ ‡çˆ»ä½ç½®:", otherYaoPositions);
    
    // åˆ¤æ–­æ˜¯å¦éœ€è¦æ•°éç›®æ ‡çˆ»
    var needCountOther = true;
    
    if(isYangTime) {
        // é˜³æ—¶ç”Ÿäººç‰¹æ®Šæƒ…å†µï¼š
        // 1. çº¯é˜³å¦ï¼ˆå…¨é˜³çˆ»ï¼‰ä¸æ•°é˜´çˆ» - å·²åœ¨ç‰¹æ®Šæƒ…å†µå¤„ç†
        // 2. ä¸‰é˜³çˆ»å…ƒå ‚å¦ä¸æ•°é˜´çˆ»
        if(yangYaoCount === 3) {
            needCountOther = false;
            console.log("ä¸‰é˜³çˆ»å¦ï¼Œä¸æ•°é˜´çˆ»");
        }
    } else {
        // é˜´æ—¶ç”Ÿäººç‰¹æ®Šæƒ…å†µï¼š
        // 1. çº¯é˜´å¦ï¼ˆå…¨é˜´çˆ»ï¼‰ä¸æ•°é˜³çˆ» - å·²åœ¨ç‰¹æ®Šæƒ…å†µå¤„ç†
        // 2. ä¸‰é˜´çˆ»å…ƒå ‚å¦ä¸æ•°é˜³çˆ»
        if(yinYaoCount === 3) {
            needCountOther = false;
            console.log("ä¸‰é˜´çˆ»å¦ï¼Œä¸æ•°é˜³çˆ»");
        }
    }
    
    // ========== æ ¹æ®è§„åˆ™åˆ›å»ºå¾ªç¯æ•°ç»„ ==========
    // æ€»ç»“è§„åˆ™ï¼š
    // 1. ä¸€é˜³çˆ»å¦ï¼šé˜³çˆ»æ•°ä¸¤æ¬¡ï¼Œç„¶åæ•°é˜´çˆ»
    // 2. äºŒé˜³çˆ»å¦ï¼šé˜³çˆ»å„æ•°ä¸¤æ¬¡ï¼ˆå…±4æ¬¡ï¼‰ï¼Œç„¶åæ•°é˜´çˆ»
    // 3. ä¸‰é˜³çˆ»å¦ï¼šåªæ•°é˜³çˆ»ï¼ˆå¾ªç¯æ•°ï¼‰ï¼Œä¸æ•°é˜´çˆ»
    // 4. å››é˜³çˆ»å¦ï¼šé˜³çˆ»æ•°ä¸€æ¬¡ï¼Œç„¶åæ•°é˜´çˆ»
    // 5. äº”é˜³çˆ»å¦ï¼šé˜³çˆ»æ•°ä¸€æ¬¡ï¼Œç„¶åæ•°é˜´çˆ»
    // é˜´æ—¶ç”Ÿäººç±»ä¼¼ï¼Œåªæ˜¯ç›®æ ‡çˆ»æ˜¯é˜´çˆ»
    
    // åˆ›å»ºå®é™…çš„å¾ªç¯æ•°ç»„
    var cycleArray = [];
    
    if(isYangTime) {
        // é˜³æ—¶ç”Ÿäºº
        switch(yangYaoCount) {
            case 1:
                // ä¸€é˜³çˆ»å¦ï¼šé˜³çˆ»æ•°ä¸¤æ¬¡
                cycleArray.push(targetYaoPositions[0]); // ç¬¬ä¸€æ¬¡
                cycleArray.push(targetYaoPositions[0]); // ç¬¬äºŒæ¬¡
                // ç„¶åæ•°é˜´çˆ»
                for(var i = 0; i < otherYaoPositions.length; i++) {
                    cycleArray.push(otherYaoPositions[i]);
                }
                break;
                
            case 2:
                // äºŒé˜³çˆ»å¦ï¼šé˜³çˆ»å„æ•°ä¸¤æ¬¡ï¼ˆå…±4æ¬¡ï¼‰
                // ç¬¬ä¸€ä¸ªé˜³çˆ»ï¼šç¬¬ä¸€æ¬¡
                cycleArray.push(targetYaoPositions[0]);
                // ç¬¬äºŒä¸ªé˜³çˆ»ï¼šç¬¬ä¸€æ¬¡
                cycleArray.push(targetYaoPositions[1]);
                // ç¬¬ä¸€ä¸ªé˜³çˆ»ï¼šç¬¬äºŒæ¬¡
                cycleArray.push(targetYaoPositions[0]);
                // ç¬¬äºŒä¸ªé˜³çˆ»ï¼šç¬¬äºŒæ¬¡
                cycleArray.push(targetYaoPositions[1]);
                // ç„¶åæ•°é˜´çˆ»
                for(var i = 0; i < otherYaoPositions.length; i++) {
                    cycleArray.push(otherYaoPositions[i]);
                }
                break;
                
            case 3:
                // ä¸‰é˜³çˆ»å¦ï¼šåªæ•°é˜³çˆ»ï¼Œä¸æ•°é˜´çˆ»
                // å¾ªç¯æ•°é˜³çˆ»ï¼š2çˆ»æ•°å­ï¼Œ4çˆ»æ•°ä¸‘ï¼Œ6çˆ»æ•°å¯…ï¼Œ2çˆ»æ•°å¯ï¼Œ4çˆ»æ•°è¾°ï¼Œ6çˆ»æ•°å·³
                for(var i = 0; i < 6; i++) {
                    cycleArray.push(targetYaoPositions[i % 3]);
                }
                break;
                
            case 4:
                // å››é˜³çˆ»å¦ï¼šé˜³çˆ»æ•°ä¸€æ¬¡ï¼Œç„¶åæ•°é˜´çˆ»
                // ä¾‹å­ï¼šå¤©æ°´è®¼é˜³çˆ»ä¸º2çˆ»4çˆ»5çˆ»6çˆ»ï¼Œ2çˆ»æ•°å­ï¼Œ4çˆ»æ•°ä¸‘ï¼Œ5çˆ»æ•°å¯…ï¼Œ6çˆ»æ•°å¯
                for(var i = 0; i < targetYaoPositions.length; i++) {
                    cycleArray.push(targetYaoPositions[i]);
                }
                // ç„¶åæ•°é˜´çˆ»
                for(var i = 0; i < otherYaoPositions.length; i++) {
                    cycleArray.push(otherYaoPositions[i]);
                }
                break;
                
            case 5:
                // äº”é˜³çˆ»å¦ï¼šé˜³çˆ»æ•°ä¸€æ¬¡ï¼Œç„¶åæ•°é˜´çˆ»
                // ä¾‹å­ï¼šç«å¤©å¤§æœ‰é˜³çˆ»ä¸º1çˆ»2çˆ»3çˆ»4çˆ»6çˆ»ï¼Œ1çˆ»æ•°å­ï¼Œ2çˆ»æ•°ä¸‘ï¼Œ3çˆ»æ•°å¯…ï¼Œ4çˆ»æ•°å¯ï¼Œ6çˆ»æ•°è¾°
                for(var i = 0; i < targetYaoPositions.length; i++) {
                    cycleArray.push(targetYaoPositions[i]);
                }
                // ç„¶åæ•°é˜´çˆ»
                for(var i = 0; i < otherYaoPositions.length; i++) {
                    cycleArray.push(otherYaoPositions[i]);
                }
                break;
        }
    } else {
        // é˜´æ—¶ç”Ÿäºº
        switch(yinYaoCount) {
            case 1:
                // ä¸€é˜´çˆ»å¦ï¼šé˜´çˆ»æ•°ä¸¤æ¬¡
                cycleArray.push(targetYaoPositions[0]); // ç¬¬ä¸€æ¬¡
                cycleArray.push(targetYaoPositions[0]); // ç¬¬äºŒæ¬¡
                // ç„¶åæ•°é˜³çˆ»
                for(var i = 0; i < otherYaoPositions.length; i++) {
                    cycleArray.push(otherYaoPositions[i]);
                }
                break;
                
            case 2:
                // äºŒé˜´çˆ»å¦ï¼šé˜´çˆ»å„æ•°ä¸¤æ¬¡ï¼ˆå…±4æ¬¡ï¼‰
                // ä¾‹å­ï¼šå±±å¤©å¤§è“„é˜´çˆ»ä¸º4çˆ»ï¼Œ5çˆ»ï¼Œ4çˆ»æ•°åˆï¼Œ5çˆ»æ•°æœªï¼Œ4çˆ»æ•°ç”³ï¼Œ5çˆ»æ•°é…‰
                cycleArray.push(targetYaoPositions[0]); // ç¬¬ä¸€ä¸ªé˜´çˆ»ï¼šç¬¬ä¸€æ¬¡
                cycleArray.push(targetYaoPositions[1]); // ç¬¬äºŒä¸ªé˜´çˆ»ï¼šç¬¬ä¸€æ¬¡
                cycleArray.push(targetYaoPositions[0]); // ç¬¬ä¸€ä¸ªé˜´çˆ»ï¼šç¬¬äºŒæ¬¡
                cycleArray.push(targetYaoPositions[1]); // ç¬¬äºŒä¸ªé˜´çˆ»ï¼šç¬¬äºŒæ¬¡
                // ç„¶åæ•°é˜³çˆ»
                for(var i = 0; i < otherYaoPositions.length; i++) {
                    cycleArray.push(otherYaoPositions[i]);
                }
                break;
                
            case 3:
                // ä¸‰é˜´çˆ»å¦ï¼šåªæ•°é˜´çˆ»ï¼Œä¸æ•°é˜³çˆ»
                // ä¾‹å­ï¼šæ³½æ°´å›°é˜´çˆ»ä¸º1çˆ»ï¼Œ3çˆ»ï¼Œ6çˆ»ï¼Œ1çˆ»æ•°åˆï¼Œ3çˆ»æ•°æœªï¼Œ6çˆ»æ•°ç”³ï¼Œ1çˆ»æ•°é…‰ï¼Œ3çˆ»æ•°æˆŒï¼Œ6çˆ»æ•°äº¥
                for(var i = 0; i < 6; i++) {
                    cycleArray.push(targetYaoPositions[i % 3]);
                }
                break;
                
            case 4:
                // å››é˜´çˆ»å¦ï¼šé˜´çˆ»æ•°ä¸€æ¬¡ï¼Œç„¶åæ•°é˜³çˆ»
                // ä¾‹å­ï¼šéœ‡ä¸ºé›·é˜´çˆ»ä¸º2çˆ»ï¼Œ3çˆ»ï¼Œ5çˆ»ï¼Œ6çˆ»ï¼Œ2çˆ»æ•°åˆï¼Œ3çˆ»æ•°æœªï¼Œ5çˆ»æ•°ç”³ï¼Œ6çˆ»æ•°é…‰
                for(var i = 0; i < targetYaoPositions.length; i++) {
                    cycleArray.push(targetYaoPositions[i]);
                }
                // ç„¶åæ•°é˜³çˆ»
                for(var i = 0; i < otherYaoPositions.length; i++) {
                    cycleArray.push(otherYaoPositions[i]);
                }
                break;
                
            case 5:
                // äº”é˜´çˆ»å¦ï¼šé˜´çˆ»æ•°ä¸€æ¬¡ï¼Œç„¶åæ•°é˜³çˆ»
                // ä¾‹å­ï¼šåœ°é›·å¤é˜´çˆ»ä¸º2çˆ»ï¼Œ3çˆ»ï¼Œ4çˆ»ï¼Œ5çˆ»ï¼Œ6çˆ»ï¼Œ2çˆ»æ•°åˆï¼Œ3çˆ»æ•°æœªï¼Œ4çˆ»æ•°ç”³ï¼Œ5çˆ»æ•°é…‰ï¼Œ6çˆ»æ•°æˆŒ
                for(var i = 0; i < targetYaoPositions.length; i++) {
                    cycleArray.push(targetYaoPositions[i]);
                }
                // ç„¶åæ•°é˜³çˆ»
                for(var i = 0; i < otherYaoPositions.length; i++) {
                    cycleArray.push(otherYaoPositions[i]);
                }
                break;
        }
    }
    
    console.log("å¾ªç¯æ•°ç»„:", cycleArray);
    console.log("æ—¶è¾°ç´¢å¼•:", timeIdx);
    
    // è®¡ç®—åœ¨å¾ªç¯ä¸­çš„ä½ç½®
    var result = cycleArray[timeIdx];
    console.log("å…ƒå ‚çˆ»ä½:", result);
    
    return result;
}

// ==================== å¤„ç†å…¨é˜³çˆ»æˆ–å…¨é˜´çˆ»çš„ç‰¹æ®Šæƒ…å†µ ====================
function handleAllSameYao(isAllYang, isYangTime, timeIdx, birthYear, isMale, lunarMonth) {
    // è·å–èŠ‚æ°”ä¿¡æ¯ï¼ˆåˆ¤æ–­å†¬è‡³åå¤è‡³å‰è¿˜æ˜¯å¤è‡³åå†¬è‡³å‰ï¼‰
    var isAfterWinterSolstice = isAfterWinterSolsticeFunc(birthYear, lunarMonth);
    
    if(isAllYang) {
        // å…¨é˜³çˆ»ï¼ˆä¹¾å¦ï¼‰
        if(isMale) {
            // ç”·å‘½ - ä¹¾å¦ç”·å‘½ä¸åˆ†å¤è‡³å†¬è‡³
            if(isYangTime) {
                // ç”·å‘½é˜³æ—¶ç”Ÿäººï¼š1çˆ»æ•°å­ï¼Œ2çˆ»æ•°ä¸‘ï¼Œ3çˆ»æ•°å¯…ï¼Œ1çˆ»æ•°å¯ï¼Œ2çˆ»æ•°è¾°ï¼Œ3çˆ»æ•°å·³
                var yangPattern = [1, 2, 3, 1, 2, 3];
            } else {
                // ç”·å‘½é˜´æ—¶ç”Ÿäººï¼š4çˆ»æ•°åˆï¼Œ5çˆ»æ•°æœªï¼Œ6çˆ»æ•°ç”³ï¼Œ4çˆ»æ•°é…‰ï¼Œ5çˆ»æ•°æˆŒï¼Œ6çˆ»æ•°äº¥
                var yinPattern = [4, 5, 6, 4, 5, 6];
            }
        } else {
            // å¥³å‘½
            if(isYangTime) {
                // é˜³æ—¶ç”Ÿäºº
                if(isAfterWinterSolstice) {
                    // å†¬è‡³åå¤è‡³å‰ï¼š6çˆ»æ•°å­ï¼Œ5çˆ»æ•°ä¸‘ï¼Œ4çˆ»æ•°å¯…ï¼Œ6çˆ»æ•°å¯ï¼Œ5çˆ»æ•°è¾°ï¼Œ4çˆ»æ•°å·³
                    var yangPattern = [6, 5, 4, 6, 5, 4];
                } else {
                    // å¤è‡³åå†¬è‡³å‰ï¼š1çˆ»æ•°å­ï¼Œ2çˆ»æ•°ä¸‘ï¼Œ3çˆ»æ•°å¯…ï¼Œ1çˆ»æ•°å¯ï¼Œ2çˆ»æ•°è¾°ï¼Œ3çˆ»æ•°å·³
                    var yangPattern = [1, 2, 3, 1, 2, 3];
                }
            } else {
                // é˜´æ—¶ç”Ÿäºº
                if(isAfterWinterSolstice) {
                    // å†¬è‡³åå¤è‡³å‰ï¼š3çˆ»æ•°åˆï¼Œ2çˆ»æ•°æœªï¼Œ1çˆ»æ•°ç”³ï¼Œ3çˆ»æ•°é…‰ï¼Œ2çˆ»æ•°æˆŒï¼Œ1çˆ»æ•°äº¥
                    var yinPattern = [3, 2, 1, 3, 2, 1];
                } else {
                    // å¤è‡³åå†¬è‡³å‰ï¼š4çˆ»æ•°åˆï¼Œ5çˆ»æ•°æœªï¼Œ6çˆ»æ•°ç”³ï¼Œ4çˆ»æ•°é…‰ï¼Œ5çˆ»æ•°æˆŒï¼Œ6çˆ»æ•°äº¥
                    var yinPattern = [4, 5, 6, 4, 5, 6];
                }
            }
        }
    } else {
        // å…¨é˜´çˆ»ï¼ˆå¤å¦ï¼‰
        // æ ¹æ®æ–‡æ¡£æ˜ç¡®è§„åˆ™ï¼š
        if(isMale) {
            // ç”·å‘½å…¨é˜´çˆ»
            if(isYangTime) {
                // é˜³æ—¶ç”Ÿäºº
                if(isAfterWinterSolstice) {
                    // å†¬è‡³åå¤è‡³å‰ï¼š1çˆ»æ•°å­ï¼Œ2çˆ»æ•°ä¸‘ï¼Œ3çˆ»æ•°å¯…ï¼Œ1çˆ»æ•°å¯ï¼Œ2çˆ»æ•°è¾°ï¼Œ3çˆ»æ•°å·³
                    var yangPattern = [1, 2, 3, 1, 2, 3];
                } else {
                    // å¤è‡³åå†¬è‡³å‰ï¼š6çˆ»æ•°å­ï¼Œ5çˆ»æ•°ä¸‘ï¼Œ4çˆ»æ•°å¯…ï¼Œ6çˆ»æ•°å¯ï¼Œ5çˆ»æ•°è¾°ï¼Œ4çˆ»æ•°å·³
                    var yangPattern = [6, 5, 4, 6, 5, 4];
                }
            } else {
                // é˜´æ—¶ç”Ÿäºº
                if(isAfterWinterSolstice) {
                    // å†¬è‡³åå¤è‡³å‰ï¼š4çˆ»æ•°åˆï¼Œ5çˆ»æ•°æœªï¼Œ6çˆ»æ•°ç”³ï¼Œ4çˆ»æ•°é…‰ï¼Œ5çˆ»æ•°æˆŒï¼Œ6çˆ»æ•°äº¥
                    var yinPattern = [4, 5, 6, 4, 5, 6];
                } else {
                    // å¤è‡³åå†¬è‡³å‰ï¼š3çˆ»æ•°åˆï¼Œ2çˆ»æ•°æœªï¼Œ1çˆ»æ•°ç”³ï¼Œ3çˆ»æ•°é…‰ï¼Œ2çˆ»æ•°æˆŒï¼Œ1çˆ»æ•°äº¥
                    var yinPattern = [3, 2, 1, 3, 2, 1];
                }
            }
        } else {
            // å¥³å‘½å…¨é˜´çˆ»
            if(isYangTime) {
                // å¥³å‘½é˜³æ—¶ç”Ÿäººï¼š1çˆ»æ•°å­ï¼Œ2çˆ»æ•°ä¸‘ï¼Œ3çˆ»æ•°å¯…ï¼Œ1çˆ»æ•°å¯ï¼Œ2çˆ»æ•°è¾°ï¼Œ3çˆ»æ•°å·³
                var yangPattern = [1, 2, 3, 1, 2, 3];
            } else {
                // å¥³å‘½é˜´æ—¶ç”Ÿäººï¼š4çˆ»æ•°åˆï¼Œ5çˆ»æ•°æœªï¼Œ6çˆ»æ•°ç”³ï¼Œ4çˆ»æ•°é…‰ï¼Œ5çˆ»æ•°æˆŒï¼Œ6çˆ»æ•°äº¥
                var yinPattern = [4, 5, 6, 4, 5, 6];
            }
        }
    }
    
    // è¿”å›å¯¹åº”æ—¶è¾°çš„çˆ»ä½
    var result = isYangTime ? yangPattern[timeIdx] : yinPattern[timeIdx];
    console.log("å…¨", isAllYang ? "é˜³" : "é˜´", "çˆ»å¦ç‰¹æ®Šå¤„ç†ï¼š", 
                isMale ? "ç”·å‘½" : "å¥³å‘½", 
                isYangTime ? "é˜³æ—¶" : "é˜´æ—¶",
                "èŠ‚æ°”:", isAfterWinterSolstice ? "å†¬è‡³åå¤è‡³å‰" : "å¤è‡³åå†¬è‡³å‰",
                "å…ƒå ‚çˆ»ä½:", result);
    
    return result;
}

// ==================== åˆ¤æ–­æ˜¯å¦åœ¨å†¬è‡³åå¤è‡³å‰ ====================
function isAfterWinterSolsticeFunc(year, lunarMonth) {
    // ç®€åŒ–å¤„ç†ï¼šå†œå†11æœˆåˆ°æ¬¡å¹´4æœˆä¸ºå†¬è‡³åå¤è‡³å‰
    // å®é™…åº”è¯¥æ ¹æ®å…·ä½“èŠ‚æ°”æ—¥æœŸåˆ¤æ–­ï¼Œè¿™é‡Œåšç®€åŒ–
    return lunarMonth >= 11 || lunarMonth <= 4;
}

// ==================== è¾…åŠ©å‡½æ•° ====================
// åˆ¤æ–­æ˜¯å¦ä¸ºé˜³å¹²å¹´ï¼ˆç”²ä¸™æˆŠåºšå£¬ï¼‰
function isYangGanYear(year) {
    var gan = getGanFromYear(year);
    return ['ç”²','ä¸™','æˆŠ','åºš','å£¬'].indexOf(gan) >= 0;
}

function getGanFromYear(year) {
    var ganIdx = (year - 4) % 10;
    if(ganIdx < 0) ganIdx += 10;
    return GAN_NAMES[ganIdx];
}

function getName(arr) {
    var s = arr.join(',');
    for(var k in GUA_BITS) {
        if(GUA_BITS[k].join(',') === s) return k;
    }
    return 'å¤';
}

function getGuaName(yaos) {
    var lower = getName(yaos.slice(0, 3));
    var upper = getName(yaos.slice(3, 6));
    return GUA_NAMES[upper + lower] || (upper + lower);
}

function getYaoName(idx) {
    return YAO_NAMES[idx];
}

// æ ¹æ®å¦åè·å–å¦è±¡ï¼ˆyaosæ•°ç»„ï¼‰
function getGuaYaosByName(guaName) {
    // ä»GUA_NAMESä¸­æŸ¥æ‰¾å¯¹åº”çš„ä¸Šä¸‹å¦ç»„åˆ
    for(var key in GUA_NAMES) {
        if(GUA_NAMES[key] === guaName) {
            // keyæ ¼å¼ï¼š'ä¸Šå¦ä¸‹å¦'ï¼Œå¦‚'ä¹¾ä¹¾'ã€'ä¹¾å¤'ç­‰
            var upper = key[0]; // ä¸Šå¦
            var lower = key[1]; // ä¸‹å¦
            if(GUA_BITS[lower] && GUA_BITS[upper]) {
                // ä¸‹å¦åœ¨å‰ï¼ˆ0-2ï¼‰ï¼Œä¸Šå¦åœ¨åï¼ˆ3-5ï¼‰
                return GUA_BITS[lower].slice().concat(GUA_BITS[upper].slice());
            }
        }
    }
    return null;
}

// ä¸º64å¦åˆ†æç³»ç»Ÿè®¡ç®—é»˜è®¤å…ƒå ‚ï¼ˆä½¿ç”¨å­æ—¶ä½œä¸ºé»˜è®¤ï¼‰
function getDefaultYuantangFor64Gua(yaos) {
    if(!yaos || yaos.length !== 6) return 1;
    // ä½¿ç”¨å­æ—¶ï¼ˆç´¢å¼•0ï¼‰ä½œä¸ºé»˜è®¤è®¡ç®—å…ƒå ‚
    return calcYuanTang(yaos, 'å­');
}

// ç”Ÿæˆå¦è±¡HTMLï¼ˆç”¨äº64å¦åˆ†æç³»ç»Ÿï¼‰
function renderGuaHtml(yaos, yuantang) {
    if(!yaos || yaos.length !== 6) return '';
    var h = '<div class="yao-stack" style="margin: 15px auto; width: 100px;">';
    for(var i = 5; i >= 0; i--) {
        var yaoVal = yaos[i];
        var bar = yaoVal === 1 ? '<div class="yang"></div>' : '<div class="yin-group"><div class="yin-part"></div><div class="yin-part"></div></div>';
        var yaoName = getYaoName(i);
        h += '<div class="yao-line"><div class="idx-text">' + yaoName + '</div>' + bar + '</div>';
    }
    h += '</div>';
    return h;
}
// æ·»åŠ æ—¥æœŸæ ¼å¼åŒ–å‡½æ•°
function formatDate(date) {
    var m = date.getMonth() + 1;
    var d = date.getDate();
    return m + 'æœˆ' + d + 'æ—¥';
}

// æ·»åŠ æ—¶é—´æ ¼å¼åŒ–å‡½æ•°ï¼ˆç”¨äºæµåˆ†ï¼‰
function formatTime(minutes) {
    var hours = Math.floor(minutes / 60);
    var mins = Math.floor(minutes % 60);
    return (hours < 10 ? '0' : '') + hours + ':' + (mins < 10 ? '0' : '') + mins;
}

// è·å–æŸå¹´æ‰€æœ‰èŠ‚æ°”çš„ç²¾ç¡®æ—¶é—´
function getYearJieqiTable(year) {
    var result = [];
    try {
        for(var m = 1; m <= 12; m++) {
            var solar = Solar.fromYmd(year, m, 1);
            var lunar = solar.getLunar();
            var jieqi = lunar.getJieQiTable();
            for(var name in jieqi) {
                if(JIEQI_MONTH_MAP[name] !== undefined) {
                    var s = jieqi[name];
                    result.push({
                        name: name,
                        lunarMonth: JIEQI_MONTH_MAP[name],
                        date: new Date(s.getYear(), s.getMonth() - 1, s.getDay(), s.getHour(), s.getMinute(), s.getSecond())
                    });
                }
            }
        }
        // è·å–æ¬¡å¹´ç«‹æ˜¥å‰çš„å°å¯’
        var nextSolar = Solar.fromYmd(year + 1, 1, 1);
        var nextLunar = nextSolar.getLunar();
        var nextJieqi = nextLunar.getJieQiTable();
        if(nextJieqi['å°å¯’']) {
            var s = nextJieqi['å°å¯’'];
            result.push({
                name: 'å°å¯’(æ¬¡å¹´)',
                lunarMonth: 12,
                date: new Date(s.getYear(), s.getMonth() - 1, s.getDay(), s.getHour(), s.getMinute(), s.getSecond()),
                isNextYear: true
            });
        }
        if(nextJieqi['ç«‹æ˜¥']) {
            var s = nextJieqi['ç«‹æ˜¥'];
            result.push({
                name: 'ç«‹æ˜¥(æ¬¡å¹´)',
                lunarMonth: 1,
                date: new Date(s.getYear(), s.getMonth() - 1, s.getDay(), s.getHour(), s.getMinute(), s.getSecond()),
                isNextYear: true
            });
        }
    } catch(e) {
        console.error('è·å–èŠ‚æ°”å¤±è´¥:', e);
    }
    result.sort(function(a, b) { return a.date - b.date; });
    return result;
}

// è·å–æŒ‡å®šæ—¶é—´æ‰€åœ¨çš„èŠ‚æ°”æœˆä»½
function getJieqiMonthInfo(year, month, day, hour, minute) {
    var targetDate = new Date(year, month - 1, day, hour, minute, 0);
    var jieqiList = [];
    
    for(var y = year - 1; y <= year + 1; y++) {
        var yearJieqi = getYearJieqiTable(y);
        jieqiList = jieqiList.concat(yearJieqi);
    }
    jieqiList.sort(function(a, b) { return a.date - b.date; });
    
    var seen = {};
    var uniqueList = [];
    for(var i = 0; i < jieqiList.length; i++) {
        var key = jieqiList[i].date.getTime();
        if(!seen[key]) {
            seen[key] = true;
            uniqueList.push(jieqiList[i]);
        }
    }
    jieqiList = uniqueList;
    
    for(var i = 0; i < jieqiList.length - 1; i++) {
        if(targetDate >= jieqiList[i].date && targetDate < jieqiList[i + 1].date) {
            return {
                startJieqi: jieqiList[i],
                endJieqi: jieqiList[i + 1],
                lunarMonth: jieqiList[i].lunarMonth
            };
        }
    }
    return null;
}

function formatDateTime(date) {
    var m = date.getMonth() + 1;
    var d = date.getDate();
    var h = date.getHours();
    var min = date.getMinutes();
    return m + 'æœˆ' + d + 'æ—¥' + h + ':' + (min < 10 ? '0' : '') + min;
}

// æ„å»ºé˜³çˆ»é¡ºåºè¡¨
function buildYangYaoOrder(xt, ht) {
    var order = [];
    var count = 0;
    
    // å…ˆå¤©å¦ï¼šä»å…ƒå ‚å¼€å§‹å‘ä¸Šæ•°
    for(var i = 0; i < 6; i++) {
        var idx = (xt.yt - 1 + i) % 6;
        if(xt.yaos[idx] === 1) {
            count++;
            order.push({ type: 'xt', yaoIdx: idx, orderNum: count });
        }
    }
    
    // åå¤©å¦ï¼šä»å…ƒå ‚å¼€å§‹å‘ä¸Šæ•°
    for(var i = 0; i < 6; i++) {
        var idx = (ht.yt - 1 + i) % 6;
        if(ht.yaos[idx] === 1) {
            count++;
            order.push({ type: 'ht', yaoIdx: idx, orderNum: count });
        }
    }
    
    return order;
}

// æ˜¾ç¤ºæ’ç›˜è¡¨å•
function showChartingForm() {
    var panelContainer = document.getElementById('chartingPanelContainer');
    var formContainer = document.getElementById('chartingFormContainer');
    var startBtn = document.getElementById('startChartingBtn');
    
    // æ˜¾ç¤ºæ•´ä¸ª"å‘½é€ æ’ç›˜"æ¿å—
    if(panelContainer) {
        panelContainer.style.display = 'block';
    }
    
    // æ˜¾ç¤ºè¡¨å•å†…å®¹
    if(formContainer) {
        formContainer.style.display = 'block';
    }
    
    // éšè—"å¼€å§‹æ’ç›˜"æŒ‰é’®
    if(startBtn) {
        startBtn.style.display = 'none';
    }
    
    // æ»šåŠ¨åˆ°è¡¨å•ä½ç½®ï¼Œä½¿ç”¨å¹³æ»‘æ»šåŠ¨
    setTimeout(function() {
        if(panelContainer) {
            panelContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }, 100);
}

function getYangYaoOrderNum(yangYaoOrder, type, yaoIdx) {
    for(var i = 0; i < yangYaoOrder.length; i++) {
        if(yangYaoOrder[i].type === type && yangYaoOrder[i].yaoIdx === yaoIdx) {
            return yangYaoOrder[i].orderNum;
        }
    }
    return 0;
}

function calcMain() {
    // #region agent log
    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:calcMain',message:'calcMainå‡½æ•°è°ƒç”¨',data:{typeofSolar:typeof Solar,hasSolar:typeof Solar!=='undefined'},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
    // #endregion
    
    // å¦‚æœSolaræœªå®šä¹‰ï¼Œç­‰å¾…åŠ è½½å®Œæˆåå†æ‰§è¡Œ
    if(typeof Solar === 'undefined') { 
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:calcMain',message:'Solaræœªå®šä¹‰ï¼Œç­‰å¾…åŠ è½½',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
        // #endregion
        
        // æ˜¾ç¤ºåŠ è½½æç¤º
        showMingliMessage('æ­£åœ¨åŠ è½½JSåº“ï¼Œè¯·ç¨å€™...');
        var loadingDialog = document.getElementById('mingliMessageDialog');
        
        // å°è¯•é‡æ–°åŠ è½½lunar.js - å…ˆå°è¯•æœ¬åœ°æ–‡ä»¶
        var tryLoadLocal = function() {
            var script = document.createElement('script');
            script.src = 'lunar.js';
            script.onload = function() {
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:calcMain',message:'æœ¬åœ°lunar.jsåŠ è½½æˆåŠŸï¼Œé‡æ–°æ‰§è¡ŒcalcMain',data:{typeofSolar:typeof Solar},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                setTimeout(function() {
                    if(typeof Solar !== 'undefined') {
                        // å…³é—­åŠ è½½æç¤º
                        if(loadingDialog) loadingDialog.remove();
                        // é‡æ–°æ‰§è¡ŒcalcMain
                        calcMain();
                    } else {
                        tryLoadCDN();
                    }
                }, 100);
            };
            script.onerror = function() {
                // æœ¬åœ°æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°è¯•CDN
                tryLoadCDN();
            };
            document.head.appendChild(script);
        };
        
        var tryLoadCDN = function() {
            var script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/lunar-javascript@1.2.37/lunar.js';
            var timeoutId = setTimeout(function() {
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:calcMain',message:'CDNåŠ è½½è¶…æ—¶',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                if(typeof Solar === 'undefined') {
                    if(loadingDialog) loadingDialog.remove();
                    var timeoutMsg = 'JSåº“åŠ è½½è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚\n\n';
                    timeoutMsg += 'å¦‚æœæ˜¯åœ¨æ‰‹æœºæ‰“åŒ…åº”ç”¨ä¸­ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š\n';
                    timeoutMsg += '1. è®¿é—®ï¼šhttps://cdn.jsdelivr.net/npm/lunar-javascript@1.2.37/lunar.js\n';
                    timeoutMsg += '2. å°†æ–‡ä»¶ä¿å­˜ä¸º lunar.js\n';
                    timeoutMsg += '3. å°† lunar.js æ”¾åœ¨ä¸ index.html ç›¸åŒçš„ç›®å½•ä¸‹\n';
                    timeoutMsg += '4. åˆ·æ–°é¡µé¢åå³å¯æ­£å¸¸ä½¿ç”¨';
                    showMingliMessage(timeoutMsg);
                }
            }, 10000); // 10ç§’è¶…æ—¶
            
            script.onload = function() {
                clearTimeout(timeoutId);
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:calcMain',message:'CDN lunar.jsåŠ è½½æˆåŠŸï¼Œé‡æ–°æ‰§è¡ŒcalcMain',data:{typeofSolar:typeof Solar},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                setTimeout(function() {
                    if(typeof Solar !== 'undefined') {
                        // å…³é—­åŠ è½½æç¤º
                        if(loadingDialog) loadingDialog.remove();
                        // é‡æ–°æ‰§è¡ŒcalcMain
                        calcMain();
                    } else {
                        if(loadingDialog) loadingDialog.remove();
                        showMingliMessage('JSåº“åŠ è½½å¯èƒ½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚');
                    }
                }, 500);
            };
            script.onerror = function() {
                clearTimeout(timeoutId);
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:calcMain',message:'CDN lunar.jsåŠ è½½å¤±è´¥',data:{error:'CDNåŠ è½½è¶…æ—¶æˆ–å¤±è´¥'},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                if(loadingDialog) loadingDialog.remove();
                var errorMsg = 'JSåº“æœªåŠ è½½ï¼Œè¯·ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸ã€‚\n\n';
                errorMsg += 'å¦‚æœæ˜¯åœ¨æ‰‹æœºæ‰“åŒ…åº”ç”¨ä¸­ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š\n';
                errorMsg += '1. è®¿é—®ï¼šhttps://cdn.jsdelivr.net/npm/lunar-javascript@1.2.37/lunar.js\n';
                errorMsg += '2. å°†æ–‡ä»¶ä¿å­˜ä¸º lunar.js\n';
                errorMsg += '3. å°† lunar.js æ”¾åœ¨ä¸ index.html ç›¸åŒçš„ç›®å½•ä¸‹\n';
                errorMsg += '4. åˆ·æ–°é¡µé¢åå³å¯æ­£å¸¸ä½¿ç”¨';
                showMingliMessage(errorMsg);
            };
            document.head.appendChild(script);
        };
        
        tryLoadLocal();
        return; 
    }
    var y = parseInt(document.getElementById('y').value);
    var m = parseInt(document.getElementById('m').value);
    var d = parseInt(document.getElementById('d').value);
    var h = parseInt(document.getElementById('h').value);
    var min = parseInt(document.getElementById('min').value);
    var isMale = document.getElementById('sex').value === "1";
    var lon = parseFloat(document.getElementById('lon').value);

    var offset = (lon - 120) * 4;
    var tm = h * 60 + min + offset;
    var th = Math.floor(tm / 60);
    var tmm = Math.floor(tm % 60);
    if(tmm < 0) { tmm += 60; th--; }
    if(th >= 24) th -= 24;
    if(th < 0) th += 24;

    var solar = Solar.fromYmdHms(y, m, d, th, tmm, 0);
    var lunar = solar.getLunar();
    var bz = lunar.getEightChar();

    document.getElementById('result-view').style.display = 'block';
    document.getElementById('txt-time').innerText = th + ':' + (tmm < 10 ? '0' : '') + tmm;
    document.getElementById('txt-jie').innerText = lunar.getPrevJie().getName() + ' / ' + lunar.getNextJie().getName();

    // è·å–å››æŸ±
    var yearGan = bz.getYearGan();
    var yearZhi = bz.getYearZhi();
    var monthGan = bz.getMonthGan();
    var monthZhi = bz.getMonthZhi();
    var dayGan = bz.getDayGan();
    var dayZhi = bz.getDayZhi();
    var timeGan = bz.getTimeGan();
    var timeZhi = bz.getTimeZhi();
    
    // ==================== æ—¶æŸ±è®¡ç®—éªŒè¯å’Œçº é”™æœºåˆ¶ ====================
    // ä½¿ç”¨å…¨å±€éªŒè¯å‡½æ•°è¿›è¡Œæ—¶æŸ±çº é”™
    timeGan = verifyAndCorrectTimeGan(dayGan, timeGan, timeZhi);
    
    var cols = [
        {g: yearGan, z: yearZhi},
        {g: monthGan, z: monthZhi},
        {g: dayGan, z: dayZhi},
        {g: timeGan, z: timeZhi}
    ];
    var ts = 0, ds = 0, html = '';
    for(var i = 0; i < cols.length; i++) {
        var c = cols[i];
        var gn = GAN_VAL[c.g], zn = ZHI_VAL[c.z];
        html += '<td><span class="ganzhi">' + c.g + c.z + '</span><span style="font-size:12px;color:#888">å¹²' + gn + ' æ”¯' + zn[0] + ',' + zn[1] + '</span></td>';
        var nums = [gn, zn[0], zn[1]];
        for(var j = 0; j < nums.length; j++) {
            if(nums[j] % 2 !== 0) ts += nums[j]; else ds += nums[j];
        }
    }
    document.getElementById('bz-body').innerHTML = '<tr>' + html + '</tr>';
    document.getElementById('val-tianshu').innerText = ts;
    document.getElementById('val-dishu').innerText = ds;

    var getGuaNum = function(n, base) {
        var v = n;
        if(base === 25 && v > 25) v = v - 25;
        else if(base === 30 && v > 30) v = v - 30;
        if(v >= 10) {
            if(v % 10 === 0) return Math.floor(v / 10);
            else return v % 10;
        }
        return v || 1;
    };
    
    var handle5Palace = function(v, birthYear, isMale, isYangYearFlag) {
        if(v !== 5) return v;
        var minguo = birthYear - 1911;
        if(minguo < 13) return isMale ? 8 : 2;
        else if(minguo <= 72) {
            if(isMale) return isYangYearFlag ? 8 : 2;
            else return isYangYearFlag ? 2 : 8;
        } else return isMale ? 9 : 7;
    };

    var yz = bz.getYearZhi();
    var YZ_YANG = ['å­','å¯…','è¾°','åˆ','ç”³','æˆŒ'];
    var isYangYearFlag = YZ_YANG.indexOf(yz) >= 0;
    
    var tGuaCode = getGuaNum(ts, 25);
    var dGuaCode = getGuaNum(ds, 30);
    tGuaCode = handle5Palace(tGuaCode, y, isMale, isYangYearFlag);
    dGuaCode = handle5Palace(dGuaCode, y, isMale, isYangYearFlag);
    
    var tGua = GUA_MAP[tGuaCode];
    var dGua = GUA_MAP[dGuaCode];
    var isTypeA = (isMale && isYangYearFlag) || (!isMale && !isYangYearFlag);
    var upper = isTypeA ? tGua : dGua;
    var lower = isTypeA ? dGua : tGua;

    var xtYaos = GUA_BITS[lower].slice().concat(GUA_BITS[upper].slice());
    var hz = bz.getTimeZhi();
    var yt = calcYuanTang(xtYaos, hz);
    var xtObj = { yaos: xtYaos.slice(), yt: yt };

    var xtGuaName = getGuaName(xtYaos);
    var lunarMonth = lunar.getMonth();
    var isYangLing = (lunarMonth >= 11 || lunarMonth <= 4);
    
    var htYaos = xtYaos.slice();
    var htYt = yt <= 3 ? yt + 3 : yt - 3;
    var isZunGua = ['åä¸ºæ°´', 'æ°´é›·å±¯', 'æ°´å±±è¹‡'].indexOf(xtGuaName) >= 0;
    
    if(isZunGua && yt === 5) {
        if(isYangLing) htYaos[yt - 1] = 1 - htYaos[yt - 1];
    } else if(isZunGua && yt === 6) {
        if(!isYangLing) htYaos[yt - 1] = 1 - htYaos[yt - 1];
    } else {
        htYaos[yt - 1] = 1 - htYaos[yt - 1];
    }
    
    var htYaosNew = htYaos.slice(3, 6).concat(htYaos.slice(0, 3));
    var htObj = { yaos: htYaosNew, yt: htYt };

    renderGua(xtObj, 'n-xt', 'g-xt');
    renderGua(htObj, 'n-ht', 'g-ht');
    
    var yangYaoOrder = buildYangYaoOrder(xtObj, htObj);
    
    renderDayun(xtObj, htObj);

    G = { by: y, xt: xtObj, ht: htObj, yangYaoOrder: yangYaoOrder };
    calcFlow();
}

function renderGua(g, nid, gid) {
    // #region agent log
    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:renderGua',message:'å¼€å§‹æ¸²æŸ“å¦å›¾',data:{nid:nid,gid:gid,hasG:!!g,hasYaos:g?!!g.yaos:false,yaosLength:g&&g.yaos?g.yaos.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'E'})}).catch(()=>{});
    // #endregion
    var nameEl = document.getElementById(nid);
    var guaEl = document.getElementById(gid);
    if(!nameEl || !guaEl) {
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:renderGua',message:'å…ƒç´ ä¸å­˜åœ¨',data:{hasNameEl:!!nameEl,hasGuaEl:!!guaEl},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'E'})}).catch(()=>{});
        // #endregion
        return;
    }
    nameEl.innerText = getGuaName(g.yaos);
    var h = '';
    for(var i = 5; i >= 0; i--) {
        var isYt = g.yt === (i + 1);
        var yaoVal = g.yaos[i];
        var bar = yaoVal === 1 ? '<div class="yang"></div>' : '<div class="yin-group"><div class="yin-part"></div><div class="yin-part"></div></div>';
        var yaoName = getYaoName(i);
        h += '<div class="yao-line ' + (isYt ? 'is-yt' : '') + '"><div class="idx-text">' + yaoName + '</div>' + bar + (isYt ? '<div class="yt-text">â† å…ƒå ‚</div>' : '') + '</div>';
    }
    guaEl.innerHTML = h;
    // #region agent log
    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:renderGua',message:'å¦å›¾æ¸²æŸ“å®Œæˆ',data:{nid:nid,gid:gid,htmlLength:h.length,guaElInnerHTML:guaEl.innerHTML.length},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'E'})}).catch(()=>{});
    // #endregion
}

function renderDayun(xt, ht) {
    var h = '', age = 1;
    var cardIndex = 0;
    for(var i = 0; i < 6; i++) {
        var yaoIdx = (xt.yt - 1 + i) % 6;
        var yaoVal = xt.yaos[yaoIdx];
        var span = (yaoVal === 1) ? 9 : 6;
        var end = age + span - 1;
        var yaoName = getYaoName(yaoIdx);
        h += '<div class="dy-card" style="cursor: pointer;" onclick="showLiunianForYao(' + cardIndex + ')" ' +
             'data-type="xt" data-yao-index="' + yaoIdx + '" data-yao-val="' + yaoVal + '" ' +
             'data-start-age="' + age + '" data-end-age="' + end + '" data-base-yuantang="' + xt.yt + '">' +
             '<div class="dy-title">å…ˆå¤©' + yaoName + 'çˆ»</div><div class="dy-range">' + age + '-' + end + 'å²</div></div>';
        age = end + 1;
        cardIndex++;
    }
    for(var i = 0; i < 6; i++) {
        var yaoIdx = (ht.yt - 1 + i) % 6;
        var yaoVal = ht.yaos[yaoIdx];
        var span = (yaoVal === 1) ? 9 : 6;
        var end = age + span - 1;
        var yaoName = getYaoName(yaoIdx);
        h += '<div class="dy-card" style="cursor: pointer;" onclick="showLiunianForYao(' + cardIndex + ')" ' +
             'data-type="ht" data-yao-index="' + yaoIdx + '" data-yao-val="' + yaoVal + '" ' +
             'data-start-age="' + age + '" data-end-age="' + end + '" data-base-yuantang="' + ht.yt + '">' +
             '<div class="dy-title">åå¤©' + yaoName + 'çˆ»</div><div class="dy-range">' + age + '-' + end + 'å²</div></div>';
        age = end + 1;
        cardIndex++;
    }
    document.getElementById('dy-area').innerHTML = h;
}

// ==================== æ˜¾ç¤ºé€‰ä¸­çˆ»çš„æ‰€æœ‰æµå¹´å¦ ====================
function showLiunianForYao(cardIndex) {
    if(!G) return;
    
    // è·å–æ‰€æœ‰ dy-card
    var cards = document.querySelectorAll('.dy-card');
    if(cardIndex >= cards.length) return;
    
    var card = cards[cardIndex];
    var type = card.getAttribute('data-type');
    var yaoIndex = parseInt(card.getAttribute('data-yao-index'));
    var yaoVal = parseInt(card.getAttribute('data-yao-val'));
    var startAge = parseInt(card.getAttribute('data-start-age'));
    var endAge = parseInt(card.getAttribute('data-end-age'));
    var baseYuantang = parseInt(card.getAttribute('data-base-yuantang'));
    
    // è·å–åŸºç¡€å¦
    var baseGua = type === 'xt' ? G.xt : G.ht;
    var baseYaos = baseGua.yaos.slice();
    
    // è®¡ç®—å¤§è¿å…ƒå ‚ï¼ˆè¯¥çˆ»çš„ä½ç½®ï¼‰
    var dayunYuantang = yaoIndex + 1;
    
    // è®¡ç®—è¯¥çˆ»çš„å¹´ä»½æ•°
    var years = (yaoVal === 1) ? 9 : 6;
    var isYangYao = yaoVal === 1;
    
    // è®¡ç®—å¤§è¿ç¬¬ä¸€å¹´çš„å¤©å¹²
    var firstYear = G.by + startAge - 1;
    var firstYearGan = (firstYear - 4) % 10;
    var isFirstYearYangGan = [0, 2, 4, 6, 8].indexOf(firstYearGan) >= 0;
    
    // åˆ›å»ºå¼¹çª—
    var dialog = document.createElement('div');
    dialog.id = 'liunianDialog';
    dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center; overflow-y: auto;';
    
    var content = document.createElement('div');
    content.style.cssText = 'background: #f5f3ef; border: 2px solid #8b6f47; border-radius: 8px; padding: 12px; width: 95%; max-width: 450px; max-height: 90vh; overflow-y: auto; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative; margin: 10px; box-sizing: border-box;';
    
    var dayunTypeName = type === 'xt' ? 'å…ˆå¤©' : 'åå¤©';
    var yaoName = getYaoName(yaoIndex);
    
    var html = '<div style="margin-bottom: 12px; border-bottom: 2px solid #8b6f47; padding-bottom: 8px;">';
    html += '<h3 style="margin: 0; color: #5c4a37; font-size: 14px; font-weight: bold; line-height: 1.5; word-wrap: break-word; white-space: normal; padding: 0 5px;">' + dayunTypeName + yaoName + 'çˆ»è¿ (' + startAge + '-' + endAge + 'å²) æµå¹´å¦</h3>';
    html += '</div>';
    
    html += '<div style="display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 12px;">';
    
    // è®¡ç®—æ¯å¹´çš„æµå¹´å¦
    // éœ€è¦ä¿å­˜åŸå§‹åŸºç¡€å¦ï¼Œå› ä¸º calcLiunianInDayun ä¼šä¿®æ”¹ä¼ å…¥çš„æ•°ç»„
    var originalBaseYaos = baseYaos.slice();
    
    // ç¦ç”¨è°ƒè¯•ä¿¡æ¯æ˜¾ç¤º
    var oldSuppressFlag = window.suppressDebugInfo;
    window.suppressDebugInfo = true;
    
    for(var year = 1; year <= years; year++) {
        var age = startAge + year - 1;
        
        // æ¯æ¬¡è®¡ç®—éƒ½ä½¿ç”¨åŸå§‹åŸºç¡€å¦çš„å‰¯æœ¬
        var liunian = calcLiunianInDayun(
            originalBaseYaos.slice(),
            dayunYuantang,
            year,
            G.by,
            startAge,
            isYangYao
        );
        
        // #region agent log
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:showLiunianForYao',message:'æµå¹´å¦è®¡ç®—ç»“æœ',data:{year:year,age:age,liunianYaos:liunian.yaos,liunianYt:liunian.yt,guaName:getGuaName(liunian.yaos)},timestamp:Date.now(),sessionId:'debug-session',runId:'fix-yao-display',hypothesisId:'B'})}).catch(()=>{});
        // #endregion
        
        var guaName = getGuaName(liunian.yaos);
        var liunianInfo = dayunTypeName + yaoName + 'çˆ»è¿ ç¬¬' + year + 'å¹´';
        
        // åˆ›å»ºå¦å›¾çš„HTML
        var guaHtml = '';
        for(var i = 5; i >= 0; i--) {
            var isYt = liunian.yt === (i + 1);
            var yaoVal = liunian.yaos[i];
            // #region agent log
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:showLiunianForYao',message:'æ¸²æŸ“çˆ»',data:{year:year,yaoIndex:i,yaoVal:yaoVal,isYt:isYt,liunianYt:liunian.yt},timestamp:Date.now(),sessionId:'debug-session',runId:'fix-yao-display',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            var bar = yaoVal === 1 ? '<div class="yang" style="width: 100%; height: 12px; background: ' + (isYt ? '#ff4d4f' : '#333') + '; border-radius: 2px;"></div>' : '<div class="yin-group" style="width: 100%; height: 12px; display: flex; justify-content: space-between; gap: 6px;"><div class="yin-part" style="flex: 1; background: ' + (isYt ? '#ff4d4f' : '#333') + '; border-radius: 2px;"></div><div class="yin-part" style="flex: 1; background: ' + (isYt ? '#ff4d4f' : '#333') + '; border-radius: 2px;"></div></div>';
            var yaoNameInGua = getYaoName(i);
            // #region agent log
            fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:showLiunianForYao',message:'ç”Ÿæˆæµå¹´å¦çˆ»',data:{yaoIndex:i,yaoVal:yaoVal,isYt:isYt,yaoName:yaoNameInGua},timestamp:Date.now(),sessionId:'debug-session',runId:'fix-yt-length',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            guaHtml += '<div class="yao-line ' + (isYt ? 'is-yt' : '') + '" style="height: 14px; display: flex; align-items: center; margin-bottom: 3px;">';
            guaHtml += '<div class="idx-text" style="width: 22px; text-align: right; font-size: 9pt; margin-right: 6px; color: #666; flex-shrink: 0;">' + yaoNameInGua + '</div>';
            guaHtml += '<div style="flex: 1; height: 12px; display: flex; align-items: center;">' + bar + '</div>';
            if(isYt) {
                guaHtml += '<div class="yt-text" style="color: #ff4d4f; font-size: 9px; font-weight: bold; line-height: 14px; white-space: nowrap; margin-left: 4px; flex-shrink: 0;">â† å…ƒå ‚</div>';
            }
            guaHtml += '</div>';
        }
        
        // ä¿å­˜æµå¹´å¦æ•°æ®
        var liunianData = {
            yaos: liunian.yaos.slice(),
            yt: liunian.yt,
            age: age,
            guaName: guaName,
            liunianInfo: liunianInfo,
            dayunTypeName: dayunTypeName,
            yaoName: yaoName
        };
        var liunianDataStr = encodeURIComponent(JSON.stringify(liunianData));
        
        html += '<div class="flow-item liunian-item" data-liunian="' + liunianDataStr.replace(/"/g, '&quot;') + '" style="background: #fff; padding: 10px; border-radius: 6px; text-align: center; border: 1px solid #e6f7ff; box-shadow: 0 2px 6px rgba(0,0,0,0.02); width: 100%; box-sizing: border-box; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.borderColor=\'#1890ff\'; this.style.boxShadow=\'0 2px 8px rgba(24,144,255,0.3)\';" onmouseout="this.style.borderColor=\'#e6f7ff\'; this.style.boxShadow=\'0 2px 6px rgba(0,0,0,0.02)\';">';
        html += '<div class="flow-label" style="font-size: 10px; color: #888; margin-bottom: 4px; font-weight: bold;">æµå¹´ï¼ˆå¤©çºªç®—æ³•ï¼‰</div>';
        html += '<div class="flow-val" style="font-size: 14px; font-weight: bold; color: #333; margin-bottom: 6px; word-wrap: break-word; white-space: normal; line-height: 1.3; overflow-wrap: break-word;">' + guaName + '</div>';
        html += '<div class="yao-stack" style="display: flex; flex-direction: column; gap: 4px; width: 100%; max-width: 150px; margin: 6px auto; position: relative;">';
        html += guaHtml;
        html += '</div>';
        html += '<div class="flow-extra" style="font-size: 9px; color: #666; margin-top: 6px; line-height: 1.5; word-wrap: break-word; white-space: normal; padding: 0 3px; overflow-wrap: break-word;">' + getYaoName(liunian.yt - 1) + 'çˆ»å…ƒå ‚ | ' + age + 'å² ' + liunianInfo + '</div>';
        html += '</div>';
    }
    
    // æ¢å¤è°ƒè¯•ä¿¡æ¯æ˜¾ç¤º
    window.suppressDebugInfo = oldSuppressFlag;
    
    html += '</div>';
    html += '<button onclick="document.getElementById(\'liunianDialog\').remove();" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #8b6f47; border: none; width: 28px; height: 28px; border-radius: 4px; cursor: pointer; font-size: 18px; line-height: 1; padding: 0; display: flex; align-items: center; justify-content: center; transition: background 0.2s; z-index: 10001;" onmouseover="this.style.background=\'#f0ebe0\';" onmouseout="this.style.background=\'transparent\';">Ã—</button>';
    
    content.innerHTML = html;
    dialog.appendChild(content);
    document.body.appendChild(dialog);
    
    // ä¸ºæ¯ä¸ªæµå¹´å¦æ·»åŠ ç‚¹å‡»äº‹ä»¶
    var liunianItems = content.querySelectorAll('.liunian-item');
    for(var i = 0; i < liunianItems.length; i++) {
        liunianItems[i].addEventListener('click', function(e) {
            e.stopPropagation();
            var dataStr = this.getAttribute('data-liunian');
            if(dataStr) {
                var liunianData = JSON.parse(decodeURIComponent(dataStr));
                showLiuyueForLiunian(liunianData);
            }
        });
    }
    
    // ç‚¹å‡»èƒŒæ™¯å…³é—­
    dialog.onclick = function(e) {
        if(e.target === dialog) {
            dialog.remove();
        }
    };
}

// ==================== æ˜¾ç¤ºæµå¹´å¦çš„æ‰€æœ‰æµæœˆå¦ ====================
function showLiuyueForLiunian(liunianData) {
    if(!G) return;
    
    var liunianYaos = liunianData.yaos;
    var liunianYt = liunianData.yt;
    var age = liunianData.age;
    var guaName = liunianData.guaName;
    var liunianInfo = liunianData.liunianInfo;
    var dayunTypeName = liunianData.dayunTypeName;
    var yaoName = liunianData.yaoName;
    
    // åœ¨ä¸»çª—å£ä¸­è®¡ç®—æ‰€æœ‰12ä¸ªæœˆçš„æµæœˆå¦æ•°æ®
    var liuyueList = [];
    var monthNames = ['æ­£æœˆ', 'äºŒæœˆ', 'ä¸‰æœˆ', 'å››æœˆ', 'äº”æœˆ', 'å…­æœˆ', 'ä¸ƒæœˆ', 'å…«æœˆ', 'ä¹æœˆ', 'åæœˆ', 'å†¬æœˆ', 'è…Šæœˆ'];
    var yaoNames = ['åˆ', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'ä¸Š'];
    
    for(var month = 1; month <= 12; month++) {
        var liuyue = calcLiuyueGua(liunianYaos, liunianYt, month);
        var liuyueGuaName = getGuaName(liuyue.yaos);
        
        // åˆ›å»ºå¦å›¾çš„HTML
        var guaHtml = '';
        for(var i = 5; i >= 0; i--) {
            var isYt = liuyue.yt === (i + 1);
            var yaoVal = liuyue.yaos[i];
            // #region agent log
            fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:showLiuyueForLiunian',message:'ç”Ÿæˆæµæœˆå¦çˆ»',data:{month:month,yaoIndex:i,yaoVal:yaoVal,isYt:isYt,liuyueYt:liuyue.yt},timestamp:Date.now(),sessionId:'debug-session',runId:'fix-yt-length-v2',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            var bar = yaoVal === 1 ? 
                '<div class="yang" style="width: 100%; height: 12px; background: ' + (isYt ? '#ff4d4f' : '#333') + '; border-radius: 2px;"></div>' : 
                '<div class="yin-group" style="width: 100%; height: 12px; display: flex; justify-content: space-between; gap: 6px;"><div class="yin-part" style="flex: 1; background: ' + (isYt ? '#ff4d4f' : '#333') + '; border-radius: 2px;"></div><div class="yin-part" style="flex: 1; background: ' + (isYt ? '#ff4d4f' : '#333') + '; border-radius: 2px;"></div></div>';
            var yaoNameInGua = yaoNames[i];
            // #region agent log
            fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:showLiuyueForLiunian',message:'ç”Ÿæˆæµæœˆå¦HTML',data:{month:month,yaoIndex:i,yaoVal:yaoVal,isYt:isYt,liuyueYt:liuyue.yt},timestamp:Date.now(),sessionId:'debug-session',runId:'fix-yt-length-v3',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            guaHtml += '<div class="yao-line ' + (isYt ? 'is-yt' : '') + '" style="height: 14px; display: flex; align-items: center; margin-bottom: 3px;">';
            guaHtml += '<div class="idx-text" style="width: 22px; text-align: right; font-size: 9pt; margin-right: 6px; color: #666; flex-shrink: 0;">' + yaoNameInGua + '</div>';
            // ä¸ºæ‰€æœ‰çˆ»é¢„ç•™"â† å…ƒå ‚"æ–‡æœ¬çš„ç©ºé—´ï¼ˆçº¦20pxï¼‰ï¼Œç¡®ä¿æ‰€æœ‰çˆ»çš„barå®¹å™¨å®½åº¦ä¸€è‡´
            // è¿™æ ·å…ƒå ‚çˆ»å’Œéå…ƒå ‚çˆ»çš„barå®¹å™¨å®½åº¦å®Œå…¨ä¸€è‡´
            guaHtml += '<div style="flex: 1; height: 12px; display: flex; align-items: center; margin-right: 20px;">' + bar + '</div>';
            if(isYt) {
                guaHtml += '<div class="yt-text" style="color: #ff4d4f; font-size: 9px; font-weight: bold; line-height: 14px; white-space: nowrap; width: 20px; flex-shrink: 0; text-align: left;">â† å…ƒå ‚</div>';
            } else {
                // éå…ƒå ‚çˆ»ä¹Ÿé¢„ç•™ç›¸åŒå®½åº¦çš„ç©ºé—´ï¼Œç¡®ä¿æ‰€æœ‰çˆ»çš„barå®¹å™¨å®½åº¦ä¸€è‡´
                guaHtml += '<div style="width: 20px; flex-shrink: 0;"></div>';
            }
            guaHtml += '</div>';
        }
        
        liuyueList.push({
            month: month,
            monthName: monthNames[month - 1],
            guaName: liuyueGuaName,
            yaos: liuyue.yaos.slice(),
            yt: liuyue.yt,
            guaHtml: guaHtml
        });
    }
    
    // åˆ›å»ºæ–°çª—å£
    var newWindow = window.open('', '_blank', 'width=600,height=800,scrollbars=yes');
    if(!newWindow) {
        alert('æ— æ³•æ‰“å¼€æ–°çª—å£ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å¼¹çª—è®¾ç½®');
        return;
    }
    
    // å†™å…¥HTMLå†…å®¹
    newWindow.document.write('<!DOCTYPE html><html><head><meta charset="UTF-8"><title>æµæœˆå¦ - ' + age + 'å²</title>');
    newWindow.document.write('<style>');
    newWindow.document.write('body { font-family: Arial, sans-serif; background: #f5f3ef; padding: 20px; margin: 0; }');
    newWindow.document.write('.header { background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 2px solid #8b6f47; }');
    newWindow.document.write('.header h2 { margin: 0; color: #5c4a37; font-size: 16px; }');
    newWindow.document.write('.header p { margin: 5px 0 0 0; color: #666; font-size: 12px; }');
    newWindow.document.write('.liuyue-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }');
    newWindow.document.write('.liuyue-item { background: #fff; padding: 12px; border-radius: 6px; text-align: center; border: 1px solid #e6f7ff; box-shadow: 0 2px 6px rgba(0,0,0,0.02); }');
    newWindow.document.write('.liuyue-label { font-size: 10px; color: #888; margin-bottom: 4px; font-weight: bold; }');
    newWindow.document.write('.liuyue-val { font-size: 14px; font-weight: bold; color: #333; margin-bottom: 6px; }');
    newWindow.document.write('.yao-stack { display: flex; flex-direction: column; gap: 4px; width: 100%; max-width: 150px; margin: 6px auto; position: relative; }');
    newWindow.document.write('.yao-line { height: 14px; display: flex; align-items: center; margin-bottom: 3px; }');
    newWindow.document.write('.idx-text { width: 22px; text-align: right; font-size: 9pt; margin-right: 6px; color: #666; flex-shrink: 0; }');
    newWindow.document.write('.yang { width: 100%; height: 12px; background: #333; border-radius: 2px; }');
    newWindow.document.write('.yin-group { width: 100%; height: 12px; display: flex; justify-content: space-between; gap: 6px; }');
    newWindow.document.write('.yin-part { flex: 1; background: #333; border-radius: 2px; }');
    newWindow.document.write('.yt-text { color: #ff4d4f; font-size: 9px; font-weight: bold; line-height: 14px; white-space: nowrap; width: 20px; flex-shrink: 0; text-align: left; }');
    // ç¡®ä¿æ‰€æœ‰çˆ»çš„barå®¹å™¨å®½åº¦ä¸€è‡´ï¼Œé˜²æ­¢å…ƒå ‚æ–‡æœ¬å‹ç¼©barå®¹å™¨
    newWindow.document.write('.yao-line > div:nth-child(2) { min-width: 0; }');
    newWindow.document.write('.liuyue-extra { font-size: 9px; color: #666; margin-top: 6px; line-height: 1.5; }');
    newWindow.document.write('</style></head><body>');
    
    // æ ‡é¢˜
    newWindow.document.write('<div class="header">');
    newWindow.document.write('<h2>' + age + 'å² æµæœˆå¦</h2>');
    newWindow.document.write('<p>æµå¹´å¦ï¼š' + guaName + ' | ' + yaoNames[liunianYt - 1] + 'çˆ»å…ƒå ‚ | ' + liunianInfo + '</p>');
    newWindow.document.write('</div>');
    
    // æµæœˆå¦ç½‘æ ¼
    newWindow.document.write('<div class="liuyue-grid">');
    
    // è¾“å‡ºæ‰€æœ‰æµæœˆå¦
    for(var i = 0; i < liuyueList.length; i++) {
        var item = liuyueList[i];
        newWindow.document.write('<div class="liuyue-item">');
        newWindow.document.write('<div class="liuyue-label">æµæœˆï¼ˆå¤©çºªç®—æ³•ï¼‰</div>');
        newWindow.document.write('<div class="liuyue-val">' + item.monthName + '</div>');
        newWindow.document.write('<div class="liuyue-val" style="font-size: 13px;">' + item.guaName + '</div>');
        newWindow.document.write('<div class="yao-stack">');
        newWindow.document.write(item.guaHtml);
        newWindow.document.write('</div>');
        newWindow.document.write('<div class="liuyue-extra">' + yaoNames[item.yt - 1] + 'çˆ»å…ƒå ‚ | å†œå†' + item.month + 'æœˆ</div>');
        newWindow.document.write('</div>');
    }
    
    newWindow.document.write('</div>');
    newWindow.document.write('</body></html>');
    newWindow.document.close();
}

// ==================== æ ¸å¿ƒï¼šæµå¹´å¦è®¡ç®—ï¼ˆä¸¥æ ¼æŒ‰ç…§è§„åˆ™ï¼‰ ====================
function calcLiunianInDayun(baseYaos, dayunYuantang, yearInDayun, birthYear, dayunStartAge, isYangYao) {
    var debugInfo = [];
    var currentYaos = baseYaos.slice();
    var currentYt = dayunYuantang;
    
    // è®¡ç®—å¤§è¿ç¬¬ä¸€å¹´çš„å¤©å¹²
    var firstYear = birthYear + dayunStartAge - 1;
    var firstYearGan = (firstYear - 4) % 10; // 0:ç”², 1:ä¹™, 2:ä¸™, 3:ä¸, 4:æˆŠ, 5:å·±, 6:åºš, 7:è¾›, 8:å£¬, 9:ç™¸
    var isFirstYearYangGan = [0, 2, 4, 6, 8].indexOf(firstYearGan) >= 0; // ç”²ä¸™æˆŠåºšå£¬
    
    debugInfo.push("å¤§è¿ç¬¬ä¸€å¹´: " + firstYear + "å¹´, å¤©å¹²: " + GAN_NAMES[firstYearGan] + 
                  ", æ˜¯å¦ä¸ºç”²ä¸™æˆŠåºšå£¬: " + (isFirstYearYangGan ? "æ˜¯(è§„åˆ™ä¸€)" : "å¦(è§„åˆ™äºŒ)"));
    
    for(var yr = 1; yr <= yearInDayun; yr++) {
        debugInfo.push("--- ç¬¬" + yr + "å¹´ ---");
        
        if(isYangYao) {
            // é˜³çˆ»è§„åˆ™
            if(isFirstYearYangGan) {
                // è§„åˆ™ä¸€ï¼šç¬¬ä¸€å¹´æ˜¯ç”²ä¸™æˆŠåºšå£¬
                if(yr === 1) {
                    // ç¬¬1å¹´ï¼šä¸å˜çˆ»
                    debugInfo.push("è§„åˆ™ä¸€ç¬¬1å¹´ï¼šç”²ä¸™æˆŠåºšå£¬å¹´ï¼Œä¸å˜çˆ»");
                    currentYt = dayunYuantang;
                } else if(yr === 2) {
                    // ç¬¬2å¹´ï¼šå–åº”çˆ»ï¼ˆå…ƒå ‚+3ï¼‰
                    var yingYao = ((dayunYuantang - 1 + 3) % 6);
                    debugInfo.push("è§„åˆ™ä¸€ç¬¬2å¹´ï¼šå˜åº”çˆ»ï¼ˆå…ƒå ‚" + dayunYuantang + "+3 = " + (yingYao+1) + "çˆ»ï¼‰");
                    currentYaos[yingYao] = 1 - currentYaos[yingYao];
                    currentYt = yingYao + 1;
                } else if(yr === 3) {
                    // ç¬¬3å¹´ï¼šå˜ç¬¬äºŒå¹´æµå¹´å¦çš„åº”çˆ»ï¼ˆå³å˜ç¬¬ä¸€å¹´å…ƒå ‚ï¼‰
                    debugInfo.push("è§„åˆ™ä¸€ç¬¬3å¹´ï¼šå˜ç¬¬äºŒå¹´æµå¹´å¦çš„åº”çˆ»ï¼ˆå³å˜ç¬¬ä¸€å¹´å…ƒå ‚" + dayunYuantang + "çˆ»ï¼‰");
                    currentYaos[dayunYuantang - 1] = 1 - currentYaos[dayunYuantang - 1];
                    currentYt = dayunYuantang;
                } else {
                    // ç¬¬4-9å¹´ï¼šæ¯å¹´ä¸Šæ¨ä¸€çˆ»ï¼ˆåŸºäºä¸Šä¸€å¹´æµå¹´å¦ï¼‰
                    var prevYt = currentYt;
                    var yaoToChange = ((prevYt - 1 + 1) % 6); // ä¸Šæ¨ä¸€çˆ»
                    debugInfo.push("è§„åˆ™ä¸€ç¬¬" + yr + "å¹´ï¼šä¸Šä¸€å¹´å…ƒå ‚" + prevYt + "çˆ»ï¼Œä¸Šæ¨ä¸€çˆ»å˜" + (yaoToChange+1) + "çˆ»");
                    currentYaos[yaoToChange] = 1 - currentYaos[yaoToChange];
                    currentYt = yaoToChange + 1;
                }
            } else {
                // è§„åˆ™äºŒï¼šç¬¬ä¸€å¹´æ˜¯ä¹™ä¸å·±è¾›ç™¸
                if(yr === 1) {
                    // ç¬¬1å¹´ï¼šå˜å…ƒå ‚çˆ»
                    debugInfo.push("è§„åˆ™äºŒç¬¬1å¹´ï¼šä¹™ä¸å·±è¾›ç™¸å¹´ï¼Œå˜å…ƒå ‚" + dayunYuantang + "çˆ»");
                    currentYaos[dayunYuantang - 1] = 1 - currentYaos[dayunYuantang - 1];
                    currentYt = dayunYuantang;
                } else {
                    // ç¬¬2-9å¹´ï¼šæ¯å¹´ä¸Šæ¨ä¸€çˆ»ï¼ˆåŸºäºä¸Šä¸€å¹´æµå¹´å¦ï¼‰
                    var prevYt = currentYt;
                    var yaoToChange = ((prevYt - 1 + 1) % 6); // ä¸Šæ¨ä¸€çˆ»
                    debugInfo.push("è§„åˆ™äºŒç¬¬" + yr + "å¹´ï¼šä¸Šä¸€å¹´å…ƒå ‚" + prevYt + "çˆ»ï¼Œä¸Šæ¨ä¸€çˆ»å˜" + (yaoToChange+1) + "çˆ»");
                    currentYaos[yaoToChange] = 1 - currentYaos[yaoToChange];
                    currentYt = yaoToChange + 1;
                }
            }
        } else {
            // é˜´çˆ»è§„åˆ™ï¼ˆ6å¹´è¿ï¼‰
            if(yr === 1) {
                // ç¬¬1å¹´ï¼šå˜å…ƒå ‚çˆ»
                debugInfo.push("é˜´çˆ»è§„åˆ™ç¬¬1å¹´ï¼šå˜å…ƒå ‚" + dayunYuantang + "çˆ»");
                currentYaos[dayunYuantang - 1] = 1 - currentYaos[dayunYuantang - 1];
                currentYt = dayunYuantang;
            } else {
                // ç¬¬2-6å¹´ï¼šæ¯å¹´ä¸Šæ¨ä¸€çˆ»ï¼ˆåŸºäºä¸Šä¸€å¹´æµå¹´å¦ï¼‰
                var prevYt = currentYt;
                var yaoToChange = ((prevYt - 1 + 1) % 6); // ä¸Šæ¨ä¸€çˆ»
                debugInfo.push("é˜´çˆ»è§„åˆ™ç¬¬" + yr + "å¹´ï¼šä¸Šä¸€å¹´å…ƒå ‚" + prevYt + "çˆ»ï¼Œä¸Šæ¨ä¸€çˆ»å˜" + (yaoToChange+1) + "çˆ»");
                currentYaos[yaoToChange] = 1 - currentYaos[yaoToChange];
                currentYt = yaoToChange + 1;
            }
        }
    }
    
    // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼ˆå¦‚æœdebug-infoå…ƒç´ å­˜åœ¨ä¸”æœªè¢«ç¦ç”¨ï¼‰
    var debugEl = document.getElementById('debug-info');
    if(debugInfo.length > 0 && debugEl && !window.suppressDebugInfo) {
        debugEl.innerHTML = "<strong>æµå¹´å¦è®¡ç®—è¿‡ç¨‹:</strong><br>" + debugInfo.join("<br>");
        debugEl.style.display = 'block';
    }
    
    return { yaos: currentYaos, yt: currentYt };
}

// ==================== æµæœˆå¦è®¡ç®—ï¼ˆä¸¥æ ¼æŒ‰ç…§è§„åˆ™ï¼‰ ====================
function calcLiuyueGua(liunianYaos, liunianYt, lunarMonth) {
    var debugInfo = [];
    debugInfo.push("æµæœˆè®¡ç®—ï¼šå†œå†" + lunarMonth + "æœˆï¼Œæµå¹´å…ƒå ‚ï¼š" + liunianYt + "çˆ»");
    
    // è®¡ç®—å¥‡æ•°æœˆï¼ˆ1,3,5,7,9,11æœˆï¼‰
    var oddMonthYaos = [];
    var oddMonthYt = [];
    
    for(var i = 1; i <= 6; i++) {
        var monthNum = i * 2 - 1; // 1,3,5,7,9,11
        var yaos, yt;
        
        if(i === 1) {
            // ä¸€æœˆï¼šå˜æµå¹´å…ƒå ‚
            yaos = liunianYaos.slice();
            yaos[liunianYt - 1] = 1 - yaos[liunianYt - 1];
            yt = liunianYt;
            debugInfo.push("ä¸€æœˆï¼šå˜æµå¹´å…ƒå ‚" + liunianYt + "çˆ»");
        } else {
            // å…¶ä»–å¥‡æ•°æœˆï¼šå˜ä¸Šä¸€å¥‡æ•°æœˆæµæœˆå¦çš„ï¼ˆæµå¹´å…ƒå ‚+(i-1)ï¼‰çˆ»
            var prevYaos = oddMonthYaos[i-2];
            var prevYt = oddMonthYt[i-2];
            
            // è®¡ç®—è¦å˜çš„çˆ»ä½ï¼š(æµå¹´å…ƒå ‚+(i-1)-1) % 6
            var yaoToChange = ((liunianYt - 1 + (i-1)) % 6);
            yaos = prevYaos.slice();
            yaos[yaoToChange] = 1 - yaos[yaoToChange];
            yt = yaoToChange + 1;
            
            debugInfo.push(monthNum + "æœˆï¼šå˜æµå¹´å…ƒå ‚" + liunianYt + "+" + (i-1) + " = " + (yaoToChange+1) + "çˆ»");
        }
        
        oddMonthYaos.push(yaos);
        oddMonthYt.push(yt);
    }
    
    // æ ¹æ®å½“å‰æœˆä»½é€‰æ‹©ç»“æœ
    var monthIndex = Math.ceil(lunarMonth / 2) - 1; // 0-5
    var isOddMonth = (lunarMonth % 2 === 1);
    
    if(isOddMonth) {
        // å¥‡æ•°æœˆï¼šç›´æ¥è¿”å›å¯¹åº”çš„å¥‡æ•°æœˆå¦
        debugInfo.push("å†œå†" + lunarMonth + "æœˆä¸ºå¥‡æ•°æœˆï¼Œè¿”å›" + (monthIndex+1) + "å¥‡æ•°æœˆå¦");
        return { yaos: oddMonthYaos[monthIndex], yt: oddMonthYt[monthIndex] };
    } else {
        // å¶æ•°æœˆï¼šåœ¨å¯¹åº”çš„å¥‡æ•°æœˆå¦åŸºç¡€ä¸Šå˜åº”çˆ»
        var oddYaos = oddMonthYaos[monthIndex];
        var oddYt = oddMonthYt[monthIndex];
        var yingYao = ((oddYt - 1 + 3) % 6);
        var evenYaos = oddYaos.slice();
        evenYaos[yingYao] = 1 - evenYaos[yingYao];
        
        debugInfo.push("å†œå†" + lunarMonth + "æœˆä¸ºå¶æ•°æœˆï¼Œåœ¨" + (lunarMonth-1) + "æœˆå¦åŸºç¡€ä¸Šå˜åº”çˆ»ï¼ˆ" + oddYt + "+3 = " + (yingYao+1) + "çˆ»ï¼‰");
        return { yaos: evenYaos, yt: yingYao + 1 };
    }
}

// ==================== æµæ—¥å¦è®¡ç®—ï¼ˆä¸¥æ ¼æŒ‰ç…§è§„åˆ™ï¼‰ ====================
function calcLiuriGua(liuyueYaos, liuyueYt, dayIndex, totalParts) {
    // è§„åˆ™ï¼šä»æµæœˆå¦å…ƒå ‚å¼€å§‹ï¼Œæ¯å¤©å˜ä¸€çˆ»ï¼Œæ¯çˆ»ç®¡ä¸€æ—¥ï¼Œæ¯å¦ç®¡å…­æ—¥
    // dayIndex: å½“å‰åœ¨èŠ‚æ°”ä¸­çš„ç¬¬å‡ å¤©ï¼ˆä»0å¼€å§‹ï¼‰
    // totalParts: èŠ‚æ°”æ€»å¤©æ•°
    
    // è®¡ç®—å½“å‰åº”è¯¥å˜å“ªä¸€çˆ»
    var yaoOffset = dayIndex % 6;  // æ¯6å¤©ä¸€ä¸ªå¾ªç¯
    
    // å¤åˆ¶æµæœˆå¦
    var result = liuyueYaos.slice();
    
    // å˜å¯¹åº”çš„çˆ»ä½
    var changedYao = ((liuyueYt - 1 + yaoOffset) % 6);
    result[changedYao] = 1 - result[changedYao];
    
    // è®¡ç®—æ–°çš„å…ƒå ‚ä½ç½®ï¼ˆå…ƒå ‚+1ï¼‰
    var newYt = ((liuyueYt - 1 + 1) % 6) + 1;
    
    return { 
        yaos: result, 
        yt: newYt, 
        yaoOffset: yaoOffset,
        dayInCycle: (dayIndex % 6) + 1  // å½“å‰åœ¨ç¬¬å‡ å¤©ï¼ˆ1-6ï¼‰
    };
}

// ==================== æµæ—¶å¦è®¡ç®—ï¼ˆä¸¥æ ¼æŒ‰ç…§è§„åˆ™ï¼‰ ====================
function calcLiushiGua(liuriYaos, liuriYt, hour) {
    // è§„åˆ™ï¼šä»æµæ—¥å¦å…ƒå ‚å¼€å§‹å˜å¦ï¼Œå†å˜å…ƒå ‚+1çˆ»ï¼Œå†å˜å…ƒå ‚+2çˆ»...
    // æ¯ä¸ªæ—¶è¾°å¯¹åº”ä¸€ä¸ªå˜çˆ»
    
    // è®¡ç®—æ—¶è¾°å¯¹åº”çš„å˜çˆ»åç§»é‡ï¼ˆ0-5ï¼‰
    var shichenIndex = Math.floor(hour / 2);  // 0-11å¯¹åº”12æ—¶è¾°
    var yaoOffset = shichenIndex % 6;  // æ¯6ä¸ªæ—¶è¾°ä¸€ä¸ªå¾ªç¯
    
    // å¤åˆ¶æµæ—¥å¦
    var result = liuriYaos.slice();
    
    // å˜å¯¹åº”çš„çˆ»ä½
    var changedYao = ((liuriYt - 1 + yaoOffset) % 6);
    result[changedYao] = 1 - result[changedYao];
    
    // è®¡ç®—æ–°çš„å…ƒå ‚ä½ç½®
    var newYt = changedYao + 1;
    
    // è·å–æ—¶è¾°åœ°æ”¯
    var zhiIndex = Math.floor((hour + 1) / 2) % 12;
    var zhi = ALL_ZHI[zhiIndex];
    
    return { 
        yaos: result, 
        yt: newYt, 
        zhi: zhi,
        shichenIndex: shichenIndex
    };
}

// ==================== æµåˆ†å¦è®¡ç®— ====================
function calcLiufenGua(liushiYaos, liushiYt, minuteInShichen) {
    // ç¬¬ä¸€å±‚å˜åŒ–ï¼šæŠŠä¸€ä¸ªæ—¶è¾°(120åˆ†é’Ÿ)åˆ†æˆ6ä»½ï¼Œæ¯ä»½20åˆ†é’Ÿ
    var fenIndex1 = Math.floor(minuteInShichen / 20);
    if(fenIndex1 > 5) fenIndex1 = 5;
    
    // å¤åˆ¶æµæ—¶å¦ä½œä¸ºåŸºç¡€
    var layer1Yaos = liushiYaos.slice();
    
    // å˜åŠ¨ç¬¬ä¸€å±‚å¯¹åº”çš„çˆ»
    var layer1ChangedYao = ((liushiYt - 1 + fenIndex1) % 6);
    layer1Yaos[layer1ChangedYao] = 1 - layer1Yaos[layer1ChangedYao];
    
    // ç¬¬ä¸€å±‚å˜åŒ–åçš„æ–°å…ƒå ‚
    var layer1Yt = layer1ChangedYao + 1;
    
    // ç¬¬äºŒå±‚å˜åŒ–ï¼šæŠŠ20åˆ†é’Ÿå†åˆ†æˆ6ä»½ï¼Œæ¯ä»½çº¦3.33åˆ†é’Ÿ
    var minuteInFen = minuteInShichen % 20;
    var fenIndex2 = Math.floor(minuteInFen * 6 / 20);
    if(fenIndex2 > 5) fenIndex2 = 5;
    
    // å¤åˆ¶ç¬¬ä¸€å±‚å˜åŒ–åçš„å¦ä½œä¸ºåŸºç¡€
    var layer2Yaos = layer1Yaos.slice();
    
    // åœ¨æ–°å…ƒå ‚çš„åŸºç¡€ä¸Šï¼Œå˜åŠ¨ç¬¬äºŒå±‚å¯¹åº”çš„çˆ»
    var layer2ChangedYao = ((layer1Yt - 1 + fenIndex2) % 6);
    layer2Yaos[layer2ChangedYao] = 1 - layer2Yaos[layer2ChangedYao];
    
    // è¿”å›æœ€ç»ˆç»“æœ
    return { 
        yaos: layer2Yaos, 
        yt: layer2ChangedYao + 1,
        fenIndex1: fenIndex1,
        fenIndex2: fenIndex2
    };
}

// è¾…åŠ©å‡½æ•°ï¼šæ ¹æ®å¦åæ‰¾åˆ°DBä¸­çš„ID
function getGuaIdByName(guaName) {
    if(typeof DB === 'undefined') return null;
    for(var i = 1; i <= 64; i++) {
        if(DB[i] && DB[i].n === guaName) {
            return i.toString();
        }
    }
    return null;
}

function calcFlow() {
    if(!G) return;
    
    var cy = parseInt(document.getElementById('cy').value);
    var cm = parseInt(document.getElementById('cm').value);
    var cd = parseInt(document.getElementById('cd').value);
    var ch = parseInt(document.getElementById('ch').value);
    var cmin = parseInt(document.getElementById('cmin').value);
    
    // åˆ¤æ–­æ˜¯å¦è¿‡äº†ç«‹æ˜¥
    var effectiveYear = cy;
    var lichunDate = new Date(cy, 1, 4, 11, 0);  // 2æœˆ4æ—¥11ç‚¹è¿‘ä¼¼ç«‹æ˜¥
    var queryDate = new Date(cy, cm - 1, cd, ch, cmin);
    if (queryDate < lichunDate) {
        effectiveYear = cy - 1;  // ç«‹æ˜¥å‰å±äºä¸Šä¸€å¹´
    }
    
    var age = effectiveYear - G.by + 1;
    if(age < 1) age = 1;
    
    // 1. æ„å»ºå¤§è¿åˆ—è¡¨
    var dayunList = [];
    var cumAge = 0;
    
    for(var i = 0; i < 6; i++) {
        var yaoIdx = (G.xt.yt - 1 + i) % 6;
        var yaoVal = G.xt.yaos[yaoIdx];
        var years = (yaoVal === 1) ? 9 : 6;
        var yangOrderNum = getYangYaoOrderNum(G.yangYaoOrder, 'xt', yaoIdx);
        
        dayunList.push({
            type: 'xt',
            yaoIndex: yaoIdx,
            yaoValue: yaoVal,
            startAge: cumAge + 1,
            endAge: cumAge + years,
            years: years,
            baseYaos: G.xt.yaos.slice(),
            baseYt: G.xt.yt,
            dayunYt: yaoIdx + 1,
            yangOrderNum: yangOrderNum
        });
        cumAge += years;
    }
    
    for(var i = 0; i < 6; i++) {
        var yaoIdx = (G.ht.yt - 1 + i) % 6;
        var yaoVal = G.ht.yaos[yaoIdx];
        var years = (yaoVal === 1) ? 9 : 6;
        var yangOrderNum = getYangYaoOrderNum(G.yangYaoOrder, 'ht', yaoIdx);
        
        dayunList.push({
            type: 'ht',
            yaoIndex: yaoIdx,
            yaoValue: yaoVal,
            startAge: cumAge + 1,
            endAge: cumAge + years,
            years: years,
            baseYaos: G.ht.yaos.slice(),
            baseYt: G.ht.yt,
            dayunYt: yaoIdx + 1,
            yangOrderNum: yangOrderNum
        });
        cumAge += years;
    }
    
    // 2. æ‰¾åˆ°å½“å‰å¹´é¾„æ‰€åœ¨çš„å¤§è¿
    var currentDayun = null;
    for(var i = 0; i < dayunList.length; i++) {
        if(age >= dayunList[i].startAge && age <= dayunList[i].endAge) {
            currentDayun = dayunList[i];
            break;
        }
    }
    if(!currentDayun) currentDayun = dayunList[dayunList.length - 1];
    
    // 3. è®¡ç®—æµå¹´å¦
    var yearInDayun = age - currentDayun.startAge + 1;
    var isYangYao = currentDayun.yaoValue === 1;
    
    var liunian = calcLiunianInDayun(
        currentDayun.baseYaos,
        currentDayun.dayunYt,
        yearInDayun,
        G.by,
        currentDayun.startAge,
        isYangYao
    );
    
    var dayunTypeName = currentDayun.type === 'xt' ? 'å…ˆå¤©' : 'åå¤©';
    var liunianInfo = dayunTypeName + getYaoName(currentDayun.yaoIndex) + 'çˆ»è¿ ç¬¬' + yearInDayun + 'å¹´';
    
    document.getElementById('fv-y').innerText = getGuaName(liunian.yaos);
    document.getElementById('fd-y').innerText = getYaoName(liunian.yt - 1) + 'çˆ»å…ƒå ‚ | ' + age + 'å² ' + liunianInfo;
    // ç»˜åˆ¶æµå¹´å¦å›¾
    renderGua(liunian, 'fv-y', 'g-ly');
    
    // 4. è·å–èŠ‚æ°”æœˆä»½ä¿¡æ¯å¹¶è®¡ç®—æµæœˆ
    var jieqiInfo = getJieqiMonthInfo(cy, cm, cd, ch, cmin);
    var lunarMonth = 1;
    var monthTimeStr = '';
    
    if(jieqiInfo) {
        lunarMonth = jieqiInfo.lunarMonth;
        monthTimeStr = jieqiInfo.startJieqi.name + '(' + formatDateTime(jieqiInfo.startJieqi.date) + ') è‡³ ' + 
                       jieqiInfo.endJieqi.name + '(' + formatDateTime(jieqiInfo.endJieqi.date) + ')';
    }
    
    var liuyue = calcLiuyueGua(liunian.yaos, liunian.yt, lunarMonth);
    
    document.getElementById('fv-m').innerText = getGuaName(liuyue.yaos);
    document.getElementById('fd-m').innerText = getYaoName(liuyue.yt - 1) + 'çˆ»å…ƒå ‚ | å†œå†' + lunarMonth + 'æœˆ';
    document.getElementById('ft-m').innerText = monthTimeStr;
    // ç»˜åˆ¶æµæœˆå¦å›¾
    renderGua(liuyue, 'fv-m', 'g-lm');
    
   // åœ¨calcFlowå‡½æ•°ä¸­æ‰¾åˆ°æµæ—¥è®¡ç®—éƒ¨åˆ†ï¼Œæ›¿æ¢ä¸ºï¼š

// 5. è®¡ç®—æµæ—¥ï¼ˆä¸¥æ ¼æŒ‰ç…§è§„åˆ™ï¼‰
if(jieqiInfo) {
    var targetDate = new Date(cy, cm - 1, cd, ch, cmin, 0);
    var monthStartMs = jieqiInfo.startJieqi.date.getTime();
    var monthEndMs = jieqiInfo.endJieqi.date.getTime();
    var totalMonthMs = monthEndMs - monthStartMs;
    var elapsedMs = targetDate.getTime() - monthStartMs;
    
    if(elapsedMs < 0) elapsedMs = 0;
    if(elapsedMs > totalMonthMs) elapsedMs = totalMonthMs;
    
    // è®¡ç®—åœ¨èŠ‚æ°”ä¸­çš„å¤©æ•°ï¼ˆä»0å¼€å§‹ï¼‰
    var totalDays = totalMonthMs / (1000 * 60 * 60 * 24);
    var dayIndex = Math.floor(elapsedMs / (1000 * 60 * 60 * 24));
    
    var liuri = calcLiuriGua(liuyue.yaos, liuyue.yt, dayIndex, totalDays);
    
    // è®¡ç®—è¯¥çˆ»æ®µçš„æ—¶é—´èŒƒå›´ï¼ˆæ¯çˆ»ç®¡ä¸€æ—¥ï¼‰
    var yaoStartDay = Math.floor(dayIndex / 6) * 6;
    var yaoEndDay = yaoStartDay + 5;
    var yaoStartDate = new Date(monthStartMs + yaoStartDay * 24 * 60 * 60 * 1000);
    var yaoEndDate = new Date(monthStartMs + Math.min(yaoEndDay, totalDays-1) * 24 * 60 * 60 * 1000);
    
    var fvDEl3 = document.getElementById('fv-d');
    var fdDEl3 = document.getElementById('fd-d');
    var ftDEl3 = document.getElementById('ft-d');
    if(fvDEl3) fvDEl3.innerText = getGuaName(liuri.yaos);
    if(fdDEl3) fdDEl3.innerText = getYaoName(liuri.yt - 1) + 'çˆ»å…ƒå ‚ | ç¬¬' + liuri.dayInCycle + 'æ—¥';
    if(ftDEl3) ftDEl3.innerText = formatDate(yaoStartDate) + ' è‡³ ' + formatDate(yaoEndDate);
    // ç»˜åˆ¶æµæ—¥å¦å›¾
    renderGua(liuri, 'fv-d', 'g-ld');
    
    // 6. è®¡ç®—æµæ—¶
    var liushi = calcLiushiGua(liuri.yaos, liuri.yt, ch);
    
    var fvHEl = document.getElementById('fv-h');
    var fdHEl = document.getElementById('fd-h');
    if(fvHEl) fvHEl.innerText = getGuaName(liushi.yaos);
    if(fdHEl) fdHEl.innerText = getYaoName(liushi.yt - 1) + 'çˆ»å…ƒå ‚ | ' + liushi.zhi + 'æ—¶';
    
    // 7. è®¡ç®—æµåˆ†ï¼ˆä¸¤å±‚å˜åŒ–ï¼‰
    var minuteInShichen = ((ch % 2) * 60 + cmin);
    var liufen = calcLiufenGua(liushi.yaos, liushi.yt, minuteInShichen);
    
    // è®¡ç®—æ—¶é—´èŒƒå›´
    var fen1StartMin = liufen.fenIndex1 * 20;  // æ¯ä»½20åˆ†é’Ÿ
    var fen1EndMin = (liufen.fenIndex1 + 1) * 20;
    var fen2StartSec = liufen.fenIndex2 * (20/6) * 60;  // æ¯ä»½çº¦3.33åˆ†é’Ÿ
    var fen2EndSec = (liufen.fenIndex2 + 1) * (20/6) * 60;
    
    var fvMinEl = document.getElementById('fv-min');
    var fdMinEl = document.getElementById('fd-min');
    if(fvMinEl) fvMinEl.innerText = getGuaName(liufen.yaos);
    if(fdMinEl) fdMinEl.innerText = getYaoName(liufen.yt - 1) + 'çˆ»å…ƒå ‚ | ç¬¬' + (liufen.fenIndex1+1) + 'å±‚ç¬¬' + (liufen.fenIndex2+1) + 'åˆ†';
    
} else {
    var fvDEl2 = document.getElementById('fv-d');
    var fdDEl2 = document.getElementById('fd-d');
    var ftDEl = document.getElementById('ft-d');
    var fvHEl2 = document.getElementById('fv-h');
    var fdHEl2 = document.getElementById('fd-h');
    var fvMinEl2 = document.getElementById('fv-min');
    var fdMinEl2 = document.getElementById('fd-min');
    if(fvDEl2) fvDEl2.innerText = '--';
    if(fdDEl2) fdDEl2.innerText = 'æ— æ³•è·å–èŠ‚æ°”ä¿¡æ¯';
    if(ftDEl) ftDEl.innerText = '';
    if(fvHEl2) fvHEl2.innerText = '--';
    if(fdHEl2) fdHEl2.innerText = '';
    if(fvMinEl2) fvMinEl2.innerText = '--';
    if(fdMinEl2) fdMinEl2.innerText = '';
}
    
    // è‡ªåŠ¨å¡«å……64å¦åˆ†æç³»ç»Ÿçš„1-5æ­¥ï¼ˆå…¨å±€å‡½æ•°ï¼‰
    window.autoFill64GuaFromCalc = function() {
        try {
            console.log('å¼€å§‹å°è¯•è‡ªåŠ¨å¡«å……64å¦åˆ†æç³»ç»Ÿ...');
            
            // æ£€æŸ¥Gå¯¹è±¡æ˜¯å¦å­˜åœ¨
            if(!G || !G.xt || !G.ht) {
                console.log('Gå¯¹è±¡ä¸å­˜åœ¨ï¼Œæ— æ³•è‡ªåŠ¨å¡«å……');
                return false;
            }
            
            // æ£€æŸ¥DBå¯¹è±¡æ˜¯å¦å­˜åœ¨
            if(typeof DB === 'undefined') {
                console.log('DBå¯¹è±¡æœªå®šä¹‰ï¼Œæ— æ³•è‡ªåŠ¨å¡«å……');
                return false;
            }
            
            // æ£€æŸ¥selectå…ƒç´ æ˜¯å¦å­˜åœ¨
            var testSelect = document.getElementById('in1_1');
            if(!testSelect) {
                console.log('é€‰æ‹©æ¡†in1_1ä¸å­˜åœ¨ï¼Œæ— æ³•è‡ªåŠ¨å¡«å……');
                return false;
            }
            
            // è·å–5ä¸ªå¦çš„åç§°
            var xiantianGuaName = getGuaName(G.xt.yaos);  // å…ˆå¤©å¦
            var houtianGuaName = getGuaName(G.ht.yaos);   // åå¤©å¦
            var fvYEl = document.getElementById('fv-y');
            var fvMEl = document.getElementById('fv-m');
            var fvDEl = document.getElementById('fv-d');
            var liunianGuaName = fvYEl ? fvYEl.innerText.trim() : '';  // æµå¹´å¦
            var liuyueGuaName = fvMEl ? fvMEl.innerText.trim() : '';   // æµæœˆå¦
            var liuriGuaName = fvDEl ? fvDEl.innerText.trim() : '';    // æµæ—¥å¦
            
            console.log('è·å–åˆ°çš„å¦åï¼š', {
                'å…ˆå¤©å¦': xiantianGuaName,
                'åå¤©å¦': houtianGuaName,
                'æµå¹´å¦': liunianGuaName,
                'æµæœˆå¦': liuyueGuaName,
                'æµæ—¥å¦': liuriGuaName
            });
            
            // å°†å¦åè½¬æ¢ä¸ºIDå¹¶å¡«å……åˆ°64å¦åˆ†æç³»ç»Ÿ
            var guaNames = [xiantianGuaName, houtianGuaName, liunianGuaName, liuyueGuaName, liuriGuaName];
            var filledCount = 0;
            
            for(var step = 1; step <= 5; step++) {
                var selectId = 'in1_' + step;
                var selectEl = document.getElementById(selectId);
                
                if(!selectEl) {
                    console.log('é€‰æ‹©æ¡† ' + selectId + ' ä¸å­˜åœ¨');
                    continue;
                }
                
                if(guaNames[step - 1] && guaNames[step - 1] !== '--' && guaNames[step - 1] !== '') {
                    var guaId = getGuaIdByName(guaNames[step - 1]);
                    if(guaId) {
                        selectEl.value = guaId;
                        console.log('ç¬¬' + step + 'æ­¥ï¼šå¡«å……å¦å "' + guaNames[step - 1] + '" (ID: ' + guaId + ')');
                        filledCount++;
                    } else {
                        console.log('ç¬¬' + step + 'æ­¥ï¼šæœªæ‰¾åˆ°å¦å "' + guaNames[step - 1] + '" å¯¹åº”çš„ID');
                    }
                } else {
                    console.log('ç¬¬' + step + 'æ­¥ï¼šå¦åä¸ºç©ºæˆ–æ— æ•ˆ');
                }
            }
            
            if(filledCount > 0) {
                console.log('âœ… æˆåŠŸè‡ªåŠ¨å¡«å…… ' + filledCount + ' ä¸ªå¦åˆ°64å¦åˆ†æç³»ç»Ÿ');
                return true;
            } else {
                console.log('âŒ æœªèƒ½å¡«å……ä»»ä½•å¦ï¼ˆå¯èƒ½æ˜¯å¦ååŒ¹é…å¤±è´¥ï¼‰');
                return false;
            }
        } catch(e) {
            console.error('è‡ªåŠ¨å¡«å……64å¦åˆ†æç³»ç»Ÿæ—¶å‡ºé”™:', e);
            return false;
        }
    };
    
    // å°è¯•è‡ªåŠ¨å¡«å……ï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿DOMå…ƒç´ å·²åˆ›å»ºï¼‰
    var retryCount = 0;
    var maxRetries = 15;
    function tryAutoFill() {
        console.log('å°è¯•è‡ªåŠ¨å¡«å……ï¼ˆç¬¬' + (retryCount + 1) + 'æ¬¡ï¼‰...');
        if(window.autoFill64GuaFromCalc()) {
            return; // æˆåŠŸå¡«å……ï¼Œé€€å‡º
        }
        if(retryCount < maxRetries) {
            retryCount++;
            setTimeout(tryAutoFill, 200);
        } else {
            console.log('å·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œè‡ªåŠ¨å¡«å……å¤±è´¥');
        }
    }
    setTimeout(tryAutoFill, 300);
}
</script>

</body>
</html>    </div>
             
        
       
            
            
            
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…­åå››å¦åˆ†æç³»ç»Ÿ (ç»ˆæå®Œæ•´ç‰ˆ)</title>
    <style>
        :root { --main: #2c3e50; --red: #c0392b; --bg: #f0f2f5; --white: #fff; }
        body { font-family: "Microsoft YaHei", sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; }
        h1 { text-align: center; color: var(--main); margin-bottom: 5px; }
        .sub { text-align: center; color: #666; font-size: 14px; margin-bottom: 20px; }
        
        .box { background: var(--white); padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; gap: 15px; }
        .col { flex: 1; display: flex; flex-direction: column; }
        .col-t { text-align: center; font-weight: bold; color: var(--main); border-bottom: 2px solid var(--main); margin-bottom: 10px; padding-bottom: 5px; }
        
        .sel-area { height: 200px; overflow-y: auto; border: 1px solid #ddd; padding: 5px; background: #fafafa; }
        .sel-row { display: flex; align-items: center; margin-bottom: 5px; font-size: 12px; }
        .lbl { width: 40px; color: #999; flex-shrink: 0; }
        select { flex: 1; padding: 4px; }

        button { width: auto; min-width: 200px; max-width: 300px; padding: 15px; background: var(--red); color: #fff; border: none; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.2s; margin: 0 auto 10px auto; display: block; }
        button:hover { background: #a93226; }

        .res-area { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 50px; margin-top: 0; }
        .res-col { flex: 1; min-width: 380px; background: #e9ecef; padding: 10px; border-radius: 8px; }
        .res-t { text-align: center; background: var(--main); color: #fff; padding: 8px; border-radius: 4px; margin-bottom: 10px; font-weight: bold; }

        .card { background: #fff; border-radius: 6px; margin-bottom: 15px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .c-head { padding: 10px 15px; background: #f8f9fa; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .c-name { font-weight: bold; font-size: 16px; color: #222; }
        .c-step { background: var(--red); color: #fff; font-size: 12px; padding: 2px 6px; border-radius: 3px; }

        details { border-top: 1px solid #eee; }
        summary { padding: 10px 15px; cursor: pointer; font-weight: bold; color: #555; list-style: none; display: flex; justify-content: space-between; }
        summary:hover { background: #fdfdfd; }
        summary::after { content: '+'; color: #ccc; }
        details[open] summary { color: var(--red); background: #fff; border-bottom: 1px dashed #eee; }
        details[open] summary::after { content: '-'; color: var(--red); }
        .c-body { padding: 15px; font-size: 14px; line-height: 1.6; color: #444; text-align: justify; background: #fff; }

        /* åœ°ç†è¡¨æ ¼ */
        table.g-tab { width: 100%; border-collapse: collapse; border: 2px solid #444; margin-top: 5px; text-align: center; font-size: 12px; }
        table.g-tab td { border: 1px solid #888; padding: 6px; width: 33%; }
        .g-on { background: #fff3cd; color: #856404; font-weight: bold; border: 2px solid #c0392b !important; }
    </style>
</head>
<body>

<h2>64å¦åˆ†æç³»ç»Ÿ</h2>
 </div>

<div class="box">
    <div class="col">
        
        <div class="sel-area" id="in1"></div>
    </div>
    </div>

<button onclick="gen()"ï¼Œdiv style="background:#f9f9f9;text-align:center; color:black;">ç‚¹å‡»ç”Ÿæˆ</button></div>
<div class="res-area" id="out">
    <div style="width:100%; text-align:center; padding:10px 50px; color:#999;">è¯·é€‰æ‹©å¦è±¡åç‚¹å‡»ç”Ÿæˆ</div>
</div>

<script>
    // 1. è¾…åŠ©ï¼šä¹å®«æ ¼ç”Ÿæˆ
    function gd(p) {
        const m = { 'SE':'å·½(ä¸œå—)', 'S':'ç¦»(å—)', 'SW':'å¤(è¥¿å—)', 'E':'éœ‡(ä¸œ)', 'C':'ä¸­å®«', 'W':'å…‘(è¥¿)', 'NE':'è‰®(ä¸œåŒ—)', 'N':'å(åŒ—)', 'NW':'ä¹¾(è¥¿åŒ—)' };
        let h = '<table class="g-tab">';
        [['SE','S','SW'],['E','C','W'],['NE','N','NW']].forEach(r => {
            h+='<tr>'; r.forEach(k => { h+=`<td class="${k===p?'g-on':''}">${m[k]}</td>`; }); h+='</tr>';
        });
        return h + '</table>';
    }

    // 2. æ ¸å¿ƒæ•°æ®åº“ï¼šç›´æ¥å®šä¹‰å†…å®¹ï¼Œæ²¡æœ‰ä»»ä½•â€œå¾…å¡«å…¥â€çš„ä»£ç 
    const DB = {
        1: {
n: "ä¹¾ä¸ºå¤©",
t: "ä¸€ã€å®˜äººåœ¨æ¢¯ä¸Šï¼šå¹³æ­¥é’é›²è±¡ã€‚<br>äºŒã€é¹¿åœ¨é›²ä¸­ï¼šä½œç‚ºè¡Œäº‹å¿ƒä¸­ä¸å¯æ±‚ç¥¿ï¼Œå‰‡ç¥¿è‡³çŸ£ã€‚<br>ä¸‰ã€çŸ³ä¸Šç‰æœ‰å…‰æ˜ï¼šç¤ºäººæ‰å¦‚ç‰ä¹‹å«å…‰ï¼Œå‰ä¹Ÿã€‚<br>å››ã€äººç£¨ç‰ï¼šç¤ºäººå …å¿ƒä¸ç§»ï¼Œå¤•æƒ•è‹¥å²ï¼Œéš¨æ™‚æˆ’ä¹‹ã€‚<br>äº”ã€å·¥åŒ ï¼šæœ‰é‡ç«‹é–€æˆ·ä¹‹è±¡ã€‚<br>å…­ã€æœ›ç£¨ç‰äººï¼šæˆ’ç››ï¼Œå¿µä¸­æ— å¦„ã€‚<br>ä¸ƒã€æ¢¯ä¸Šå®˜äººï¼šæ£ºä¹Ÿã€‚åœç–¾å„å‡¶ä¹Ÿã€‚<br>å…«ã€å®˜äººæœ›ç£¨ç‰äººï¼šç¤ºäººå³å¹³æ­¥é’é›²é ˆæˆ’ç››ï¼Œä¸”æœ›ä¸‹çœ‹ï¼Œå¿µä¸­ç„¡å¦„ï¼Œå‰‡å‡é·å¹³å®‰ï¼Œå¦‚çˆ­ä½å‰‡æ—¦å¤•è€Œäº¡ä¹Ÿã€‚",
x: "åˆšå¥ä¸­æ­£ï¼Œå¤©è¡Œå¥ï¼Œå›å­ä»¥è‡ªå¼ºä¸æ¯ã€‚å…­é¾™å¾¡å¤©ä¹‹è±¡ã€‚<br>åˆä¹ï¼šæ½œé¾™å‹¿ç”¨ã€‚<br>ä¹äºŒï¼šè§é¾™åœ¨ç”°ï¼Œåˆ©è§å¤§äººã€‚<br>ä¹ä¸‰ï¼šå›å­ç»ˆæ—¥å¹²å¹²ï¼Œå¤•æƒ•è‹¥å‰ï¼Œæ— å’ã€‚<br>ä¹å››ï¼šæˆ–è·ƒåœ¨æ¸Šï¼Œæ— å’ã€‚<br>ä¹äº”ï¼šé£é¾™åœ¨å¤©ï¼Œåˆ©è§å¤§äººã€‚<br>ä¸Šä¹ï¼šäº¢é¾™æœ‰æ‚”ã€‚",
d: gd('NW')+"çˆ¶å±…è¥¿åŒ—ã€‚",
u:"æ­¤å¦å‡ºç¾ï¼Œå®˜äººé€¢ä¹‹èˆ‰æ­¥é’é›²ï¼Œå¿ƒæƒ³äº‹æˆï¼Œç™¼é”æ™‚å¾€å¾€æ¯”å¹³å¸¸ å¿«ï¼Œä¸”è¶Šç´šæ™‰å‡ã€‚å•†äººé€¢ä¹‹ï¼Œç‚ºåšç”Ÿæ„ç•¶è€é—†ä¹‹äººï¼Œè²¡å¤šç¥¿è±ï¼Œç§‘ç”²ä¸€èˆ¬ï¼Œå¯¹å…»ç—…æå¥½ï¼Œå¯¹å©šå§»æå¥½å±äºçˆ¶ä¹‹æ­£ä½ã€‚",
h: "ç”Ÿå¸¦ç¦„,æ™ºæ…§é«˜ï¼Œèªæ˜æ‰æ™ºï¼Œä¸è§ç”Ÿçˆ¶ä¸ºå®šæ•°ï¼Œéè¿‡ä¸–ï¼Œä¹ƒå› åæˆ¿ç”Ÿã€‚",
 a: "å®˜å¸¦åŠ èº«ï¼Œå£°åè¿œæ’­ï¼Œå››æµ·æ‰¬åã€‚è´¢ç¦„ä¸°ç››ï¼Œçˆ¶æ¯åŒå…¨ã€‚",
 b: "ç”·ï¼Œæµå¹´é€¢ä¹‹ï¼Œè¿å‡ä¸‰çº§ã€‚å”¯å¥½äº‹å¤šç£¨ï¼Œå…­ç”²å¾—å­ï¼Œä¹ƒåæˆ¿ç”Ÿï¼Œéæ­£æˆ¿ç”Ÿã€‚è·Ÿä»æ¯å§“ï¼Œä¸è·Ÿçˆ¶å§“ã€‚å¥³ï¼Œæ€§è¿‡åˆšï¼Œäº‹ä¸šéå¸¸äº¨é€šï¼Œä½†å©šäº‹å¤šç£¨ï¼Œæ€»æˆç©ºã€‚çœŸæ­£ä¸ˆå¤«åœ¨ä¸Šä½ã€‚",
 e: "å®˜äººç™»æ¢¯ï¼Œå‡å®˜ï¼Œå‘ä¸‹çœ‹ï¼ˆéœ€è¦ç…§é¡¾è‡£æ°‘æ‰ä¼šå‡å®˜ï¼Œå¦åˆ™ä¸å‡ï¼‰ï¼Œå¦‚æœé—®å‡å‡ çº§çš„è¯å°±æ˜¯ä¸‰çº§ï¼Œä¸€æ¬¡åªèƒ½é—®ä¸€ä¸ªé—®é¢˜ï¼Œåªèƒ½åœ¨å‡å®˜ä¸å¦æˆ–è€…å‡å‡ çº§ä¹‹é—´é€‰æ‹©ä¸€ä¸ªé—®é¢˜å†åœï¼Œçš„å‡ºç»“æœå°±æ˜¯å‡æˆ–è€…ä¸‰çº§ä¸­çš„ä¸€ä¸ªç­”æ¡ˆã€‚åŒ äººç£¨ç‰ï¼ŒåŒ ï¼Œå°†ä¹Ÿï¼Œé—®è¿™ä¸€å¹´ä¼šä¸ä¼šå‡å°†å†›ï¼Œé—®å°±æ˜¯å‡ï¼Œåªæ˜¯éœ€è¦è°¨æ…åº”å¯¹æ‰ä¼šå‡ã€‚",
 f: "é¹¿ä»å¤©ä¸Šæ¥ï¼Œä¸ºå¤©ç¦„ä¹Ÿã€‚é£æœºï¼Œç©ºä¸­ç­‰æœ‰å…³å¯æˆï¼Œæˆ–è€…å®¢æˆ·åé£æœºæ¥å°±å¯ä»¥ï¼Œä¹Ÿå¯ä»¥æ˜¯å•ä½ä¸€æŠŠæ‰‹æœ‰å…³çš„ç¦„ï¼Œäº¦æˆ–è€…åå­—ä¸­å¸¦å­”ï¼Œç©ºç­‰ï¼Œå¯å¾—ç¦„ã€‚å…¶ä½™çš„å¾—åˆ°ä¹¾ä¸ºå¤©å°±å¯ä»¥æ­‡èœäº†ï¼Œç”Ÿæ„ä¸èƒ½åšï¼Œä¼‘æ¯å§ã€‚",
 g: "åŒ äººç£¨ç‰ï¼Œä¸ºä»€ä¹ˆä¼šæ˜¯åŒ äººï¼Œæ›´æ”¹é—¨åº­ï¼Œè‡ªç«‹é—¨æˆ·æ˜¯ä¹Ÿï¼Œç»“å©šå°±æ˜¯è‡ªç«‹é—¨æˆ·ã€‚æœˆæœ‰å…‰æ˜ï¼Œäº‹æƒ…æœ‰å¸Œæœ›ä¹Ÿï¼Œç£¨ç‰æœ‰å…‰ï¼Œä»£è¡¨å°å¿ƒè°¨æ…ï¼Œäº‹æƒ…å¯æœŸä¹Ÿã€‚å©šå§»å¯ä»¥æˆï¼Œä½†æ˜¯éœ€è¦å°å¿ƒè°¨æ…ç»è¥ã€‚é‚£ä½ é—®ç¦»å©šæˆä¸æˆï¼Œä¹Ÿæ˜¯æœ‰å¾ˆå¤§å¸Œæœ›çš„ï¼Œåªæ˜¯éœ€è¦è°¨æ…åº”å¯¹ã€‚",
 l: "å…‰ï¼Œå¸Œæœ›ä¹Ÿï¼Œåšå¿ƒè°¨æ…ä¼šæˆã€‚",
 m: "äººç™»æ¢¯ï¼Œäººï¼‹æœ¨=ä¼‘ï¼Œä¼‘ä¹Ÿï¼Œå®˜ç™»æ¢¯ï¼Œå®˜+æœ¨=æ£ºä¹Ÿï¼Œæ‰€ä»¥ç—…ä¼šåŠ é‡ï¼Œéœ€è¦ä¼‘æ¯ï¼Œå¦‚æœ‰ç”Ÿæ­»ä¹‹äº‹ï¼Œé‚£å°±æ˜¯è¦å»äº†ï¼Œæ£ºæçš„æ£ºå˜›ã€‚",
 z: "æš‚æ— ",

                     

        },
        2: {
            n: "å¤ä¸ºåœ°",
            t: "ä¸€ã€åä¸€å£ï¼šå‰ä¹Ÿï¼Œé™ˆå§“äººä¹Ÿã€‚<br>äºŒã€ä¸€å®˜äººï¼šå€Œäººï¼Œä¸ˆå¤«ä¹Ÿã€‚å…¬åŠ¡å‘˜ä¹Ÿã€‚<br>ä¸‰ã€åçœ‹äºŒä¸²é’±ï¼šæ¬²æ‹¿ä¸å¾—ï¼Œå¿§å¿ƒå¿¡å¿¡çŠ¶ã€‚<br>å››ã€ä¸€é©¬è€…ï¼šè‚–é©¬äººï¼›æŒ‡å®˜è´µï¼›æŒ‡è°ƒåŠ¨ä¹Ÿã€‚<br>äº”ã€é‡‘ç”²ç¥ï¼šç¤ºæ°‘å¿ƒä¹Ÿã€‚<br>å…­ã€æˆæ–‡ä¹¦ä¸å®˜ï¼šæˆå®˜å°ä¾¯ã€‚<br>ä¸ƒã€åœŸå †ä¸Šæœ‰å››é»ï¼šé»‘ä¹Ÿï¼ŒèƒŒæœ‰é™°è¬€ä¹Ÿã€‚",
            x: "åšå¾·è½½ç‰©ï¼Œåœ°åŠ¿å¤ã€‚å«å¼˜å…‰å¤§ï¼Œå“ç‰©å’¸äº¨ã€‚<br>åˆå…­ï¼šå±¥éœœï¼Œåšå†°è‡³ã€‚<br>å…­äºŒï¼šç›´æ–¹å¤§ï¼Œä¸ä¹ ï¼Œæ— ä¸åˆ©ã€‚<br>å…­ä¸‰ï¼šå«ç« å¯è´ï¼Œæˆ–ä»ç‹äº‹ï¼Œæ— æˆæœ‰ç»ˆã€‚<br>å…­å››ï¼šæ‹¬å›Šï¼Œæ— å’ï¼Œæ— èª‰ã€‚<br>å…­äº”ï¼šé»„è£³ï¼Œå…ƒã€‚<br>ä¸Šå…­ï¼šé¾™æˆ˜äºé‡ï¼Œå…¶è¡€ç„é»„ã€‚",
            d: gd('SW')+"æ¯å±…è¥¿å—ã€‚",
u:"æ¯å±…è¥¿å—ã€‚æ­¤æ ¼åœ¨é˜³å®…ä¸Šå‡ºç°ï¼Œå°±å¦‚æ˜“ä¹‹è¨€åœ°åšèƒ½è½½ç‰©ä¸€æ ·ï¼Œå·²å©šå¥³äººæ‰ æœ‰ï¼Œå…¶åŒ…å«å¯¡å±…ï¼Œä¸”æœ‰å­å¥³åŒä½ï¼Œæ­¤å±€æ–¹ç°ã€‚ä»£è¡¨æ„ä¹‰ä¸ºå©šå§»ä¸»ç ´æ•£ï¼Œå­¤å†›å¥‹æˆ˜ï¼Œè‚©è´Ÿä¸€å®¶ä¹‹é‡ä»»ï¼Œå¤«å®«ä¸ å¾—å¿—é€ æˆæ­¤æœï¼Œå¦‚ä»¥äº‹ä¸šä¸Šè®ºï¼Œåˆ™å®˜å®¶æŒæƒï¼Œå•†äººèµšé’±æ˜“å¦‚åæŒï¼Œ å¥³ä¸­å¼ºäººå‹ï¼Œå…¶å¿—è¿‡ä¸ˆå¤«ï¼Œæ— äººèƒ½åŠã€‚",
h: "å¥³å­ï¼šæ¯ä»ªå¤©ä¸‹ï¼Œæœ‰å¾·æ€§ï¼Œåšå¾·ï¼Œå¤šæ‰ï¼Œä¸é‡åˆ©ã€‚å®˜å¸¦å…¥å‘½ï¼Œä»å®˜ã€‚",
 a: "å¥³ï¼Œå¤©æœºï¼šé™ˆå®˜äººè´ªç¦„æˆç¾ã€‚é©¬äººï¼Œå±é©¬ï¼Œæˆ–å§“é©¬ï¼Œå¤§å‰ï¼Œå—å¤©å‘½ã€‚å¿§å¿ƒä¸ºè´¢ï¼Œè´¢ä¸å…¥ã€‚çŒ´ä¸Šé€¢ä¹‹äº‹ç«Ÿæˆï¼Œç”Ÿæ„äººæœ‰å®˜è®¼ã€‚",
 b: "å¥³å‘½é€¢ä¹‹å¿Œå£èˆŒã€‚é™·å®³ä»–äººä¸æˆåŠŸã€‚é€¢é©¬ç›¸å…‹äº‹ä¸æˆï¼Œå¤©æœºä¹Ÿã€‚é©¬ï¼Œå±é©¬ï¼Œé©¬å¹´ï¼Œç ´è´¢å› å·±ä¸å®ˆã€‚å®˜äººåˆ™å…¬åŠ¡å‘˜å¸æ³•ä¸»è´µã€‚ä¸€èˆ¬å…¬èŒäººå‘˜ï¼Œè´ªæ±¡çŠ¯å®˜ç¬¦ã€‚éœ€é˜²çªƒã€‚",
 e: "åšçœ‹ä¸¤ä¸²é’±ï¼Œå¿§å¿ƒå¿¡å¿¡ï¼Œè´ªæ±¡ä¸å‡ã€‚é©¬å›å¤´ï¼Œè°ƒåŠ¨ã€‚æ–‡ä¹¦è‡³ï¼Œå¯å‡å®˜è°ƒåŠ¨ã€‚",
 f: "ä¸¤ä¸²é’±åœ¨åœ°ï¼Œå¿§å¿ƒå¿¡å¿¡ï¼Œé’±è¢«å·ç›—ã€‚æ— è´¢å¯è¿›ï¼Œé€¢é©¬äººã€æ—¶é—´é©¬ä¸Šå›å¤´ï¼Œä¸è¦åšã€‚",
 g: "é‡‘ç”²ç¥äººå¸¦æ–‡ä¹¦è‡³ï¼Œå¯å©šï¼Œåä¸€ä¸ªå£ï¼Œå‰é€¢å€™äººæ—¶é—´åŠ å‰ã€‚",
 l: "é‡‘ç”²ç¥äººå¸¦æ–‡ä¹¦è‡³ï¼Œé«˜ä¸­ï¼Œåä¸€ä¸ªå£ï¼Œå‰ã€‚",
 m: "é’±å®åœ¨åœ°ï¼Œçº¸é’±è±¡ï¼Œä¸§è‘¬ä¹‹è±¡ï¼Œé‡ç—…å‡¶ã€‚",
 z: "æš‚æ— ",

                             },
        3: {
            n: "æ°´é›·å±¯",
            t: "ä¸€ã€äººåœ¨æœ›ç«¿å¤´ä¸Šç«‹ï¼šæ­¤ä¸æ˜å±€åŠ¿ä¹‹å±¯éš¾æ—¶ä¹Ÿï¼Œä¸å¯å¦„åŠ¨ä¹Ÿã€‚<br>äºŒã€çŠ¬ä¸Šå›å­—ï¼šä¹ƒè‚–ç‹—ä¹‹äººï¼Œç‹—å¹´ï¼Œç‹„å§“ä¹‹äººï¼Œæœä¸ºå“­ä¹‹è±¡ã€‚<br>ä¸‰ã€è½¦åœ¨æ³¥ä¸­ï¼šè¿›é€€ä¸¤éš¾ä¹‹è±¡ã€‚åˆ€åœ¨ç‰›ä¸Šï¼šè§£ä¹Ÿï¼Œç‰›ä¸ºè´µäººè±¡ã€‚<br>å››ã€äººå°„æ–‡ä¹¦ï¼šå¼ å§“ï¼Œå°äººé˜»ç¢ä¹Ÿã€‚å°„ï¼šåŒéŸ³ï¼Œè‰²ä¹Ÿï¼Œç»¯é—»ã€‚<br>äº”ã€ç‰›ä¸é¡ºé“ï¼šèƒŒé“è€Œé©°ï¼Œåå…¶é“è€Œä¸ºä¹‹ï¼Œå‰ã€‚<br>å…­ã€äººæœ›ï¼šäººäº¡ä¹Ÿã€‚<br>ä¸ƒã€äººç«‹ï¼šåœ¨ä½ä¹Ÿã€‚<br>å…«ã€ç›’ï¼šå…ˆæˆåç ´ã€‚<br>ä¹ã€ç‰›å›å¤´è§†çŠ¬ï¼šè®¡æ— æ‰€å‡ºï¼Œå¾…ä¹Ÿã€‚",           
            x: "ä¸‡äº‹å¼€å¤´éš¾ï¼ŒåŠ¨ä¹é™©ä¸­ã€‚åˆ©å»ºä¾¯ã€‚<br>åˆä¹ï¼šç›˜æ¡“ï¼Œåˆ©å±…è´ï¼Œåˆ©å»ºä¾¯ã€‚<br>å…­äºŒ ï¼šå±¯å¦‚é‚…å¦‚ï¼Œä¹˜é©¬ç­å¦‚ï¼ŒåŒªå¯‡ï¼Œå©šåª¾ï¼Œå¥³å­è´ä¸å­—ï¼Œåå¹´ä¹ƒå­—ã€‚<br>å…­ä¸‰ï¼šå³é¹¿æ— è™ï¼ŒæƒŸå…¥äºæ—ä¸­ï¼Œå›å­å‡ ï¼Œä¸å¦‚èˆï¼Œå¾€åã€‚<br>å…­å››ï¼šä¹˜é©¬ç­å¦‚ï¼Œæ±‚å©šåª¾ï¼Œå¾€ï¼Œæ— ä¸åˆ©ã€‚<br>ä¹äº”ï¼šå±¯å…¶è†ï¼Œå°è´ï¼Œå¤§è´å‡¶ã€‚<br>ä¸Šå…­ï¼šä¹˜é©¬ç­å¦‚ï¼Œæ³£è¡€æ¶Ÿå¦‚ã€‚",
                       d: gd('E')+"æ¬¡å­å±…ä¸œã€‚",
u:"æ­¤å¦ä¸ºæ¬¡å­å¦ï¼Œæ—¶æœºåœ¨é•¿å­æœªå©šï¼Œä¸”åŒå±…ä¸€å¤„ï¼Œæ–¹å¯è®ºä¹‹ï¼Œä¸€ æ—¦é•¿å­æˆ–æœ¬äººç»“å©šï¼Œæ­¤å±€ç«‹æ¶ˆï¼Œåˆ‡è®°ã€‚æ¬¡å­å±…æ­¤ï¼Œåˆ™æ¯”é•¿å­æ—©å©šï¼Œæ¯”åŒæ—¶å‡ºç”Ÿä¹‹äººæ—©äºŒå¹´ç»“å©šï¼Œä½†æœ‰ç¦å¿Œï¼Œå¦‚è‚–ç‹—æˆ–ç‹„å§“ä¹‹äººï¼Œä¸»å¤­æŠ˜ï¼Œæ­¤å¦å¤§å‡¶ï¼Œåˆé€¢çŠ¬å¹´åŠ å‡¶ï¼Œè‚–ç‰›äººï¼Œå¿…ä»»å¦»æ‘†å¸ƒï¼ŒèƒŒç¦»å®¶åº­ï¼Œä¸é¡¾çˆ¶æ¯ã€‚æ‰€ä»¥å¦‚å…¶ä»–äººæˆæ­¤å±€ï¼Œ åªä¸è¿‡æ—©å©šè€Œå·²ï¼Œå¯¹çŠ¬ã€ç‰›äººä¸»å‡¶ï¼Œä¸åˆ©ã€‚å±¯å¦æœ‰ä¸€è¿ç”¨ï¼Œåœ¨å®¶æ—äº‹ä¸šï¼Œä¸–ä»£äº¤æ›¿æ—¶ï¼Œçˆ¶å¿…ä½¿æ¬¡å­ç»§ä½é•¿ å­å¤±å® ï¼Œå…¶è¿å¦‚æ­¤ï¼Œå¾äººè§‚å‘½æ—¶ï¼Œå¿…å¯å‘ç°ï¼Œæ¬¡å­ä¹‹äº‹ä¸šå¿…ä¼˜äºé•¿ å­ï¼Œæ‰æ™ºèƒ½åŠ›è¶…è¶Šé•¿å­å¤šå¤šï¼Œè‡ªç„¶è€Œç„¶å±…æ­¤å±€ï¼Œæ•…å¾äººå…¥å®…å¦‚å‘ç° æ­¤å±€ï¼Œåè¿‡æ¥çœ‹ï¼Œäº¦å¯å¾—åˆ°å¾ˆæ­£ç¡®ä¹‹ç»“è®ºï¼Œæ‰€ä»¥å‘½è¿åŒå‚ï¼Œæ–¹å¯äº† è§£åŒæ—¶ç”Ÿäººä¹‹ç»“æœä¸åŒï¼Œå³ä»¤åŒæ—¶ç”Ÿäººéƒ½ä¸ºæ¬¡å­ï¼Œä¸”é•¿å­å±è‚–ä¹Ÿ åŒï¼Œä½†å´ä¸ä¸€å®šé•¿å…„ç”Ÿæ—¶çš†äº¦åŒï¼Œå·®å¼‚å³åœ¨æ­¤ã€‚æ¬¡å­è¶Šä½ï¼Œå¿—è¿‡é•¿å…„å±€å·²å®šå‡ºï¼Œä¸ªæ€§ä¸Šäº¦åŒã€‚",
h: "è‚–ç‹—ä¹‹äººï¼Œçˆ¶æ¯åŒå…¨ï¼Œç‹¬å­ã€‚è‚–ç‰›äººï¼Œæ—©å¹´å¤šè¡€å…‰ç¾ï¼Œç—…ç—›ã€‚èƒ†å¤§è¿‡äººï¼Œéº»çƒ¦å¤šï¼Œæ˜¯éå®˜å¸æ€»ä¸åœã€‚",
 a: "å®˜è¿äº¨é€šï¼Œä¸”å‘æ–‡ä¹¦èŒï¼ˆæ–‡å®˜ã€æ•™å‘˜ã€æˆ–å§“è°¢ï¼‰ã€‚ä½é«˜æ— æƒå¯å¹³å®‰ï¼ˆå¦‚å‚è°‹é¡¾é—®ï¼‰ã€‚å¤§å™¨æ™šæˆã€‚äº‰åå¤ºåˆ©å¿…æ‹›å‡¶ã€‚é…‰å¹´é¡»é˜²çˆ¶æ¯å‡¶ã€‚",
 b: "äº‹æ€ä¸æ˜ï¼Œé˜»åŠ›å¤§ï¼Œç§‹é€¢è´µäººå‘æ–‡ä¹¦ã€‚å¼ºåŠ›æ±‚ä¹‹å¿…æ‹›ç¾ã€‚é‡å°¼å¿…ä¸»å©šäº‹ç ´ã€‚å¥³å‘½é€¢ä¹‹ï¼Œå¤«è°ƒè¿œæ–¹ï¼Œèšå°‘ç¦»å¤šã€‚è‚–çŠ¬äººï¼Œæˆ–å§“ç‹„ï¼Œä¸»ä¸§æœï¼Œè‚–ç‰›äººï¼Œæˆ–å§“è§£ï¼Œé¡ºé“å—é˜»ï¼Œå‡¡äº‹å¤šè´¥ã€‚è´«ä¸”å›°ï¼Œæ•…é€¢ä¹‹ä¸åˆ©ã€‚å”¯æœ‰è¯»ä¹¦ä¸ºä¸Šå‰ã€‚ä¸åšå†³ç­–ä¸ºä¸Šç­–ã€‚",
 e: "äººå°„æ–‡ä¹¦ï¼Œæ–‡ä¹¦ä¸å…¨ä¸è‡³ã€‚ä»£è¡¨å®˜ä¸å‡ã€‚é€¢åˆ°è°¢å§“åå‡ã€‚",
 f: "è½¦åœ¨æ³¥ä¸­ï¼Œå¦‚åšäº‹åˆ™ä¼šè¿›é€€ä¸¤éš¾ï¼Œå±ç‰›é€¢ç‰›å¤§å‡¶ï¼Œè¢«è§£ä½“ç“œåˆ†ã€‚é€¢æœ±äº¦å‡¶ã€‚",
 g: "ä¸è¦ç»“å©šï¼Œä¼šè¿›é€€ä¸¤éš¾ï¼Œç»“æœæ˜¯å“­ã€‚é—®ç¦»å©šä¹Ÿä¸è¦ç¦»å©šï¼Œæ­¤æ—¶ä¸ºå±€åŠ¿ä¸æ˜ä¹‹æ—¶ï¼Œä¸è¦å¦„åŠ¨ã€‚",
 l: "ä¸ä¸­ï¼Œæˆ–æš—ä¸­è¢«äººç ´åã€‚",
 m: "ä¸ºå‡¶ï¼Œç»“æœä¸ºå“­ã€‚å¦‚ç—…é‡æ±‚é—®ï¼Œç»“æœå¤§å‡¶ï¼Œæœ‰ç¦»ä¸–ä¹‹æ„ã€‚äººæœ›ï¼Œäººäº¡æ˜¯ä¹Ÿã€‚é€¢ç‰›äººåŠ å‡¶ï¼Œæœ±å§“åŠ å‡¶ï¼Œæœ‰è¢«è‚¢è§£ä¹‹å«Œã€‚",
 z: "è‹¥å¾—åˆ°å±¯ï¼Œä¸è¦ç€æ€¥å¦„åŠ¨ï¼Œé™å¾…å¤©æ—¶ã€‚å°å¿ƒçŠ¬äººï¼Œç‹„å§“ä¹‹äººï¼Œäº¦æˆ–è€…è´µäººä¸ºçŠ¬äºº",

                   },
        4: {
            n: "å±±æ°´è’™",
            t: "ä¸€ã€æ»¡èˆ¹çå¯³ï¼šæš—ç¤ºäººå›¾è´¢ä¹‹è±¡ã€‚<br>äºŒã€èˆ¹åœ¨æ°´ä¸Šï¼šä¹ƒç¦»å›½ä»–å»è±¡ã€‚<br>ä¸‰ã€é¹¿åœ¨åœ°ä¸Šï¼Œç¤ºä»æœ‰å°ç¦„äºå†…ï¼Œé¹¿â€”ç¦„ä¹Ÿã€‚<br>å››ã€ä¸¤ä¸²é’±ï¼šä¹ƒå¿§å¿ƒå¿¡å¿¡è±¡ï¼Œå³æ„è™½æœ‰ç¦„ï¼Œä½†ä»ä»¤äººå¿§å¿ƒã€‚<br>äº”ã€å›¾ä¸­ä¸€ç¢—ï¼šç¤ºæ­¤è’™è”½æ‰‹æ®µï¼Œå¿…å…ˆæˆåç ´ï¼Œå› å…¶ä¹ƒä¸æ­£ä¹‹è´¢ï¼Œå¿…ä¸ä¹…è¿œä¹Ÿã€‚<br>å…­ã€ææ ‘å­æŠ˜ï¼šç¤ºäººæå§“äººæ°ï¼Œä¸”æœ‰å­å¤­æŠ˜ä¹‹è±¡ï¼Œåˆ™æˆæ ¼ã€‚",
            x: "ç«¥è’™æ±‚æˆ‘ï¼Œå¯è’™æ•™è‚²ã€‚æœè¡Œè‚²å¾·ã€‚<br>åˆå…­ï¼šå‘è’™ï¼Œåˆ©ç”¨åˆ‘äººï¼Œç”¨è¯´æ¡æ¢ï¼Œä»¥å¾€åã€‚<br>ä¹äºŒï¼šåŒ…è’™ï¼Œçº³å¦‡ï¼Œå­å…‹å®¶ã€‚<br>å…­ä¸‰ï¼šå‹¿ç”¨ï¼Œå–å¥³è§é‡‘å¤«ï¼Œä¸æœ‰èº¬ï¼Œæ— æ”¸åˆ©ã€‚<br>å…­å››ï¼šå›°è’™ï¼Œåã€‚<br>å…­äº”ï¼šç«¥è’™ï¼Œã€‚<br>ä¸Šä¹ï¼šå‡»è’™ï¼Œä¸åˆ©çˆ²å¯‡ï¼Œåˆ©å¾¡å¯‡ã€‚",
            d: gd('N')+"ä¸‰å­å±…åŒ—ã€‚",
u:"é˜³å®…ä¸Šæ­¤å±€å‡ºç°ï¼Œå¿…æœ‰ä¸‰å­å±…å®¶ä¸­ï¼Œä¸”æœªå©šï¼Œæ’è¡Œç¬¬ä¸‰å„¿å­ï¼Œå‡ºæ­¤å±€å…¶é€ æˆï¼šä¸€ã€ä»¥è’™è”½ä¹‹æ³•æ¬ºå®¶äººï¼ŒæƒŸåˆ©æ˜¯å›¾ã€‚äºŒã€æœ¬èº«æ„šæ˜§ï¼Œä¸çŸ¥è¿›é€€ã€‚ä¸‰ã€æ€§åˆšä¸å¬å…„é•¿ä¹‹è¨€ï¼Œç‹¬è¡Œç‹¬æ–­ã€‚å››ã€è¾ƒæ¬¡å­æ—©å©šï¼Œè¾ƒé•¿å­æ™šå©šã€‚äº”ã€æ¯”åŒæ—¶ç”Ÿäººæ—©ä¸ƒå¹´å©šã€‚å…­ã€å¸¸å–œèµŒåšæ€§ä¹‹é’±ç¦„ï¼Œæ•…å¾€å¾€æ±‚è´¢é‡é™©ä¹‹è±¡ã€‚å¾äººå…¥å®…å‘ç°æ­¤å±€ï¼Œå½“åŠæ—©å¯¹å…¶æ”¹å±€ï¼ŒæƒŸæœ‰ä½¿ä»–æœ¬äººæƒ³é€šï¼Œæ–¹ å¯åŠ©ä»–ï¼Œå¦åˆ™å³ä»¤çˆ¶æ¯è€³æé¢å‘½ï¼Œäº¦äºäº‹æ— è¡¥ï¼Œæˆè´¥åœ¨ä¸€å¿µä¹‹é—´ è€³ã€‚è’™ä¹‹ç”Ÿï¼Œç”±å·²ä¹‹å¿µï¼Œä¿—è¨€ï¼šäºŒç‰‡å¶å­æ”¾åœ¨çœ¼å‰ï¼Œæ³°å±±ä¹Ÿçœ‹ä¸åˆ° äº†ã€‚å¯è§ä¸€å¿µä¹‹å·®ï¼Œè·ç¦»æœ‰å¦‚æ­¤è¿œï¼Œæ›´é‘è®ºå¯èƒ½è¯¯ä¸€ä¸–ï¼Œå¾…åæ‚” åï¼Œå·²æ˜¯ç™¾å¹´èº«çŸ£ã€‚æŠ±æŒä¾¥å¹¸å¿ƒç†ä¹‹äººæ˜¯æœ€è¦ä¸å¾—çš„ï¼Œä½ ä¸ä¼šæœ‰ç¬¬ äºŒæ¬¡æœºä¼šå†æ¥è¿‡çš„ï¼Œåˆ‡è®°ï¼åˆ‡è®°ï¼",
h: "ä¸ªæ€§è¿·è’™ä¸å¼€ï¼Œæ…§é•œç”Ÿå°˜ã€‚å¤šç—…å¤šç¾ã€‚æ— å­ä¹‹å®¶ï¼Œå§å¦¹å¤šã€‚æœ‰å­å¤­æŠ˜ã€‚äºŒäººï¼Œå¤«ä¹Ÿã€çˆ¶ä¹Ÿï¼ŒäºŒäººåœ¨æ±Ÿæ°´ä¸­ï¼Œäººäºé™©ä¸­ã€‚çˆ¶æ¯ä¸å’Œã€‚ç”Ÿç¦»æ­»åˆ«ï¼Œä¸€èˆ¬ä¸ºçˆ¶æœ‰å‡¶ã€‚",
 a: "è’™è”½ä¸–äººæ€»ä¸ºè´¢ï¼Œå¾—è´¢é‡é™©ã€‚å…ˆæˆåç ´ã€‚æ™šèŠ‚ä¸ä¿ã€‚å…ˆæˆåç ´ã€‚å¤«å¦»å¾—è´¢ï¼Œå´æœ‰å­å¤­æŠ˜ã€‚",
 b: "åå…«å­ï¼ˆæï¼‰ï¼Œåå…«å­å¤§å‰ã€‚è´¢ç¦„äº¨é€šã€‚æœ‰å­å¤­æŠ˜ï¼Œå‘å¤–æˆšã€‚å¾—ä¹‰å­ã€‚è´¢ç¦„æ•£åœ°ä¸Šï¼Œæ¥æºä¸æ­£ï¼ˆå¦‚çªƒå–è€Œæ¥ï¼Œä¸æ­£ï¼‰ã€‚æœ‰å®˜å¸é€¢ä¹‹ï¼Œæ‹›çªƒï¼Œç°æˆåç ´ã€‚å¥³å‘½ä¸ˆå¤«é‡é™©ï¼Œå¾—è´¢å…ˆæˆåç ´ã€‚åˆä¼™æ‹›å‡¶ã€‚æ‹›çªƒï¼Œç°æˆåç ´è±¡ã€‚",
 e: "èˆ¹åœ¨æ°´ä¸Šï¼Œè¿œç¦»æ­¤åœ°ï¼Œè°ƒèŒã€‚",
 f: "æ»¡èˆ¹çå®ï¼Œç¦»å¼€æ­¤åœ°ï¼Œä¸€ç›’å­ï¼Œä¸€é¹¿ã€‚å…ˆèµšåèµ”ï¼Œä¸èƒ½åšï¼Œåšçš„ç»“æœå°±æ˜¯è’™è”½ä»–äººçš„äººæœ€ç»ˆè¢«åˆ«äººæ‰€è’™è”½ï¼Œè¢«ç›—çªƒã€‚",
 g: "ç›’å­ï¼Œåˆå’Œï¼Œå¯ç»“å©šï¼Œä½†è¦é˜²ç ´ï¼Œç›’å­æœ€åæ˜¯ç ´çš„ã€‚",
 l: "æŠ˜æï¼Œç¦»å¼€æ­¤åœ°ï¼Œæ­¤æ¬¡æˆ–è€…æ­¤å¿—æ„¿ä¸ä¸­ï¼Œå¦‚å¯è°ƒå‰‚å¯ä¸Šã€‚",
 m: "é‡‘é’±åœ¨åœ°ï¼Œçƒ§çº¸é’±è±¡ï¼Œä¸§äº‹ã€‚",
 z: "æš‚æ— ",

                             },
        5: {
            n: "æ°´å¤©éœ€",
            t: "ä¸€ã€æœˆå½“å¤©ï¼šé˜´äººå±…ä¸Šä½è±¡ï¼Œæ— æ‹…å½“ä¹Ÿï¼›æ¸…æ˜æ— ç¾ã€‚<br>äºŒã€ä¸€é—¨ï¼šè±ªæ–—ä¹Ÿï¼Œå®˜åºœä¹Ÿã€‚<br>ä¸‰ã€ä¸€äººæ”€é¾™å°¾ï¼šé™„äºè´µäººï¼Œæƒ³è¿›æ®å…¶ä½ä¹Ÿã€‚<br>å››ã€ä¸€åƒ§æ¥å¼•ï¼šå…‰å¤´ä¹‹äººï¼ŒæŸ”è€Œæ— æ¬²ä¹‹è±¡ã€‚å…¥ç©ºé—¨å¯è§£ã€‚<br>äº”ã€å¢“ï¼šè—æ£ºä¹‹åœ°ï¼Œæœ‰å®˜ä¸è´¢è±¡ï¼›ç½®ä¹‹æ­»åœ°è€Œåç”Ÿä¹‹è±¡ã€‚",
            x: "é¥®é£Ÿå®´ä¹ï¼Œç­‰å¾…æ—¶æœºã€‚ä¸è¿›é˜²é™©ã€‚<br>åˆä¹ï¼šéœ€äºéƒŠï¼Œåˆ©ç”¨æ’ï¼Œæ— å’ã€‚<br>ä¹äºŒï¼šéœ€äºæ²™ï¼Œå°æœ‰è¨€ï¼Œç»ˆã€‚<br>ä¹ä¸‰ï¼šéœ€äºæ³¥ï¼Œè‡´å¯‡è‡³ã€‚<br>å…­å››ï¼šéœ€äºè¡€ï¼Œå‡ºè‡ªç©´ã€‚<br>ä¹äº”ï¼šéœ€äºé…’é£Ÿï¼Œè´ã€‚<br>ä¸Šå…­ï¼šå…¥äºç©´ï¼Œæœ‰ä¸é€Ÿä¹‹å®¢ä¸‰äººæ¥ï¼Œæ•¬ä¹‹ç»ˆã€‚",
            d: gd('NW')+"æ¬¡å­å±…è¥¿åŒ—ã€‚",
u:"æ­¤å¦å‡ºç°ï¼Œä»£è¡¨å…¶äººæ™ºæ…§æˆé•¿å¿«é€Ÿï¼ŒåŠ¿å¿…è¶…è¶ŠåŒå¹´çºªåŒæ—¶ç”Ÿäºº å¤šå¤šï¼Œä¸”ä¸ªæ€§åˆšçƒˆï¼Œä¸å—å»ºè¨€ï¼Œé¡»æ³¨æ„ï¼Œå¦‚é•¿å…„ä¸€æ—¦ç»“å©šï¼Œæ­¤å±€ç«‹ æ¶ˆï¼Œå±€è‡ªé•¿å…„å©šä¹‹æ—¥å§‹ï¼Œç«‹å˜ä¸ºé›·å¤©å¤§å£®æ”¶å±€ã€‚éœ€å¦å±€æ‰€è¡¨ç°çš„æ„ä¹‰å¦‚åï¼šä¸€ã€å©šäº‹å»¶åä¸ƒå¹´ï¼Œä¸”å•å²å©šã€‚äºŒã€å¦‚é€¢å…«å­—ä¸­ï¼Œå–œåº†é€¢å‡¶ï¼Œå¿…å…¥å®—æ•™æˆ–ä¸å©šã€‚ ä¸‰ã€å©šæ—¶ï¼Œå¦»å¿…ä¸ºæ”¹å«ä¹‹äººã€‚å››ã€äºäº‹ä¸šä¸Šï¼Œå¿…æœ‰å¤§æˆï¼Œå¹´å°‘å±…æƒä½ï¼Œå—é‡ç”¨ï¼Œè¿›é€€æœ‰æ®ã€‚",
h: "çˆ¶å…ˆä¸§å¤±ï¼Œæ¯ç‹¬å…»æˆï¼Œæ”€é¾™é™„å‡¤ï¼Œå±…äºå°¾ï¼Œäº”å²ä¹‹å‰ï¼Œæœ‰å‡¶äº‹ã€‚äºŒåæ—¥å¤§äººå…¥åœŸä¸­ã€‚",
 a: "ä¾å›èº«ä¾§ä¸ºé©¶å¸­ï¼ˆå¦‚é©¾é©¶å‘˜å…¬äº¤è½¦å¸æœºï¼‰ã€‚è·Ÿéšè´µäººï¼Œç»ˆå…¶ä¸€ç”Ÿã€‚å…„å¼Ÿäº‰è´¢ã€‚è€æ¥å…¥ç©ºé—¨ã€‚",
 b: "é¾™å‡ºç°ï¼Œå¤±å® æ— å®˜ã€‚éå°”æ‰€æ„¿ä¹Ÿã€‚æœ‰çˆ¶å‡¶ä¹‹è™ã€‚è‰ä¸­æœ‰ç‰ï¼Œä¸è§å¤©æ—¥ã€‚å°¾å¤§ä¸æ‰ï¼Œä»»äººå®°å‰²ã€‚ä¸¢å®˜ã€‚å…¥ç©ºé—¨å¯è§£ã€‚å©šäº‹æœ‰å‡¶ï¼Œæ˜“ç»“éš¾ç¦»ã€‚æœ‰å¾…æˆŒåƒ(æˆŒå¹´ï¼Œç‹—äººï¼Œè‚–ç‹—ï¼‰å¯å‘ç¦å‘ç¦„ã€‚",
 e: "æ”€é™„é¾™å°¾ï¼Œå¢“ï¼Œè·Ÿéšè´µäººå¯å‡ï¼Œå‡ä¸ä¸å‡åªåœ¨ä¸€çº¿ä¹‹é—´ã€‚",
 f: "å¢“ï¼Œé‡Œé¢æœ‰æ£ºæï¼Œè´¢ä¹Ÿï¼Œä¸ºä¸€çº¿è´¢ï¼Œå¾—ä¸ä¸å¾—åœ¨ä¸€çº¿ä¹‹é—´ã€‚",
 g: "æ”€é™„é¾™å°¾ï¼Œæ”€é¾™é™„å‡¤ï¼Œå«å…¥è±ªé—¨ã€‚æˆ–è€…é—®æ˜¯å¦ä¸å©šï¼Œé—®å°±æ˜¯ä¸å©šï¼Œå‡ºå®¶ã€‚è¦å…ˆç¡®å®šé—®é¢˜é—®çš„æ˜¯ä»€ä¹ˆã€‚",
 l: "æœˆæœ‰å…‰ï¼Œå¢“ï¼Œåƒ§äººæ¥å¼•ã€‚é€¢æ›¾å§“ï¼Œåæœˆï¼ˆyueï¼‰å­—æœ‰å¸Œæœ›é«˜ä¸­ï¼Œå…¶ä½™çš†ä¸è§å¤©æ—¥ï¼Œæ˜¯ä¸ºä¸ä¸­ä¹Ÿã€‚",
 m: "çˆ¶äº¡ä¹‹æ—¶ï¼Œæˆ–è€…æ˜¯å„¿å­ï¼Œå…„å¼Ÿï¼Œä¸ˆå¤«ã€‚æ€»ä¹‹ä¸æ˜¯å®¶é‡Œçš„å¥³äººã€‚å¥³äººå°±æ˜¯å¹³å®‰ã€‚",
 z: "å¾—åˆ°éœ€ï¼Œéœ€è¦å®ˆæ­£å¾…æ—¶ï¼Œè‚–é¾™æˆ–è€…ä¸é¾™æœ‰å…³çš„äººæœ€å‡¶ï¼Œæ›¾å§“äººæ˜¯è´µäººã€‚è‰å¤´äººå¥³äººå‡ºå¤´ï¼Œä¾‹å¦‚è‘£ï¼Œè‹—ï¼Œé»„ç­‰ã€‚",

                             },
        6: {
            n: "å¤©æ°´è®¼",
            t: "ä¸€ã€å£èˆŒäºŒå­—ï¼šå®˜å¸ï¼Œçº çº·ï¼Œç¾ä¹Ÿã€‚<br>äºŒã€å±±ä¸‹æœ‰ç¡è™ï¼šå…¥å±åœ°è€Œä¸çŸ¥è±¡ã€‚<br>ä¸‰ã€è™ï¼šç‹å§“ï¼Œè‚–è™ä¹‹äººã€‚<br>å››ã€æ–‡ä¹¦åœ¨äº‘ä¸­ï¼šå¿ƒæƒ³äº‹ä¸æˆï¼Œå¹»æƒ³ä¹Ÿã€‚<br>äº”ã€äººç«‹è™ä¸‹ï¼šè¿‘é™©ä¹Ÿï¼Œè¿‘é™©ä¸ºè„±é™©ä¹‹é“ã€‚<br>å…­ã€æŸ³æ ‘ï¼šéšé£è€ŒåŠ¨ï¼Œè™½å¤§é£è€Œä¸æ–­ï¼Œæ­¤æŸ³ä¹‹æ€§ä¹Ÿã€‚",
            x: "ä½œäº‹è°‹å§‹ï¼Œè®¼åˆ™ç»ˆå‡¶ã€‚æ…å§‹æ•¬ç»ˆã€‚<br>åˆå…­ï¼šä¸æ°¸æ‰€äº‹ï¼Œå°æœ‰è¨€ï¼Œç»ˆã€‚<br>ä¹äºŒï¼šä¸å…‹è®¼ï¼Œå½’è€Œé€‹ï¼Œå…¶é‚‘äººä¸‰ç™¾æˆ·ï¼Œæ— çœšã€‚<br>å…­ä¸‰ï¼šé£Ÿæ—§å¾·ï¼Œè´å‰ç»ˆã€‚æˆ–ä»ç‹äº‹ï¼Œæ— æˆã€‚<br>ä¹å››ï¼šä¸å…‹è®¼ï¼Œå¤å³å‘½ï¼Œæ¸å®‰è´ï¼Œã€‚<br>ä¹äº”ï¼šè®¼ï¼Œå…ƒã€‚<br>ä¸Šä¹ï¼šæˆ–é”¡ä¹‹é¶å¸¦ï¼Œç»ˆæœä¸‰è¤«ä¹‹ã€‚",
            d: gd('N')+"çˆ¶å±…åŒ—ã€‚",
u:"æ­¤å±€ä»¤äººå®˜å¸ä¸æ–­ï¼Œè¯‰è®¼ç¼ èº«ï¼Œæˆ–ä¸ºå¥½è®¼ä¹‹å¾’ã€‚ä¸€æ—¦ç¦»å©šæ­¤å±€ æ–¹ç ´ï¼Œå¦åˆ™ä½ åªå¥½æ”¹å˜å§æˆ¿ä½ç½®ï¼Œæ–¹å¯è„±ç¦»æ­¤å±€ä¹‹é™ã€‚ä¸€ã€å®˜äººå±…æ­¤å±€ï¼Œå‡å®˜æ…¢äº”å¹´ï¼Œè¯¸äº‹ä¸é¡ºï¼Œå³ä»¤ä¸è¿æ³•ï¼Œäº¦å— ä»–äººè¿ç´¯ã€‚äºŒã€å•†äººå±…æ­¤å±€ï¼Œè´¢ç¦„ä¸è¿›ï¼Œå¿…é¡»å…´è®¼æ–¹å¯å¾—è´¢ã€‚ä¸‰ã€å¤«å¦»å©šå§»ä¸»ç ´ï¼Œè¯‰è®¼ç¦»å©šï¼Œæ­¤é¡»çœ‹å‘½ï¼Œå¦‚å‘½ä¸­æœ‰ï¼Œåˆ™å¿…æˆ æ ¼ï¼›å¦‚å‘½ä¸­æ²¡æœ‰ï¼Œåˆ™ä¸æˆæ ¼ã€‚å››ã€ä¸“ä¸šäººå£«å¦‚åŒ»å¸ˆï¼Œä¼šè®¡å¸ˆç­‰å±…æ­¤å±€ï¼Œåƒä¸‡é¡»é˜²è®¼äº‹æ¥ä¸´ï¼Œ æµå¹´é€¢ä¹‹ï¼ŒåŒæ—¶ç”Ÿäººæ²¡äº‹ï¼Œè€Œä½ å¿…ç”Ÿäº‹ç«¯ï¼Œè¿æ°”ä¸å¥½ä½¿ç„¶ã€‚",
h: "å£èˆŒæ˜¯éæ€»ä¸æ–­ï¼Œç¥¸å› çš†ç”±å£æ— é®æ‹¦ã€‚äº‹ä¸æ„¿è¿(å«è€ƒè¯•è¯»ä¹¦)ã€‚åŠ¨åˆ™å¾—å’ã€‚å¤©æœºï¼šç‹è™æ½œè—ï¼Œå‘åœ¨ä»–ä¹¡ã€‚",
 a: "é¡ºåŠ¿è€Œä¸ºï¼Œåšå®ˆæ­£é“ï¼Œæ–¹å¯å¹³å®‰ã€‚å½“å®˜ã€å…¬åŠ¡äººå‘˜ï¼šå®˜è¿ä¸é€šï¼Œæœ‰å£èˆŒç¼ èº«ã€‚æœ‰å¹¸å¾—è´¢ï¼Œæœ‰è´¢é™©ä¸­æ±‚ï¼ˆå¦‚å…­åˆå½©ï¼‰ã€‚ä¸€ç”Ÿä¸é‚ã€‚è¾ƒç´¯ã€‚ç‹å§“è™äººä¸ºè´µï¼Œä»ä¹‹å‰ã€‚",
 b: "å£èˆŒå®˜å¸ä¸ºä»–äººã€‚äºŒæ¬¡å®˜å¸éš¾å…ã€‚è‚–è™è´µäººï¼Œç‹å§“å‡¶äººã€‚å¤„é™©ï¼Œéšé£å¹³å®‰ï¼ŒæŸ³å§“åˆ˜å§“æ˜¯è´µäººã€‚å©šå§»åˆ™æœ‰å®æ— åï¼Œå©šä¸æˆã€‚",
 e: "æ–‡ä¹¦äº‘ä¸­ï¼Œå£èˆŒï¼Œå¿ƒæƒ³äº‹ä¸æˆï¼Œæ˜¯å¹»æƒ³ä¹Ÿï¼Œæœ‰å®˜å¸ä¹Ÿã€‚",
 f: "æ–‡ä¹¦äº‘ä¸­ï¼Œè™å§æ˜¯å¹»æƒ³ä¹Ÿï¼Œæœ‰å±é™©ä¹Ÿã€‚",
 g: "æ–‡ä¹¦äº‘ä¸­ï¼Œæ˜¯å¹»æƒ³ä¹Ÿï¼Œä¸æˆã€‚",
 l: "æ˜¯å¹»æƒ³ä¹Ÿï¼Œä¸ä¸­ã€‚",
 m: "è™å§ï¼Œæœ‰é™©ä¹Ÿï¼Œå§“ç‹å‡¶ï¼Œå§“æŸ³è‚–è™åè€Œå¹³å®‰ï¼Œè‚–è™è€…è°ƒåŠ¨è¿œæ–¹æ¯”åœ¨æœ¬åœ°å¥½ã€‚",
 z: "æš‚æ— ",

                             },
        7: {
            n: "åœ°æ°´å¸ˆ",
            t: "ä¸€ã€è‚–è™ã€é©¬ã€ç¾Šä¹‹äººä¸‰åˆï¼šå¯æˆ˜ã€‚<br>äºŒã€æ–‡æ­¦äºŒå®˜ç»¶å°ï¼šå¾—ä¸‡äººæœä¹‹å¸…ã€‚<br>ä¸‰ã€äººç«‹æ£‹ç›˜ä¸Šï¼šå›´æ£‹æ„ˆä¸‹æ„ˆå¤šï¼Œä½†é¡»æœ‰è°‹ç•¥æ–¹å¯æˆäº‹<br>å››ã€å°†å†›å°ä¸Šç«‹ï¼šç¤ºæœ‰å…µæƒä¹Ÿã€‚ç”Ÿæ€ä¹‹ä¸“æƒä¹Ÿã€‚æ­¦èŒå¤§åˆ©ã€‚<br>äº”ã€ç¾Šå›é¦–ï¼šå›é˜³ä¹Ÿï¼Œç—…å±ä¹‹äººåœä¹‹ï¼Œæœ‰è‡ªé˜´é—´å›é˜³é—´ä¹‹è±¡ã€‚<br>å…­ã€è™åœ¨é©¬åï¼šä¸ºé©¬ä¹‹é å±±ï¼Œé©¬å› è™å¨è€ŒåŠ¨ã€‚æ•…é©¬å›é¦–è§†è™ã€‚",
            x: "è¡Œå†›ç”¨å…µï¼Œä¸ˆäººå‰ï¼Œæ— å’ã€‚<br>åˆå…­ï¼šå¸ˆå‡ºä»¥å¾‹ï¼Œå¦è‡§å‡¶ã€‚<br>ä¹äºŒï¼šåœ¨å¸ˆä¸­ï¼Œï¼Œæ— å’ï¼Œç‹ä¸‰é”¡å‘½ã€‚<br>å…­ä¸‰ï¼š å¸ˆæˆ–èˆ†å°¸ï¼Œå‡¶ã€‚<br>å…­å››ï¼šå¸ˆå·¦æ¬¡ï¼Œæ— å’ã€‚<br>å…­äº”ï¼šç”°æœ‰ç¦½ï¼Œåˆ©æ‰§è¨€ï¼Œæ— å’ã€‚é•¿å­å¸…å¸ˆï¼Œå¼Ÿå­èˆ†å°¸ï¼Œè´å‡¶ã€‚<br>ä¸Šå…­ï¼šå¤§å›æœ‰å‘½ï¼Œå¼€å›½æˆå®¶ï¼Œå°äººå‹¿ç”¨ã€‚",
            d: gd('N')+"æ¯å±…åŒ—ã€‚",
u:"æ­¤å±€å¤§å¼‚å…¶è¶£ï¼Œå¾äººå¸¸è§æ³¼å¦‡éª‚è¡—ï¼Œå¥³äººæ€§åˆšï¼Œç”šè€Œä¸äººæ®´ æ‰“ï¼Œå…¶å±€å¦‚æ­¤ï¼Œç”Ÿäººå¦‚æ­¤ï¼Œäº¦ä¸ºå¦™çŸ£ã€‚å½“ä½ å‘ç°æ¯äº²å¦‚æ­¤ï¼Œå‡¶æš´ï¼Œæ˜“ä¸äººèµ·äº‰ç«¯ï¼Œä»‡è§†å¤–äººï¼Œå…¶çš†ç”± æ­¤å±€äº§ç”Ÿçš„ï¼Œå½“é¡»åŒ–è§£ï¼Œæ–¹å¯å¹³å®‰ã€‚ä¸€ã€å¯¹å©šäº‹å¿…å‡¶ï¼Œæœ‰å¦»æ®´å¤«ä¹‹è±¡ã€‚äºŒã€äº‹ä¸šä¸Šï¼Œäº¦ä¸å¾—å¿—ï¼Œå¸¸ç”Ÿçº çº·ï¼Œç”·å‘½å¥³èº«ã€‚ä¸‰ã€ç‹¬æ¥ç‹¬å¾€ï¼Œèƒ†å¤§è¿‡äººã€‚å››ã€ä»å•†ä¸»ç ´å©šï¼Œå¾—è´¢ï¼Œå°¤åˆ©è™ã€é©¬ã€ç¾Šä¸‰äººï¼Œå…¶å•†æœºã€å®˜è¿ äº¨é€šï¼Œä½†å©šåˆ™å‡¶ï¼Œå„æœ‰åˆ©å¼Šã€‚å…¶ä¸åŒæ—¶ç”Ÿä¹‹äººæˆ–åŒèƒèƒå¤§å¼‚å…¶è¶£ï¼Œå„æ–¹é¢çš†ä¸åŒã€‚",
h: "å¤©é™ç¥æ­¦äºæ–¯äººï¼Œè‹±æ˜ç¥æ­¦ã€‚æˆæ ¼éœ€è‚–é©¬è‚–è™è‚–ç¾Šäººã€‚æ©ä»ä¹é‡å¤©æ¥ï¼Œå—é‡ç”¨ï¼Œé’å¹´æ—¶å½“å°†å†›æ‰“èƒœä»—ã€‚å°†æ˜Ÿå—å‘½ï¼Œä¸»å¤§è´µã€‚å°¤å…¶å‘æ­¦å®˜äººï¼ˆå†›äººè­¦å¯Ÿæ³•å®˜å¤–äº¤å®˜ï¼‰ï¼Œæ­¦å®˜äººå‘è¿¹ã€‚æ‰‹è¶³ä¸‰äººï¼Œå‘äºŒäººï¼Œå‘ä¸¤æˆ¿ã€‚",
 a: "å¹³æ­¥é’äº‘ï¼Œé€¢è°ƒå¿…å‡ã€‚æ£‹å­ï¼ˆå„¿å­ï¼‰å°‘ï¼Œå”¯ä¸€ç¼ºå¤±ã€‚",
 b: "å£èˆŒå®˜å¸ä¸ºä»–äººã€‚äºŒæ¬¡å®˜å¸éš¾å…ã€‚è‚–è™è´µäººï¼Œç‹å§“å‡¶äººã€‚å¤„é™©ï¼Œéšé£å¹³å®‰ï¼ŒæŸ³å§“åˆ˜å§“æ˜¯è´µäººã€‚å©šå§»åˆ™æœ‰å®æ— åï¼Œå©šä¸æˆã€‚",
 e: "æ–‡æ­¦æˆå°ï¼Œæ–‡æ­¦åŒå…¨ï¼Œå‡å®˜ä¹‹è±¡ã€‚",
 f: "äººåœ¨æ£‹ç›˜ä¸Šç«‹ï¼Œå›´æ£‹è¶Šä¸‹è¶Šå¤šä¹‹è±¡ï¼Œå‘è´¢ä¹‹è±¡ï¼Œå¦‚é—®æ˜¯å¦ä¼šæ»é”€ï¼Œè´§ç‰©ç§¯ç´¯è¶Šæ¥è¶Šå¤šï¼Œé—®å°±æ˜¯ä¼šã€‚æ£‹ç›˜ï¼Œéœ€è¦è°‹ç•¥ä¹Ÿã€‚",
 g: "å©šå§»å¸¦å°å¿…æˆã€‚",
 l: "æ–‡æ­¦æˆå°ï¼Œæœ‰æ–‡å°ï¼Œæ•…å¤§åˆ©è€ƒè¯•ã€‚",
 m: "ç¾Šå›å¤´ï¼Œå›é˜³ä¹Ÿï¼Œä¸ºä¸æ­»ä¹Ÿã€‚äº¦æˆ–è€…æ–°å† ç­‰ç—…æ¯’å¤é˜³ä¹Ÿã€‚è‚–è™ã€é©¬ã€ç¾Šå¤§åˆ©ï¼Œå‡¡äº‹åŠ å‰ã€‚",
 z: "æš‚æ— ",

                             },
        8: {
            n: "æ°´åœ°æ¯”",
            t: "ä¸€ã€æœˆåœ†å½“ç©ºï¼šæ”¿æ²»æ¸…æ˜è±¡ã€‚<br>äºŒã€ä¸‰æ˜Ÿæ‹±ç…§ï¼šå¾—è´¤èƒ½åˆšç›´ä¹‹äººè¾…åŠ©ã€‚<br>ä¸‰ã€ç§€æ‰æœ›æœˆé¥®é…’ï¼šç¤ºæ‰æ™ºä¹‹äººæ— å¿§ä¹Ÿ<br>å››ã€è‡ªé…Œè‡ªæ–Ÿï¼šæ— æ¬²åˆ™åˆšè±¡ï¼Œå­¤ç‹¬ä¹‹è±¡ã€‚<br>äº”ã€è¯ç‚‰åœ¨é«˜å¤„ï¼šæ— ç—…æ— ç¾ï¼Œæ•…ä¸éœ€ç”¨è¯ä¹Ÿã€‚<br>å…­ã€æ¯æ ‘å¼€èŠ±ï¼šæ™šå‘ä¹Ÿã€‚ç¤ºå¿ƒæœ‰è¯šï¼Œåˆ¶åº¦ç«‹ï¼Œäº‹å¿…æˆã€‚<br>ä¸ƒã€é…’ï¼šå¿˜å¿§ä¹‹ç‰©ã€‚",
            x: "äº²æ¯”ï¼Œè¾…åŠ©ï¼Œä¼—æ˜Ÿæ‹±æœˆã€‚å»ºä¸‡å›½äº²è¯¸ä¾¯ã€‚<br>åˆå…­ï¼šæœ‰å­šï¼Œæ¯”ä¹‹æ— å’ã€‚æœ‰å­šç›ˆç¼¶ï¼Œç»ˆæ¥æœ‰å®ƒï¼Œã€‚<br>å…­äºŒï¼šæ¯”ä¹‹è‡ªå†…ï¼Œè´ã€‚<br>å…­ä¸‰ï¼šæ¯”ä¹‹åŒªäººã€‚<br>å…­å››ï¼šå¤–æ¯”ä¹‹ï¼Œè´ã€‚<br>ä¹äº”ï¼šæ˜¾æ¯”ï¼Œç‹ç”¨ä¸‰é©±ï¼Œå¤±å‰ç¦½ï¼Œé‚‘äººä¸è¯«ï¼Œã€‚<br>ä¸Šå…­ï¼šæ¯”ä¹‹æ— é¦–ï¼Œå‡¶ã€‚",
            d: gd('SW')+"æ¬¡å­å±…è¥¿å—ã€‚",
u:"æ­¤å¦å‡ºç°ï¼Œé¡»é•¿å…„ä¸ºæœªå©šï¼Œä¸€æ—¦é•¿å…„å©šï¼Œæ­¤å±€ç«‹å˜ä¸ºè±«å¦ï¼Œé¡» æ³¨æ„å˜å±€å°†å¦‚ä½•ï¼Œåˆ™çœ‹é•¿å…„ä¹‹å‘½ï¼Œä½•æ—¶æœ‰å©šï¼ŒçŸ¥ä½•æ—¶ç”Ÿå˜å±€ï¼Œæ­¤å³ é˜³å®…ä¸Šå¯è§æœªæ¥ä¹‹è±¡ã€‚æ­¤å¦æœ‰äº²æ¯”ä¹‹æ„ã€‚ä¸€ã€æ€§å–œä»æ¯äº‹ï¼Œä¸”ä»»åŠ³ä»»æ€¨ï¼Œå®¶äº‹ä¸€æ‰‹åŒ…åŠï¼Œä¸æ¯è¿å¿ƒã€‚ äºŒã€é€‚å©šå¹´é¾„åˆ°æ—¶ï¼Œå–œæ¬¢æ¯”è‡ªå·±å¹´é•¿äºå·±ä¹‹å¥³äººï¼Œå¦‚å‘½ä¸­åŒæ—¶ç”Ÿäººä¸ºäºŒåå…«å²å©šï¼Œä½†æ­¤å±€äººå©šå¿…å»¶åä¸‰å¹´åˆ°ä¸‰åä¸€å²æ‰å©šï¼Œä¸”å¨¶ å¹´é•¿äºå·±ä¹‹å¥³äººæ–¹åˆæ ¼ï¼Œå¦åˆ™å©šä¸»ç ´æ•£ï¼Œä¸å‡ºä¸€å¹´ã€‚ä¸‰ã€å¦‚å‘½ä¸­ä¸»ç ´ï¼Œå©šäº‹ä¸æˆï¼Œå†å±…æ­¤å±€ï¼Œåˆ™ç»ˆèº«ä¸å¨¶ï¼Œä¸”ä¸æœ‰ å©šæˆ–ç¦»å©šä¹‹å¥³æœ‰æ¥å¾€ï¼Œç»ˆæ— æœä¹Ÿã€‚å››ã€äº‹ä¸šä¸Šåˆ™å±…ä½æ‰ä¹‹ä½ï¼Œæ— æ³•ä»»èŒä¸»ç®¡ã€‚äº”ã€å•†åœºä¸Šäº¦ä¸ºäººå·¥ä½œï¼Œä¸ä¸ºè€æ¿ï¼ŒåŒæ—¶ç”Ÿäººæœ‰å¯èƒ½ä¸ºå¾ˆæˆåŠŸ çš„è€æ¿ï¼Œä½†å‘½åªå±…ä¸‰æ‰ä¹‹ä¸‰åˆ†ä¹‹ä¸€ï¼Œè¿çš„å±€å½±å“ï¼Œä½¿å…¶ç»ˆèº«ä¸å¾— å¿—ï¼Œä¸”ä¸åŒæ—¶ç”Ÿäººæœ‰ä¸åŒä¹‹ç»“æœã€‚å”¯ä¿Ÿé•¿å­æˆå©šåï¼Œå±€æ–¹å¯æ”¹å˜ï¼Œå¦‚é•¿å…„å±…ä¾§ï¼Œæˆ–è®¤å¹²å…„ï¼Œæ­¤å±€åŠ¿å¿…éš¾å˜ã€‚",
h: "æ¯ä¸ºè´µäººå‘½ä¸­å®šã€‚æ­Œèˆå‡åæ‰å‡ºä¼—ã€‚å­¤ç‹¬ä¸€ç”Ÿè°æ¥é—®ã€‚è‹¥é¼»å­æ²¡æœ‰è‚‰ï¼Œå°–å°–ä¸‹æ¥ï¼Œç»ˆèº«ä¸ºä¼¶äººã€‚çˆ¶ä¸å…¨ï¼Œæ™šå¾—å­ã€‚å¤©æœºï¼šä¸‰æ˜Ÿç›¸ä½ï¼Œå†…é€šå¤–æµã€‚",
 a: "å¦»å®«å¾—åŠ›ï¼Œé˜´ä¸ºè´µäººã€‚è´µäººéšåœ¨æš—å¤„ã€‚å››äº”ä¹‹åæ–¹å…´å‘ã€‚ä¸­å¹´èµ·è¿ã€‚æœ‰ç—…æ— ç¾æ¸…é—²äººã€‚æœ‰å¿—ä¸é‚æ™šå¾—å­ï¼Œç„¶æ™šæ¥å­è´µã€‚",
 b: "éœ€é˜²èƒƒç—…ã€‚æ¯å‰çˆ¶æ— åŠ©ã€‚æ‰è‰ºä¹‹äººæ— äº‹åšã€‚æ•™èŒå‰ã€‚æ­¤ä¸ºé¡¶ç‚¹ã€‚æ¡ƒææ»¡å¤©ä¸‹ã€‚",
 e: "æ­¤æ¬¡ä¸å‡ã€‚é—®æ˜¯å¦å¯ä»¥åšå±€é•¿ï¼Œå¯ä»¥åšå‰¯å±€é•¿ã€‚",
 f: "æ¯æ ‘å¼€èŠ±ï¼Œæ™šå‘ï¼Œç°åœ¨ä¸è¦ç€æ€¥åšã€‚",
 g: "è‡ªé…Œè‡ªé¥®ï¼Œè‡ªå·±æ— å¯¹è±¡ï¼Œæ™šå©šã€‚",
 l: "ç§€æ‰æœ›æœˆé¥®é…’ï¼Œæ‰æ™ºæ— å¿§ï¼Œå¯é«˜ä¸­ã€‚",
 m: "è¯ç‚‰é«˜å¤„ï¼Œä¸éœ€ç”¨è¯ï¼Œç‚‰ä¸ºç«åœŸä¹‹ä¸åˆï¼Œå°å¿ƒèƒƒåè¡€ç­‰ã€‚",
 z: "æš‚æ— ",

                             },
        9: {
            n: "é£å¤©å°ç•œ",
            t: "ä¸€ã€ä¸¤é‡å±±ï¼šçŸ¥æœ‰é™©é˜»äºå‰ï¼Œä¸å¦„åŠ¨ä¹‹è±¡ã€‚äº¦ä¸ºå‡ºå­—è±¡ã€‚<br>äºŒã€ä¸€äººå±±é¡¶ï¼šå­¤ç«‹ç‹¬è¡Œè±¡ã€‚å·²è‡³é¢ å³°ï¼Œå°†èµ°ä¸‹å¡ä¹‹æ„ã€‚<br>ä¸‰ã€èˆŸæ¨ªå²¸ä¸Šï¼šå‡†å¤‡å‡ºå‘ï¼Œæ°´æœªè‡³è€Œä¸è¡Œä¹Ÿã€‚<br>å››ã€æœ›ç«¿åœ¨è‰é‡Œï¼šç­‰å¾…è®¯æ¯è±¡ã€‚è‰å¤´å§“äººä¸ºè´µäººã€‚æœ›ï¼Œäº¡ä¹Ÿã€‚<br>äº”ã€ä¸Šæœ‰ç¾Šé©¬ï¼šé©¬å¼•ç¾Šè¿‡æ²³ï¼Œé©¬ä¸ºè´µäººï¼Œè‚–é©¬äººï¼Œå§“é©¬äººä¹Ÿï¼Œé©¬äº¦ä¸ºåˆæ—¶ã€‚",
            x: "å°æœ‰ç§¯è“„ï¼Œæš‚æ—¶å—é˜»ã€‚æ‡¿æ–‡å¾·ã€‚<br>åˆä¹ï¼šå¤è‡ªé“ï¼Œä½•å…¶å’ï¼Œã€‚<br>ä¹äºŒï¼šç‰µå¤ï¼Œã€‚<br>ä¹ä¸‰ï¼šèˆ†è¯´è¾ï¼Œå¤«å¦»åç›®ã€‚<br>å…­å››ï¼šæœ‰å­šï¼Œè¡€å»æƒ•å‡ºï¼Œæ— å’ã€‚<br>ä¹äº”ï¼šæœ‰å­šæŒ›å¦‚ï¼Œå¯Œä»¥å…¶é‚»ã€‚<br>ä¸Šä¹ï¼šæ—¢é›¨æ—¢å¤„ï¼Œå°šå¾·è½½ï¼Œå¦‡è´å‰ã€‚æœˆå‡ æœ›ï¼Œå›å­å¾å‡¶ã€‚",
            d: gd('NW')+"é•¿å¥³å±…è¥¿åŒ—ã€‚",
u:"æ­¤å¦å±€ï¼Œç€é‡äºäº‹ä¸šï¼Œä¸é‡äºå©šå§»ï¼Œå‡¡å®¶æœ‰å¥³å„¿çš†æ˜“æˆæ­¤å±€ï¼Œ å¦å±€ä¹‹åˆ¤è¯»ï¼Œè¯·å‚é˜…å½•åƒæ•™å­¦å¸¦ï¼Œæ­¤å¤„ä¸è¨€ã€‚ä¸€ã€å¥³ä»£çˆ¶èŒï¼Œä¸”èƒ½åŠ›å¼ºè¿‡ç”·äººï¼Œç‹¬ç«‹è‡ªä¸»ï¼Œä¸ä¾èµ–ä»–äººã€‚ äºŒã€äº‹ä¸šä¼å›¾å¿ƒæ—ºç››ï¼Œæ—©å¹´ä¸ºè€æ¿ï¼Œäº‹ä¸šæœ‰æˆã€‚ä¸‰ã€å©šäº‹æ–¹é¢ï¼Œé¡»ä¸å‘½åŒå‚ï¼Œå¦‚åŒæ—¶ç”Ÿäººä¸ºäºŒåå…«å²å©šï¼Œè€Œæ­¤ é˜³å®…å±€ä¹‹äººä¼šæå‰äºŒå¹´ç»“å©šã€‚å¦‚åŒæ—¶ç”Ÿäººå©šå§»ä¸æˆä¸»æœ‰å©šå¿…ç ´ï¼Œæ­¤ å±€ä¹‹äººå¿…ç»ˆèº«ä¸å«ï¼Œå…¨å¿ƒåœ¨äº‹ä¸šä¸Šå‘å±•ï¼Œæˆä¸ºä¸€å¥³å¼ºäººã€‚æ­¤å±€å¤§åˆ©è‚–ç¾Šã€é©¬ä¹‹äººï¼Œä½†å³ä»¤æœ‰å©šï¼Œå¤«äº¦æ— åŠ›åŠ©ä¹‹ï¼Œå…¨é ä¸€å·±ä¹‹åŠ›ç‹¬æ’‘å¤§å±€ã€‚",
h: "ä¸¤é‡å±±é˜»ï¼Œå¤–ä¹¡å‘è¿¹ã€‚å¤©æœºï¼šèˆŸæ‰¬çŠ¹å¾…æ°´æ¥ä¼šã€‚èˆŸï¼Œå¦‚å‘¨ï¼Œæ¨ï¼Œç¾Šç­‰ã€‚è‰å¤´äººæœ›ã€‚è‹—ã€é»„ï¼Œè‰å¤´ä¹Ÿã€‚é©¬é¢†ç¾Šè¿‡é™©ï¼Œé©¬ä¸ºç¾Šä¹‹è´µäººã€‚å±±é¡¶ç‹¬è¡Œï¼Œç‰¹ç«‹ç‹¬è¡Œï¼Œç‰¹ç«‹äººé—´ï¼Œä¸ä¸äººç¾¤å±…ä¸€èµ·ï¼Œå–œä¸€äººç‹¬æ¥ç‹¬å¾€ã€‚ä¸ªæ€§ä½¿ç„¶",
 a: "å¤–ä¹¡å‘è¿¹å‘½ä¸­å®šã€‚ä¸‡äº‹ä¿±å¤‡ï¼Œä¸œé£ä¸ºæ°´ï¼ˆæ°´å¹´ã€äººã€äº‹ã€‚æ¼‚æ´‹è¿‡æµ·ï¼‰ã€‚å¤«å¦»ä¸¤åœ°ç›¸éš”ï¼Œå¤«å¦»åç›®ã€‚å¤©æœºï¼šé©¬ç¾Šä¹‹äººï¼Œç‹¬å­ä¸äº¡ã€‚æˆ–æ›°ï¼šéé©¬ç¾Šä¹‹äººï¼Œæœ‰å„¿å­å¤­æŠ˜ã€‚",
 b: "è‰å¤´äººæˆæ ¼ï¼Œè´µã€‚éè‰å¤´äººä¸æˆæ ¼ï¼Œå­¤ç«‹æ— æ´ï¼Œå‰é™©åé˜»ã€‚å·¦æ”¯å³æ‹™ï¼Œè‰å¤´äººå‡ºåŠ›å¤§ï¼Œè‰å¤´äººä¸ºè´µï¼ˆé»„ï¼Œè‹—ï¼Œè‰å¤´ï¼‰ã€‚é€¢é©¬ç¾Šå¯è„±å›°ï¼ŒäºŒæ¬¡åŠªåŠ›å¯å¾—ã€‚å©šäº‹é€¢ä¹‹ï¼Œåˆ†ä¸¤åœ°ã€‚è‰å¤´äººæœ›å½’ã€‚",
 e: "ä¸¤é‡å±±ï¼Œä¸€äººå±±é¡¶ï¼Œé©¬å¼•ç¾Šè¿‡æ²³ï¼Œå‡ºä¹Ÿï¼Œå¤–æ´¾ï¼Œèµ°ä¸‹å¡è·¯ä¹Ÿï¼Œä¸å‡ï¼Œé©¬ã€ç¾Šå‡å®˜ï¼ˆå±è‚–æˆ–æ—¶é—´ï¼Œé•¿å¾—åƒä¹Ÿç®—ï¼‰ã€‚",
 f: "æ²³ä¸­æ— æ°´ï¼Œæ— è´¢ä¹Ÿï¼Œé©¬ã€ç¾Šå¾—è´¢ã€‚",
 g: "ä¸€äººå±±é¡¶ï¼Œå­¤ç‹¬ä¹‹è±¡ï¼Œå©šå§»ä¸æˆï¼Œé€¢é©¬ç¾Šæˆã€‚",
 l: "æœ›è€…ï¼Œæœ‰æœ›ä¹Ÿï¼Œé€¢é©¬ã€ç¾Šé«˜ä¸­ï¼Œè‰å¤´äººï¼Œè‹—ç­‰æœ‰æœ›é«˜ä¸­ã€‚",
 m: "æœ›è€…ï¼Œäº¡ä¹Ÿã€‚é©¬ç¾Šä¸äº¡ã€‚",
 z: "æš‚æ— ",

                             },
        10: {
            n: "å¤©æ³½å±¥",
            t: "ä¸€ã€å¥³äººåœ¨ç¬ ä¸‹ï¼šå¦¾ä¹Ÿã€‚<br>äºŒã€åƒé‡Œå  ï¼šè¿œç¦»å¤–å‡ºå°ä¾¯è±¡ã€‚<br>ä¸‰ã€æ–‡ä¹¦ç ´åœ¨åœ°ï¼šå‡­è¯æ‰¿è¯ºæ— æ•ˆè±¡ã€‚<br>å››ã€ä¼ä¸‹ï¼šæœ‰åº‡è«ä¹Ÿã€‚<br>äº”ã€å†›æ——ä¸‹å®˜äººåï¼šä¸»æœ‰å®˜å¸ã€è¯‰è®¼ã€ç‰¢ç‹±ä¹‹ç¾è±¡ã€‚<br>å…­ã€äºŒç‚¹åœ¨åœ°ï¼šè·µè¸ä¹‹è¶³å°ä¹Ÿï¼Œç¤ºäººå¤„å±ä¹‹æ—¶ï¼Œæœ‰ç¤¼ä¹‹é“ï¼Œä¹ƒèƒ½è¡Œå±è€Œæ— æ®ƒä¹Ÿ",
            x: "å¦‚å±¥è–„å†°ï¼Œè¡Œç¤¼æœ‰åº¦ã€‚å®šæ°‘å¿—ã€‚<br>åˆä¹ï¼šç´ å±¥å¾€ï¼Œæ— å’ã€‚<br>ä¹äºŒï¼šå±¥é“å¦å¦ï¼Œå¹½äººè´ã€‚<br>å…­ä¸‰ï¼šçœ‡èƒ½è§†ï¼Œè·›èƒ½å±¥ï¼Œå±¥è™å°¾ï¼Œå’¥äººå‡¶ï¼Œæ­¦äººçˆ²äºå¤§å›ã€‚<br>ä¹å››ï¼šå±¥è™å°¾ï¼Œæ„¬æ„¬ç»ˆã€‚<br>ä¹äº”ï¼šå¤¬å±¥è´å‰ã€‚<br>ä¸Šä¹ï¼šè§†å±¥è€ƒç¥¥ï¼Œå…¶æ—‹å…ƒã€‚",
            d: gd('W')+"çˆ¶å±…è¥¿ã€‚",
u:"é‡é™©äº‹å´å¾€å¾€è¸¯èº…ä¸å‰ï¼Œæˆå±¥å¦ã€‚ä¸€ã€äº‹ä¸šä¸Šå¸¸æœ‰æ¬²è¿›ä¸å¾—ï¼Œé€€ä¹‹åˆå‡¶ï¼Œå±…è¿›é€€ä¸¤éš¾ä¹‹å±€ï¼Œå…¶äº‹ åŠ¿å¦‚æ­¤ï¼Œè€Œå…¶æ€§äº¦å¦‚æ­¤ï¼Œå…¶è§£å¸¸é å¥³äººå†³å®šä¹‹ã€‚äºŒã€å®˜è¿ä¸é€šï¼Œåœæ»ä¸å‰ã€‚ä¸‰ã€å•†æœºä¸åˆ©ï¼Œè¿æ°”ä¸ä½³ï¼Œå–èˆä¹‹é—´ï¼Œå› æ—¶æœºå·²è¯¯ï¼Œä¸§å¤±è‰¯å¥½ æœºä¼šï¼Œå¾’äºäº‹æ‡Šæ¼è€Œå·²ï¼Œäºäº‹æ— è¡¥ã€‚å››ã€å©šäº‹æ–¹é¢ï¼Œå¦»èƒ½åŠ›è¿‡äºå·±ï¼Œæ•…æœ‰åœ¨å¤–å¨¶å¦¾ä¹‹è¡Œä¸ºï¼Œä»¥æ±‚æ¢ å¤ç”·äººä¹‹è‡ªä¿¡å¿ƒã€è‡ªå°Šå¿ƒï¼Œæ•…äºå©šå§»ä¸»å‡¶ã€‚åŒæ—¶ç”Ÿäººå¦‚å‘½ä¸­å©šå§»ä¸ æ•£åˆ™æ„Ÿæƒ…ç ´è£‚ï¼Œç»ˆè€ŒåŒåºŠå¼‚æ¢¦ï¼Œä½†å¦‚å‘½ä¸­ï¼Œä¸»å©šå§»ç ´è£‚ï¼Œå†åŠ è¿ä¸Š æ­¤å±€ï¼Œåˆ™å¿…ä¸»ç ´æ•£æ— æ•‘ã€‚æ­¤åŒæ—¶ç”Ÿäººä¹‹ä¸åŒå¤„ï¼Œæµå¹´ä¸åŒä¹‹å› ä¹Ÿã€‚",
h: "åº¶å‡ºä¹‹äººå¤©æ³¨å®šã€‚å¯„äººæ——ä¸‹ä¸è‡ªçŸ¥ã€‚æ—©å¹´ç¦»å®¶ï¼Œé‡é‡é˜»éš”ã€‚è¾›è‹¦æˆå®¶ã€‚ç§‘ç”²ä¸å…´ï¼Œæ¡ƒèŠ±å¤šã€‚",
 a: "å¦¾æœ‰é—ªï¼Œäººåç¦»ï¼Œè¿‘å†›ä»¤ã€‚é‡æ¥¼ä¹‹ä¾§ï¼Œæ— åæœ‰é™©ã€‚å©šå§»æœ‰é™©ã€‚å¤«å¦»ç›¸éš”ï¼Œæ€»ä¸ºæƒ…ã€‚å®˜å¸å¤±è´¢ï¼Œç”Ÿæ¨ªäº‹ã€‚çªƒç›—ç«ç¾æ¥ã€‚",
 b: "ç”·å¤–æœ‰å¦¾ï¼Œå¦¾åœ¨ä½•å¤„ï¼Œé‡æ¥¼ä¹‹å†…ã€‚æ­¦å®˜å¤–è°ƒï¼Œè´¢ä¸åˆ©ï¼Œå¥‘çº¦æˆç©ºå©šäº‹å‡¶ã€‚å¤©æœºï¼šç«¹å­ç«‹ä¸‹ï¼Œæ–‡ä¹¦ç ´ã€‚é‡çŒ´ä¹ƒæœ‰åƒé‡Œè¡Œã€‚",
 e: "æ–‡ä¹¦ç ´åœ¨åœ°ï¼Œå®˜äº‹ä¸å‡ï¼Œæœ‰å®˜å¸ã€‚éæ–‡èŒå¤–åœ°å‰ã€‚",
 f: "æ–‡ä¹¦å†åœ°ï¼Œè´¢ä¼šä¸è¿›ã€‚",
 g: "æ–‡ä¹¦åœ¨åœ°ï¼Œå©šäº‹ä¸æˆæˆ–è€…ç¦»å©šã€‚ç«‹å¦¾ï¼Œä»£è¡¨å‡ºè½¨ï¼Œåœ¨é‡æ¥¼ä¹‹å†…ã€‚",
 l: "æ–‡ä¹¦åœ¨åœ°ï¼Œä¸ä¸­ã€‚",
 m: "æ–‡ä¹¦åœ¨åœ°ï¼Œæ˜¯ä¸ºçƒ§çº¸ä¹‹è±¡ï¼Œä¸§è±¡ã€‚",
 z: "æš‚æ— ",

                             },
        11: {
            n: "åœ°å¤©æ³°",
            t: "ä¸€ã€æœˆä¸­æ¡‚å¼€ï¼šæ¸…æ˜æ”¿æ²»ä¹‹æ—¶ã€‚<br>äºŒã€å®˜äººç™»æ¢¯ï¼šå‡è¿é¡ºé‚ä¹‹æ„ï¼Œå®˜äººäº¦å€Œäººï¼Œå³ä¸ˆå¤«ä¹Ÿã€‚<br>ä¸‰ã€é¹¿è¡”ä¹¦ï¼šå—å¤©å­æ©èµç¦„ä½ã€‚<br>å››ã€å°å„¿åœ¨äº‘ä¸­ï¼šå°‘å¹´å¾—å¿—è±¡ã€‚å¾—å¤©å®˜è´µäººåŠ©ä¹Ÿã€‚<br>äº”ã€ç¾Šå›å¤´ï¼šå›é˜³é—´ä¹Ÿã€‚äº¦æ¨å§“äººï¼Œå‘è‚–ç¾Šäººæˆæ ¼ã€‚",
            x: "å¤©åœ°äº¤ï¼Œä¸‡ç‰©é€šã€‚å›å­é“é•¿ã€‚<br>åˆä¹ï¼šæ‹”èŒ…èŒ¹ï¼Œä»¥å…¶æ±‡ï¼Œå¾ã€‚<br>ä¹äºŒï¼šåŒ…è’ï¼Œç”¨å†¯æ²³ï¼Œä¸éé—ï¼Œæœ‹äº¡ï¼Œå¾—å°šäºä¸­è¡Œã€‚<br>ä¹ä¸‰ï¼šæ— å¹³ä¸é™‚ï¼Œæ— å¾€ä¸å¤ï¼Œè‰°è´æ— å’ï¼Œå‹¿æ¤å…¶å­šï¼Œäºé£Ÿæœ‰ç¦ã€‚<br>å…­å››ï¼šç¿©ç¿©ä¸å¯Œï¼Œä»¥å…¶é‚»ï¼Œä¸æˆ’ä»¥å­šã€‚<br>å…­äº”ï¼šå¸ä¹™å½’å¦¹ï¼Œä»¥ç¥‰å…ƒã€‚<br>ä¸Šå…­ï¼šåŸå¤äºéšï¼Œå‹¿ç”¨å¸ˆï¼Œè‡ªé‚‘å‘Šå‘½ï¼Œè´åã€‚",
            d: gd('NW')+"æ¯å±…è¥¿åŒ—ã€‚",
u:"æ­¤åä¸ºæ³°å¦ï¼Œæœ‰å¦ææ³°æ¥ï¼Œå®‰æ³°èˆ’é€‚ä¹‹è±¡ã€‚æ¯é€¢æœ‰å·²å©šå¥³å‘æœ¬ äººæ±‚æ•™ä¹‹æ—¶ï¼Œæˆ‘éƒ½ä»¥æ­¤å¦æ•™ä¹‹ï¼Œä»¤æ”¹ï¼Œä¿ƒè¿›å¤«å¦»å’Œç¦ä¹ƒå¾é“ä¸­äººä¹‹ ä¸€å¤§èŒè´£ï¼Œæ­¤åŠŸå¾·æ— é‡ã€‚æ­¤å±€å¤§å‰ï¼Œæ— è®ºäºå©šå§»ã€äº‹ä¸šã€å¥åº·åŠæ•™è‚²å­å¥³ä¸Šï¼Œéƒ½æœ‰å“è¶Š ä¹‹è¡¨ç°ï¼Œä¸ºä¸€è´¤å¦»è‰¯æ¯ã€‚ä¸€ã€äºå©šå§»ï¼Œä¸»ä¸€ä¸–å¤«å¦»ï¼Œç™½é¦–åˆ°è€ã€‚äºŒã€äºäº‹ä¸šï¼Œåœ¨å®¶ç›¸å¤«æ•™å­äº¦ä¸ºäº‹ä¸šã€‚åœ¨å…¬äº‹ä¸Šï¼Œè¿›é€€æœ‰æ®ï¼Œ å—äººé‡ç”¨ï¼Œå¿…ä¸å¾…è¨€ï¼Œå…¶å¿ƒæƒ³äº‹æˆã€‚ä¸‰ã€äºå¥åº·ä¸»å¹³å®‰åˆ°è€ï¼Œä¸€ç”Ÿæ— å¤§ç—…ç—›ï¼Œå‡¡æœªç»æŒ‡ç‚¹ï¼Œèƒ½å¾—æ­¤ å±€ä¹‹äººï¼Œå¿…å±å¤§å¯Œå¤§è´µä¹‹äººï¼Œç¦åšä¹‹äººï¼Œä¸€ç”Ÿæ— ç¾ï¼Œå¸¸è§å‘½æ ¼å¥½ä¹‹ äººï¼Œè‡ªç„¶å±…ä¹‹ï¼ŒçœŸæ‰€è°“ã€Œç¦åœ°ç¦äººå±…ã€å®ä¸ä¸ºè¿‡ã€‚å®åŠ¡ä¸Šï¼Œå¾äººå¯ è§å‘½è–„ä¹‹äººï¼Œä¸ä½†æ— æ³•å±…æ­¤ï¼Œå³ä½¿ä½ å‘Šè¯‰å¥¹æœ‰å¦‚æ­¤å¥½ï¼Œè€Œå¥¹äº¦ä¼šå›  å¤–åœ¨ç¯å¢ƒä¸Šä¹‹æŸç¼šï¼Œè€Œæ— æ³•æ”¹å˜è‡ªå·±ï¼Œä¸çŸ¥äººä¸å¤©äº‰ï¼Œå³åœ¨æ­¤ï¼Œç¥¸ ç¦åœ¨ä¸€å¿µä¹‹é—´è€³ã€‚å”¯è‡ªæ±‚å¤šç¦ï¼Œä½†å¸Œæœ›ä½ çœŸèƒ½è‡ªæ±‚è€Œç”Ÿå¤šç¦ï¼Œä½†é¡» çŸ¥ä¸–äº‹å¸¸ä¸å°½äººæ„ï¼Œå¦‚èƒ½åˆ»æ„æˆå±€ä¹‹äººä¹ƒå±æœ‰ç¦ä¹‹äººï¼Œå…¶åˆšæŸ”åŠ¨é™ä¹‹é—´ï¼Œå¿…èƒ½æŒæ¡æœºå…ˆï¼Œäº‹äº‹å¿«äººä¸€æ­¥ï¼Œç»ˆå¿…å¤§æˆã€‚",
h: "çˆ¶ç™»é’äº‘ä½ï¼Œç”Ÿåœ¨æ¸…è´µå®¶ã€‚ç¦„å‘½æ¥ã€‚å°‘å¹´å¾—å¿—ã€‚é‡é˜³å›é˜³ã€‚å¤©æœºï¼šç¾Šæ¨æœ‰æ¡‚ï¼Œå—é«˜ä»»å‘½ã€‚ä¸­å¹´ä»¥åï¼Œç¦„å‘½è‡ªä¹é‡æ¥ã€‚",
 a: "æ¡ƒææ»¡å¤©ä¸‹ï¼Œæ¸…èª‰è´µäººé¦™ï¼Œå®˜äººå®ˆç¦„å‘½ã€‚å®˜äººå¹³ç™»é’äº‘å¿—ã€‚æœ‰å­åœ¨è¿œæ–¹ï¼Œé€¢ç¾Šæ¨æ–¹å›ã€‚å­å¤§è´µã€‚",
 b: "å®˜è¿äº¨é€šã€‚å¹³æ­¥é’äº‘å˜›ã€‚æµå¹´ç”Ÿç—…ï¼Œç–¾å„å›é˜³ã€‚æ±‚è´¢åšç”Ÿæ„ï¼Œç¦„è´¢ä¸°ç››ã€‚å¤©æœºï¼šè¿›äºŒæ˜¥å‰ã€‚æ˜¥æ—¶è¿›äºŒã€‚ç”·å¸¦æ¡ƒèŠ±ï¼Œå©šäº‹å¿…æˆã€‚",
 e: "é¹¿è¡”ä¹¦ï¼Œä»»å‘½åˆ°ï¼Œå‡ã€‚",
 f: "é¹¿è¡”ä¹¦ï¼Œå¤§åˆ©è‡³ã€‚",
 g: "é¹¿è¡”ä¹¦ï¼Œå©šä¹¦åˆ°ï¼Œå¯æˆï¼Œå¤©å®˜èµç¦ï¼Œå‰ã€‚",
 l: "æœˆä¸­æ¡‚å¼€ï¼Œé«˜ä¸­ã€‚",
 m: "ç¾Šå›å¤´ï¼Œå›ç¾Šï¼Œå›é˜³æ˜¯ä¹Ÿã€‚å†é‡çš„ç—…éƒ½æœ‰å¸Œæœ›æ•‘å›æ¥ã€‚",
 z: "æš‚æ— ",

                             },
        12: {
            n: "å¤©åœ°å¦",
            t: "ä¸€ã€ç”·å­å§ç—…ï¼šç”·å­ä¸ºé˜³ï¼Œé˜³åŒä½¯ï¼Œè£…ç—…ä¹‹è±¡ä¹Ÿã€‚<br>äºŒã€é•œç ´ï¼šä¸å¯èµ´ä¹Ÿã€‚ç ´é•œéš¾åœ†ä¹‹è±¡ã€‚<br>ä¸‰ã€äººè·¯ä¸Šåï¼šå°äººé˜»è·¯ï¼Œä¸è®©è¿›ä¹Ÿã€‚<br>å››ã€å¼ å¼“ç®­å¤´è½åœ°ï¼šé¸Ÿå°½å¼“è—ä¹Ÿã€‚<br>äº”ã€äººæ‹æŒç¬‘ï¼šå¹¸ç¾ä¹ç¥¸ä¹‹å°äººï¼Œåšå‡æ”»è®¦ä¸¤äººæ„Ÿæƒ…å¾—é€çŠ¶ï¼Œå¤«å¦»å‡¶ã€‚<br>å…­ã€èˆŒï¼šä¸»å£èˆŒï¼Œå®˜å¸ï¼Œè¬¡è¨€ç”Ÿå®³ã€‚<br>ä¸ƒã€å£ä¸Šæœ‰å››ç‚¹ï¼šå››ç‚¹ä¸ºé»‘ï¼Œæš—ä¸­è¯¬é™·ä¹‹è¬¡è¨€ï¼Œå¤äººè°“ä¸‰å£æˆè™ï¼Œå³æ„æ­¤ã€‚",
            x: "å¤©åœ°ä¸äº¤ï¼Œé—­å¡ã€‚å°äººé“é•¿ã€‚<br>åˆå…­ï¼šæ‹”èŒ…å¦‚ï¼Œä»¥å…¶æ±‡ï¼Œè´ï¼Œäº¨ã€‚<br>å…­äºŒï¼šåŒ…æ‰¿ï¼Œå°äººï¼Œå¤§äººå¦ï¼Œäº¨ã€‚<br>å…­ä¸‰ï¼šåŒ…ç¾ã€‚<br>ä¹å››ï¼šæœ‰å‘½ï¼Œæ— å’ï¼Œç•´ç¦»ç¥‰ã€‚<br>ä¹äº”ï¼šä¼‘å¦ï¼Œå¤§äººï¼Œå…¶äº¡ï¼Œå…¶äº¡ï¼Œç¹‹äºè‹æ¡‘ã€‚<br>ä¸Šä¹ï¼šå€¾å¦ï¼Œå…ˆå¦åå–œã€‚",
            d: gd('SW')+"çˆ¶å±…è¥¿å—ã€‚",
u:"æƒŸç”·äººæœ‰ä¹‹ï¼Œæ­¤ç”·å¥³æœ¬æ€§ä¹‹ä¸åŒï¼Œäº¦å¯äºæ­¤å¦å±€çª¥è§ä¹‹ï¼Œç”·äºº ä¹‹æ€§è¿‡åˆšäºå¥³ï¼Œè‡ªå°Šå¥½å¼ºä¹‹å¿ƒï¼Œåˆæ˜¾ç°æ— é—ï¼Œå¾€å¾€å¤©æ€§ä¸Šï¼Œæœ‰æ¬²å¤§ åŠ›å°ä¹‹æ€§è€Œä¸è‡ªçŸ¥ï¼Œä¸çŸ¥å·±ä¹‹æ‰èƒ½å¦‚ä½•ï¼Œå¦„åº¦ä¸çŸ¥é‡è¿›ï¼Œä¹ƒç»ˆæˆå¦ å¦ã€‚å¸¸è§ä¸ªæ€§å¦‚æ­¤ä¹‹äººå±…å¦å±€ï¼Œè€Œä¸è‡ªçŸ¥ï¼Œä»è‡ªä»¥ä¸ºæ˜¯ï¼Œæ•…ç»ˆå…¶ä¸€ ç”Ÿå¿…æ— æˆå°±ï¼Œæ¯æ—¥åªçŸ¥æ€¨å¤©å°¤äººï¼Œå¹æ—¶ä¸åˆ©å·±ï¼Œå·±ä¸é€¢æ—¶è€Œå·²ã€‚ä¸€ã€äºå©šäº‹ä¸»å¤§å‡¶ï¼Œå¤«å¦»åç›®æˆä»‡ï¼ŒåŠ ä¸Šå‘½æ ¼ä¸­å¦‚å©šç ´ï¼Œåˆåœ¨ è¿å®…ä¸Šå±…æ­¤å±€ï¼Œåˆ™åŠ¿å¿…æ— æ³•æŒ½å›ã€‚äºŒã€å®˜å®¶ä¹‹äººï¼Œå¿…ä¸»å¦å¡ä¸é€šï¼Œç»ˆè‡´æ— æˆï¼Œä¸ä½†ä¸å‡å®˜ï¼Œåæ‹› å‡¶ç¥¸ï¼Œä¹ƒè‡´é€€ä¼‘ã€‚ä¸‰ã€å•†å®¶äººï¼Œå±…æ­¤å±€ï¼Œå¿…ç”Ÿå¤§è€—ï¼Œè´¢è€—å®¶æ•£ï¼Œç»ˆè‡´ä¸€è´¥æ¶‚åœ°ã€‚ å››ã€å¥åº·ä¸Šäº¦å‡¶ï¼Œä¸»å¤§ç—…ç¼ èº«ï¼Œå¦‚åŠ ä¸Šå‘½ä¸­æµå¹´é€¢ç¾Šåˆƒï¼Œè¡€å…‰å¿…ç°ï¼Œåœ¨æ•°ä¸­éš¾é€ƒæ­¤å¤§é™ä¹‹å±€ã€‚",
h: "ä¸­å¹´å‰è¿å¤šé˜»æ¡¡ï¼Œå°‘å¹´å®¶è¿è´¢ç¦„ç ´ï¼Œçˆ¶æ¯ç›¸åˆ‘ä¸å¾€æ¥ï¼Œé•¿å¼“ï¼ˆå¦‚å¼ ï¼‰å‘äºŒæœªä¸­ã€‚æ˜ä¸­æœ‰æŸã€‚å¯»å¸¸äº‹æ— é˜»ï¼Œå´æ¯é€¢è¦äº‹å¿…å€’éœ‰ï¼Œæ»¡è…¹ç»çº¶ç„¶ç§‘ç”²ä¸ä¸­ã€‚ä¸å…¥è¡™é—¨å–åœäººã€‚",
 a: "è´¢ç ´äººä½¯ç—…ã€‚è¿ç»­å£èˆŒæ¥ã€‚ä¸ä»ç”Ÿæ„äººï¼Œå†…ç§å¿ƒè™šæ— äººçŸ¥ã€‚æœºå†…è¯¬é™·æ€»ä¸æˆï¼Œå”¯æœ‰é’ç¯ï¼ˆå‡ºå®¶ï¼‰ä¼´åˆ°è€ã€‚",
 b: "å®˜å¸ï¼Œæš—å®³ã€å£èˆŒï¼Œè´¢ç ´æ‹†ä¼™ã€‚å©šå§»ç ´è£‚ã€‚é•¿å¼“ç«é‡‘ä¸ä¸­ï¼Œäº‰è´¢ä¸ä¸­ä¸”ç ´ã€‚é˜²äººæš—å®³ã€‚å¤©æœºï¼šäºŒæˆˆä¸€è´è‡ªå¯»çƒ¦æ¼ã€‚å¯¸è¨€ç«‹èº«é€¢å¼ è½åœ°ï¼ˆäºŒæˆˆä¸€è´é‡é•¿å¼“ä¹°å•ã€‚å¦‚å§“è°¢äººè€ƒè¯•ï¼Œä¸»è€ƒå®˜å§“å¼ ï¼Œåˆ™ä¹°å•ï¼‰ã€‚å ‚ä¸Šï¼ˆåœ¨è¿‘å¤„ï¼‰æ‹¿äººã€‚",
 e: "äººè·¯ä¸Šåï¼Œå°äººå½“é“ï¼Œå®˜ä¸å‡ä¹Ÿï¼Œå£èˆŒï¼Œå®˜å¸ç¼ èº«ä¹Ÿã€‚",
 f: "é•œç ´ï¼Œç«äº‰ä¸åˆ©ä¹Ÿã€‚åšç”Ÿæ„æ‹¿åˆ°å¤©åœ°å¦ç»å¯¹ä¸èƒ½åšï¼Œç»å¯¹ä¼šå¤§è´¥è€Œå½’ï¼Œè€—å°½å®¶è´¢ã€‚",
 g: "äººæ‹æŒç¬‘ï¼Œå¼ å·¥è½åœ°ï¼Œè¢«äººæš—ç®—ï¼Œå£èˆŒï¼Œå®˜å¸æ˜¯éï¼Œä¸æˆã€‚",
 l: "å¼ å¼“è½åœ°ï¼Œä¸æˆã€‚",
 m: "ç”·å­ä¸ºé˜³ï¼Œé˜³ç—…ï¼Œæ´‹è£…ç—…ä¹Ÿï¼Œæˆ–è€…æ˜¯å¿ƒè¡€ç®¡æ–°å† ç­‰é˜³ç—…ã€‚",
 z: "æš‚æ— ",

                             },
        13: {
            n: "å¤©ç«åŒäºº",
            t: "ä¸€ã€äººæ§æ–‡ä¹¦ä¸Šæœ‰å¿ƒå­—ï¼šå¾—æ°‘å¿ƒä¹‹è±¡ï¼ŒåŒå¿ƒååŠ›ä¹‹è±¡ã€‚å®å§“ã€‚<br>äºŒã€äººå¼ å¼“å°„å±±ä¸Šï¼šé«˜ä¸­é‡‘æ¦œã€‚å¼ å§“äººæ°ã€‚<br>ä¸‰ã€ä¸€é¹¿é¥®æ°´ï¼šè´¢ç¦„æ»šæ»šè€Œæ¥ã€‚äº¦åœ¨é‡ä¹‹è´¤äººã€‚<br>å››ã€ä¸€æºªï¼šå¹³å’Œå®‰é™çŠ¶ã€‚<br>äº”ã€é¹¿ä¹‹æ€§ï¼ŒåŠ¨åˆ™æ•ï¼Œé™åˆ™é¡ºï¼Œæ­¤åˆšå¥äººä¹‹æ€§ï¼Œä¸–é—´ä½†é—»è™é£Ÿäººï¼Œæœªé—»é¹¿é£Ÿäººã€‚",
            x: "ä¸Šä¸‹åŒå¿ƒï¼Œåˆ©æ¶‰å¤§å·ã€‚ç±»æ—è¾¨ç‰©ã€‚<br>åˆä¹ï¼šåŒäººäºé—¨ï¼Œæ— å’ã€‚<br>å…­äºŒï¼šåŒäººäºå®—ï¼Œåï¼<br>ä¹ä¸‰ï¼šä¼æˆäºè½ï¼Œå‡å…¶é«˜é™µï¼Œä¸‰å²ä¸å…´ã€‚<br>ä¹å››ï¼šä¹˜å…¶å¢‰ï¼Œå¼—å…‹æ”»ï¼Œã€‚<br>ä¹äº”ï¼šåŒäººï¼Œå…ˆå·å’·è€Œåç¬‘ï¼Œå¤§å¸ˆå…‹ç›¸é‡ã€‚<br>ä¸Šä¹ï¼šåŒäººäºéƒŠï¼Œæ— æ‚”ã€‚",
            d: gd('S')+"çˆ¶å±…å—ã€‚",
u:"æ­¤å±€åœ¨é˜³å®…ä¸Šäº¦å¦™ä¸å¯è¨€ï¼Œå­¦è€…åˆ‡å‹¿åˆ†è¾¨é”™è¯¯ï¼Œé¡»ä»”ç»†åˆ†è¯¦ï¼Œ ä»¥å…è¯¯äººè€Œä¸è‡ªçŸ¥ã€‚ä¸€ã€å®˜å®¶äººé€¢ä¹‹ï¼Œå¿…ä¸»äººå’Œï¼Œæ‰‹ä¸‹å¾—åŠ›ï¼Œç¦„å‘½ä¹é‡æ¥ï¼Œå¹³æ­¥é’äº‘ã€‚äºŒã€å•†äººé€¢ä¹‹ï¼Œè´¢ç¦„ä¸°ç››ï¼Œä½†é¡»äºŒäººåˆä¼™ï¼Œæ–¹å¯æˆäº‹ï¼Œä¸€äººç‹¬ èµ„åŠ¿å¿…ä¸æˆå¤§å™¨ã€‚ä¸‰ã€è‡ªç”±ä¸šã€æœåŠ¡ä¸šå±…æ­¤å±€ï¼Œå¿…ä¸»åæ°”å¤§ï¼Œå£°åè¿œæ’­ï¼Œè´¢ç¦„äº¨é€šã€‚å››ã€å¯¹å¦»ä¸åˆ©ï¼Œå› æ­¤å±€å‡ºç°ï¼Œå¦»å¿…æˆæ˜å¤·å¦ï¼Œä¸»å¦»æœ‰æš—ä¼¤ï¼Œè¡€ å…‰éš¾é€ƒï¼Œæ•…ä¸å¦‚å¹²ä¸ºå¤©ï¼Œåœ°å¤©æ³°å‰ï¼Œå³åœ¨æ­¤ï¼Œä¸åˆ©å¦»ä¹‹å¤„ã€‚å¾äººå¸¸è§å¤«å¦»ä¸€å¯¹ï¼Œå¤«ä¹‹äº‹ä¸šå¦‚æ—¥ä¸­å¤©ï¼Œè€Œå¦»å­å´ç—…ç¾ä¸æ–­å¿…ä¸ºæ­¤å±€ä¹‹é˜³å®…ä¹Ÿã€‚",
h: "ç”Ÿæ—¶å¸¦è´¢äººç§°ç¾¡ï¼Œæ–‡æ­¦åŒå…¨å—å°è¯°ã€‚åç™»é‡‘æ¦œï¼Œé•¿å¼“å®ï¼Œç¬¬ä¸‰å„¿æˆæ ¼ï¼Œä¸æ’ç¬¬ä¸‰ä½™å‡ä¸€åŠã€‚",
 a: "æ–‡ä»æ­¦ï¼Œæ­¦ä»æ–‡ã€‚æ–‡æ­¦åŒå…¨ï¼Œå‡ºå°†å…¥ç›¸ã€‚ååˆ©åŒæ”¶ã€‚å¿ƒæƒ³äº‹æˆã€‚å‘äºé»„ç”²ï¼Œå‘½ä¸­å››å­ï¼Œä¸‰å­é€ç»ˆã€‚",
 b: "é‡‘æ¦œç™»ç§‘ã€‚ä¸€æœæ‰¬åï¼Œå››æµ·åŒå¿ƒã€‚éœ€ä¸“å¿ƒï¼Œä¸”åšæŒåˆ°ç»ˆå¿…æˆã€‚å†¬åŠ ä¸€å–œã€‚",
 e: "æ–‡æ­¦åŒå…¨ï¼Œæ–‡æ­¦çš†å‡ã€‚æ–‡ä¹¦æœ‰å­—ä¸ºå¿ƒï¼Œä»£è¡¨å¾—æ°‘å¿ƒä¹‹å®˜ï¼Œäººå¤§ï¼Œæ”¿åï¼Œåä¼šæ›´ä½³ã€‚",
 f: "ä¸€é¹¿é¥®æ°´ï¼Œè´¢ç¦„æ»šæ»šè€Œæ¥ã€‚",
 g: "ä¸€äººæ§ä¹¦ï¼Œå©šä¹¦ä¹Ÿï¼Œå¯å©šï¼Œå¦‚æµ‹ç®—ç»“å©šä¹‹åå¦‚ä½•ï¼Œæ­¤ä¸ºå®˜ç¦„çš†å¾—ï¼Œå¤«å¦»æ©çˆ±ä¹‹è±¡ã€‚",
 l: "ä¸€äººé«˜å°„å±±ä¸Šï¼Œé«˜ä¸­ã€‚",
 m: "å®é™ä¹‹è±¡ï¼Œé™å…»ä¹‹è±¡ã€‚",
 z: "æš‚æ— ",

                             },
        14: {
            n: "ç«å¤©å¤§æœ‰",
            t: "ä¸€ã€å¦‡äººè…¹ä¸­ä¸€é“æ°”ï¼šå¦Šå¨ ä¹‹äº‹ï¼›äº‹èŒäºå†…ä¹Ÿã€‚<br>äºŒã€æ°”ä¸­äºŒå­ï¼šä¸»åŒå–œä¸´æ–—ã€‚ä¼¯ä»²ä¹‹é—´è±¡ã€‚<br>ä¸‰ã€ä¸€è¯ç‹ï¼šå¹³å®‰ä¹‹è±¡ã€‚å¾—ç—…æœ‰æ•‘ï¼Œé‡è‰¯åŒ»ä¹Ÿã€‚<br>å››ã€è¯æœ‰å…‰ï¼šè¯æœ‰åä¹Ÿï¼Œç¾ä¸­æœ‰æ•‘ä¹Ÿã€‚<br>äº”ã€å¥³äººå—è¯ï¼šå¥³äººä¸ºé˜´ï¼Œç¤ºè¡¨é¢ä¸ä¿¡ï¼Œä½†æš—ä¸­ä»å¬ä¹‹ã€‚<br>å…­ã€ä¸€çŠ¬ï¼šä¹ƒç‹—å¹´ï¼ŒæˆŒæœˆï¼ŒæˆŒæ—¥ï¼Œæ­¤è®ºæ—¶æœºä¹Ÿï¼›æˆ–ç‹„å§“äººå£«ã€‚<br>ä¸ƒã€çŠ¬ï¼šå“­ç¬‘çš†æœ‰è±¡ã€‚",
            x: "é¡ºå¤©ä¼‘å‘½ï¼Œå¯Œç”²å¤©ä¸‹ã€‚éæ¶æ‰¬å–„ã€‚<br>åˆä¹ï¼šæ— äº¤å®³ï¼ŒåŒªå’ï¼Œè‰°åˆ™æ— å’ã€‚<br>ä¹äºŒï¼šå¤§è½¦ä»¥è½½ï¼Œæœ‰æ”¸å¾€ï¼Œæ— å’ã€‚<br>ä¹ä¸‰ï¼šå…¬ç”¨äº¨äºå¤©å­ï¼Œå°äººå¼—å…‹ã€‚<br>ä¹å››ï¼šåŒªå…¶å½­ï¼Œæ— å’ã€‚<br>å…­äº”ï¼šå¥å­šäº¤å¦‚ï¼Œå¨å¦‚ï¼Œã€‚<br>ä¸Šä¹ï¼šè‡ªå¤©ç¥ä¹‹ï¼Œï¼Œæ— ä¸åˆ©ã€‚",
            d: gd('NW')+"æ¬¡å¥³å±…è¥¿åŒ—ã€‚",
u:"å¾äººå¸¸è§æœ‰æœªå©šä¹‹å¥³ï¼Œå¨‡ç¾å¦‚èŠ±ï¼Œäº‹ä¸šä¸ŠåŠŸæˆåå°±ï¼Œä½†å©šå§»ä¸ å¥½ï¼Œå³æ­¤å±€ä¹‹äººã€‚ä¸€ã€æ€§é˜³åˆšè¿‡äººï¼Œå€”å¼ºå›ºæ‰§æœ¬æ€§å±•ç°æ— é—ã€‚äºŒã€ä¸é‡è§†å©šå§»ï¼Œä¹Ÿä¸åœ¨ä¹å©šå§»ï¼Œå”¯å¯¹å­å¥³ç‹¬æœ‰æ‰€é’Ÿï¼Œæœ‰æœªå©š ç”Ÿå­ä¹‹è±¡ï¼Œä¸”ä¸åœ¨ä¹äººè¨€ï¼Œä¸”ä¸»å¾—äºŒå­ã€‚ä¸‰ã€å¦‚é‡å‘½ä¸­å©šå§»é¡ºç•…ï¼Œåˆ™æ¯”åŒæ—¶ç”Ÿäººè¦æ—©ä¸‰å¹´æˆå©šã€‚å››ã€å‘½ä¸­äº‹ä¸šæ—ºï¼Œç¥–ä¸šå¤§ä¹‹äººï¼Œå†åŠ ä¸Šæ­¤å±€ï¼ŒåŠ¿å¿…ä¸ºå¥³æ‰¿çˆ¶ä¸š ä¹‹è±¡ï¼Œå…„å¼Ÿæ— åŠ›ã€‚è‚–çŠ¬ä¹‹å°å§å±…æ­¤å±€åä¹‹ï¼Œå¿…ä¸»å¤§å‰å¤§åˆ©ï¼Œæ™ºæ…§é«˜ï¼Œå©šäº‹å‰ï¼Œäº‹ ä¸šé¡ºåˆ©ï¼Œå©šåæœ‰äºŒå­åŒç”Ÿä¹‹è±¡ã€‚",
h: "æ•°ä¸­å…„å¼ŸäºŒäººï¼Œè°‹ç•¥è¿‡äººç”Ÿå³å¯Œï¼Œç‹—äººé€¢ä¹‹å¿…åŠ å‰ã€‚ç”·æ‹›è´µå¦»ï¼Œå¥³æ‹›è´µå¤«ã€‚åç‹„è‚–çŠ¬æ˜¯çœŸå½¢ï¼Œå¯å»ºç«‹ä¸ä¸–ä¹‹åŠŸã€‚",
 a: "åŒ»æ˜Ÿé«˜ç…§ï¼Œæ‚¬å£¶å¾—å‘½ã€‚å‘åŒ»ç”Ÿã€‚è¯æµä¼—ç”Ÿã€‚åŒäººä¸€å„¿ï¼ŒçŠ¬åœ¨ä¾§ã€‚å¦‚åŒäººå¾ã€‚è¯¸äº‹é¡ºé‚ã€‚å½“å¾—åŠå­ã€‚è‰¯é©¬é€¢ä¼¯ä¹ï¼Œå®ç‰æœ‰å…‰å½©ã€‚",
 b: "åŒ»æ˜Ÿå…¥å‘½ï¼Œå£°åè¿œæ’­ã€‚æœ‰å–œä¸”æ˜¯åŒå–œï¼Œç”Ÿå­ã€‚åˆé€¢ç‹—ï¼ˆå¹´ã€äººã€äº‹ï¼‰ï¼Œæ›´åŠ å‰ã€‚é—®é¼å¤©ä¸‹ã€‚",
 e: "å¦‡äººä¸€æ°”ç”ŸäºŒå­ï¼ŒåŒå–œä¸´é—¨ï¼Œå°¤åˆ©åŒ»è¯ã€‚",
 f: "å¦‡äººä¸€æ°”ç”ŸäºŒå­ï¼Œå‰ï¼Œå°¤åˆ©åŒ»è¯ã€‚",
 g: "å¦‡äººä¸€æ°”ç”ŸäºŒå­ï¼Œå¯æˆã€‚",
 l: "å¦‡äººä¸€æ°”ç”ŸäºŒå­ï¼Œé«˜ä¸­ã€‚",
 m: "å¦‡äººä¸€æ°”ç”ŸäºŒå­ï¼Œä¸€è¯ç‹ï¼Œå¦‡ä¸ºé˜´ï¼Œè¡¨é¢ä¸ä¿¡ï¼Œä»æ—§æœè¯ã€‚è¯ç‹ï¼ŒåŒ»æœ¯é«˜è¶…ä¹‹äººï¼Œæœ‰æ•‘ã€‚",
 z: "æš‚æ— ",

                             },
        15: {
            n: "åœ°å±±è°¦",
            t: "ä¸€ã€æœˆå½“å¤©ï¼šæ¸…æ˜ä¹‹æ”¿ï¼Œä¸­ç§‹æ—¶ä¹Ÿã€‚<br>äºŒã€ä¸€äººéª‘é¹¿ï¼šæ‰ç¦„ä¿±å¤‡ã€‚<br>ä¸‰ã€ä¸‰äººè„šä¸‹ä¹±ä¸ï¼Œéšäºå±±åï¼šå°äººä¸æ•¢æ­£é¢ç¤ºäººï¼ŒæƒŸéšå±±è°¦ä¹‹å(å³å¤–é¥°è°¦ä¸ºå¹Œå­)å®åˆ™ä¹±å¦‚éº»ï¼Œè®¡æ— æ‰€å‡ºã€‚<br>å››ã€è´µäººæ§é•œï¼šæ˜é•œé«˜æ‚¬ï¼Œæ‰§æ³•å…¬æ­£å…‰å¤§ã€‚",
            x: "è°¦å—ç›Šï¼Œæ»¡æ‹›æŸã€‚è£’å¤šç›Šå¯¡ã€‚<br>åˆå…­ï¼šè°¦è°¦å›å­ï¼Œç”¨æ¶‰å¤§å·ï¼Œã€‚<br>å…­äºŒï¼šå‘œè°¦ï¼Œè´ã€‚<br>ä¹ä¸‰ï¼šåŠ³è°¦ï¼Œå›å­æœ‰ç»ˆï¼Œã€‚<br>å…­å››ï¼šæ— ä¸åˆ©ï¼Œæ’è°¦ã€‚<br>å…­äº”ï¼šä¸å¯Œä»¥å…¶é‚»ï¼Œåˆ©ç”¨ä¾µä¼ï¼Œæ— ä¸åˆ©ã€‚<br>ä¸Šå…­ï¼šé¸£è°¦ï¼Œåˆ©ç”¨è¡Œå¸ˆï¼Œå¾é‚‘å›½ã€‚",
            d: gd('NE')+"æ¯å±…ä¸œåŒ—ã€‚",
u:"è°¦å¦ä¹ä¸‰çˆ»ä½ï¼ŒåŠ³è°¦ï¼Œå›å­æœ‰ç»ˆï¼Œæœ‰åŠ³è°¦ä¹‹ç¾ã€‚å²ä¸Šå¦‚å‘¨å…¬ï¼Œ ä¸ºå…¶ä»£è¡¨ã€‚å¸¸è§å¦‡äººï¼Œä»»åŠ³ä»»æ€¨ï¼Œå±…æ— æ‰€è‹¦ï¼Œè°¦ä»¥è®©äººï¼Œå¦‡ä¹‹è´¤ å¾·ï¼Œè¡¨ç°æ— é—ï¼Œä¸”å§‹ç»ˆä¸å˜ï¼Œå³æ­¤å¦å±€èƒ½æˆã€‚ä¸€ã€å¿…ä¸ºè´¤å¦»è‰¯æ¯ä¹‹äººæ— ç–‘ï¼Œä½†å¤«å¦ä¸ºé¯ï¼Œä¸»å¤«å¦»ä¸åˆ©ï¼Œæ„Ÿæƒ… é€€åŒ–ï¼Œæ‰€ä»¥å¸¸è§æœ‰è´¤å¾·ä¹‹å¦‡äººï¼Œå¾€å¾€å°½å¿ƒå°½åŠ›ä¸ºå®¶æ“å¿ƒï¼Œç»“æœå´æ—  æ³•æŒ½å›å©šå§»ä¹‹å–„ï¼Œä½†å…­åäº”å²ä»¥åä¸æˆæ­¤å±€ã€‚äºŒã€èº«ä½“å°ç—…ç—›ä¸æ–­ï¼Œå› åŠ³æˆç–¾å¤šæœ‰ã€‚ä¸‰ã€å®˜å®¶äººé€¢ä¹‹ï¼Œä¸»é‡äº‹å…¬å¹³å¤„ä¹‹ï¼Œä¸€ä¸ä¸èŒä¹‹äººã€‚å››ã€å•†å®¶äººå¾—æ­¤å±€ï¼Œå¿…ç”Ÿè´¢ç¦„ï¼Œä½†å¾€å¾€æœ‰è‚¡ä¸œä¸åˆï¼Œå› åˆ†åˆ©ä¸ å‡è€Œç ´åã€‚äº”ã€åŒæ—¶ç”Ÿäººï¼Œåˆ™æœ‰å®˜å¸¦ç°ï¼Œå¦‚å‘½ä¸ºå…¬èŒäººï¼Œä½†å±…è°¦å¦å±€ï¼Œæœ‰ æ°‘é€‰å®˜ä¹‹å€¾å‘ï¼Œå•†å®¶äººäº¦æœ‰æ­¤å€¾å‘ï¼Œä¼šå±…å›½ä¼šæ®¿å ‚ä¹‹ä¸­ã€‚",
h: "æ™ºæ˜å¦‚æœˆï¼Œæ‰å¾·å…¼å¤‡ã€‚å¤©æœºï¼šä¼—äººå¿ƒä¹±ï¼Œæ— æ‰€é€‚ä»ã€‚è°¦å—ç›Šï¼Œæ»¡æ‹›æŸã€‚å‡ºåˆ™å‡¶ã€‚å‡ºäº‹å‡ºå±±ï¼Œæ‹›å‡¶ã€‚å—ä¸–äººè¯¬ä¹±ã€‚æ½œè—è¿›ä¿®ï¼Œå‰ã€‚çœ‹å°½äººé—´ç™¾æ€ã€‚ç‹¬æ¥ç‹¬å¾€ã€‚é©¬æœ€å¥‡ã€‚",
 a: "å›å­ä¸´æœï¼Œå°äººé€€éšã€‚ä¸ºå®˜å…¬æ­£ï¼Œé€¢é©¬æœ€å¥‡ã€‚ç¦„ä¸”æ˜ã€‚",
 b: "å‹¾é™ˆæœ‰çªƒç¾ï¼Œä¸‰äººæˆè¡Œï¼Œè´µäººä¸ºå®˜ã€‚æ˜æœˆå½“å¤©ã€‚æœ‰ç¦„è‡³ï¼Œä¸å®ˆï¼Œè´¢è¿›è´¢å‡ºã€‚äº‹åå®˜å¸ç»ˆæœ‰å·¢ã€‚",
 e: "å®˜äººéª‘é¹¿ï¼Œå…¬å­—é«˜æ‚¬ï¼Œæ‰‹æ§æ˜é•œï¼Œå¤„äº‹å…¬é“ï¼Œå‡å®˜ä¸€æ–¹ä¹‹è±¡ï¼Œè¿™ç§äººå½“å®˜æœ€åï¼Œä¾‹å¦‚é©¬å¥‡ã€‚",
 f: "ä¸€é¹¿åœ¨åœ°ï¼Œè´¢ç¦„è¿›ä¹Ÿï¼Œå°äººåœ¨æ—ï¼Œæˆ–æœ‰åŠ³ç´¯ä¹‹è±¡ã€‚",
 g: "æ‰‹æ§æ˜é•œï¼Œæœˆå½“å¤©ï¼Œæœ‰å…‰æ˜ä¹Ÿï¼Œäº‹å¯æˆä¹Ÿï¼Œéœ€ç¤¼é‡å¤„å…¬ï¼Œè¡Œæ­£å¤§å…‰æ˜ä¹‹é“å‰ã€‚",
 l: "å…¬å­—ä¸Šé•œï¼Œç«å¾—å…¬ä¹Ÿï¼Œå¤§åˆ©ç«äº‰æ€§è€ƒè¯•ã€‚",
 m: "ç‹¬è¡Œï¼Œå°äººåœ¨åï¼Œä¸€å †ç»³ç´¢ï¼Œç”šé˜²åŠ³ç´¯è‡´ç—…ã€‚",
 z: "æš‚æ— ",

                             },
        16: {
            n: "é›·åœ°è±«",
            t: "ä¸€ã€ä¸¤é‡å±±ï¼šå‡ºè±¡ï¼Œåƒé‡Œé˜»éš”ä¹Ÿã€‚<br>äºŒã€å®˜äººåœ¨ä¸­ï¼šå¤–å‡ºä¸ä»»å®˜è±¡ï¼›ä¸ˆå¤«å¤–å‡ºä»å•†ã€‚<br>ä¸‰ã€ä¸€ç¦„ä¸€é©¬ï¼šä»å•†ä¹‹äººï¼Œè´¢ç¦„ä¸°ç››ã€‚<br>å››ã€é‡‘é“¶æ•°é”­ï¼šçº¸é’±é”­ï¼Œä¸»ä¸§æœã€‚<br>äº”ã€é’±ä¸€å †è€…ï¼šå†…æœ‰å¿§å¿ƒå¿¡å¿¡è±¡ã€‚",
            x: "é›·å‡ºåœ°å¥‹ï¼Œæ‚¦ä¹ã€‚ä½œä¹å´‡å¾·ã€‚<br>åˆå…­ï¼šé¸£è±«ï¼Œå‡¶ã€‚<br>å…­äºŒï¼šä»‹äºçŸ³ï¼Œä¸ç»ˆæ—¥ï¼Œè´ã€‚<br>å…­ä¸‰ï¼šç›±è±«ï¼Œæ‚”ã€‚è¿Ÿæœ‰æ‚”ã€‚<br>ä¹å››ï¼šç”±è±«ï¼Œå¤§æœ‰å¾—ï¼Œå‹¿ç–‘ï¼Œæœ‹ç›ç°ªã€‚<br>å…­äº”ï¼šè´ç–¾ï¼Œæ’ä¸æ­»ã€‚<br>ä¸Šå…­ï¼šå†¥è±«ï¼Œæˆæœ‰æ¸ï¼Œæ— å’ã€‚",
            d: gd('SW')+"é•¿å­å±…è¥¿å—ã€‚",
u:"æˆæ­¤å¦å±€ä¹‹ç”·äººï¼Œå¿…æœ‰å› ç¦„è¿œè¡Œä¹‹è±¡ï¼Œå¤§åˆ©è‚–é©¬ä¹‹äººã€‚ä¸€ã€å±…å®¶ä¸­ä¸ºæ¯åŠ©ï¼Œå®¶äº‹çç¢ï¼Œå·¨ç»†é¡é—ï¼Œæœ‰ç”·äººèƒ½åšä¸€æ‰‹å¥½ èœå³æ­¤å±€ä¹‹äººã€‚äºŒã€äº‹ä¸šè´¢å®˜åŒç¾å¹³æ­¥é’äº‘ï¼ŒæƒŸä¸å…­äº²è¿œç¦»ï¼Œæ¯æœ‰å…ˆä¸§ä¹‹è±¡ã€‚ ä¸‰ã€å©šå§»å»¶åï¼Œæ­¤åŒæ—¶å‡ºç”Ÿä¹‹äººæ™šäº”å¹´å©šã€‚å››ã€äº‹ä¸šä¸Šä¸ºè‰¯ä½ä¹‹äººï¼Œä»»ä½•è€æ¿æˆ–ä¸»ç®¡ä»»ç”¨ä¹‹åï¼Œéƒ½å°†å¾—å¹¸æœ‰æ­¤äººç›¸åŠ©ã€‚äº”ã€å©šäº‹æœ‰å¨¶äºŒå©šå¦»ä¹‹è±¡ï¼Œæˆ–å¹´é•¿äºå·±ä¹‹å°å§ã€‚",
h: "å†…å¿§å¤–é˜»ï¼Œçˆ¶æœ‰å‡¶ã€‚ç¦„é©¬äº¤é©°ï¼Œå…¥è±ªé—¨ã€‚é©¬äººå¤§åˆ©ã€‚å‡¶ä¸ºå‰ã€‚çœ‹ä¼¼å‡¶äº‹ï¼Œå®ä¸ºå‰äº‹ã€‚ä¸ä¸ºå®˜äººä¸ºå¯Œå•†ã€‚å¤©æœºï¼šäº”é˜´ä¸€é˜³æ•°ä¸­å®šã€‚å­¤å­æ‰¿æ¯ï¼Œä¸‰åƒå® çˆ±åœ¨ä¸€èº«ã€‚",
 a: "ç”Ÿæ„å…´éš†ã€‚è´¢ç¦„å¤šã€‚å‡ºå±±å¾—é‡‘åˆå¾—å®˜ã€‚",
 b: "å†¬æœ‰ä¸§æœï¼Œé˜´äººäº¡ã€‚å‡ºå¾—å¤–åœ°åˆ†ä¸œè¥¿ã€‚å¤©æœºï¼šè‰åŸåƒé‡Œä¸ºé™©é˜»ã€‚åŠ¨å¾—å¹²æˆˆæœ‰å®˜å¸ã€‚å»å®˜åˆ™ç»ˆå‰ï¼Œå¯ä»å•†å—åŒ—èµ°ã€‚",
 e: "å®˜äººå¤–å‡ºï¼Œè°ƒèŒè¿œæ–¹æˆ–è€…ç¦»èŒï¼Œé©¬äººå‡¶åä¸ºå‰ã€‚",
 f: "ä¸€é¹¿ä¸€é©¬ï¼Œè´¢å®è‹¥å¹²ï¼Œæ­¤ä¸ºå¤§åˆ©ä¹‹è±¡ã€‚å»å®˜ä»å•†ä¸ºæ­£é“ã€‚",
 g: "å¯å¦‚è±ªé—¨ï¼Œé€¢é©¬æœ€ä½³ã€‚",
 l: "ä¸¤é‡å±±ï¼Œå‡ºä¹Ÿï¼Œé‡ä¹Ÿï¼Œæ­¤æ¬¡ä¸ä¸­ã€‚",
 m: "è´¢å®æ•£è½åœ¨åœ°ä¸€å †ï¼Œæ­¤ä¸§è‘¬ä¹‹è±¡ã€‚",
 z: "å¾—è±«æ—¶å»å®˜ä»å•†ä¸ºæ­£é“ï¼Œå¾—è´¢ä¹‹åä¸å¯äººå‰æ˜¾è€€ï¼Œä¼šæ‹›æ¥å°äººæš—ç®—ï¼ˆç›—çªƒï¼‰ç”šè‡³æ€å®³",

                             },
        17: {
            n: "æ³½é›·éš",
            t: "ä¸€ã€äº‘ä¸­é›ä¼ ä¹¦ï¼šé£æ¥å–œè®¯è±¡ã€‚<br>äºŒã€ä¸€å †é’±ï¼šè´¢èšä¹Ÿã€‚<br>ä¸‰ã€æœ±é—¨å†…æœ‰äººåï¼šå›ç‹ä¹‹è±¡ï¼Œå¿…è§å›é¢ä¹Ÿã€‚<br>å››ã€ä¸€äººåœ¨æ–—å¤–ç«‹åœ°ï¼šä¹ƒå£«äººæ±‚ä»•ï¼Œå—å°Šé‡ä¹‹è±¡ã€‚<br>äº”ã€ä¸²é’±åœ¨åœ°ï¼šæœ‰ç”¨åˆ©ä¸è¡Œä¹‹è±¡ã€‚<br>å…­ã€ä¹±ç èšç›†ï¼šå…ˆèšåæ•£ä¹‹è±¡ã€‚",
            x: "éšé¡ºï¼Œéšæ—¶å˜é€šã€‚å‘æ™¦å…¥å®´æ¯ã€‚<br>åˆä¹ï¼šå®˜æœ‰æ¸ï¼Œè´ï¼Œå‡ºé—¨äº¤æœ‰åŠŸã€‚<br>å…­äºŒï¼šç³»å°å­ï¼Œå¤±ä¸ˆå¤«ã€‚<br>å…­ä¸‰ï¼šç³»ä¸ˆå¤«ï¼Œå¤±å°å­ï¼Œéšæœ‰æ±‚å¾—ï¼Œåˆ©å±…è´ã€‚<br>ä¹å››ï¼šéšæœ‰è·ï¼Œè´å‡¶ï¼Œæœ‰å­šåœ¨é“ä»¥æ˜ï¼Œä½•å’ï¼Ÿ<br>ä¹äº”ï¼šå­šäºå˜‰ï¼Œã€‚<br>ä¸Šå…­ï¼šæ‹˜ç³»ä¹‹ï¼Œä¹ƒä»ç»´ä¹‹ï¼Œç‹ç”¨äº¨äºè¥¿å±±ã€‚",
            d: gd('E')+"ä¸‰å¥³å±…ä¸œã€‚",
u:"æ­¤å¦ç°ä»£äººæœ€å¤šè§ï¼Œå¾äººå¸¸è§è¡—ä¸Šæœ‰å¥³å­©ï¼Œå¥³æ‰®ç”·è£…æˆ–ç²—å£®è¿‡ ä¸€èˆ¬å¥³äººä¹‹å°å§ï¼Œå³æ­¤å±€ä¹‹äººã€‚ä¸€ã€æœ‰å¥³åŒæ€§æ‹ä¹‹å€¾å‘ï¼Œå…¶å¿ƒå¿µä¸€ç›´è®¤ä¸ºè‡ªå·±ä¸ºç”·äººï¼Œä¸”ä¸å±‘ è‡ªå·±ä¸ºç”·äººï¼Œä¸”ä¸å±‘ä¸€é¡¾å‘¨å›´ä¹‹ç”·äººï¼Œå–œä¸å¥³å­©åŒå‡ºåŒå…¥ã€‚äºŒã€å…¨å¿ƒäºäº‹ä¸šï¼Œä¸ºè¾¾ç›®çš„ä¸æ‹©æ‰‹æ®µï¼Œæœ‰æ—¶ä½é«˜ä¸”å±…å¤©å­æˆ–è‘£ äº‹é•¿ä¹‹èº«ä¾§ã€‚ä¸‰ã€å¦‚åŒæ—¶ç”Ÿäººï¼Œå‘½ä¸­å©šå§»å‰ç¥¥ï¼Œå†åŠ æ­¤å±€åŠ¿å¿…å«å…¥å¯Œè´µäºº å®¶ï¼Œä¸”æ¯”åŒæ—¶ç”Ÿäººï¼Œæ—©å©šå››å¹´ï¼Œå¦‚å¯¹æ–¹ä¸å¯Œæœ‰ï¼Œç»ˆå¿…æ•£ã€‚æ•…å­¦è€…å¦‚æ­¤ï¼Œå¿…é¡»å¤©æ–‡åœ°ç†åˆå±€ï¼Œæ–¹å¯ç¡®çŸ¥åŒæ—¶ç”Ÿäººä¹‹ä¸åŒåœ¨ ä½•å¤„ï¼ŒåŒæ—¶äº¦çŸ¥å¦‚ä½•å¯è§£ã€‚æ¯”æ–¹é‡æ­¤å¦å±€ä¹‹äººï¼Œå‘½ä¸­å©šå§»åˆå‡¶ï¼Œå¾ äººäº‹å…ˆæ¢çŸ¥ï¼Œåˆ©ç”¨å·½ä¸ºé£å¦ï¼Œå³å¯è§£å¼€æ­¤å±€ç”Ÿæˆä¹‹ç¥¸ç«¯ã€‚",
h: "äº‘ä¸­é›æ¥å‘å—è¡Œã€‚é¡ºæ€§é¡ºå‘½äººéšå’Œã€‚èº«åœ¨è±ªé—¨ä¸é‡åˆ©ã€‚é‡äº‹é¿å¼€ï¼Œæ— æœ‰æ‹…å½“ã€‚å…­äº²å…ˆèšåæ•£ã€‚å…„å¼Ÿå§å¦¹å„å¥”ä¸œè¥¿ã€‚ç”·å¾—è‰¯å¦»ï¼Œå¥³å¾—è´µå¤«ã€‚å…«ç‰›äººå¤§å‰ã€‚æœ±é«˜æ­£ï¼Œå…«æ¡ç‰›ã€‚",
 a: "æœ‰å£ä¹‹äººå¾—å›ç¦„ï¼ˆå¦‚å£å¤©å´ï¼‰ã€‚é‡å¾—è´µäººå‡é’äº‘ã€‚å¾—å®˜å¾—ç¦„ï¼Œæœ‰ç¾æ®ƒã€‚èˆå»é‡åˆ©æ–¹æ˜¯å‰ã€‚",
 b: "å©šäº‹å‰ã€‚ç§‘ç”²ä¸­ã€‚æ±‚è´¢æœ‰è´¢ã€‚å¾—è´¢é¡»é—ªï¼Œä¸å¯è´ªç¦„ã€‚æ±‚äº‹é€¢è´µï¼Œå½“å®˜è€…å¿ƒæƒ³äº‹æˆã€‚ææœ‰å—è¿ã€‚",
 e: "äº‘ä¸­ç‡•ä¼ ä¹¦ï¼Œå–œè®¯è‡³ï¼Œå‡å®˜ã€‚",
 f: "ä¸€å †é’±ï¼Œå¤§åˆ©ã€‚",
 g: "äº‘ä¸­ç‡•ä¼ ä¹¦ï¼Œå–œè®¯è‡³ï¼Œå¯æˆã€‚",
 l: "äº‘ä¸­ç‡•ä¼ ä¹¦ï¼Œå¤§åˆ©è€ƒè¯•ã€‚",
 m: "ä¸€å †é’±åœ¨åœ°ï¼Œæ­¤ä¸ºçº¸é’±ä¹Ÿï¼Œå‡¶ã€‚",
 z: "æš‚æ— ",

                             },
        18: {
            n: "å±±é£è›Š",
            t: "ä¸€ã€å­©å„¿åœ¨äº‘ä¸­ï¼šæœ‰å¤©å®˜ä¿ƒæˆä¹Ÿã€‚ä¸æ±‚ååˆ©ä¹‹äººã€‚<br>äºŒã€é›å•£ä¹¦ï¼šæœ‰æ¶ˆæ¯è‡³ã€‚<br>ä¸‰ã€ä¸€é¹¿ï¼šæœ‰å¤§åˆ©ä¹Ÿã€‚<br>å››ã€é’±åœ¨ç©ºä¸­ï¼šæ­¤å¿ƒä¸­å›¾åˆ©ä¹‹è±¡ä¹Ÿã€‚<br>äº”ã€å¯¹æ‹œï¼šéæ­£å©šã€‚",
            x: "å­æ‰¿çˆ¶ä¸šï¼Œæ•´é¡¿æ”¹é©ã€‚æŒ¯æ°‘è‚²å¾·ã€‚<br>åˆå…­ï¼šå¹²çˆ¶ä¹‹ç›ï¼Œæœ‰å­ï¼Œè€ƒæ— å’ï¼Œå‰ç»ˆã€‚<br>ä¹äºŒï¼šå¹²æ¯ä¹‹è›Šï¼Œä¸å¯è´ã€‚<br>ä¹ä¸‰ï¼šå¹²çˆ¶ä¹‹è›Šï¼Œå°æœ‰æ‚”ï¼Œæ— å¤§å’ã€‚<br>å…­å››ï¼šè£•çˆ¶ä¹‹è›Šï¼Œå¾€è§åã€‚<br>å…­äº”ï¼šå¹²çˆ¶ä¹‹è›Šï¼Œç”¨èª‰ã€‚<br>ä¸Šä¹ï¼šä¸äº‹ç‹ä¾¯ï¼Œé«˜å°šå…¶äº‹ã€‚",
            d: gd('SE')+"ä¸‰å­å±…ä¸œå—ã€‚",
u:"ä¸‰è™«èšä¸€ç›˜ä¸­ï¼Œäº’ç›¸äº‰é£Ÿï¼Œæ­¤æˆè›Šè±¡ï¼Œå¾äººå¸¸è§å‡ ä½å¥³æ€§åŒå±… ä¸€æ¡Œï¼Œä¸œå®¶é•¿è¥¿å®¶çŸ­çš„è®®è®ºä»–äººï¼Œæ­¤è™½ç”Ÿæ˜¯éä¹‹åœ°ï¼Œä½†å¹¶éæˆè›Š å¦ï¼Œæ­¤å¦åœ¨é˜³å®…ä¸ŠæƒŸè§ä¹‹äºç”·äººï¼Œæ­¤åˆç”·å¥³ä¹‹ä¸åŒï¼Œå¥³äººä¹‹è›Šï¼Œå¾ äººå¯ä»¥ç«‹è§ï¼Œç”·äººä¹‹è›Šåœ¨å¿ƒä¸­ï¼Œè¡¨é¢ä¸Šä¸æ˜“çœ‹åˆ°ã€‚ä¸€ã€æ­¤å±€ç”·äººå›¾åˆ©é‡å¿ƒè‡³å¤§ï¼Œä¸ºè¾¾ç›®çš„ï¼Œå¾€å¾€ä¸æ‹©æ‰‹æ®µã€‚äºŒã€ä¸»å‘ç§‘ç”²ï¼Œè¯»ä¹¦è€ƒè¯•æˆç»©å¿…è¶…äººä¸€ç­‰ã€‚ä¸‰ã€æœ‰æ—©å©šä¹‹è±¡ï¼Œæ¯”åŒæ—¶ç”Ÿäººæå‰å››å¹´å©šï¼Œä¸”äºŒä½å…„é•¿å°šæœªå¨¶å¦»ï¼Œè‡ªå·±å…ˆå¨¶ã€‚",
h: "äº”å²å¤§é™ï¼Œå¥³ä¸ºå‡¶ï¼Œä¸”éš¾é˜²ã€‚äººè²Œä¸åŒã€‚å–„çŸ¥äººæ„ï¼Œå¤§äººçŠ¶ã€‚ä¸»å¤­ã€‚ç§¯å–„ä¹‹å®¶å¿…æœ‰ä½™åº†ã€‚ç¥–ä¸šæœ‰ç§¯ï¼Œæœºæ·±ã€‚æ—©æœ‰åŠŸåã€‚æ—©å©šã€‚",
 a: "é‡‘æ¦œé¢˜åè‡ªç”±äººï¼Œä¸æ±‚ååˆ©ï¼Œååˆ©è‡ªæ¥ã€‚è´¢ç¦„å…´æ—ºï¼Œæ— å®˜å¸¦ã€‚ç”·å¥³åˆæœ‰åˆ©ï¼Œæœºå¤šå¿…è´¥ã€‚",
 b: "ç§‘ç”²é«˜ä¸­ï¼Œå©šäº‹æœ‰æˆã€‚ä»å•†åˆä¼™å‰ï¼Œé¡»é˜²äººè¨€ç”Ÿå®³ã€‚",
 e: "å¤©å®˜åŠ©åŠ›ï¼Œå¯å‡ï¼Œæœºå¤šåè´¥ã€‚",
 f: "ä¸€é¹¿ä¸€è´¢ï¼Œè´¢ç¦„åŒå…¨ä¹‹è±¡ï¼Œå‰ã€‚",
 g: "ç”·å¥³ç›¸æ‹œï¼Œæ­¤ä¸ºå› åˆ©ç»“åˆï¼Œéä¸ºæ­£é“ã€‚",
 l: "ç‡•è¡”ä¹¦ï¼Œå–œè®¯è‡³ï¼Œé«˜ä¸­ã€‚",
 m: "ç—…æœ‰å¤©å®˜ç›¸åŠ©ï¼Œæœ‰æ•‘ã€‚å°å„¿é˜²å¤­äº¡ã€‚éœ€è¦é˜²å¿ƒè„ç—…ï¼Œä¸­é£ç­‰ã€‚",
 z: "æš‚æ— ",

                             },
        19: {
            n: "åœ°æ³½ä¸´",
            t: "ä¸€ã€å¦‡äººä¹˜é£ï¼šå¤–æ´ä¸ºé˜´å¥³ï¼Œç¾äººä¹Ÿã€‚<br>äºŒã€ä¸€è½¦ä¸Šæœ‰ä½¿æ——ï¼šå‡ºä½¿ä¹‹è±¡ï¼Œä»¥è°‹ç•¥å¯è§£ç¾ï¼Œè°‹ä¹‹å¯¹è±¡ä¸ºå¥³äººä¹Ÿã€‚è¿å§“ã€è½¦å§“äººã€‚<br>ä¸‰ã€äººåœ¨å±±é¡¶å¤´ï¼šç››æå°†è¡°ï¼Œæ‹›å›°ä¹Ÿï¼Œå³å°†ä¸‹å¡ä¹Ÿã€‚<br>å››ã€è™åœ¨å±±ä¸‹åï¼šäººå—è™å›°ä¹‹è±¡ã€‚<br>äº”ã€ä¸€åˆï¼šå…ˆæˆåç ´è±¡ã€‚<br>å…­ã€äººå°„å¼“ï¼šå¼ å§“äººå£«ï¼Œå¤·ç‹„ä¹‹äººï¼Œä»¥å¼“å°„çŒï¼Œæ•…å¤–æ—å…¥ä¾µè±¡ã€‚",
            x: "ä»¥ä¸Šä¸´ä¸‹ï¼Œè‡³äºå…«æœˆæœ‰å‡¶ã€‚ä¿æ°‘æ— ç–†ã€‚<br>åˆä¹ï¼šå’¸ä¸´ï¼Œè´ã€‚<br>ä¹äºŒï¼šå’¸ä¸´ï¼Œæ— ä¸åˆ©ã€‚<br>å…­ä¸‰ï¼šç”˜ä¸´ï¼Œæ— æ”¸åˆ©ï¼Œæ—¢å¿§ä¹‹ï¼Œæ— å’ã€‚<br>å…­å››ï¼šè‡³ä¸´ï¼Œæ— å’ã€‚<br>å…­äº”ï¼šçŸ¥ä¸´ï¼Œå¤§å›ä¹‹å®œï¼Œã€‚<br>ä¸Šå…­ï¼šæ•¦ä¸´ï¼Œï¼Œæ— å’ã€‚",
            d: gd('W')+"æ¯å±…è¥¿ã€‚",
u:"æ¯å±…æ­¤å±€ï¼Œå› å¯¹è±¡ä¹‹å¦ä¸ºå±¥ï¼Œæ•…æœ‰éš¾ä¸ºä¹‹è±¡å‡ºç°ã€‚å·²å©šå¦‡äººå±… æ­¤ç”±äºå¤«å®«å¿…æ— åŠ›ï¼Œäº§ç”Ÿä»¥ä¸‹æ•°ç§çŠ¶å†µï¼šä¸€ã€å¤«ä¸šå—å›°ï¼Œä¹ƒå› å¦»ä¹‹è¿‡åˆšï¼Œä¸ºæ±‚åŠŸå¿ƒåˆ‡ï¼Œæ‹›è‡´å¦‚æ­¤ï¼Œè¯·å‚ è€ƒå±¥å¦ã€‚äºŒã€å¦»ä¸ºå§”æ›²æ±‚å…¨ï¼Œè€Œä»¥åŠ›å¤§å±…å°ï¼Œé¡ºä»äºå¤«å¯ä¹Ÿã€‚ä¸‰ã€å­å¥³é€¢æ¯å¦‚æ­¤ï¼Œä»»ä½•äº‹çš†æœ‰æ¯æ¥åšä¸»ï¼Œä»¥è‡´æ¯è¿‡çƒ¦å¿§ï¼Œå‘ å±•æƒé™è¿‡å¤§ï¼Œç»ˆè‡´å­å¥³åå¼¹ï¼ŒèƒŒé€†å…¶æ„è¡Œäº‹ï¼Œå…¶æ‹›è‡´å¦‚æ­¤ï¼Œä¹ƒå› æ¯ äº²æ— å®‰å…¨æ„Ÿï¼Œå…¨å¿ƒå¯„æ‰˜åœ¨å­å¥³èº«ä¸Šè€Œæˆæ­¤ç‰¹æ®Šä¹‹å¿ƒç†çŠ¶å†µã€‚å…¶ç»“æœ å¤§å®¶ç—›è‹¦ï¼Œè€Œæ— æ³•è§£å†³ã€‚å››ã€è‚–è™äººå±…æ­¤å±€ï¼Œå©šäº‹å‡¶ï¼Œä¸»ç ´ï¼Œä½†äºäº‹ä¸šå´èƒ½åŠ›äº‰ä¸Šæ¸¸ï¼Œæˆå°±éå‡¡ã€‚",
h: "å¤©æœºï¼šä¹”æœ¨æœ‰å‡¤æ¥ä»ªï¼Œé˜´å¤šé˜³äºŒã€‚ç”Ÿåœ¨æ­¦å®˜å®¶ï¼Œä¸»å¤§è´µã€‚é™ˆè¿å•ä½¿ï¼Œå‘è‚–è™äººã€‚é•¿å¼“ä¹‹äººï¼Œæš—åº¦é™ˆä»“ã€‚å…ˆæˆåç ´ã€‚",
 a: "æ­¦å°†å—å›°ï¼Œé€¢å¼ ç”Ÿå®³ã€‚å¼ƒæ­¦ä»å•†ï¼Œåä¸ºå¯Œã€‚å¤©é“ï¼šé‡ç¾äººã€‚åœ¨ä»»å‡ºä½¿ï¼Œè½¦è¡Œåƒé‡Œã€‚é˜²å¼ ç”Ÿå®³ï¼Œäººè‡³åŒ—åƒé‡Œã€‚",
 b: "å©šäº‹é¡»é˜²ï¼Œè™ç”Ÿæš—å®³ã€‚æ­¦å®˜å¤–è°ƒã€‚å‡ºä½¿ä»–å›½ã€‚ç­‰å¾…å‰ã€‚å¼ºè¿›ç”Ÿæ˜¯éï¼Œå®˜å¸ã€‚å¯ä¸åŠ¨å£°è‰²ï¼Œå‡ä½œä¸çŸ¥ã€‚",
 e: "è½¦è¡Œå¸¦ä»¤ï¼Œå¤–äº‹å‰ï¼Œå¤§ä½¿å‰ï¼Œå…¶ä½™è¢«å›°ï¼Œä¸å‡ã€‚è‚–è™å§“ç‹åå‡ã€‚",
 f: "ä¸€ç›’å­ï¼Œå¼ å¼“å°„ï¼Œå…ˆæˆåç ´ï¼Œæœ‰äººæš—ç®—ï¼Œä¸èƒ½åšã€‚",
 g: "å¯æˆä½†è¦é˜²ç ´ã€‚",
 l: "è¿œæ–¹å¯ä¸­ï¼Œéœ€åœ¨èˆŸè½¦ä¹‹å¤–ã€‚å¦ä¸€è§£é‡Šå¯ä»¥è¯´æ˜¯ç¾å›½ã€‚",
 m: "ç”·è€…æ‹›å›°ï¼Œéœ€è¦å¥³äººæˆ–è€…ç¾äººæ¥è§£ï¼Œå¦ä¸€è§£é‡Šæ˜¯éœ€é˜´äººè§£ã€‚",
 z: "æš‚æ— ",

                             },

        20: {
            n: "é£åœ°è§‚",
            t: "ä¸€ã€æ—¥æœˆå½“å¤©ï¼šæ”¿æ²»æ¸…æ˜ï¼Œæ™®ç…§å¤§åœ°ï¼Œçˆ¶æ¯åŒå…¨ã€‚<br>äºŒã€å®˜äººé¦™æ¡ˆè¾¹ç«‹ï¼šå€Œäººï¼Œä¸ˆå¤«ä¹Ÿã€‚è”¡å§“äººå£«ï¼Œç¥äººå…±æ˜ä¹‹è±¡ã€‚<br>ä¸‰ã€é¹¿åœ¨å±±ä¸Šï¼šå¾—é«˜ç¦„ä¹‹è±¡ã€‚<br>å››ã€é‡‘ç”²äººï¼šå›ä¾§ä¹‹äººä¹Ÿï¼ŒæŠ¤å«ä¹Ÿã€‚<br>äº”ã€æ‰§å°ç§¤ï¼šæå°ä¿¡è€Œæ¥æˆæƒä¹Ÿã€‚",
            x: "è§‚æ°‘è®¾æ•™ï¼Œç¥é“è®¾æ•™ã€‚çœæ–¹è§‚æ°‘ã€‚<br>åˆå…­ï¼šç«¥è§‚ï¼Œå°äººæ— å’ï¼Œå›å­åã€‚<br>å…­äºŒï¼šé—šè§‚ï¼Œåˆ©å¥³è´ã€‚<br>å…­ä¸‰ï¼šè§‚æˆ‘ç”Ÿï¼Œè¿›é€€ã€‚<br>å…­å››ï¼šè§‚å›½ä¹‹å…‰ï¼Œåˆ©ç”¨å®¾äºç‹ã€‚<br>ä¹äº”ï¼šè§‚æˆ‘ç”Ÿï¼Œå›å­æ— å’ã€‚<br>ä¸Šä¹ï¼šè§‚å…¶ç”Ÿï¼Œå›å­æ— å’ã€‚",
            d: gd('SW')+"é•¿å¥³å±…è¥¿å—ã€‚",
u:"è§‚å¦ä¹‹ç²¾ä¹‰åœ¨ä»¥é™è§‚å¯ä»¥æ´æ‚‰å‘¨å›´ä¹‹äº‹ï¼Œé»„å¸ä¹‹é˜´ç¬¦ç»äº‘ï¼šã€Œè‹è€…å–„è§†ã€‚ã€å³æ­¤æ„ã€‚ä½†äº¦æœ‰ç¼ºå¤±ï¼Œå²‚ä¸é—»å¤è¨€ï¼šã€Œæ°´è‡³æ¸…åˆ™æ—  é±¼ï¼Œäººè‡³æ˜åˆ™æ— å¾’ã€æ­¤å¦å”¯é•¿å¥³å¯è§ï¼Œå©šåå±€æ¶ˆã€‚ä¸€ã€å…¶æ˜åœ¨è¿‡æ˜ï¼Œè€Œäº§ç”Ÿä»¥è´¢å¯Œè®ºå®šæ˜¯å¦æ„¿æ„å«äººï¼Œé€ æˆå¦‚é‡æœªæœ‰äº‹ä¸šä¹‹ç”·äººï¼Œå³ä½¿å†çˆ±ä¹Ÿä¸æ„¿ç»“å©šï¼Œå®å¯åšæœ‰é’±äººçš„åæˆ¿ï¼Œä¸ å©šã€‚äºŒã€å¦‚é€¢å‘½æ ¼å©šå§»æœ‰å‡¶ï¼Œåˆ™æœ‰å«äºŒå©šå¤«ï¼Œä¸”å¯¹æ–¹æœ‰å­ä¹‹äººï¼Œä½† é¡»æ¯”åŒæ—¶ç”Ÿäººå†åŠ å…­å¹´æ–¹æˆæ­£å¼å©šå§»ã€‚ä¸‰ã€æœªå©šå‰ï¼Œå¥³å„¿ä»£æ¯èŒï¼ŒæŒç†ä¸€å®¶å¤§å°ä¹‹äº‹ï¼Œæœ‰å§Šå¦‚æ¯ï¼Œå³ æ­¤å±€ä¹‹äººã€‚å››ã€å¦‚é‡å‘½ä¸­ä¸ºåƒ§é“å‘½ä¹‹äººï¼Œåˆ™ä¸»ç»ˆèº«ä¸å«ã€‚",
h: "çˆ¶æ¯åŒå…¨äººå¤§å‰ã€‚æ¬¡å­åç¦„æˆäº‹ä¸šï¼Œå®˜äººå¾—å°åˆç§°å¿ƒã€‚å¥³å­é€¢ä¹‹æä¸ºåã€‚",
 a: "çˆ¶å…¨æ¯å¤±ä¸ºå®šæ•°ã€‚è´¢ç¦„æ—¥å¢ï¼Œå®˜è¿é€šã€‚é€¢è¾›é€¢ä¹™å¿…å¾å©šã€‚ç«å¹´é¡»é˜²æ¯æœ‰å‡¶ã€‚",
 b: "é€¢ä¹‹å¿…å‡ï¼Œè¯¸äº‹é¡ºé‚ï¼Œè·¯ä¸Šå¹³å®‰ã€‚å©šäº‹å¯æˆï¼Œå¤«ä¸»è´µã€‚çˆ¶æ¯åŒå…¨äººå®‰åº·ã€‚",
 e: "æ‰§å°ç§¤ï¼Œå®˜å¿…å‡ï¼Œä¸åˆ†æ–‡æ­¦ã€‚",
 f: "æ‰§å°ç§¤ï¼Œå®˜å¿…å‡ï¼Œä¸åˆ†æ–‡æ­¦ã€‚é¹¿åœ¨å±±ï¼Œè¿œé¹¿ä¹Ÿï¼Œéœ€è¦æ—¶é—´ã€‚",
 g: "å¸¦å°å¿…æˆã€‚",
 l: "å¸¦å°å¿…ä¸­ã€‚",
 m: "æ—¥æœˆåŒå…¨ï¼Œæ— ç¾ã€‚ä½†éœ€é˜²ç«ç¾ï¼Œå¿ƒè„ç—…ï¼Œé€¢åˆä¸ºå‡¶ã€‚",
 z: "æ­¤ä¸ºå¾—ç¥äººç›¸åŠ©ä¹‹æ—¶ï¼Œæ¸…æ˜æ— ç¾ï¼Œå”¯æœ‰é€¢åˆ°åˆå¹´æœˆæ—¥æ—¶ä¼šå‡ºäº‹ï¼Œè¦å°å¿ƒ",

                             },

        21: {
            n: "ç«é›·å™¬å—‘",
            t: "ä¸€ã€åŒ—æ–—æ˜Ÿï¼šå›ç‹ä¹Ÿï¼Œå¤«å›ä¹Ÿï¼Œå…¬èŒä¹Ÿã€‚<br>äºŒã€å¦‡äººçƒ§é¦™æ‹œï¼šå¦»äºäººäº‹æ— åŠ©ï¼Œä¹ƒæ±‚åŠ©äºå¤©ã€‚<br>ä¸‰ã€å¿§å­—ä¸å…¨å–œå­—å…¨ï¼šä¹ƒæ— åˆå–œè±¡ã€‚<br>å››ã€ä¸€é¸¡é£Ÿç¨»ï¼šæœè¢«é£Ÿï¼Œæ— æœä¹Ÿã€‚<br>äº”ã€ä¸€é’±è´¢ã€ä¸€é¹¿è€…ï¼šäºè´¢ç¦„äº‹å¿§å¿ƒå¿¡å¿¡ä¹Ÿã€‚<br>å…­ã€ç¦½ï¼šå­—è§£ä¸ºã€ç¦»å¤šä¼šå°‘ã€ä¹‹è±¡ã€‚",
            x: "å’¬åˆï¼Œåˆ‘ç½šï¼Œé™¤æ¢—ã€‚æ˜ç½šæ••æ³•ã€‚<br>åˆä¹ï¼šå±¦æ ¡ç­è¶¾ï¼Œæ— å’ã€‚<br>å…­äºŒï¼šå™¬è‚¤ç­é¼»ï¼Œæ— å’ä¹Ÿã€‚<br>å…­ä¸‰ï¼šå™¬è…Šè‚‰é‡æ¯’ï¼Œå°åï¼Œæ— å’ã€‚<br>ä¹å››ï¼šå™¬å¹²èƒï¼Œå¾—é‡‘çŸ¢ï¼Œåˆ©è‰°è´ï¼Œã€‚<br>å…­äº”ï¼šå™¬å¹²è‚‰ï¼Œå¾—é»„é‡‘ï¼Œè´å‰ï¼Œæ— å’ã€‚<br>ä¸Šä¹ï¼šä½•æ ¡ç­è€³ï¼Œå‡¶ã€‚",
            d: gd('E')+"æ¬¡å¥³å±…ä¸œã€‚",
u:"æˆæ­¤ä¹‹å±€æ³•ï¼Œè¯·è§‚å½•å½±å¸¦è¯´æ˜ï¼Œäºæ­¤ä¸ç´¯è¿°ã€‚å¾äººå¸¸è§æœ‰å¥³å­© å°æ—¶å³å–œæ¬¢å’¬äººï¼ŒåŠä¹‹ä¸å¬ï¼Œä¹ƒç”Ÿå™¬å—‘ä¹‹è±¡ã€‚ä¸€ã€æ­¤å¥³æ€§åˆšï¼ŒæŠ¥å¤æ‰‹æ®µå¸¸ç”¨å’¬çš„ï¼Œå¹³æ—¥å” å¨ä¸åœã€‚ äºŒã€å©šå§»å¯¹è±¡ä¸ºé˜´æŸ”ä¹‹ç”·äººã€‚ä¸‰ã€æœ¬èº«æƒ³æ³•åŠ¨ä½œä¸€å¦‚ç”·äººï¼Œä¸”ä¸»å°‘å¹´æœ‰æˆï¼Œæ•…å¸¸è§å¹´è½»ä¹‹å½± å‰§åœˆå‡ºèº«å°å§ï¼Œåæ°”å¾ˆå¤§ï¼Œå°‘å¹´å¾—å¿—ï¼Œéƒ½å±æ­¤å±€ã€‚å››ã€å©šäº‹å»¶åå…­å¹´ï¼Œæ•…åŒæ—¶ç”Ÿäººå¦‚ä¸ºäºŒåå…­å²å©šï¼Œåˆ™æ­¤å±€äººåŠ  å…­å¹´ï¼Œæˆä¸ºä¸‰åäºŒå²å©šã€‚äº”ã€äº‹ä¸šéå¸¸é¡ºåˆ©ï¼Œä½†å¦‚ä¸ºè‚–é¸¡ä¹‹å¥³æ€§é€¢ä¹‹ï¼Œå…¶æœå¿…ååƒå±± ç©ºï¼Œå¾äººå¸¸è§çš„æœ‰æœªå©šå¦¾æˆæ­¤å±€ï¼Œä¹Ÿæœ‰ç¦»å©šä¹‹å¥³æˆæ­¤å±€ï¼Œä½†é¡»ä¸å¯¡ æ¯åŒä½ä¸€èµ·ï¼Œæ–¹æˆæ­¤å±€ã€‚ä¸ºä½•å¦‚æ­¤ï¼Œå­¦è€…é¡»çœ‹å½•å½±å¸¦è¯´æ˜ã€‚",
h: "ç”Ÿä¸ºå°¾èƒï¼Œåœ¨è±ªé—¨ã€‚è¶³è¸ä¸ƒæ˜Ÿï¼Œå‘ç”·å„¿ã€‚ä»å•†å¤šè´¥å¤šæˆã€‚ä»å®˜ä»æ­¦ï¼Œä½è‡³æå“ï¼Œä¸€äººä¹‹ä¸‹ä¸‡äººä¹‹ä¸Šã€‚",
 a: "å¿ƒé¦™ä¸€ç‚·ä¸ºè¯¸å›ï¼Œæ‰€æ±‚æœªæœï¼Œé€¢é¸¡å¿§è´¢ã€‚å¥³å‘½é€¢ä¹‹ï¼Œæ¯ååˆ°è€ã€‚æ±‚è´¢å¦‚é•œä¸­æœˆï¼Œå¯é‡ä¸é‡ã€‚",
 b: "é˜²çªƒå¿§å¤±è´¢ã€‚å¦‚è€ƒè¯•ï¼Œå†åº¦æ— åŠŸåã€‚å¿ƒè¯šæ±‚è‹å¤©ã€‚å¤©æœºï¼šè‚–é¸¡èƒ½é£Ÿæœï¼ˆé¸¡äººï¼Œæˆ–é¸¡å¹´ï¼‰ã€‚",
 e: "ä¸€é¸¡é£Ÿæœï¼Œå¦ä¸€è§£é‡Šä¸ºé›ï¼Œé€¢é›å­—ï¼Œé¸¡å¹´æ—¶ï¼Œé¸¡äººç­‰å¯æˆã€‚",
 f: "ä¸¤ä¸²é’±ï¼Œè¢«å·ä¹‹è±¡ï¼Œé˜²ç›—ã€‚æ­¤ä¸ºè´¢ç¦„è¢«å·ä¹‹è±¡ï¼Œä¸å¯åšã€‚ä¸€é¸¡é£Ÿæœï¼Œå¦ä¸€è§£é‡Šä¸ºé›ï¼Œé€¢é›å­—ï¼Œé¸¡å¹´æ—¶ï¼Œé¸¡äººç­‰å¯å¾—è´¢ç¦„ã€‚",
 g: "ä¸€é¸¡é£Ÿæœï¼Œå¦ä¸€è§£é‡Šä¸ºé›ï¼Œé€¢é›å­—ï¼Œé¸¡å¹´æ—¶ï¼Œé¸¡äººç­‰å¯æˆã€‚",
 l: "è€ƒä¸¤æ¬¡ä»¥ä¸Šä¸ä¸­ï¼Œä¸€æ¬¡å¯ä¸­ã€‚ä¸€é¸¡é£Ÿæœï¼Œå¦ä¸€è§£é‡Šä¸ºé›ï¼Œé€¢é›å­—ï¼Œé¸¡å¹´æ—¶ï¼Œé¸¡äººç­‰å¯ä¸­ã€‚",
 m: "ä¸²é’±åœ¨åœ°ï¼Œçº¸é’±ä¸§è‘¬ä¹‹è±¡ï¼Œé‡ç—…å‡¶ã€‚éé‡ç—…çš„ç»“æœå°±æ˜¯å¿§å¿ƒå¿¡å¿¡ï¼Œé€¢åˆ°é…‰å¹´æœˆç­‰ä¼šå¥½ï¼Œæˆ–è€…é¸¡äººä¼šå¥½ã€‚",
 z: "æš‚æ— ",

                             },
        22: {
            n: "å±±ç«è´²",
            t: "ä¸€ã€é›¨ä¸‹ï¼šæ»¡ä¹Ÿï¼Œæ¶¦æ³½ä¹Ÿï¼Œæˆä¹Ÿã€‚<br>äºŒã€è½¦è¡Œè·¯ï¼šå‰å¾€ä»»å®˜è±¡ï¼Œè¡Œèµ°å››æ–¹ä¹Ÿã€‚<br>ä¸‰ã€èˆŸå¼ å¸†åœ¨æ±Ÿä¸­ï¼šæ­¤è¡Œé¡ºé£å¤§åˆ©ä¹Ÿã€‚<br>å››ã€å®˜äººç€å…¬æœç™»æ¢¯ï¼šå‡è¿åœ¨å¤–åœ°è±¡ã€‚ä»»å…¬èŒä¸»å®˜å¤–è°ƒè±¡ã€‚ä¸ˆå¤«ä»å…¬èŒå‡å®˜ä¹Ÿã€‚<br>äº”ã€ä»™å¥³äº‘ä¸­æ‰§çªï¼šå—é˜´äººææºè±¡",
            x: "è£…é¥°ï¼Œå¤–è¡¨åä¸½ã€‚æ˜åº¶æ”¿ã€‚<br>åˆä¹ï¼šè´²å…¶è¶¾ï¼Œèˆè½¦è€Œå¾’ã€‚<br>å…­äºŒï¼šè´²å…¶é¡»ã€‚<br>ä¹ä¸‰ï¼šè´²å¦‚æ¿¡å¦‚ï¼Œæ°¸è´ï¼Œã€‚<br>å…­å››ï¼šè´²å¦‚çš¤å¦‚ï¼Œç™½é©¬ç¿°å¦‚ï¼ŒåŒªå¯‡å©šåª¾ã€‚<br>å…­äº”ï¼šè´²äºä¸˜å›­ï¼ŒæŸå¸›æˆ‹æˆ‹ï¼Œåï¼Œç»ˆã€‚<br>ä¸Šä¹ï¼šç™½è´²ï¼Œæ— å’ã€‚",
            d: gd('S')+"ä¸‰å­å±…å—ã€‚",
u:"è´²å¦ä¸ºæ±‚å¤–é¥°ä¹‹é“ï¼Œå…¶ä¹‹äºäººäº‹ï¼ŒæƒŸç”·äººå±…æ­¤å±€ä¸­æˆæ ¼ã€‚è¯¸å› è¯•æƒ³ä¸€ä½å ‚å ‚ç”·å­æ±‰ï¼Œå¦‚æœè¦å¤–é¥°ï¼Œå…¶ç›®çš„ä½•åœ¨å‘¢ï¼Ÿå› ä¸ºæœ‰çœŸå†…å® ä¹‹äººï¼Œå…¶å¿ƒä½†æ±‚å……å®ï¼Œå¿…èˆå¤–é¥°ä¹‹é“ï¼Œä¸ä¼šèŠ±å¿ƒæ€åˆ»æ„å»ä¿®é¥°ã€‚å› ä¸è§çœŸæ­£æœ‰é’±ï¼Œæœ‰é«˜æ™ºæ…§ä¹‹äººï¼Œå…¶å¤–è§‚å¾€å¾€å¾ˆé›¶ä¹±ï¼Œç”šè‡³è¡£æœåç©¿ è€Œä¸è‡ªçŸ¥ï¼Œå…¶åŸå› åœ¨ä»–æ ¹æœ¬ä¸æƒ³èŠ±å¿ƒæ€åœ¨è¿™æ–¹é¢ï¼Œä½ æœ‰åŒæ„Ÿå—ï¼Ÿä¸€ã€ç”·èº«å¥³æ€ä¹‹è±¡ï¼Œæ€§å–œå¤¸å¼ çŸ«ä½œä¹‹æœé¥°ã€‚äºŒã€ä¸ªæ€§å¥½åŠ¨ï¼Œä¸è€é™å®ˆï¼Œåˆåˆšçƒˆä¸»è§å¼ºï¼Œæ€§æ˜“æ€’ã€‚ä¸‰ã€å©šå§»å»¶åï¼Œä¸‰åå²ä»¥åè¿›é€€å¤±æ®ï¼Œå¾äººå¸¸è§ç©ºæœäººå‘˜åŠå½± å‰§åœˆäººå£«å±…æ­¤å±€ä¸­è€Œä¸è‡ªçŸ¥ã€‚å››ã€æ­¤å±€ä»¥ç§‘ç”²ï¼Œå£°åï¼Œæ•…åˆ©è€ƒè¯•ã€‚åŒæ—¶ç”Ÿäººä¼šè€ƒè¯•æˆç»©ä¸ åŒï¼Œæœ‰äººåè½å­™å±±ï¼Œåœ°ç†ä¹‹æ ¼å±€å½±å“æ·±è¿œçŸ£ã€‚",
h: "è‹±æ˜ä¸ºå®˜å¸¦ï¼Œå‡ºä½¿å››æ–¹ä¸ºäººé‡ã€‚å…¬åŠ¡äººå‘˜å‰é€”æœ‰äººåŠ©ã€‚ä¸é¡»å»é—®æ´¥ã€‚é•¿å¼“ä¹‹äººè¡Œå··é“ã€‚æ’åˆ—ç¬¬ä¸‰ã€‚ä¸å‡ºæ±Ÿä¸­æ•°ä¸­å®šã€‚å§“æ±Ÿæ’ç¬¬ä¸€ã€‚",
 a: "å¹³æ­¥é’äº‘ï¼Œä½è‡³ä¸‰å…¬ã€‚ç¦„å‘½å¤©ä¸Šæ¥ã€‚å£°åè¿œæ’­ã€‚",
 b: "ç”·å¥³åŒå¿ƒï¼Œå‡å®˜è¿åŠ¨ï¼Œå¾…åŠ¿è€Œå‘ï¼Œæ­¤è¡Œå¤§åˆ©ã€‚é€¢ç§‘ç”²é«˜ä¸­ï¼Œé•¿å¼“è¡Œé™©è·¯ï¼Œç»ˆå‡¶ã€‚",
 e: "å®˜äººç™»æ¢¯ï¼Œå‡å®˜ã€‚",
 f: "é›¨ä¸‹æ±Ÿæ»¡ï¼ŒèˆŸæ‰¬é£å¸†ï¼Œé¡ºé£å¤§åˆ©ä¹Ÿã€‚",
 g: "ä»™å¥³äº‘ä¸­ï¼Œæ¬£èµææ‹”ä¹‹è±¡ï¼Œå¯å©šã€‚",
 l: "æ¨è½¦ï¼Œç™»æ¢¯ï¼Œä»™å¥³äº‘ä¸­ï¼Œæ­¤ä¸ºé˜´äººåŠ©åŠ›ï¼Œè½¬å˜ä¹‹è±¡ï¼Œå¯ä¸Šã€‚",
 m: "å®˜+äºº=æ£ºï¼Œæœ¨+äºº=ä¼‘ï¼Œç—…é‡åˆ™äº¡ï¼Œå°ç—…åˆ™ä¿®å…»ä¹Ÿã€‚",
 z: "æš‚æ— ",

                             },
        23: {
            n: "å±±åœ°å‰¥",
            t: "ä¸€ã€å¦‡äººåºŠä¸Šåï¼šå¿…æœ‰æš—ç¾ï¼Œé˜´äººå¾—åŠ¿ï¼Œé˜³é“è¡°å¼±ï¼Œå°äººä¸ºä¸»å®˜ã€‚<br>äºŒã€çƒ›åœ¨é£ä¸­ï¼šé™©ä¹Ÿã€‚<br>ä¸‰ã€è‘«èŠ¦ï¼šåŒ»è¯æ— æ•‘ä¹Ÿï¼›æœ‰æš—è®¡ä¹Ÿã€‚<br>å››ã€ç¼«ä¸ï¼šäº‹åŠ¡ç¹å†—ã€‚<br>äº”ã€å±±ä¸‹å®˜äººåï¼šæœ‰é å±±ï¼Œä½†é˜´äººä¸ºç¥¸ã€‚<br>å…­ã€å† å·¾æŒ‚æœ¨ä¸Šï¼šæ±‚å»ä¹‹è±¡ï¼›åˆæœ‰ä¹ä¹‹è±¡ã€‚",
            x: "å‰¥è½ï¼Œå°äººé“é•¿ã€‚åšä¸‹å®‰å®…ã€‚<br>åˆå…­ï¼šå‰¥åºŠä»¥è¶³ï¼Œè”‘è´ï¼Œå‡¶ã€‚<br>å…­äºŒï¼šå‰¥åºŠä»¥è¾¨ï¼Œè”‘è´å‡¶ã€‚<br>å…­ä¸‰ï¼šå‰¥ä¹‹ï¼Œæ— å’ã€‚<br>å…­å››ï¼šå‰¥åºŠä»¥è‚¤ï¼Œå‡¶ã€‚<br>å…­äº”ï¼šè´¯é±¼ï¼Œä»¥å®«äººå® ï¼Œæ— ä¸åˆ©ã€‚<br>ä¸Šä¹ï¼šç¡•æœä¸é£Ÿï¼Œå›å­å¾—èˆ†ï¼Œå°äººå‰¥åºã€‚",
            d: gd('SW')+"ä¸‰å­å±…è¥¿å—ã€‚",
u:"å‰¥æœ‰è€—å°½ä¹‹è±¡ï¼Œæœ‰äººå®¶è´¢ä¸‡è´¯ï¼Œä½†å‡ºä¸€å­è€—å°½å®¶è´¢ï¼Œæ‰€è°“å¯Œä¸ è¿‡ä¸‰ä»£ï¼Œå…¶å› ä½•åœ¨ï¼Ÿæœ‰æ—¶è§ä¸‰è€äººï¼Œå±…è€äººé™¢ä¸­ï¼Œæœ¬æ˜¯å®‰å…»å¤©å¹´ä¸ ä¸–æ— äº‰ï¼Œä¸‰äººç»“æ‹œå…„å¼Ÿåï¼Œé•¿å¹¼æœ‰åºåˆ†åˆ—ï¼Œæ­¤æ—¶å¦‚å‰¥å¦ç°ï¼Œåˆ™å…¶ä¸­ ä¸€äººå¿…æ•£å°½ä¸‰äººä¹‹è´¢åŠ¡ï¼Œç»ˆè‡³å¼•å‘è‡ªæ€æˆ–ä»‡æ€äº‹ä»¶ï¼Œå…¶å› çš†ä¸ºè´¢ï¼Œ ä¸–äººä½†çŸ¥ä¸ºè´¢æ€ï¼Œå´æ°¸è¿œæ— æ³•æ·±å…¥äº†è§£ï¼Œä¸ºä½•è´ªè´¢å¦‚æ­¤ï¼Ÿä¸ºä½•å¹´è‡³ å¤ç¨€ï¼Œä»æ— æ³•æ‘†è„±è´¢åˆ©ä¹‹æƒ‘ï¼Ÿçš†ä¸çŸ¥å¦å±€ä¹‹å½±å“ï¼Œä¹ƒèƒ½æ·±å…¥äººå¿ƒï¼Œ ä½¿å½“äº‹äººèœ•å˜è€Œä¸è‡ªçŸ¥ï¼Œç»ˆè‡´æ™šèŠ‚ä¸ä¿ï¼Œå­¦è€…é¡»æˆ’ä¹‹ï¼Œä¸€æ—¦å‘ç°æ­¤å±€å·²æˆï¼Œå¿…æå°½äººäº‹ç ´åæ­¤å±€ï¼Œå…ç”Ÿå¤§å®³ï¼Œå¾’å‘¼å¥ˆä½•ï¼Ÿ ä¸€ã€å®¶æœ‰å‰¥å¦ï¼Œä¸»è€—ç ´å®¶ä¸šï¼Œä¼¦ç†ä¸§å¤±ï¼Œä¼¤é£è´¥ä¿—ã€‚ äºŒã€æ€§æ¯’æš—ç”Ÿï¼Œå®³äººè€Œäººä¸çŸ¥ã€‚ä¸‰ã€å©šäº‹ä¸æˆï¼ŒåŒæ—¶ç”Ÿäººå³ä»¤æµå¹´çº¢é¸¾æ˜ŸåŠ¨ï¼Œäº¦æ— æ³•æˆå©šã€‚ å››ã€ç§‘ç”²ä¸é¡ºï¼Œè€ƒè¯•å¿…è´¥ã€‚äº”ã€èº«ä½“ç¾ç—…å¤šï¼ŒæŠ˜æŸé˜³å¯¿ã€‚æ­¤å±€å¤§å‡¶ï¼Œå­¦è€…é¡»èƒ½äºäº‹åˆå³å¯åˆ¤è¯»å‡ºï¼Œå¿…å¯è¶‹å‰é¿å‡¶ï¼Œä¹ƒè‡³ å¤§å‰ï¼ŒåŠŸå¾·æ— é‡ï¼ŒåŒé“é¡»çŸ¥ï¼ŒåŠ©äººäºæ— å½¢ï¼Œå—åŠ©äººä¸è‡ªçŸ¥ï¼Œæ— æ³•å¯Ÿ è§‰åˆ°ä½ çš„åŠŸåŠ³ï¼Œæ­¤å…¶åŠŸå¾·ä¹Ÿï¼Œå³é˜´å¾·ã€‚ä»Šäººæå‹Ÿå–„æ¬¾ï¼Œä¸ºç©·äººæ´— è¡£ã€åšé¥­ã€åªæ˜¯é˜³å¾·ï¼Œå¹¶éçœŸåŠŸå¾·ã€‚åœ£äººæ²»ä¸–ï¼Œå¤©ä¸‹ç™¾å§“ï¼ŒåªçŸ¥å¹³ å®‰ï¼Œæ— ä¹±ï¼Œæ— æ³•æ„Ÿå—åˆ°åœ£è´¤çš„åŠŸåŠ³ï¼Œåº¸æ‰æ²»ä¸–ï¼Œå¤©ä¸‹å¤§ä¹±ï¼Œå…¶æ´¾äºº å¹³ä¹±åï¼Œäººæ°‘è§æ­¤ï¼Œå³è®¤å®šå…¶åŠŸåŠ³å¾ˆå¤§ï¼Œæ‰€ä»¥æœ¬ä¹¦ä¹‹å‡ºä¸–ï¼Œæœ‰è­¦ä¸– æ•™æ°‘ä¹‹æ— çŸ¥åŠŸæ•ˆï¼ŒåŒé“å…±å‹‰ä¹‹ã€‚",
h: "å…ˆå¤©å¦ï¼šå®¶äººç¦»ï¼Œè´¢ç¦„æ•£ã€‚ç”Ÿä¸é€¢æ—¶å¤©æ³¨å®šã€‚çˆ¶æ¯å¤±å’Œã€‚äººä¸å°‘ã€‚æ€§æƒ…å­¤åƒ»ï¼Œå¿—å–„å˜ã€‚è¡Œäº‹å–å·§ï¼Œäº‹å€åŠŸåŠã€‚åªå¯å®ˆæ ªå¾…å…”ã€‚ä¸å¯ç¼˜æœ¨æ±‚é±¼ã€‚",
 a: "é€€æ—©æ— åŠŸä»æ‹›è®¼ï¼Œé˜´äººç”Ÿå®³ä¸è‡ªçŸ¥ã€‚å°¤ä»¥å¯Œé˜´æ›´å¯æ€•ï¼ŒçŸ¥äººçŸ¥é¢ä¸çŸ¥å¿ƒã€‚å®ˆæˆä¸é€¾çŸ©ï¼Œä¸€åŠ¨è´ªå¿µå¿…æ‹›å‡¶ã€‚",
 b: "å©šäº‹ä¸æˆã€‚ç§‘ç”²ä¸ä¸­ã€‚æ„ˆç†æ„ˆä¹±ã€‚ä¹ƒå› å¥³å­å®³ã€‚å¥³ï¼šé—­é—¨é€ è½¦ï¼Œå…¶æœè‡ªé£Ÿã€‚",
 e: "æ±‚å»ä¹‹è±¡ï¼Œé£ä¸­æ®‹çƒ›ï¼Œä¸€å›¢ä¹±ä¸ï¼Œå†—æ‚äº‹åŠ¡éš¾ä»¥å¤„ç†ï¼Œå±ä¹Ÿï¼Œè¾å®˜ã€‚ä¸å‡ä¹‹è±¡ã€‚",
 f: "é£ä¸­æ®‹çƒ›ï¼Œå±é™©ä¹Ÿï¼Œä¸è¦åšäº‹ã€‚",
 g: "é£ä¸­æ®‹çƒ›ï¼Œå±é™©ä¹Ÿï¼Œé˜´äººåºŠä¸Šï¼Œæš—ç¾ä¹Ÿï¼Œä¸è¦ç»“å©šï¼Œèµ¶ç´§è·‘ã€‚",
 l: "å† å·¾æŒ‚æœ¨ä¸Šï¼Œä¸ä¸­ä¹Ÿã€‚",
 m: "é£ä¸­æ®‹çƒ›ï¼Œå±é™©ä¹Ÿï¼Œè‘«èŠ¦åœ¨åœ°ï¼Œæ— è¯æ•‘ä¹Ÿã€‚",
 z: "æš‚æ— ",

                             },
        24: {
            n: "åœ°é›·å¤",
            t: "ä¸€ã€å®˜äººä¹˜è½¦ï¼šä½¿èŠ‚ä¹Ÿï¼›è½¦å§“ã€è¿å§“ä¹Ÿï¼›å†›é˜Ÿä¹Ÿï¼›å®˜å¤§ä¹Ÿï¼›è°ƒèŒä¹Ÿã€‚<br>äºŒã€ä¸Šä¸¤åªæ——ï¼šæ–—ä¹Ÿï¼›å°†ã€å¸…ä¹Ÿï¼›ä¸€æ–¹ä¹‹ä¸»ä¹Ÿã€‚<br>ä¸‰ã€å  ä¸Šä¸œå­—ï¼šçŒ´å‘æœ¨å½¢äººã€‚ä¸œï¼šæœ‰å¿ƒçº¦æŸï¼Œåå…«æ—¥è‡³ã€‚åæ—¥æ¥äººå°ä¾¯è±¡ã€‚<br>å››ã€ä¸€å°†æŒåˆ€ç«‹ï¼šæ­¦å¨ä¹‹äººï¼Œå¸æ³•æ‰§è¡Œäººã€‚<br>äº”ã€ä¸€å…”ï¼šè‚–å…”ä¹‹äººï¼Œåˆ˜å§“ä¹‹äººã€‚<br>å…­ã€ä¸€è™ï¼šè‚–è™ä¹‹äººï¼Œç‹å§“ä¹‹äººã€‚",
            x: "ä¸€é˜³æ¥å¤ï¼Œå¾ªç¯å¾€å¤ã€‚è‡³æ—¥é—­å…³ã€‚<br>åˆä¹ï¼šä¸è¿œå¤ï¼Œæ— ç¥‡æ‚”ï¼Œå…ƒã€‚<br>å…­äºŒï¼šä¼‘å¤ï¼Œã€‚<br>å…­ä¸‰ï¼šé¢‘å¤ï¼Œå‰ï¼Œæ— å’ã€‚<br>å…­å››ï¼šä¸­è¡Œç‹¬å¤ã€‚<br>å…­äº”ï¼šæ•¦å¤ï¼Œæ— æ‚”ã€‚<br>ä¸Šå…­ï¼šè¿·å¤ï¼Œå‡¶ï¼Œæœ‰ç¾çœšï¼Œç”¨è¡Œå¸ˆï¼Œç»ˆæœ‰å¤§è´¥ï¼Œä»¥å…¶å›½å›å‡¶ï¼Œè‡³äºåå¹´ä¸å…‹å¾ã€‚",
            d: gd('E')+"æ¯å±…ä¸œã€‚",
u:"å¾äººå¸¸è§å·²å©šä¹‹å¦‡äººï¼Œå©šäº‹ä¸ä½³ï¼Œç‹¬ç«‹æ”¯æ’‘å®¶è¿ï¼Œå…æ–‡å…æ­¦ï¼Œ å±æœ¨å…°å‹ä¹‹äººï¼Œå¿…ä¸ºå¤å¦ä¹‹å±€ã€‚ä¸€ã€æœ‰å¥³èº«ç”·äººæ€§æ ¼ä¹‹å¾ã€‚äºŒã€æ­¤å¦å±€å°¤åˆ©å‘æ­¦å®˜ï¼Œå³å†›ã€è­¦ã€æ³•ã€å¤–äº¤ç­‰å·¥ä½œä¹‹äººã€‚ ä¸‰ã€ä»£å¤«å‡ºå¾ï¼Œä¸æ¯«ä¸è®©é¡»çœ‰ã€‚å››ã€æ­¤å±€å‘å®˜äººï¼Œä¸å‘å•†äººï¼Œå°¤ä»¥è‚–è™ã€å…”äººå¤§å‰ï¼Œæ›´æ—ºã€‚äº”ã€ä¸å¤«ä¹‹å¯¹åº”å±€ä¸ºæ— å¦„å¦ï¼Œæ•…å¤«å¦»å¿…ä¸å’Œï¼Œå…¶å› ä¹ƒç”Ÿäºå¦»å¿— è¿‡ä¸ˆå¤«ï¼Œä¸ˆå¤«æ— æ³•ä¸å…¶åŒ¹é…ï¼Œå±‹æ¼åé€¢è¿å¤œé›¨ï¼ŒåŠ ä¸Šå¤«æœ‰å®˜å¸æ˜¯é ç¼ èº«ï¼Œæ‰€ä»¥å¯¹å©šå§»æ¥è¯´æ˜¯åŠ å‡¶ã€‚",
h: "å¤©ç”Ÿç¥æ­¦ï¼Œå¥½å‹‡ä¹‹äººã€‚å¥³äººé€¢ä¹‹ï¼Œä¸ºè‹±é›Œã€‚è™å…”ä¹‹äººåŒ–ä¸ºå°†ã€‚æ‰‹æ¡ç”Ÿæ€ä¹‹æƒã€‚çŒ´å‘ä¸œè¡Œå‡ºå¤–åœ°ã€‚ä¸€çˆ¶åŒæ¯ï¼Œç’ç‰ä¸ç›¸è¯†ã€‚æ·˜æ²™å§‹è§é‡‘ã€‚",
 a: "å®˜çˆµæ˜¾è€€ï¼Œå‘çŒ´è™å…”ï¼ˆè™å¯å§“ç‹ï¼Œå…”å¯å§“åˆ˜ï¼ŒçŒ´å¯å§“ä¾¯ï¼‰ã€‚ä¸€äººä¸¤å¦»ï¼Œåå¤å¾€æ¥ï¼Œé€¢åˆ˜é€¢å®‹é­é‡é˜»ã€‚è¿å¾€ä»–å¤„å¯å¹³å®‰ã€‚",
 b: "è¡Œå¹´è‡³æ­¤ï¼Œå‡å°†å®˜ã€‚æœ¨å½¢è‚–çŒ´äººæˆæ ¼ï¼ŒåŒ–å°†ã€‚ä¸æˆæ ¼è€…å‡ä¸Šæ ¡ï¼Œä¸å‡å°†ã€‚å†é‡è™å…”å¯…å¯å¹´ï¼Œå¿…å¯å¤èŒä»»å¤§ä½¿ã€‚",
 e: "ä¸œå­—å€™ï¼Œåå…«æ—¥æ¥äººå°å®˜ï¼Œå‡ã€‚å°¤åˆ©è™ï¼Œå…”ç­‰æ­¦å°†ã€‚",
 f: "è™ã€å…”ï¼Œé€¢è™å…”ç”Ÿè‚–æˆ–è€…å¹´é™æ—¶é—´å¯åšï¼Œæˆ–è€…å§“åˆ˜ç‹å¯åšã€‚",
 g: "é€¢è™å…”ç”Ÿè‚–æˆ–è€…å¹´é™æ—¶é—´å¯æˆï¼Œæˆ–è€…å§“åˆ˜ç‹å¯æˆã€‚",
 l: "è™å…”ç”Ÿè‚–æˆ–è€…å¹´é™æ—¶é—´å¯æˆï¼Œæˆ–è€…å§“åˆ˜ç‹å¯æˆã€‚",
 m: "è™å…”ç”Ÿè‚–æˆ–è€…å¹´é™æ—¶é—´å¯å¥½ï¼Œæˆ–è€…å§“åˆ˜ç‹å¯å¥½ã€‚å¾—å¤ä¹‹æ—¶æ˜“æœ‰è½»åº¦å¥½è½¬ï¼Œéœ€æ³¨æ„åç»­å˜åŒ–ã€‚",
 z: "æš‚æ— ",

                             },

        25: {
            n: "å¤©é›·æ— å¦„",
            t: "ä¸€ã€å®˜äººå°„é¹¿ï¼šè‡ªä¹±é˜µè„šã€‚<br>äºŒã€é¹¿å•£æ–‡ä¹¦ï¼šè´¢è®¯è‡³ä¹Ÿã€‚<br>ä¸‰ã€é’±ä¸€å †åœ¨æ°´ä¸­ï¼šå¾—è´¢é‡é™©ä¹‹è±¡ã€‚é™©ä¸­æ±‚è´¢ï¼Œå¿§å¿ƒå¿¡å¿¡ä¹Ÿã€‚<br>å››ã€ä¸€é¼ ä¸€çŒªï¼šé‡å­ã€äº¥å¹´å‰ï¼Œè‚–é¼ äººé˜´è°‹ï¼Œè‚–çŒªäººé»‘å¿ƒã€‚",
            x: "ä¸å¦„ä¸ºï¼Œæ„å¤–ä¹‹ç¾ã€‚èŒ‚å¯¹æ—¶è‚²ä¸‡ç‰©ã€‚<br>åˆä¹ï¼šæ— å¦„ï¼Œå¾€ã€‚<br>å…­äºŒï¼šä¸è€•è·ï¼Œä¸è‘ç•¬ï¼Œåˆ™åˆ©æœ‰æ”¸å¾€ã€‚<br>å…­ä¸‰ï¼šæ— å¦„ä¹‹ç¾ï¼Œæˆ–ç³»ä¹‹ç‰›ï¼Œè¡Œäººä¹‹å¾—ï¼Œé‚‘äººä¹‹ç¾ã€‚<br>ä¹å››ï¼šå¯è´ï¼Œæ— å’ã€‚<br>ä¹äº”ï¼šæ— äº¡ä¹‹ç–¾ï¼Œå‹¿è¯æœ‰å–œã€‚<br>ä¸Šä¹ï¼šæ— å¦„ï¼Œè¡Œæœ‰çœšï¼Œæ— æ”¸åˆ©ã€‚",
            d: gd('E')+"çˆ¶å±…ä¸œã€‚",
u:"æ­¤åæ— å¦„ï¼ŒçŠ¹æ— å¦„ä¹‹ç¾æ„ï¼Œå±…æ­¤å±€ä¹‹ä¸ˆå¤«æˆæ­¤æ ¼ï¼Œå³ä»¤å·²ç¦»å©š ä½†æœ‰å­å¥³åŒä½ï¼Œåªè¦è±¡å­˜åœ¨ï¼Œå…¶å±€ä¸å˜ã€‚é¡»æ³¨æ„æ­¤ç‚¹ã€‚ä¸€ã€å¿…é¡»ä¸ºä»å•†è¾ƒå‰ï¼Œä½†é¡»é˜²é˜´äººæš—å®¢ï¼Œæœ‰å¾—è´¢é‡é™©ä¹‹è±¡ï¼Œè‚– çŒªè‚–é¼ äººæˆæ ¼ï¼Œä¸»å¤§è´¢å…¥ï¼Œä½†çš†æœ‰é˜´è°‹å…¶ä¸­ã€‚äºŒã€å¦‚ä¸ºå…¬èŒäººï¼Œåˆ™æ˜“æµäºåˆ©æ¬²è€ŒæŒºèº«èµ°é™©ã€‚ä¸‰ã€æ±‚è´¢æ‹›é™©äº‹ï¼Œä½æ»¡ç¬¬äºŒå¹´ï¼Œå±€å†ä¸åŠ¨ï¼Œå¿…è§ä¹‹ã€‚ å››ã€æ€§åˆšå›ºæ‰§ï¼Œä¸å¬äººè¨€ï¼Œæ•…ç”Ÿå°äººï¼Œè‡ªä¹±é˜µè„šã€‚äº”ã€é ˆé˜²å­ç½ï¼Œæ•…åŒæ™‚ç”Ÿäººï¼Œæœ‰äººç„¡å­ï¼Œæœ‰äººæœ‰å­ï¼Œä½†ä¸»å¤­æŠ˜ æˆ–å›é€†ï¼Œæ­¤å…¶çœŸå› ä¹Ÿã€‚å› å¼·ä½é•·å­ä½ï¼Œè‡´ä»¤é•·å­ç„¡å®®ä½ï¼Œæ•…ç”Ÿç¦å®³ã€‚",
h: "è‚–é¼ è‚–çŒªé¡»é˜²ã€‚åŒå¤§å®¶ä¸šåˆ†ä¸œè¥¿ã€‚ä¸ªæ€§åˆšæ–­ç”¨äº‹ï¼Œåšäº‹æœå†³ã€‚é™©ç§æ±‚è´¢ã€‚å•†äººåˆä¼™ï¼Œé˜²é™·ã€‚æœ‰å¤§ç¦„è‡³ï¼Œé¡»æˆ’ç››ã€‚",
 a: "çŒªå¹´äººè¿›ç¦„ä¸ºå¤©æ•°ï¼ˆçŒªå¹´ï¼Œæˆ–çŒªäººï¼‰ã€‚å°‘ç¼ºä¸€åŠï¼Œé˜´äººæœ‰è°‹ç•¥ã€‚åšäº‹ä¸æŠ±ä¾¥å¹¸ï¼Œå¯è„±é™©ã€‚å¯å‘Šä¹‹æ›°ï¼šç•™å¾—é’å±±åœ¨ï¼Œä¸æ€•æ²¡æŸ´çƒ§ã€‚",
 b: "é™©ä¸­æ±‚è´¢ã€‚å¾—è´¢æœ‰åŠã€‚è‡ªä¹±é˜µè„šã€‚é˜²çªƒã€‚å¿§å¿ƒçˆ¶ç—…ã€‚",
 e: "æ–‡å®˜è´ªæ±¡ï¼Œä¸å‡æˆ–è€…å—åˆ°å®˜å¸å›°æ‰°ã€‚å…¶ä½™å‡ã€‚",
 f: "å®˜äººå°„é¹¿ï¼Œå¾—è´¢ï¼Œè´¢è¢«åˆ†èµ°ä¸€åŠã€‚",
 g: "å¯æˆï¼Œä½†è¦å°å¿ƒç®—è®¡é’±è´¢ç­‰ã€‚",
 l: "é¹¿è¡”æ–‡ä¹¦ï¼Œé«˜ä¸­ã€‚",
 m: "é’±è´¢æ°´ä¸­ï¼Œä¸§è±¡ï¼Œå°¤å…¶æ˜¯å­©å­ã€‚",
 z: "æš‚æ— ",

                             },

        26: {
            n: "å±±å¤©å¤§ç•œ",
            t: "ä¸€ã€ä¸€é¹¿ä¸€é©¬ï¼šç¦„é©¬äº¤é©°ï¼Œå¤§å¯Œä¹‹è±¡ã€‚<br>äºŒã€æœˆä¸‹æœ‰æ–‡ä¹¦ï¼šæ˜è€Œæœ‰å¾€ï¼Œä¸­ç§‹æ—¶èŠ‚ï¼Œæ–‡ä¹¦åœ¨ç©ºä¸­å°šæœªåˆ°æ‰‹ã€‚<br>ä¸‰ã€å®˜äººå‡­æ ï¼šæ— äº‹çŠ¶ï¼Œé¥æœ›æ‰€å¤±ä¹‹å›½åº¦ã€‚åˆæ ä¸ºæœ¨ï¼Œäººé æœ¨ï¼Œä¼‘ä¹Ÿã€‚æ£ºä¹Ÿã€‚<br>å››ã€èŠ±åœ¨ç›†ä¸­ï¼šæœ‰é™ä¹Ÿã€‚",
            x: "å¤§ç§¯è“„ï¼Œåˆ©æ¶‰å¤§å·ã€‚å¤šè¯†å‰è¨€å¾€è¡Œã€‚<br>åˆä¹ï¼šæœ‰å‰ï¼Œåˆ©å·±ã€‚<br>ä¹äºŒï¼šèˆ†è¯´è¼¹ã€‚<br>ä¹ä¸‰ï¼šè‰¯é©¬é€ï¼Œåˆ©è‰°è´ï¼Œæ›°é—²èˆ†å«ï¼Œåˆ©æœ‰æ”¸å¾€ã€‚<br>å…­å››ï¼šç«¥ç‰›ä¹‹ç‰¿ï¼Œå…ƒã€‚<br>å…­äº”ï¼šè±¶è±•ä¹‹ç‰™ï¼Œã€‚<br>ä¸Šä¹ï¼šä½•å¤©ä¹‹è¡¢ï¼Œäº¨ã€‚",
            d: gd('NW')+"ä¸‰å­å±…è¥¿åŒ—ã€‚",
u:"å›ä¸è§æœ‰å­ä¸ºå®¶ä¸é¡¾ä¸€åˆ‡çš„å·¥ä½œï¼Œå¤„å¤„ä¸ºå®¶ç€æƒ³ï¼Œç”šè‡³æ”¾å¼ƒå©šäº‹äº¦åœ¨æ‰€ä¸æƒœï¼Œå›ºç„¶æ­¤è±¡ä¸ä¸€å®šåœ¨ä¸‰å­èº«ä¸Šå‘ç”Ÿï¼Œä½†å¤§ç•œå¦å¿…ç°äº ä¸‰å­èº«ä¸Šã€‚ä¸€ã€ä»£çˆ¶ä¹‹èŒå®ˆï¼Œè´Ÿæ‹…ä¸€å®¶ä¹‹ç”Ÿè®¡ã€‚äºŒã€èŠ‚ä¿­è‡³çŸ£ï¼Œç»ä¸æ‹›å¾…èŠ±é’±ä¹°å¥¢ä¾ˆå“ï¼Œæ•…é¢‡æœ‰ç§¯è“„ã€‚ä¸‰ã€æœ‰å©šä¹ŸçŸ­æš‚ï¼Œå¿…ä¸è¶³ä¸‰æœˆè€Œç ´ï¼Œæ¯”åŒæ—¶ç”Ÿäººæå‰äºŒå¹´ç»“å©šã€‚å››ã€æ­¤å±€ä¸åˆ©å…¬èŒå‘å±•ï¼Œå¿…å›°äºå·¥ä½œï¼Œå †ç§¯å…¬æ–‡å¦‚å±±ã€‚äººè¨€æœ‰ç§¯ä¹ƒå¤§ï¼Œè¯šä¸æ¬ºäººä¹Ÿï¼Œè®¸å¤šäººåœ¨å©šå‰æå°½èŠ‚ä¿­ï¼Œå¾€å¾€å©š åæ— æ³•å¿å—å¦»å­ä¹‹å¥¢ä¾ˆæµªè´¹ï¼Œç»ˆè‡´ç¦»å©šï¼Œæ•…ç§¯çš„è§‚å¿µäº§ç”Ÿåœ¨è‡ªå·±èº« ä¸Šè€Œä¸è‡ªè§‰ï¼Œä¹ƒè‡´å©šåï¼Œç¡¬è¦åŠ è¯¸äºå¯¹æ–¹èº«ä¸Šï¼Œçµ‚æ–¼ç ´è£‚ï¼Œå¾äººç•¶ æ–¼å§‹æ™‚ï¼Œå³å·²å¯Ÿè¦ºçŸ¥æ›‰ï¼Œæ–¹ä¸æ„§ç‚ºç¿’æ˜“ä¹‹äººã€‚",
h: "ç”Ÿæ¥æ³¨å®šå¯Œè´µäººã€‚çº¢æ¥¼ä¹‹ä¸­æœ‰ç§‘åã€‚é©¬äººå¤§å‰ã€‚æ±‚å®˜ä¸åˆ©ã€‚æ±‚è´¢å‰ã€‚ç»è¥äº¤æ˜“ï¼Œä¸€ç”Ÿå¯Œè¶³ã€‚",
 a: "ä¼‘è¾å®˜ä½ï¼Œä¸“å¿ƒä»å•†ã€‚å¾—ç¥–ä¸šï¼Œä½†å®ˆæˆä¸æ˜“ã€‚ç”·é˜²æ¡ƒèŠ±ï¼Œç„¶æœå¿…çŠ¯ã€‚è´¢ç¦„å¯Œè¶³ä¸€ç”Ÿã€‚",
 b: "é¥æœ›å›½åœŸæ€æ•…ä¹¡ï¼Œèº«åœ¨å¼‚ä¹¡ä¸ºå¼‚å®¢ã€‚è´¢ç¦„å…´æ—ºï¼Œç¦„é©¬äº¤é©°ï¼Œæ»šæ»šè€Œæ¥ã€‚æ–‡ä¹¦è‡³ã€‚å¤©æœºï¼šå¿…åº¦åŠ¿è€Œè¿›ï¼Œè«è¦çŒ›èºè€Œè¿›ã€‚çœ‹åŠ¿è€Œè¿›ï¼Œä¸å¯é€€ï¼Œä¸å¯çŠ¯ç¾è€Œè¡Œã€‚å®˜äººé€¢ä¹‹ï¼Œè´ªç¦„ä¼‘å®˜ã€‚",
 e: "æ–‡ä¹¦ç©ºä¸­ï¼Œå¯å‡ä¹Ÿã€‚è´ªå›¾è´¢ç¦„ä¼šå¯¼è‡´å®˜ä¸å‡ã€‚",
 f: "ä¸€é¹¿ï¼Œä¸€é©¬ã€‚å¤§åˆ©ã€‚å¤§å‘é©¬äººã€‚",
 g: "æ–‡ä¹¦åœ¨ç©ºä¸­ï¼Œæˆä¹Ÿã€‚",
 l: "æ–‡ä¹¦åœ¨ç©ºä¸­ï¼Œå¯ä¸­ã€‚",
 m: "å®˜äººå‡­æ ï¼Œå®˜+äºº=æ£ºï¼Œäºº+æœ¨=ä¼‘ï¼Œé‡ç—…åˆ™ä¼‘ã€‚",
 z: "æš‚æ— ",

                             },

        27: {
            n: "å±±é›·é¢",
            t: "ä¸€ã€é›¨ä¸‹ï¼šå—æ©æ³½ä¹Ÿã€‚<br>äºŒã€ä¸‰å°å„¿ï¼šä¹ƒåˆå¿ƒä¹‹è±¡ï¼Œæœ‰å¾·ä¹‹å›½ä¹Ÿã€‚<br>ä¸‰ã€æ—¥å½“å¤©ï¼šå›æ˜ä¹‹è±¡ã€‚çˆ¶å…¨ã€‚<br>å››ã€é¦™æ¡ˆï¼šæ±‚å–ä¹‹è±¡ã€‚<br>äº”ã€é‡‘ç´«å®˜äººï¼šå¤©å­èº«ä¾§ä¹‹äººã€‚",
            x: "é¢å…»ï¼Œç—…ä»å£å…¥ã€‚æ…è¨€è¯­èŠ‚é¥®é£Ÿã€‚<br>åˆä¹ï¼šèˆå°”çµé¾Ÿï¼Œè§‚æˆ‘æœµé¢ï¼Œå‡¶ã€‚<br>å…­äºŒï¼šé¡šé¢ï¼Œæ‹‚ç»ï¼Œäºä¸˜é¢ï¼Œå¾å‡¶ã€‚<br>å…­ä¸‰ï¼šæ‹‚é¢ï¼Œè´å‡¶ï¼Œåå¹´å‹¿ç”¨ï¼Œæ— æ”¸åˆ©ã€‚<br>å…­å››ï¼šé¡šé¢ï¼Œï¼Œè™è§†çœˆçœˆï¼Œå…¶æ¬²é€é€ï¼Œæ— å’ã€‚<br>å…­äº”ï¼šæ‹‚ç»ï¼Œå±…è´ï¼Œä¸å¯æ¶‰å¤§å·ã€‚<br>ä¸Šä¹ï¼šç”±é¢ï¼Œå‰ï¼Œåˆ©æ¶‰å¤§å·ã€‚",
            d: gd('E')+"ä¸‰å­å±…ä¸œã€‚",
u:"é¢æœ‰é¥®é£Ÿå…»èº«ä¹‹æ„ï¼Œå¦‚ä½•å…»äººï¼Ÿå¦‚ä½•å…»æ­£ï¼Ÿå¦‚ä½•çŸ¥å…»ä¹‹æ­£ç¡®ä¸ å¦ï¼Ÿä½•æ—¶å¯å…»ï¼Ÿè¿™äº›é›¶ç¢å¤æ‚çš„é—®é¢˜ï¼Œå¦‚è¦ä¸€ä¸€è§£é‡Šï¼Œä¸ä¸€å®šå…¨éƒ¨ éƒ½èƒ½çŸ¥é“äº†è§£ï¼Œå…«å¦ä¹‹å…¥å®…å˜å±€ï¼Œå°±æ˜¯å–è‡ªç„¶é¢å…»ä¹‹é“ï¼Œä½¿èŒç”Ÿä¹‹ å§‹å¿µï¼Œç”±å·±ä¹‹æ‰€éœ€è¦ï¼Œäººä¹‹æ€§åœ¨å…¶è®¤ä¸ºæéœ€è¦ä¹‹æ—¶ï¼Œä½ æä¾›æ‰€éœ€æ–¹ å¯çœŸæ­£å—ç”¨ï¼Œå¦‚æœä»–æœ¬èº«ä¸æƒ³è¦ï¼Œå³ä»¤æ˜¯ä½ çš„äº²äººä¹Ÿæ— æ³•æ”¹å˜ä»–ï¼Œ åªé€ æˆçƒ­è„¸è´´åˆ°å†·å±è‚¡çš„ç»“æœã€‚æ•…å¾äººèƒ½å‚é€æ˜“ç»ï¼Œç”¨é˜³å®…æ–¹å¼ï¼Œ è‡ªç„¶è€Œç„¶çš„å¤§å¹…æ”¹å˜ï¼Œå…¶æœ¬äººè€Œä¸è‡ªçŸ¥ï¼Œç›¸ä¿¡æ˜¯æœ€æœ‰æ•ˆçš„æ–¹æ³•ã€‚æ­¤ å¦ç°åˆ™å¯è§ï¼šä¸€ã€å°‘å¹´å¾—å¿—ï¼Œæ—©æ¥å…´å‘ä¹‹è±¡ã€‚äºŒã€èº«ä½“å¥åº·å¹³å®‰ï¼Œæ•…åŒæ—¶ç”Ÿäººå¦‚èº«ä½“å·®ï¼Œå¾äººå¯åˆ©ç”¨æ­¤å±€æ¥ åŒ–è§£ï¼ŒååŠ©ä»–å¸å–è‡ªç„¶ä¹‹ç²¾åï¼Œå¹¶èƒ½åŒ…å«å…¶æƒ…ç»ªåœ¨å†…ã€‚ä¸‰ã€å©šå§»å½“è¾ƒåŒæ—¶ç”Ÿäººæå‰äº”å¹´ï¼Œæœ‰æ—©å©šä¹‹å€¾å‘ã€‚å››ã€å¦‚ä¸ç»å¾åŒé“ä¹‹äººæŒ‡ç‚¹ï¼ˆå±æ˜“æ´¾è±¡æœ¯å®—ï¼‰ï¼Œè‡ªç„¶å±…æ­¤ï¼Œæœ‰ æ—¶ç”šè‡³äºä¸ºå…¶ä»–é£æ°´åœ°ç†å¸ˆæ‰€æ”¹ï¼Œçš†ä¸»åŒçˆ¶å¼‚æ¯ä¹‹äººï¼Œåè§‚ä¹‹ï¼Œä¸º åŒçˆ¶å¼‚æ¯ä¹‹äººï¼Œå´å±…æ­¤å±€ä¸­ï¼Œå±¡è§ä¸é²œã€‚",
h: "ç”Ÿåˆ™ä»çˆ¶ï¼Œæ¯æœ‰å‡¶ã€‚å¦»ä¸€å­ï¼Œå¦¾äºŒå­ã€‚å°‘å—å°ç¦„ï¼Œæ‰è‰ºé«˜ã€‚ä¸€ç”Ÿä»äº‹æ­£å®˜å¸¦ï¼Œæ±‚å®˜å¾—å®˜ã€‚å¾—çˆ¶è«ã€‚å…„å¼Ÿé½å¿ƒï¼Œç›¸äº’å‘¼åº”ã€‚å®˜å‘é•¿æˆ¿ï¼Œä½™å‘ç¦„ã€‚å°¤å…¶å‡ºç›–å¤´ä¸äººï¼Œæ—¥æ˜æ˜å¾·ã€‚",
 a: "å¾—ä¼—æœ›ï¼Œå—å¤©å­ç¦„å‘½ï¼Œæ°‘é€‰å‰ã€‚å¹³æ­¥é’äº‘è¿‘å¤©å­ä¾§ã€‚ä½åˆ—ä¸‰å°ã€‚",
 b: "çˆ¶å‰ï¼Œæ¯å‡¶ã€‚æ­¤å¹´é€¢è´µä¸Šé’äº‘ã€‚æ±‚è´¢å¹³å®‰æ±‚å®˜å¤§åˆ©ã€‚å©šäº‹å¿…æˆã€‚",
 e: "é‡‘ç´«å®˜äººå¼•èï¼Œå‡å®˜ä¹‹è±¡ã€‚",
 f: "é›¨ä¸‹ï¼Œæ¶¦æ³½ä¹Ÿï¼Œæœ‰åˆ©ï¼Œå¯åšã€‚",
 g: "ä¸‰å°å„¿ï¼Œå’Œåˆä¹‹è±¡ï¼Œå¯æˆã€‚",
 l: "ä¸‰å°å„¿ï¼Œé‡‘ç´«å®˜äººå¼•èï¼Œæ±‚å–ä¹‹è±¡ï¼Œå¯ä¸Šã€‚",
 m: "æ—¥å½“å¤©ï¼Œç¥­æ‹œï¼Œå¥³æ€§å¥åº·å ªå¿§ï¼Œç”šé˜²å¿ƒè„ç—…ã€‚",
 z: "æš‚æ— ",

                             },
        28: {
            n: "æ³½é£å¤§è¿‡",
            t: "ä¸€ã€å®˜äººä¹˜è½¦ä¸Šæ’ä¸¤æ——ï¼šè½¦è‡³å®˜æ¥ï¼Œå¿…æœ‰å®˜å¸è¯‰è®¼ï¼Œå†›äººè±¡ã€‚<br>äºŒã€æ——ä¸Šæœ‰å–œå­—ä¸”åˆ†å¼€ï¼Œä¹ƒå–œæœ‰ç ´æŸè±¡ï¼Œèˆå»å©šå§»è±¡ã€‚<br>ä¸‰ã€å…¥æœ±æ–—ï¼šä¹ƒè±ªé—¨ä¸–å®¶ç›¸è¯·ï¼Œæˆ–æœ±å§“äººã€‚<br>å››ã€é—¨å¤–è´µäººç«‹ï¼šè¢«å¼ƒäºå¤–è±¡ã€‚<br>äº”ã€æ–‡ä¹¦åœ¨åœ°ï¼šåˆçº¦ï¼Œå¥‘çº¦ï¼Œä¸æˆä¹‹è±¡ã€‚<br>å…­ã€ä¸€åˆå­ï¼šå…ˆæˆåç ´ä¹‹è±¡ã€‚",
            x: "æ ‹æ¡¡ï¼Œå‹åŠ›å¤§ã€‚ç‹¬ç«‹ä¸æƒ§ã€‚<br>åˆå…­ï¼šè—‰ç”¨ç™½èŒ…ï¼Œæ— å’ã€‚<br>ä¹äºŒï¼šæ¯é˜³ç”Ÿç¨Šï¼Œè€å¤«å¾—å…¶å¥³å¦»ï¼Œæ— ä¸åˆ©ã€‚<br>ä¹ä¸‰ï¼šæ ‹æ¡¡ï¼Œå‡¶ã€‚<br>ä¹å››ï¼šæ ‹éš†ï¼Œ ï¼Œæœ‰å®ƒåã€‚<br>ä¹äº”ï¼šæ¯æ¨ç”Ÿåï¼Œè€å¦‡å¾—å…¶å£«å¤«ï¼Œæ— å’æ— èª‰ã€‚<br>ä¸Šå…­ï¼šè¿‡æ¶‰ç­é¡¶ï¼Œå‡¶ï¼Œæ— å’ã€‚",
            d: gd('SE')+"ä¸‰å¥³å±…ä¸œå—ã€‚",
u:"å¤§è¿‡ä¹‹å¦ï¼Œäºäººäº‹ä¸Šåˆ†äºŒè§£ï¼Œä¸€ä¸ºçŠ¯ä¸‹å¤§è¿‡ï¼ŒäºŒä¸ºç«‹ä¸‹å¤§è¿‡äº å¸¸äººä¹‹åŠŸã€‚åœ°è„‰é“æ¯”è¾ƒåç‹­ï¼Œå¾€å¾€è§åˆ°å°å¦¹æœ€æ—©å«äººï¼Œä¹Ÿå«çš„æœ€ å¥½ï¼Œå¿…ä¸ºæ­¤å¦ã€‚è‡³äºä½•æ—¶ä¸ºå¤§è¿‡ï¼Œå¦‚ä½•ç”¨å¤§è¿‡ä¹‹é“ï¼Œå…¶è¿›é€€ä¹‹æœºï¼Œ è¯»è€…å¯å‚çœ‹äººé—´é“éƒ¨ä»½ï¼Œæ­¤ä¸è¯¦è¿°ã€‚ä¸€ã€æ¯”åŒæ—¶ç”Ÿäººæ—©å©šä¸‰å¹´ï¼Œä¸”å«å¤«æœ‰é•¿åå²ä»¥ä¸Šä¹‹çŠ¶å†µã€‚ äºŒã€èº«è¿›è±ªé—¨ä¸–å®¶ï¼Œäº«å°½è£åå¯Œè´µã€‚ä¸‰ã€æ€§è¿‡åˆšï¼Œä»»æ„è€Œä¸ºï¼Œå©šå‰å©šåéƒ½ä¸€æ ·ã€‚å››ã€å¦‚å©šä¹‹å¯¹è±¡ï¼Œå¹´çºªç›¸è¿‘ï¼Œå¿…ä¸»å‡¶ï¼Œæ˜“ç ´ã€‚",
h: "åŒ—äººå—ç›¸ä¸»å¤§è´µï¼Œä¸€äººä¸¤æ¯ä¸ºå®šæ•°ã€‚å—äººåŒ—ç›¸ä¸»å¤§å¯Œï¼Œå§å¦¹å…±äº‹ä¸€å¤«ã€‚å…«ç‰›ä¹‹äººç»ˆæˆç©ºã€‚å…«ç‰›ï¼ˆå¦‚æœ±ï¼‰äººï¼Œå…ˆå®˜åå•†å¤§å‰ã€‚å¤–æŸ”å†…åˆšï¼Œä»å¿ƒä¹‹äººã€‚",
 a: "æœ‰æ ‹æ¢ä¹‹æ‰ã€‚æ— ç§‘ç”²ä¹‹æ—¶ã€‚å—äººé‡ç”¨ï¼Œå¤„äº‹ä¸çœŸï¼Œä¸å¤Ÿåšå¿ƒã€‚å©šäº‹æœ‰ç ´ï¼Œä¸çŸ¥å–èˆã€‚",
 b: "å®˜å¸æœ‰è®¼ï¼Œå©šäº‹ä¸æˆã€‚å½“å®˜å…ˆæˆåç ´ã€‚å¥³å‘½é€¢ä¹‹ï¼Œå«å…¥è±ªé—¨ã€‚",
 e: "æ–‡ä¹¦åœ¨åœ°ï¼Œä¸å‡ï¼Œæœ‰å®˜å¸ã€‚",
 f: "æ–‡ä¹¦åœ¨åœ°ï¼Œä¸æˆä¹‹è±¡ã€‚",
 g: "æ–‡ä¹¦åœ¨åœ°ï¼Œä¸€ç›’å­ï¼Œä¸æˆï¼Œå³ä½¿æˆä¹Ÿä¼šç¦»å©šï¼Œç”šé˜²ç¦»å©šã€‚",
 l: "æ–‡ä¹¦åœ¨åœ°ï¼Œä¸ä¸­ã€‚",
 m: "æ–‡ä¹¦åœ¨åœ°ï¼Œçƒ§çº¸ä¹‹è±¡ï¼Œä¸§äº‹ï¼Œé‡ç—…å‡¶ã€‚",
 z: "æš‚æ— ",

                             },
        29: {
            n: "åä¸ºæ°´",
            t: "ä¸€ã€äººåœ¨äº•ä¸­ï¼šå®˜å¸ï¼Œç‰¢ç‹±ï¼Œé™·å…¥é™©åœ°è±¡ã€‚<br>äºŒã€äººç”¨ç»³å¼•å‡ºï¼šè´£äººå‡ºæ‰‹ç›¸æ•‘çŠ¶ã€‚<br>ä¸‰ã€ä¸€ç‰›ï¼šåŠ³è‹¦ä¹Ÿï¼Œæ˜¥å¤å‡¶ï¼Œç§‹å†¬å‰ï¼Œäº¦è‚–ç‰›äººã€‚<br>å››ã€ä¸€é¼ ï¼šè‚–é¼ äººï¼Œé˜´è°‹æš—å®³è€…ï¼Œæš—è—ä¹Ÿã€‚<br>äº”ã€äººèº«è™å¤´ï¼šæœ‰æƒå¨ä¹‹äººï¼Œè´µäººä¹Ÿã€‚",
            x: "é‡é™©ï¼Œä¹ åã€‚è¡Œé™©è€Œé¡ºã€‚<br>åˆå…­ï¼šä¹ åï¼Œå…¥äºåçªï¼Œå‡¶ã€‚<br>ä¹äºŒï¼šåæœ‰é™©ï¼Œæ±‚å°å¾—ã€‚<br>å…­ä¸‰ï¼šæ¥ä¹‹ååï¼Œé™©ä¸”æ•ï¼Œå…¥äºåå¯Œï¼Œå‹¿ç”¨ã€‚<br>å…­å››ï¼šæ¨½é…’ï¼Œç°‹è´°ï¼Œç”¨ç¼¶ï¼Œçº³çº¦è‡ªç‰–ï¼Œç»ˆæ— å’ã€‚<br>ä¹äº”ï¼šåä¸ç›ˆï¼Œè¡¹ã€‚æ—¢å¹³ï¼Œæ— å’ã€‚<br>ä¸Šå…­ï¼šç³»ç”¨å¾½çº†ï¼Œå¯˜äºä¸›æ£˜ï¼Œä¸‰å²ä¸å¾—ï¼Œå‡¶ã€‚",
            d: gd('N')+"æ¬¡å­å±…åŒ—ã€‚",
u:"æœ¬åå¦æœ‰é™©ä¹‹è±¡ä¸€ã€å„¿å­å–œæ¬¢å†’é™©ï¼Œè¯¸å¦‚èµŒåšã€æ¯’å“ç­‰ä¸¾å‡¡æƒŠé™©åˆºæ¿€éƒ½æœ‰å…´è¶£ã€‚äºŒã€å”¯è‚–è™ï¼Œè‚–ç‰›äººä½å‰ã€‚ä¸‰ã€å¦‚æ­¤å­è‚–é¼ ï¼Œåˆæˆæ­¤å±€ï¼Œåˆ™æš—ä¸­ç”Ÿå®³ï¼Œä¸ºç¥¸å®¶äººï¼Œæ¯äº²å¿… é¦–å½“å…¶å†²ã€‚å››ã€å©šå§»è¾ƒåŒæ—¶ç”Ÿäººï¼Œå»¶åäºŒå¹´ã€‚äº”ã€æ­¤æ ¼ä¹‹äººï¼Œå¸¸çŠ¯å®˜å¸ï¼Œç‰¢ç‹±ä¹‹ç¾ã€‚è§£æ­¤å±€æƒŸæ°´ç«æ—¢æµå¦å¯æˆï¼Œå¯ä»¤å…¶è„±èƒæ¢éª¨ã€‚",
h: "é‡é™©ã€‚å‡ºå…¥è‰°é™©ï¼Œç¥¸å®³æš—ç”Ÿï¼Œå¤„é™©ä¹ƒä¸æ­¢ã€‚ç‰¢ç‹±å®˜å¸éš¾é€ƒã€‚ä¸åšå®˜äººçˆµç¦„æ˜¾ï¼Œåªåœ¨ç»¿æ—ç§°è‹±é›„ã€‚å¤–åœ°å‰ã€‚è¿å‘è¥¿æ–¹ï¼Œå¤©æœºï¼šé€¢ç‰›é€¢é¼ å¯å¾—åŠ©ï¼Œè´µäººä¸ºä¸€å¤§å¤´äººã€‚",
 a: "ç‰¢ç‹±ä¹‹ç¾éš¾å…ï¼Œå¤±å´å®¶äººåˆè¡Œé™©ã€‚ä»»åŠ³ä»»è‹¦æ€¨å°¤ï¼Œå®‰åˆ†å®ˆå·±å¯å¹³å®‰ã€‚è™å¤´äººå¯è„±é™©ï¼Œç‰›é¼ äººå¿…é™·ã€‚",
 b: "å¿…æœ‰å®˜è®¼ã€‚ç‰¢ç‹±ç¾ã€‚ç§‹å†¬å‰ï¼Œæ˜¥å¤å‡¶ã€‚é¼ æœ‰ä¼¤ï¼Œç‰›å¹³å®‰ã€‚è™äººé€¢ä¹‹åå‰ï¼ˆè‚–è™ï¼Œé•¿ä¼¼è€è™ï¼Œå§“ç‹ä»¥å¤–ï¼Œè¿˜æœ‰å¸æ³•å®˜ï¼Œå¾‹å¸ˆï¼Œæ­¤ç§äººåå‰ï¼Œä¹ƒå› å…¶æœ¬ä¸»å®˜å¸è¯‰è®¼ï¼‰ã€‚å…¶ä½™ä¹ç”Ÿè‚–äººæœ‰å¤§é™ä¹‹è™ï¼Œé‡é™©ä¹Ÿã€‚ä¸åŠ¨å¯å¹³å®‰ã€‚",
 e: "äººåœ¨äº•ä¸­ï¼Œæ•²å“è­¦é’Ÿï¼Œé­è¯¬é™·ï¼Œå®˜å¸ï¼Œçº çº·ã€‚ä¸å‡åé™ã€‚è™å¹´æœˆæ—¶è™ç‹äººå¹³å®‰æ— ç¾ã€‚",
 f: "äººåœ¨äº•ä¸­ï¼Œé‡é™©ä¹Ÿã€‚",
 g: "äººåœ¨äº•ä¸­ï¼Œé‡é™©ä¹Ÿã€‚",
 l: "äººåœ¨äº•ä¸­ï¼Œä¸ä¸­ã€‚",
 m: "äººåœ¨äº•ä¸­ï¼Œæ­¤ä¸ºç—…å±ç¾å·¨ä¹‹è±¡ï¼Œè™äººå¹³å®‰ï¼Œç‰›äººå—ç¾ç»ˆå¹³å®‰ï¼Œç‹æœ±å§“ç»ˆå¹³å®‰ã€‚éæ­»å³ä¼¤ã€‚ç‰›äººæœ±äººç§‹å†¬æ¯”æ˜¥å¤å¥½ã€‚",
 z: "æš‚æ— ",

                             },

        30: {
            n: "ç¦»ä¸ºç«",
            t: "ä¸€ã€äººåœ¨è™èƒŒä¸Šç«‹ï¼šè¡Œå±ä¸æƒ§ï¼›éš¾ä¸‹ä¹Ÿã€‚<br>äºŒã€ä¸€èˆ¹åœ¨æ±Ÿå¿ƒï¼šå£èˆŒç›¸äº‰ï¼Œæ— æ‰€é€‚ä»ä¹Ÿã€‚<br>ä¸‰ã€å®˜äººæ‰§ç®­å²¸ä¸Šç«‹ï¼šåœ¨ä½ä¹‹äººï¼Œæ¬²æ€ä¹‹è±¡ã€‚<br>å››ã€æ‰§ç®­ï¼šäº‰ã€‚",
            x: "ä¸½ä¹Ÿï¼Œé™„ä¸½ï¼Œå…‰æ˜ã€‚ç»§æ˜ç…§å››æ–¹ã€‚<br>åˆä¹ï¼šå±¥é”™ç„¶ï¼Œæ•¬ä¹‹ï¼Œæ— å’ã€‚<br>å…­äºŒï¼šé»„ç¦»ï¼Œå…ƒã€‚<br>ä¹ä¸‰ï¼šæ—¥æ˜ƒä¹‹ç¦»ï¼Œä¸é¼“ç¼¶è€Œæ­Œï¼Œåˆ™å¤§è€‹ä¹‹å—Ÿï¼Œå‡¶ã€‚<br>ä¹å››ï¼šçªå¦‚ã€å…¶æ¥å¦‚ã€ç„šå¦‚ã€æ­»å¦‚ã€å¼ƒå¦‚ã€‚<br>å…­äº”ï¼šå‡ºæ¶•æ²±è‹¥ï¼Œæˆšå—Ÿè‹¥ï¼Œã€‚<br>ä¸Šä¹ï¼šç‹ç”¨å‡ºå¾ï¼Œæœ‰å˜‰ã€‚æŠ˜é¦–ï¼Œè·åŒªå…¶ä¸‘ï¼Œæ— å’ã€‚",
            d: gd('S')+"æ¬¡å¥³å±…å—ã€‚",
u:"æ­¤å±€å¸¸è§ï¼Œç¦»å¦æœ¬ç¤ºäººä¸­è™šä¸ºæ˜ï¼Œä»Šäººä½†ä»¥ä¸ºè‡ªå·±å¾ˆæ˜ï¼Œå…¶å® ä¸€ç›´éƒ½æ²¡è¿›æ­¥ï¼Œå±¡é”™ä¸æ”¹ï¼ŒèŒ«ç„¶ä¸çŸ¥ï¼Œçš†è‚‡å› äºä¸æ˜ï¼Œæ˜“ç»æå‡ºä¹‹ ä¸­è™šä¸ºæ˜ï¼Œå°±æ˜¯éšæ—¶æŠŠè‡ªå·±å˜æˆç©ºæ¯å­ï¼Œé‚£æ‰å¯ä»¥çœŸæ˜ã€‚å®¶ä¸­æœ‰ å¥³ï¼Œå¤©ç”Ÿå¥½æ‰‹ï¼Œæ˜äº‹ç†ï¼ŒçŸ¥è¿›é€€ï¼Œå¿…ä¸ºæ­¤å±€ï¼Œè¯»è€…é¡»æ³¨æ„è¦çŸ¥åˆ©ç”¨æ­¤å±€æ–¹æ˜¯ï¼Œä¸çŸ¥è¿ç”¨ï¼Œç©ºè¨€æ˜“ç»ï¼Œå¾æ‰€ä¸è€»ã€‚ä¸€ã€æ­¤å¥³å¿…å¿ƒåœ¨è¿ç§»å¤–åœ°ï¼Œä¸å–œåœ¨æœ¬åœ°ã€‚äºŒã€å‘½æ ¼ä¸Šå¦‚äºŒåå…«å²å©šï¼Œåˆ™å®…å±€å¦‚æ­¤ï¼Œå¿…ç„¶ä¸å‡ºäºŒåå…«å²å©šã€‚ä¸‰ã€å¤©ç”Ÿæ˜ç†è€Œä¸æƒ§ã€‚å››ã€ä¸å®ˆè´¢ç¦„ï¼Œä¸é‡åˆ©ä¹‹äººã€‚äº”ã€ç§‘ç”²é«˜ä¸­ï¼Œå¾€å¾€éƒ½æ˜¯ç¬¬ä¸€å¿—æ„¿ã€‚",
h: "æ€§å–œé£˜è¡ï¼Œæ— æ‰€äº‹æˆã€‚é›¨ä¸­é¸¡é¹¤ï¼›è…¿å¾ˆé•¿ã€‚çˆ¶ç•™æ¯å¤±ï¼Œä¸¤åœ°ç›¸éš”ã€‚æ–‡ç« æ‰è‰ºå‡ºä¼—ï¼Œä¸èšè´¢ï¼Œä¸€ç”Ÿå‡­æ‰è‰ºèµ°æå¤©ä¸‹ã€‚å©šå§»ç»“è€Œç¦»ï¼Œåˆç»“ï¼Œå©šäº‹æ— å®šå±…ã€‚",
 a: "è™½æ— æ–¹å‘ï¼Œéœ€è¡Œå±ä¸ä¿±ã€‚å»å‰ï¼Œæ­¢å‡¶ã€‚å©šæœ‰å¤±å¦»ä¹‹è™‘ã€‚ç‰¹ä¾‹ï¼šå¯…å¹´é‡è™ï¼ˆæˆ–å§“ç‹ï¼‰æœ‰å¤§å˜ï¼Œè´¢æ•£äººç¦»ã€‚",
 b: "å¿ƒæœ‰å¿§è™‘ï¼Œæ–¹å‘ä¸æ˜ã€‚è¡Œå±ä¸æƒ§æ–¹æ˜¯çœŸã€‚ä»å®˜é€¢æš—ç®­ã€‚è´¢ç¦„å©šäº‹ä¸¤ä¸å‰ã€‚",
 e: "ä¸‹å±èƒŒå›ï¼Œæ˜“æœ‰å®˜å¸ã€‚é€¢è™å¹´æ—¶åŠ å‡¶ã€‚",
 f: "å£èˆŒç›¸äº‰ï¼Œè´¢ä¸è¿›ä¹Ÿã€‚",
 g: "å®˜äººæ‰§ç®­ï¼Œå£èˆŒä¹‹äº‰ï¼Œä¸æˆæˆ–è€…ç»“å©šä¼šç¦»å©šã€‚",
 l: "ä¸€äººè™èƒŒä¸Šç«‹ï¼Œå®˜äººæ‰§ç®­ï¼Œéš¾è±¡ï¼Œæ¨èè±¡ï¼Œè™½å¾—åˆ°æ¨èå´éš¾æˆã€‚",
 m: "ä¸€äººè™èƒŒä¸Šç«‹ï¼Œéš¾è±¡ï¼Œé‡éš¾ä¹Ÿã€‚",
 z: "æš‚æ— ",

                             },
        31: {
            n: "æ³½å±±å’¸",
            t: "ä¸€ã€ ç©ºä¸­æœ‰ä¸€æ‹³ï¼šè´µäººææ‹”ï¼Œå‡­ç©ºè€Œå¾—ã€‚<br>äºŒã€é’±å®ä¸€å †ï¼šæ±‚è´¢å¾—è´¢ã€‚<br>ä¸‰ã€è´µäººåœ¨å±±é¡¶ï¼šå­¤ç«‹çŠ¶ï¼Œå³å°†ä¸‹å¡ï¼Œé€€ä¼‘çŠ¶ã€‚<br>å››ã€å¥³äººä¸Šå±±ï¼šå¤«å¦»å‰ï¼Œé˜´äººåœä¹‹çŸ¥èµ°é©¬ä¸Šä»»ã€‚<br>äº”ã€åˆå­ï¼šå…ˆæˆåç ´ï¼Œå› è¯šæ„Ÿæ–¹å‰ï¼Œç‰©æ„Ÿå¿…å‡¶ã€‚",
            x: "æ„Ÿåº”ï¼Œé€Ÿä¹Ÿã€‚è™šå—äººã€‚<br>åˆå…­ï¼šå’¸å…¶æ‹‡ã€‚<br>å…­äºŒï¼šå’¸å…¶è…“ï¼Œå‡¶ï¼Œå±…ã€‚<br>ä¹ä¸‰ï¼šå’¸å…¶è‚¡ï¼Œæ‰§å…¶éšï¼Œå¾€åã€‚<br>ä¹å››ï¼šè´ï¼Œæ‚”äº¡ï¼Œæ†§æ†§å¾€æ¥ï¼Œæœ‹ä»å°”æ€ã€‚<br>ä¹äº”ï¼šå’¸å…¶è„¢ï¼Œæ— æ‚”ã€‚<br>ä¸Šå…­ï¼šå’¸å…¶è¾…ï¼Œé¢Šï¼ŒèˆŒã€‚",
            d: gd('NE')+"ä¸‰å¥³å±…ä¸œåŒ—ã€‚",
u:"æ­¤å¦å±€è¿‡å»å¸¸è§ï¼Œä»Šäººä¸å¤šï¼Œä½†è¯»è€…äº¦æ˜äº†ï¼Œå…¶å˜åŒ–å¦‚åï¼š ä¸€ã€å©šæˆäºåª’å¦ä¹‹è¨€ï¼Œå¹¶éè‡ªç”±æ‹çˆ±ã€‚äºŒã€å©šäº‹å…ˆæˆåç ´ï¼Œå‡¶ã€‚ä¸‰ã€å¯¹è±¡å¿…ä¸ºè±ªé—¨ä¸–å®¶ï¼Œæ¯”åŒæ—¶ç”Ÿäººæ—©ä¸€å¹´å©šï¼Œé€¢å•å²å©šã€‚ å››ã€è´¢ç¦„äº‹ä¸šé¡ºåˆ©ï¼Œå·¥ä½œé‡å¿ƒå¤§ï¼Œä½†ç§‘ç”²ä¸å…´ã€‚",
h: "ç”Ÿå³å¸¦è´¢æ¥ã€‚æ³¨å®šç»§å­æ‰¿å®¶ä¸šã€‚å·³å¹´å‘½ï¼Œå­äº¦å½“æ— ã€‚è´¢ç¦„æ—¥ä¸°ï¼Œç”°å›­å¿…å¢ã€‚åˆç«ä¹‹æ—¶å©šäº‹æˆã€‚å¥³æœ‰è´µå¤«ã€‚ç”·æœ‰ç¾å¦»ã€‚",
 a: "å®˜è‡³ä¸€æ–¹ä¹‹ä¸»ï¼ˆå¸‚é•¿ã€å¿é•¿ã€é™¢é•¿ã€æ ¡é•¿ï¼‰ï¼Œå­¤ç«‹æ— æ´ã€‚è´¤å¦»åŠ©åŠ›å¤§ã€‚å†…åŠ©å‰ï¼Œå¤–åŠ©å¾—ä¹‹åä¸ºå‡¶ã€‚å¥³å‘½é€¢ä¹‹ï¼ŒåŠ©å¤«åå®³å¤«ã€‚",
 b: "å‡­ç©ºè€Œå¾—æƒç¦„ä½ã€‚å•†äººé€¢ä¹‹å¾—è´¢ã€‚å¥³äººå‡èŒã€‚å®˜äººé€¢ä¹‹é¡»é€€ï¼Œå¦æ‹›å‡¶ï¼Œå®šæ˜¯å®˜ä½è‡³é¡¶ï¼Œè€Œåè¡Œä¸‹å¡é“ã€‚",
 e: "è´µäººå±±é¡¶ï¼Œå¥³äººä¸Šå±±ï¼Œå¥³äººå‡å®˜ï¼Œç”·äººä¸å‡ã€‚",
 f: "è´¢å®ä¸€å †ï¼Œæœ‰åˆ©å¯åšã€‚",
 g: "ä¸€ç›’å­ï¼Œå’Œåˆä¹Ÿï¼Œä½†è¦é˜²æ­¢ç¦»å©šã€‚",
 l: "ä¸¤ä¸²é’±ï¼Œå¿§å¿ƒå¿¡å¿¡ä¹‹è±¡ï¼Œä¸ä¸Šã€‚",
 m: "äº‘ä¸­æ‹³ç°ï¼Œäººéšäº‘ä¸­ï¼Œé’±è´¢ä¸¤ä¸²åœ¨åœ°ï¼Œé‡ç—…èµ°äººã€‚",
 z: "æš‚æ— ",

                             },
        32: {
            n: "é›·é£æ’",
            t: "ä¸€ã€æ—¥åœ¨äº‘ä¸­ï¼šæ˜æš—ä¹‹è±¡ï¼Œå›ä¸»ä¸æ˜è±¡ã€‚<br>äºŒã€å‡¤å•£ä¹¦ï¼šå–œè®¯è‡³ï¼Œé‡‘æ¦œé¢˜åä¹Ÿã€‚<br>ä¸‰ã€å®˜äººè¡Œè·¯ï¼šå°†è‡³ä¹Ÿï¼Œè´µäººè‡³ã€‚å®˜äººï¼Œå€Œäººï¼Œä¸ˆå¤«ä¹Ÿï¼Œäººå‚ä¸ºå€Œä¹Ÿã€‚<br>å››ã€é“å£«æ‰‹æŒ‡æ–—ï¼šå…¥ç©ºé—¨ä¹Ÿï¼Œé—ªä¹Ÿã€‚<br>äº”ã€é¼ ä¸‹ä¸¤å£ï¼šé˜´è°‹åœ¨åä¹‹è±¡ï¼›ä¸¤å£ï¼Œå›ä¹Ÿï¼Œå•å§“ä¹Ÿã€‚<br>å…­ã€æ—¶æœºï¼šåœ¨æ˜¥æœ«ï¼Œæ—¥ä¸ºæ˜¥ä¹‹æœ«å°¾ä¹Ÿã€‚",
            x: "æ’ä¹…ï¼Œç«‹ä¸æ˜“æ–¹ã€‚å¤«å¦‡ä¹‹é“ã€‚<br>åˆå…­ï¼šæµšæ’ï¼Œè´å‡¶ï¼Œæ— æ”¸åˆ©ã€‚<br>ä¹äºŒï¼šæ‚”äº¡ã€‚<br>ä¹ä¸‰ï¼šä¸æ’å…¶å¾·ï¼Œæˆ–æ‰¿ä¹‹ç¾ï¼Œè´åã€‚<br>ä¹å››ï¼šç”°æ— ç¦½ã€‚<br>å…­äº”ï¼šæ’å…¶å¾·ï¼Œè´ï¼Œå¦‡äºº ï¼Œå¤«å­å‡¶ã€‚<br>ä¸Šå…­ï¼šæŒ¯æ’ï¼Œå‡¶ã€‚",
            d: gd('SE')+"é•¿å­å±…ä¸œå—ã€‚",
u:"ä»Šäººæœ€å¸¸è§æ­¤å±€ï¼ŒåŒ–è§£å±€å¼ï¼Œå¦‚é›·åœ°è±«å¦ç­‰éƒ½å‰ã€‚ ä¸€ã€æ˜“ä»å®—æ•™ä¿¡ä»°ï¼Œä½†ä¸æ˜¯æ­£é“ä¹‹å®—æ•™ã€‚äºŒã€æ¯”åŒæ—¶ç”Ÿäººæ™šå©šä¸€å¹´ã€‚ä¸‰ã€æ™ºæ…§è¢«å‹æŠ‘ï¼Œå¸¸ä¸çŸ¥å–èˆï¼Œå¤±å»åšæŒã€‚å››ã€è‚–é¼ äººæœ‰å‰ï¼Œé˜´è°‹ä¸ç”Ÿã€‚äº”ã€å®˜è¿ä¸ä½³ï¼Œå•†åœºä¸é¡ºï¼ŒæƒŸç§‘ç”²æ—ºï¼Œåˆ©æ•™èŒè‡ªç”±ä¸šäººã€‚",
h: "è‚–é¼ ï¼Œä¸¤å£äººï¼Œæ—©å¹´å…¥ç©ºé—¨ï¼Œå› æ— æ—¥å¤´ã€‚æ˜å¿ƒè§æ€§ï¼Œè¯´æ³•è°ˆç»ï¼Œç”Ÿå…·ä½›æ€§ã€‚è‹¥æ­¤ç”Ÿä¸å…¥å®˜å®¶é—¨ï¼Œå¿…ç„¶ä¸ºåƒ§æ—ã€‚",
 a: "æ”¿å±€ä¸æ¸…ï¼Œå›ä¸æ˜ã€‚ä¸¥é‡è€…ï¼Œå¯èº«å…¥ç©ºé—¨å…é­å‡¶ã€‚å¾…å¾—å­å¹´æ–¹å‡ºå¤´ã€‚å­å¹´æœ‰å‡¤æ¥ä»ªï¼Œæ˜ä¸”å‰ã€‚",
 b: "å©šäº‹æˆã€‚ç§‘ç”²æ— ã€‚å®˜è¿å˜åŠ¨ï¼Œè¿œæ–¹å‰ã€‚çœ‹ä¼¼å‡å®˜ï¼Œå®æœ‰é™©ã€‚æ—©æ—©è„±èº«å…é­é™·ã€‚æ­¤ä¸ºå®šæ•°ã€‚",
 e: "é“äººæ‰‹æŒ‡é—¨ï¼Œé—¨+äºº=é—ªï¼Œé—ªäººï¼Œè¾å®˜æˆ–è€…ä¸å‡ã€‚",
 f: "é“äººæ‰‹æŒ‡é—¨ï¼Œé—¨+äºº=é—ªï¼Œé—ªäººï¼Œæ— åˆ©å¯å›¾ï¼Œåå—å…¶å®³ã€‚",
 g: "æœ‰å‡¤æ¥ä»ªï¼Œå©šå§»å¯æˆã€‚",
 l: "æœ‰å‡¤æ¥ä»ªï¼Œé‡‘æ¦œé¢˜åä¹Ÿã€‚",
 m: "å…¥é“é—¨æœ‰æ•‘ã€‚é€¢å­å¹´æœˆæ—¶ä¸ºå‡¶ï¼Œè¢«æš—ç®—ä¹Ÿã€‚",
 z: "æš‚æ— ",

                             },
        33: {
            n: "å¤©å±±é¯",
            t: "ä¸€ã€ä¸€å±±ï¼šé˜»ä¹Ÿã€‚<br>äºŒã€ä¸€æ°´ï¼šé™©ä¹Ÿã€‚<br>ä¸‰ã€é…’æ——ä¸Šæ–‡å­—ï¼šé…’ä¸ºå¿˜å¿§ä¹‹ç‰©ï¼Œæ–‡åœ¨æ——ä¸Šï¼Œå—äººææºä¹Ÿã€‚<br>å››ã€å®˜äººè¸é¾Ÿï¼šå½’ï¼Œé¬¼ä¹Ÿï¼›ç„æ­¦è‡ªæ¥ï¼Œæ°´ä¸Šæ±‚è´¢ã€‚<br>äº”ã€å¹å¤´ä¸Šæ ‘ï¼šæ±‚å»è¾å®˜ä¹Ÿã€‚<br>å…­ã€æœˆåœ¨äº‘ä¸­ï¼šä¸»åŠæ¸…åŠæµŠè±¡ï¼Œäº‹æœªæ˜æ™°ã€‚<br>ä¸ƒã€äººåœ¨æ°´è¾¹ï¼šç­‰å¾…å¹³å®‰çŠ¶ï¼Œè…ä¸´ä¹Ÿã€‚",
            x: "é€€é¿ï¼Œéšå±…ã€‚è¿œå°äººä¸æ¶è€Œä¸¥ã€‚<br>åˆå…­ï¼šé¯å°¾ï¼Œå‰ï¼Œå‹¿ç”¨æœ‰æ”¸å¾€ã€‚<br>å…­äºŒï¼šæ‰§ä¹‹ç”¨é»„ç‰›ä¹‹é©ï¼Œè«ä¹‹èƒœè¯´ã€‚<br>ä¹ä¸‰ï¼šç³»é¯ï¼Œæœ‰ç–¾å‰ï¼Œç•œè‡£å¦¾ï¼Œã€‚<br>ä¹å››ï¼šå¥½é¯ï¼Œå›å­ï¼Œå°äººå¦ã€‚<br>ä¹äº”ï¼šå˜‰é¯ï¼Œè´ã€‚<br>ä¸Šä¹ï¼šè‚¥é¯ï¼Œæ— ä¸åˆ©ã€‚",
            d: gd('NE')+"çˆ¶å±…ä¸œåŒ—ã€‚",
u:"å¾äººå¸¸è§ä¸€å®¶ä¹‹ä¸»ç»ˆæ—¥å”‰å£°å¹æ°”ï¼Œä¸­å¹´å³æ— æ–¡åŠ²ï¼Œä¸”å·¥ä½œä¸Šä»˜ å‡ºåŠ³åŠ›å¾ˆå¤šï¼Œå´å¾€å¾€åŠŸç»™ä»–äººï¼Œä»•é€”åŸåœ°è¸æ­¥ï¼Œæ¯«æ— è¿›å±•ï¼Œå¿…ä¸ºæ­¤ å¦è€Œæ‰€çº¦æŸä¹Ÿã€‚ä¸€ã€èŒç”Ÿé€€æ„ï¼Œè‚‡å› äºè¯¥å‡ä¸å‡ï¼Œæœ‰æ— åŠ›æ„ŸäºŒã€å¤«å¦»æ„Ÿæƒ…é€€åŒ–ï¼Œç»ˆè‡´ç¦»å©šã€‚ä¸‰ã€äº‹äº‹å›å½’åŸåœ°ï¼Œå¿…é¡»é‡æ–°å‡ºå‘ã€‚å››ã€èº«ä½“äº¦æœ‰é€€åŒ–ç°è±¡ï¼Œä¸­å¹´å³å¾—è€å¹´ç—…ã€‚",
h: "çˆ¶ä¸å…¨ï¼Œæ¯äº¦åŠã€‚ç›–å¤´ï¼ˆå¦‚é«˜ï¼Œå®‹ï¼‰é«˜è€³æœ‰ï¼Œäººæˆæ ¼ã€‚æœ‰é™©æœ‰é˜»ï¼ŒåŠ³å¤šåŠŸå°‘ã€‚æˆæ ¼äººï¼ŒåŠæ¯å¤šç—…ã€‚ä¸­å¹´å¤±å®˜ã€‚é¤é¥®å‰ã€‚å¥³å‘½é€¢ä¹‹ï¼Œä¸­å¹´ä¸§å¶ã€‚",
 a: "å¥³å‘½å¤«å…ˆå¤±ï¼Œè¾›åŠ³æˆå®¶ï¼Œä¸å†æœ‰å©šï¼Œå¤–é˜»å†…é™©ã€‚ç”·å‘½è¾å®˜å½’éšï¼Œæ— æ‰€äº‹ã€‚ä¸­åæ–‡åŒ–æ‰è‰ºå¥½ï¼Œæœ‰éº»çƒ¦ã€‚æ±‚è´¢é‡é™©ï¼Œé˜²äººä¸æˆï¼Œæ¸”ä¸šå¹³å®‰ã€‚",
 b: "çˆ¶å‡¶ä¹‹å¹´ï¼Œå®˜è¿åœæ»ï¼Œè´¢ç¦„æ— ã€‚é™©åœ¨å—å±±ã€‚å¥³å‘½é€¢ä¹‹ï¼Œå¤«å‡¶ã€‚äº‹ä¸šä¸æ˜ã€‚é‡ç¾éœ€å°å¿ƒï¼Œé™©ä¸­æœ‰é™©ã€‚å­¦ä¹ å¹³å®‰ã€‚",
 e: "ä¸€å±±ï¼Œä¸€æ°´ï¼Œé™©é˜»ä¹Ÿï¼Œä¸å‡ï¼Œæˆ–è€…å‡ä¹Ÿä¸é•¿ä¹…ã€‚",
 f: "å®˜äººè¸ç„æ­¦ï¼Œä¸€å±±ï¼Œä¸€æ°´ï¼Œé™©é˜»ä¹Ÿï¼Œä¸èƒ½åšã€‚æ¸”ä¸šå¯æ­£å¸¸è¥æ”¶ï¼Œé…’æ——ï¼Œå¯å¼€é…’é¦†ï¼Œå…¶ä½™ä¸èƒ½åšã€‚",
 g: "è¸ç„æ­¦è€Œå»ï¼Œå©šå§»ä¸æˆæˆ–è€…ç¦»å©šã€‚",
 l: "æ–‡åœ¨é«˜å¤„ï¼Œé«˜ä¸­ä¹Ÿã€‚",
 m: "ç„æ­¦å½’å»ï¼Œå½’å»ä¹Ÿï¼Œé‡ç—…ä¸ºå‡¶ã€‚",
 z: "æš‚æ— ",

                             },
        34: {
            n: "é›·å¤©å¤§å£®",
            t: "ä¸€ã€åŒ—æ–—æ˜Ÿï¼šå¸å›ï¼Œè€æ¿ï¼Œä¸»äº‹ä¹‹äººã€‚<br>äºŒã€å¤©ç¥æ‰§å‰‘ï¼šæ°‘æ„å½’å‘ï¼Œäººå¿ƒä¹Ÿã€‚<br>ä¸‰ã€ä¸€å®˜äººçƒ§é¦™æ‹œï¼šæ‹œæ±‚äºå¤©ï¼Œè€Œä¸æ±‚äººï¼Œå‡¶ã€‚<br>å››ã€ä¸€çŒ´ã€ä¸€å…”ã€ä¸€çŠ¬ï¼šä¾¯ï¼Œåˆ˜ï¼Œç‹„å§“ï¼Œåœ¨é‡ä¹‹äººã€‚<br>äº”ã€çŒ´å›å¤´ï¼šå›å¼ã€‚<br>å…­ã€å…”å›å¤´ï¼šå›åã€‚<br>ä¸ƒã€ç¾Šå›å¤´ï¼šå›é˜³ã€‚",
            x: "å£®ä¹Ÿï¼Œéç¤¼å¼—å±¥ã€‚é›·åœ¨å¤©ä¸Šã€‚<br>åˆä¹ï¼šå£®äºè¶¾ï¼Œå¾å‡¶ï¼Œæœ‰å­šã€‚<br>ä¹äºŒï¼šè´ã€‚<br>ä¹ä¸‰ï¼šå°äººç”¨å£®ï¼Œå›å­ç”¨ç½”ã€‚è´å‰ï¼Œç¾ç¾Šè§¦è—©ï¼Œç¾¸å…¶è§’ã€‚<br>ä¹å››ï¼šè´ï¼Œæ‚”äº¡ï¼Œè—©å†³ä¸ç¾¸ï¼Œå£®äºå¤§èˆ†ä¹‹å¤ã€‚<br>å…­äº”ï¼šä¸§ç¾Šäºæ˜“ï¼Œæ— æ‚”ã€‚<br>ä¸Šå…­ï¼šç¾ç¾Šè§¦è—©ï¼Œä¸èƒ½é€€ï¼Œä¸èƒ½é‚ï¼Œæ— æ”¸åˆ©ï¼Œè‰°åˆ™ã€‚",
            d: gd('NW')+"é•¿å­å±…è¥¿åŒ—ã€‚",
u:"æ­¤å¦å±€ä¹Ÿå¸¸è§ä¸é²œï¼Œå¾äººé¡»çŸ¥ä½•å±€ä¸ºå¤§å£®å±€ï¼Œå¦‚ä½•åˆ©ç”¨å¤§å£®å±€ï¼Œä½•æ—¶å¯ç”¨å¤§å£®ä¸ºæœ€åˆ©ã€‚ä½•æ—¶é¡»ç¦»å¼€æ­¤å±€ã€‚ ä¸€ã€æ€§åˆšä¸ºä¸€å®¶ä¹‹ä¸»ï¼Œæœ‰è¶Šå±…çˆ¶ä½ä¹‹è±¡ã€‚äºŒã€å®¶åº­è´£ä»»æ„Ÿé‡ã€‚ä¸‰ã€ä¸å©šï¼Œä¸åŒæ—¶ç”Ÿäººä¸åŒã€‚å››ã€å¦‚æœ‰å©šï¼Œå¿…ä¸ºçŒ´ï¼Œå…”ï¼ŒçŠ¬ä¸‰è‚–å±ä¹‹äººï¼Œä½†å¸¸ä¸è¶³ä¸‰æœˆå©šç ´ã€‚äº”ã€äº‹ä¸šç‹¬ç«‹è‡ªä¸»ï¼Œè‡ªç”±ä¸šäººå¯ä¸ºä¸€æ–¹ä¹‹ä¸»ï¼Œå£°åè¿œæ’­ã€‚",
h: "çŒ´ç¾ŠçŠ¬æˆæ ¼ï¼Œé•¿ç”·æ›´å£®ã€‚å¥³ä¸æˆï¼Œæ‹›å‡¶ï¼Œè¿‡åˆšã€‚å‡¡æˆæ ¼è€…ï¼Œé€¢å‡¶ä¸ä¸ºå‡¶ï¼Œå››æµ·æ‰¬åã€‚æ–‡æ­¦åŒå…¨ï¼Œå®˜æ¯”çˆ¶å¤§ã€‚ä¹é‡ç¦„å‘½ï¼Œä½è‡³ä¸‰å…¬ã€‚",
 a: "ä¸­å¹´åå¹³æ­¥é’äº‘ã€‚ä¸€å¿µä¹‹é—´ï¼Œå¤©åœ°åè¦†ã€‚çŒ´ç¾ŠçŠ¬åŠ è´µã€‚å¥³å‘½é€¢ä¹‹ï¼Œå®˜æ¯”å¤«å¤§ã€‚è‹¥å—å¤©å­ç¦„å‘½ï¼Œå¾—äººå¿ƒå´èƒŒåˆ©ï¼ˆè¢«åˆ©ç”¨ï¼‰ã€‚ç»™å›å…«å­—ï¼šäº‰æ—¶å®œè¿œã€‚å’Œæ—¶å®œè¿‘ã€‚",
 b: "è´µäººæ¥åŠ©å¾—å¿«åˆ©è´¢ï¼Œé€¢çŒ´ç¾ŠçŠ¬ï¼ŒåŠ å‰ã€‚å®˜äººå‡è¿ï¼Œæ±‚ä¹‹ä¸å¾—ã€‚ç”·å­é€¢ä¹‹å¦»é‡ç—…ï¼Œä½†æ— ç¾ï¼ˆå¯è§£ï¼‰ã€‚",
 e: "çŒ´å…”çŠ¬ï¼ˆä¸€è¯´æ³•ä¸ºå€™å…”ç¾Šï¼‰ï¼Œé€¢çŒ´å…”çŠ¬äººå¹´æœˆæ—¶å‡å®˜ï¼Œå…¶ä½™ä¸å‡ã€‚",
 f: "é€¢çŒ´å…”çŠ¬äººå¹´æœˆæ—¶å¯å¾—ç¥äººåŠ©åŠ›ï¼Œå¾—å¤§è´¢ã€‚å…¶ä½™ä¸åšã€‚",
 g: "é€¢çŒ´å…”çŠ¬äººå¹´æœˆæ—¶å¯å©šï¼Œå…¶ä½™ä¸å©šæˆ–å©šæœŸçŸ­æš‚ã€‚",
 l: "é€¢çŒ´å…”çŠ¬äººå¹´æœˆæ—¶å¯ä¸­ï¼Œå…¶ä½™ä¸ä¸­ã€‚",
 m: "é€¢çŒ´å…”çŠ¬äººå¹´æœˆæ—¶æœ‰æ•‘ï¼Œå¦åˆ™é‡ç—…æœ‰å±ã€‚",
 z: "æš‚æ— ",

                             },
        35: {
            n: "ç«åœ°æ™‹",
            t: "ä¸€ã€æ–‡å­—ç ´ï¼šå®˜äº‹ä¸æˆï¼Œé€€ä½è±¡ã€‚<br>äºŒã€å®˜äººæ©é¢ï¼šæ— é¢œè§äººï¼Œæ‚²è±¡ã€‚<br>ä¸‰ã€çƒåœ¨æ³¥ä¸Šï¼šæ‰€æ±‚å¿…é™·é™©ä¹Ÿã€‚<br>å››ã€é¸¡å•£ç§¤ï¼šé¸¡ï¼Œé…‰ä¹Ÿï¼Œè‚–é¸¡äººä¹Ÿï¼Œè½æ—¥ä¹‹è±¡ã€‚ç§¤ï¼šç¤ºå…¬å¹³ï¼Œç§°å¿ƒä¹Ÿã€‚<br>äº”ã€æ¯æœ¨ç”ŸèŠ±ï¼šæ™šå‘ä¹Ÿã€‚<br>å…­ã€é¹¿å•£ä¹¦ï¼šç¦„ä¸å‘½åˆ°ä¹Ÿã€‚",
            x: "è¿›ä¹Ÿï¼Œæ—¥å‡ºåœ°ä¸Šã€‚è‡ªæ˜­æ˜å¾·ã€‚<br>åˆå…­ï¼šæ™‹å¦‚æ‘§å¦‚ï¼Œè´ï¼Œç½”å­šï¼Œè£•æ— å’ã€‚<br>å…­äºŒï¼šæ™‹å¦‚æ„å¦‚ï¼Œè´ã€‚å—å…¹ä»‹ç¦ï¼Œäºå…¶ç‹æ¯ã€‚<br>å…­ä¸‰ï¼šä¼—å…ï¼Œæ‚”äº¡ã€‚<br>ä¹å››ï¼šæ™‹å¦‚é¼«é¼ ï¼Œè´å‰ã€‚<br>å…­äº”ï¼šæ‚”äº¡ï¼Œå¤±å¾—å‹¿æ¤ï¼Œå¾€ï¼Œæ— ä¸åˆ©ã€‚<br>ä¸Šä¹ï¼šæ™‹å…¶è§’ï¼Œç»´ç”¨ä¼é‚‘ï¼Œå‰ï¼Œæ— å’ï¼Œè´å’ã€‚",
            d: gd('SW')+"æ¬¡å¥³å±…è¥¿å—ã€‚",
u:"æ­¤å±€ä¹‹ç°ï¼Œè¯»è€…å¯ä»¥ç«‹åˆ¤å‡ºã€‚ä¸€ã€æ€§æŸ”æœ‰æ¯çˆ±ä¹‹äººã€‚äºŒã€å©šå§»å¸¸æ™šï¼Œçº¦å››åå²ä»¥åã€‚ä¸‰ã€å®ˆè´¢ä¸èŠ±ï¼Œæ€§æèŠ‚çœä¹‹äººã€‚å››ã€åæˆ¿ä¹‹äººï¼ŒåŒæ—¶ç”Ÿäººæœ‰å©šä¸ºæ­£æˆ¿ã€‚äº”ã€å©šå«å¯¹è±¡è‹¥è‚–é¸¡ï¼Œåˆ™å¤§å‰ï¼Œä½†å¤§å¹´é•¿å¤šå¤šã€‚",
h: "æµæµªåœ¨å¤–æ— å®¶å¯å½’ã€‚çˆ¶ä¸å…¨ï¼Œæ¯æ•£ã€‚åˆ‡è®°èµŒä¸å…´å®¶ã€‚å”¯é…‰äººç§°å¿ƒå¦‚æ„ï¼Œä½™ç”Ÿè‚–å®˜äº‹é˜»ï¼Œåæ±‚äºä¸‹ï¼Œä¸­å¹´åå¤§å‰ã€‚å¯Œè´µå‚¬äººè€ã€‚",
 a: "å©šå‡¶ã€‚æ‰‹ä¸‹çŠ¯ä¸Šï¼ˆåŒ…æ‹¬å­å¥³çŠ¯çˆ¶æ¯ï¼‰ã€‚ä¸‰åº¦æ¢…å¼€ã€‚é€¢é¸¡å¿…æˆã€‚ä»å•†å¤§å‰ï¼Œå½“å®˜è€…ä¸å¿…ç•™è¿ï¼Œå¯å»å®˜ä»å•†ã€‚",
 b: "å©šäº‹å‡¶ï¼Œå‡è¿æ— æœ›ã€‚å¤±æƒä½ã€‚åæ±‚æ‰‹ä¸‹ã€‚æ°é€¢é…‰å¹´ï¼Œæˆ–è€…é¸¡äººï¼Œå¿…å¯ç§°å¿ƒå¦‚æ„ï¼Œè´¢ç¦„å¤§è¿›ã€‚",
 e: "æ–‡å­—ç ´ï¼Œå®˜å¸çº çº·ï¼Œä¸å‡ã€‚",
 f: "é¹¿è¡”æ–‡ä¹¦ï¼Œè´¢ç¦„è‡³ä¹Ÿã€‚",
 g: "çƒåœ¨æ³¥ä¸­ï¼Œæ–‡å­—ç ´ï¼Œä¸æˆæˆ–ç»“å©šä¹‹åå†ç¦»å©šã€‚",
 l: "æ–‡å­—ç ´ï¼Œä¸ä¸­ã€‚",
 m: "çƒåœ¨æ³¥ä¸­ï¼Œå®˜äººæ©é¢è€Œå“­ï¼Œæ–‡å­—ç ´ï¼Œä¸§äº‹ä¹Ÿã€‚é€¢åˆ°é¸¡äººé…‰å¹´æœˆè½¬å‡¶ä¸ºå®‰ï¼Œå¤§å‰ã€‚",
 z: "æš‚æ— ",

                             },
        36: {
            n: "åœ°ç«æ˜å¤·",
            t: "ä¸€ã€å¦‡äººåœ¨äº•ä¸­ï¼šå¥³äººæ‹›ç¾ï¼Œæˆ–é¢ˆéƒ¨ç¾ï¼Œå®¶å†…æœ‰ç¾ã€‚<br>äºŒã€è™åœ¨å¤–ï¼šå¤–äººè™è§†çœˆçœˆã€‚<br>ä¸‰ã€é’±ç¼ºï¼šè´¢ä¼¤ä¹Ÿã€‚<br>å››ã€äººé€é¹¿ï¼šè´¢å¤±ä¹Ÿï¼Œäº‰ç›¸ä¸ºç¦„ï¼Œé€é¹¿ä¸­åŸã€‚<br>äº”ã€å  åœ¨äººé¹¿ä¸­ï¼šçŒ´ä½œæ¢—ä¹Ÿã€‚<br>å…­ã€ã€Œï¼šå°ºä¹Ÿï¼Œå·¥åŒ ç‹¬æœ‰ï¼ŒåŒ ï¼Œå°†ä¹Ÿï¼Œæ­¦å®˜äººã€‚<br>ä¸ƒã€å  ï¼šä¸åŠ¨ä¹Ÿï¼Œå°Šä½ä¹Ÿï¼Œå§“ä¾¯ï¼Œè‚–çŒ´",
            x: "æ™¦å…¶æ˜ï¼Œè‰°éš¾ä¹‹æ—¶ã€‚è…ä¼—ç”¨æ™¦ã€‚<br>åˆä¹ï¼šæ˜å¤·äºé£ï¼Œå‚å…¶ç¿¼ã€‚å›å­äºè¡Œï¼Œä¸‰æ—¥ä¸é£Ÿï¼Œæœ‰æ”¸å¾€ï¼Œä¸»äººæœ‰è¨€ã€‚<br>å…­äºŒï¼šæ˜å¤·ï¼Œå¤·äºå·¦è‚¡ï¼Œç”¨æ‹¯é©¬å£®ï¼Œã€‚<br>ä¹ä¸‰ï¼šæ˜å¤·äºå—ç‹©ï¼Œå¾—å…¶å¤§é¦–ï¼Œä¸å¯ç–¾è´ã€‚<br>å…­å››ï¼šå…¥äºå·¦è…¹ï¼Œè·æ˜å¤·ä¹‹å¿ƒï¼Œäºå‡ºé—¨åº­ã€‚<br>å…­äº”ï¼šç®•å­ä¹‹æ˜å¤·ï¼Œåˆ©è´ã€‚<br>ä¸Šå…­ï¼šä¸æ˜æ™¦ï¼Œåˆç™»äºå¤©ï¼Œåå…¥äºåœ°ã€‚",
            d: gd('S')+"æ¯å±…å—ã€‚",
u:"æ­¤å¦å¾ˆå‡¶ï¼Œå®…å±€é€¢ä¹‹ï¼Œå¿…ä¸»æ¯å…ˆäº¡ï¼Œä¸”ç”Ÿå‰è¡€å…‰è¿å¹´ï¼Œå¸Œè¯»è€… é‡ä¹‹å¿…åŠ›æ±‚å…¶å˜å±€ï¼ŒåŠŸå¾·æ— é‡ï¼Œäººä¸çŸ¥å…¶åŠŸï¼Œä¹ƒæ‰€è°“é˜´å¾·ä¹Ÿã€‚ä¸€ã€å¦»ç”Ÿéšç–¾ä¸å¥½å‘Šäººã€‚äºŒã€ç ´è´¢ä¸”è¯¸äº‹ä¸é¡ºã€‚ä¸‰ã€æ˜“å—å°äººè¨€ï¼Œæ‹›äººæš—å®³ã€‚å››ã€ä¸€æ—¦è§è¡€å…‰ï¼Œå¿…ç»ˆè‡´å‡¶ã€‚äº”ã€å”¯è‚–è™äººï¼Œå¯å¹³å®‰æ¸¡è¿‡ã€‚",
h: "çˆ¶ä¸å…¨æ¯å…¨ï¼Œç”Ÿé€¢å®¶ä¸šæ²¡è½æ—¶ï¼Œåˆé€¢å¯…å¹´ï¼Œé›ªä¸ŠåŠ éœœï¼Œæ¯æœ‰å‡¶ã€‚ç”³çŒ´æœ‰å›ç¦„ï¼ˆå³ç«ç¾ï¼‰ã€‚ç ´è´¢åˆæŸäººã€‚å›å¤©ä¹åŠ›ï¼Œå¤§é™æ•°ç»ˆå¯…ï¼Œæœ‰é¢ˆä¹‹æˆ’ï¼ˆå±Œä¸ã€å‹’æ­»ï¼Œæ·‹å·´ç™Œç­‰ï¼‰ã€‚",
 a: "æ— åŠ›å›å¤©ã€‚äººè´¢æŸä¼¤ã€‚å¦»å…ˆæ‹›å‡¶ã€‚æ…é˜²è™äººã€‚å›ç¦„ä¹‹ç¾éœ€æ³¨æ„ã€‚å®ˆæˆï¼Œæ­£è´¢ï¼Œä¸ºäººå·¥ä½œï¼Œå®‰å®‰åˆ†åˆ†ï¼Œè°¨è¨€æ…è¡Œæ–¹å¯æ— å¿§ã€‚",
 b: "å¤§é™æ•°å·²ç»ˆã€‚ä¸é€¢è¡€å…‰ä¹Ÿæœ‰ç«å„ã€‚",
 e: "å¦‡äººåœ¨äº•ä¸­ï¼Œäººé€é¹¿ï¼Œå€™åœ¨ä¸­ï¼Œæš—ä¸­æ‹›ç¾ï¼Œæœ‰äººä»ä¸­ä½œæ¢—ï¼Œä¸å‡ï¼Œåæ‹›é™·å®³ã€‚",
 f: "é’±ç ´ï¼Œè´¢ä¸å…¨ä¸åˆ©ä¹Ÿã€‚",
 g: "å¥³äººäº•ä¸­ï¼Œä¸åˆ©å©šå§»ä¹Ÿã€‚",
 l: "äººæ‹¿æ ‘æï¼Œå°ºæŠ˜ï¼Œå€™åœ¨ä¸­ï¼Œä¸ä¸­ä¹‹è±¡ã€‚",
 m: "å¦‡äººäº•ä¸­ï¼Œé˜²å‹’æ­»ï¼ŒåŠæ­»ï¼Œæ·‹å·´ç™Œï¼Œæœ¨+äºº=ä¼‘ï¼Œå°†ä¼‘ä¹‹è±¡ï¼Œææœ‰è¡€å…‰ä¹‹ç¾ã€‚é€¢è™å¹³å®‰ã€‚",
 z: "æš‚æ— ",

                             },
        37: {
            n: "é£ç«å®¶äºº",
            t: "ä¸€ã€ä¸€äººå¼ å¼“ï¼šæš—ç®—ï¼Œç ´åä¹Ÿã€‚<br>äºŒã€ä¸€å¸¦åœ¨æ°´è¾¹ï¼šäº‹æ»ä¹Ÿï¼Œå¼ƒå®˜ä¹Ÿã€‚<br>ä¸‰ã€äº‘ä¸­æ–‡ä¹¦ï¼šçªè€Œæ¥ä¹‹å–œè®¯ä¹Ÿã€‚<br>å››ã€è´µäººæ‹œå—ï¼šç»¶å‘½ä¹Ÿã€‚<br>äº”ã€å¦‡äººæºæ‰‹ï¼šå®¶å’Œä¹‹è±¡ï¼Œæ­¤å¦åœå©šå§»å¤§å‰ã€‚",
            x: "å®¶å’Œä¸‡äº‹å…´ã€‚è¨€æœ‰ç‰©è¡Œæœ‰æ’ã€‚<br>åˆä¹ï¼šé—²æœ‰å®¶ï¼Œæ‚”äº¡ã€‚<br>å…­äºŒï¼šæ— æ”¸é‚ï¼Œåœ¨ä¸­é¦ˆï¼Œè´ã€‚<br>ä¹ä¸‰ï¼šå®¶äººå—ƒå—ƒï¼Œæ‚”å‰ï¼Œå¦‡å­å˜»å˜»ï¼Œç»ˆåã€‚<br>å…­å››ï¼šå¯Œå®¶ï¼Œå¤§ã€‚<br>ä¹äº”ï¼šç‹å‡æœ‰å®¶ï¼Œå‹¿æ¤ï¼Œã€‚<br>ä¸Šä¹ï¼šæœ‰å­šå¨å¦‚ï¼Œç»ˆã€‚",
            d: gd('S')+"é•¿å¥³å±…å—ã€‚",
u:"ä»Šæ—¥å¸¸è§ä¹‹å¦å±€ï¼Œè¯»è€…å¯çŸ¥å¦‚åï¼š ä¸€ã€ ä»å®˜èŒå¿…æ— æ³•å‡èŒã€‚äºŒã€ ç§‘ç”²åŠŸåæ— è™‘ã€‚ä¸‰ã€ å©šå»¶åäº”å¹´ä¸åŒæ—¶ç”Ÿäººä¸åŒã€‚å››ã€ ä¸å®¶äººç›¸å¤„å’Œç¦ï¼Œä¸”éå¸¸é¡¾å®¶ã€‚äº”ã€ å¤šå¦‡äººç—…ã€‚",
h: "å®¶æ—å’Œç¦ï¼Œäº‹ä¸šå…´ç››ã€‚ç”°è´¢å¹¿è¿›ã€‚ç§‘ç”²é«˜ä¸­ã€‚ç”Ÿè€Œä¸ºå®˜ã€‚å¦»å¦¾å„ä¸€ã€‚å…„å¼Ÿä¸€æ–‡ä¸€æ­¦ï¼Œä¸¥æ¯æŒå®¶ã€‚",
 a: "äº‹ä¸šç”±æ­¦è½¬æ–‡ï¼Œå—å°å°ï¼Œå…ˆæœ‰é˜»æ»ï¼Œäº‹åæˆã€‚å¦»åŠ©å¤§ï¼Œå”¯é€¢æ°´å¹´å‡¶ã€‚å©šäº‹å‰ï¼Œä¸»å¾—äºŒå­ã€‚",
 b: "é€¢ä¹‹æœ‰ç§‘ç”²ã€‚å®˜äººå—å°ã€‚å¤§è´µä¹‹å¹´ã€‚å©šå¿…æˆã€‚æ°é€¢æ°´å¹´ï¼Œé˜²äººç”Ÿæš—å®³ã€‚",
 e: "å®˜äººæˆæ–‡ä¹¦ï¼Œç¬¬ä¸€æ¬¡ä¸å‡ç¬¬äºŒæ¬¡ä¼šå‡ã€‚",
 f: "æ°´æ—æœ‰å¸¦ï¼Œæ»ä¹Ÿã€‚è´¢è·¯ä¸é€šã€‚",
 g: "å¦‡äººæ‹±æ‰‹ï¼Œå©šå§»å¤§å‰ã€‚",
 l: "å®˜äººæˆæ–‡ä¹¦ï¼Œå¯é«˜ä¸­ã€‚",
 m: "è·ªæ¥æ–‡ä¹¦ï¼Œè·ªå¯¿ä¹Ÿï¼Œä¸§è±¡ã€‚",
 z: "å®¶äººæœ€åˆ©å©šå§»",

                             },
        38: {
            n: "ç«æ³½ç½",
            t: "ä¸€ã€äººæ‰§æ–§åœ¨æ‰‹ï¼šæ±‚å¿«ä¹Ÿï¼Œè¡Œåˆ‘ä¹‹äººï¼Œæ‰§æ³•ä¹‹äººï¼Œæœ‰æƒæŸ„ä¹Ÿã€‚<br>äºŒã€æ–‡ä¹¦åŠç ´ï¼šæ— æœ›è±¡ï¼Œæ¯çº¦ä¹Ÿã€‚<br>ä¸‰ã€ç‰›é¼ ï¼šç§‹å†¬å‰ï¼Œæ˜¥å¤å‡¶ã€‚<br>å››ã€æ¡ƒå¼€ï¼šé€ƒå¼€ä¹Ÿã€‚<br>äº”ã€é—¨æ©ï¼šç‰¢ç‹±ä¹‹ç¾ï¼Œé—­ä¹Ÿï¼Œéš”ä¹Ÿã€‚",
            x: "ç½è¿ï¼ŒèƒŒç¦»ã€‚äºŒå¥³åŒå±…å¿—ä¸åŒã€‚<br>åˆä¹ï¼šæ‚”äº¡ï¼Œä¸§é©¬å‹¿é€ï¼Œè‡ªå¤ï¼›è§æ¶äººï¼Œæ— å’ã€‚<br>ä¹äºŒï¼šé‡ä¸»äºå··ï¼Œæ— å’ã€‚<br>å…­ä¸‰ï¼šè§èˆ†æ›³ï¼Œå…¶ç‰›æ£ï¼Œå…¶äººå¤©ä¸”åŠ“ï¼Œæ— åˆæœ‰ç»ˆã€‚<br>ä¹å››ï¼šç½å­¤ï¼Œé‡å…ƒå¤«ï¼Œäº¤å­šï¼Œå‰æ— å’ã€‚<br>å…­äº”ï¼šæ‚”äº¡ï¼Œå¥å®—å™¬è‚¤ï¼Œå¾€ä½•å’ã€‚<br>ä¸Šä¹ï¼šæšŒå­¤ï¼Œè§è±•è´Ÿæ¶‚ï¼Œè½½é¬¼ä¸€è½¦ï¼Œå…ˆå¼ ä¹‹å¼§ï¼Œåè¯´ä¹‹å¼§ï¼ŒåŒªå¯‡å©šåª¾ï¼Œå¾€é‡é›¨åˆ™ã€‚",
            d: gd('W')+"æ¬¡å¥³å±…è¥¿ã€‚",
u:"æˆ‘ä»¬å¸¸è§æœ‰å°å¥³å­©ï¼ŒèƒŒç¦»å®¶äººï¼Œè‡ªé¡¾è‡ªç§ï¼Œä½¿çˆ¶æ¯æ·±ä¸ºè‹¦æ¼ï¼Œ è€Œæ— æ³•æ”¹å˜ï¼Œåªæœ‰ä»»å…¶ä»»æ€§è€Œä¸ºï¼Œç»ˆè‡´ä¸€ç”Ÿçš†å‡¶ï¼Œåå·ï¼Œå®å› è‡ªå†… ç”Ÿã€‚ä¸€ã€æ€§åˆšåƒ»å€”å¼ºï¼Œä»»æ€§èƒ¡é—¹ï¼Œä»¥è‡´å®¶æ— æ³•å®¹ã€‚äºŒã€è‚–ç‰›è‚–é¼ äººè§ä¹‹ï¼Œæ›´å‡¶ã€‚ä¸‰ã€ç§‘ç”²ä¸å…´ã€‚å››ã€å©šå§»ä¸æˆã€‚äº”ã€æ‹›å‡¶äº‹ï¼Œå®˜å¸ï¼Œç½ç¦é€£é€£ã€‚å…­ã€æœ‰åŒæ€§æˆ€å‚¾å‘ã€‚",
h: "ç”Ÿé€¢å®¶é“è¡°ï¼Œçˆ¶æ¯ä¸å’Œæœ‰ç‰¢ç¾ã€‚ä¸æ¯æ— ç¼˜ã€‚æ±‚è´¢ä¸æ‹©æ‰‹æ®µã€‚é€¢é¼ é€¢ç‰›é¿ä¹‹å‰ã€‚",
 a: "ä¸€äº‹æ— æˆã€‚å®¶äººèƒŒç¦»ã€‚æœ‰ç‰¢ç‹±ä¹‹ç¾ã€‚å”¯é¼ ç‰›äººå¯é¿ã€‚å…¶ä½™å¤šå‡¶ã€‚å—è¿å‰ã€‚",
 b: "ä¾¥å¹¸å¾—è´¢ã€‚é€¢ç‰›é¼ ä¸»ç ´ï¼ˆå¦‚é¼ æœˆï¼Œé¼ äººï¼‰ï¼Œå©šç ´ï¼Œäº‹ç ´ï¼Œä¸é€ƒå…¥ç‰¢é—¨ã€‚å—è¡Œå‰ã€‚é‡åˆšå¼ºä¹‹è´¼ã€‚",
 e: "æ–‡ä¹¦åŠç ´ï¼Œå®˜äº‹ä¸å‡ï¼Œå®˜å¸çº çº·ä¹Ÿã€‚",
 f: "æ¡ƒå¼€ï¼Œé€ƒå¼€ï¼Œä¸è¦åšï¼ŒæŠ“ç´§è·‘ã€‚",
 g: "æ–‡ä¹¦ç ´ï¼Œä¸æˆæˆ–è€…ç¦»å©šï¼Œå†ä¸€ä¸ªåˆ€æ–§æ‰‹åœ¨æ—è¾¹ï¼Œå¯èƒ½è¢«æ§åˆ¶ï¼Œè¦å°å¿ƒã€‚",
 l: "æ–‡ä¹¦åœ¨åœ°ç ´ï¼Œä¸ä¸­ã€‚",
 m: "æ–‡ä¹¦åœ¨åœ°ï¼Œçƒ§çº¸ä¹‹è±¡ï¼Œææœ‰è¡€å…‰ä¹‹ç¾ã€‚é€¢åˆ°è€é¼ ã€ç‰›äººæ—¶é—´åŠ å‡¶ã€‚",
 z: "æš‚æ— ",

                             },
        39: {
            n: "æ°´å±±è¹‡",
            t: "ä¸€ã€æ—¥å½“å¤©ï¼šå›æ˜ä¹‹è±¡ï¼Œå´å§“ã€‚<br>äºŒã€æ——ä¸€é¢åªæœ‰ä½¿å­—ï¼šå‡ºä½¿ï¼Œå’Œå¹³ä¹‹è±¡ï¼Œä½¿â€”äºŒäººä¸€å£ï¼Œç¤ºå•äººä¹Ÿã€‚<br>ä¸‰ã€é¼“äº”é¢è€…ï¼šæ—¶ä¸ºäº”æ›´å¤©ï¼Œå äº”é¢åœ°ï¼Œç‹ä¸ºå›ç‹ï¼Œä¸€æ–¹ä¹‹ä¸»ï¼Œæœ‰å¤šå›½æˆ–å¤šå²›ä¹‹è±¡ã€‚<br>å››ã€ä¸­æœ‰ä¸€é¹¿ï¼šæºè´¢ç¦è‡³ï¼Œæ—…å®¢å¸¦è´¢æ¥çŠ¶ï¼Œå•†äººè‡³ä¹Ÿã€‚<br>äº”ã€å †å­åƒé‡Œå­—ï¼šè¡Œè¥¿å—ï¼Œåƒé‡Œå°å€™ï¼Œå€™å§“ä¹Ÿã€‚<br>å…­ã€åƒé‡Œä¸ºé‡ï¼šæœ‰ç¬¬äºŒæ¬¡æ–¹å‰ã€‚",
            x: "éš¾ä¹Ÿï¼Œæ­¢ä¹Ÿã€‚åèº«ä¿®å¾·ã€‚<br>åˆå…­ï¼šå¾€è¹‡ï¼Œæ¥èª‰ã€‚<br>å…­äºŒï¼šç‹è‡£è¹‡è¹‡ï¼ŒåŒªèº¬ä¹‹æ•…ã€‚<br>ä¹ä¸‰ï¼šå¾€è¹‡ï¼Œæ¥åã€‚<br>å…­å››ï¼šå¾€è¹‡ï¼Œæ¥è¿ã€‚<br>ä¹äº”ï¼šå¤§è¹‡ï¼Œæœ‹æ¥ã€‚<br>ä¸Šå…­ï¼šå¾€è¹‡ï¼Œæ¥ç¡•ï¼Œï¼Œåˆ©è§å¤§äººã€‚",
            d: gd('NE')+"æ¬¡å­å±…ä¸œåŒ—ã€‚",
u:"æ­¤å±€åˆ©ä»æ­¦å®˜ä¹‹äººï¼Œå¦‚å†›äººã€å‘˜è­¦ã€å¤–äº¤ã€å¸æ³•äººå‘˜ç­‰ï¼Œä¹Ÿå¯ ä»¥åˆ»æ„å¸ƒå‡ºæ­¤å±€å¦‚æœä½ æƒ³å„¿å­ä»æ­¤ç±»å…¬èŒçš„è¯ã€‚ä¸€ã€æ±‚è´¢äº¨é€šï¼Œä¸”æ— åŠŸåˆ©ä¹‹å¿ƒã€‚äºŒã€å®˜è°ƒä»–ä¹¡ï¼Œä¸å…­äº²è¿œç¦»ã€‚ ä¸‰ã€å©šå§»è¾ƒåŒæ—¶ç”Ÿäººå»¶åä¸ƒå¹´ã€‚å››ã€ç§‘ç”²å‰ï¼Œæ•…è€ƒè¯•èµ„æ ¼å¿…é¡ºå¿ƒã€‚äº”ã€ç‹¬è‡ªå‘å±•äº¦ç‰¹ç«‹ç‹¬è¡Œä¹Ÿã€‚",
h: "ç”Ÿäºå®˜å®¶ï¼Œæ—¥å¤´æ­£æ—ºã€‚ä¸¤äººä¸€å¤§å£ï¼Œå…­äº²æ•°åœ¨äº”äººã€‚ä½†å‡ºä¸€åœã€ä¸€å•†äººã€‚å¤–åœ°å°ä¾¯ã€‚ä¸€æ–¹ä¹‹ä¸»ã€‚ä¸ä¸ºä½¿èŠ‚ï¼Œä¸ºå„’æ—ã€‚",
 a: "å¤«å¦»åŒå‡ºå¤–åœ°ï¼Œäº”äººç›¸ä»ã€‚å¤«æ¥ä»å®˜ï¼Œå¦»ç”Ÿè´¢ã€‚ä¸‰å­å»ä¸€å‘äºŒæˆ¿ã€‚å¥³å‘½é€¢ä¹‹ï¼Œåƒé‡Œå•éª‘ï¼Œå‡ºå¤–æ±‚è´¢ã€‚å²›ä¸­å±…ã€‚",
 b: "å¤«å½“å¤–å‡ºï¼Œæ±‚ç¦„å¿…å…´ï¼Œå®˜äººé€¢ä¹‹ï¼Œå‡ºå¤–ä½¿èŠ‚ã€‚å¥³å‘½é€¢ä¹‹ï¼Œé¡»é˜²å­åŠ«ï¼Œå·å¤©æ¢æ—¥ï¼ˆå­è¢«æŠ±èµ°ï¼Œå­è¢«çªƒç›—ï¼‰ã€‚",
 e: "åƒé‡Œï¼Œä½¿æ——ï¼Œå€™ï¼Œé€¢å€™ä¹‹è±¡ï¼Œå½“å±€é•¿ä¹‹è±¡ï¼Œå‡å®˜ä¹‹è±¡ã€‚å¯èƒ½ä¸ºå¤–åœ°è°ƒèŒï¼Œä¸€æ¬¡ä¸å‡æœ€å¤šä¸¤æ¬¡ã€‚",
 f: "ä¸€é¹¿ï¼Œäº”ä¸ªé¼“ï¼Œæ‹¥æœ‰å¤šä¸ªè¿›é¡¹ã€‚",
 g: "æ—¥å½“å¤©ï¼Œä¸€ä½¿æ——ï¼Œä¸€é¹¿ï¼Œç”·å‘½å¤«å”±å¦‡éšï¼Œä¸€å®˜ä¸€å•†ã€‚å¥³å‘½åƒé‡Œèµ°å•éª‘ï¼Œè¿™æ˜¯ä¸å¥½çš„åœ°æ–¹ã€‚",
 l: "é‡ï¼Œå€™ï¼Œä¸€æ¬¡ä¸ä¸­å°±å†è€ƒä¸€æ¬¡ï¼Œå¿…ä¸­ã€‚",
 m: "ç”·å¹³å®‰ï¼Œå¥³è¦é˜²å¿ƒè„ç—…ï¼Œå¯æ±‚åŠ©ä¸åœäººï¼Œå­©å­æœ‰è¢«å·æ¢ä¹‹å«Œã€‚",
 z: "æš‚æ— ",

                             },
        40: {
            n: "é›·æ°´è§£",
            t: "ä¸€ã€æ——ä¸Šæå­—ï¼šæŒ‡åæå‡¶ï¼Œä¸åˆ©ã€‚æœ‰è¿œèµ°ä»–ä¹¡ä¹‹è±¡ã€‚<br>äºŒã€ä¸€åˆ€æ’åœ°ï¼šæ±‚å¿«ä¹Ÿï¼Œåˆ˜å§“ä¹‹äººä¹Ÿã€‚<br>ä¸‰ã€ä¸€å…”èµ°ï¼šå¯å¹´ï¼Œåˆ˜å§“ã€‚<br>å››ã€ä¸€é¸¡åœ¨è¾¹é¸£ï¼šæœ‰ç«äº‰è±¡ï¼Œé…‰å¹´é€‚é€¢è´µäººæ•‘ã€‚<br>äº”ã€è´µäººäº‘ä¸­ï¼šä¸åŠæ•‘ä¹Ÿã€‚<br>å…­ã€é“å£«æ‰‹æŒ‡é—¨ï¼šå…¥ç©ºé—¨ä¹Ÿï¼Œé€ƒäº¡æ–¹å‘ï¼Œå‡ºå®¶ä¹Ÿã€‚",
            x: "è§£è„±ï¼Œèµ¦å…ã€‚èµ¦è¿‡å®¥ç½ªã€‚<br>åˆå…­ï¼šæ— å’ã€‚<br>ä¹äºŒï¼šç”°è·ä¸‰ç‹ï¼Œå¾—é»„çŸ¢ï¼Œè´ã€‚<br>å…­ä¸‰ï¼šè´Ÿä¸”ä¹˜ï¼Œè‡´å¯‡è‡³ï¼Œè´åã€‚<br>ä¹å››ï¼šè§£è€Œå§†ï¼Œæœ‹è‡³æ–¯å­šã€‚<br>å…­äº”ï¼šå›å­ç»´æœ‰è§£ï¼Œï¼Œæœ‰å­šäºå°äººã€‚<br>ä¸Šå…­ï¼šå…¬ç”¨å°„éš¼äºé«˜å¢‰ä¹‹ä¸Šï¼Œè·ä¹‹æ— ä¸åˆ©ã€‚",
            d: gd('N')+"é•¿å­å±…åŒ—ã€‚",
u:"æ­¤å¦å±€å¸¸è§ï¼Œä¹Ÿç›¸å½“ç‰¹æ®Šï¼š ä¸€ã€ä¸ºæ€§åˆšæ­¦å‹‡ä¹‹äººã€‚äºŒã€æ€»æ˜¯å®˜å¸æ˜¯éä¸æ–­ã€‚ä¸‰ã€æ— å©šã€‚å››ã€è‚–å…”äººï¼Œåˆ˜å§“äººï¼ŒæŸ³å§“äººï¼Œä¸»å‡¶ã€‚",
h: "ç”Ÿäºæ‚£éš¾ã€‚åå¹³å®‰ã€‚é€¢å…”è€Œèµ°ã€‚å¤±ä¸€å…„ã€‚å¼ƒæ­¦ä»æ–‡æ•°ä¸­å®šã€‚é€¢é¸¡åˆ™ä¸»å…¥ç©ºé—¨ã€‚æ­£å®˜å¸¦å°ã€‚å¯é‡‘ä¸€åˆ€äººï¼ˆå¦‚å§“åˆ˜ï¼‰ï¼Œå¤§å‰ã€‚",
 a: "å¤§å¿—æ¶ˆç£¨æ—¥æ²‰æ²‰ã€‚éš¾èˆä¼—ç”Ÿä¸€å…”äººã€‚é€¢é¸¡æœ‰æœºå±•é•¿æ‰ã€‚æ—¥åœ¨åºŠå¤´ä¸é¡»è™‘ã€‚",
 b: "æ˜¯éä¹‹å¹´ã€‚å…”äººä¸€åˆ€èµ°ä»–ä¹¡ï¼Œèº«åœ¨é€†æ—…ã€‚ä¸æ„é€¢é¸¡åå¾—åˆ©ï¼Œæ—¥å‡ºå±±å¤´ã€‚",
 e: "é“äººæŒ‡é—¨ï¼Œé—ªäººï¼ˆé—¨+äºº=é—ªï¼‰ã€‚å®˜ä¸å‡ï¼Œé…‰å¹´é¸¡äººå‡ã€‚",
 f: "é“äººæŒ‡é—¨ï¼Œé—ªäººï¼ˆé—¨+äºº=é—ªï¼‰ã€‚è´¢ä¸åˆ©ï¼Œé…‰å¹´é¸¡äººå¾—åˆ©ã€‚å›å…”ï¼Œè‚¡ç¥¨èµ¶å¿«åæ‰ï¼Œé€¢é¸¡é™¤å¤–ã€‚",
 g: "é“äººæŒ‡é—¨ï¼Œé—ªäººï¼ˆé—¨+äºº=é—ªï¼‰ï¼Œç»“å©šä¸åˆ©ï¼Œä¸å©šã€‚",
 l: "é¸¡äººäº‘ä¸­ï¼Œä¸€å…”ï¼Œåˆ˜å§“ï¼Œé¸¡äººå…”äººï¼Œé…‰å¯å¹´æ—¶çš†å‰ã€‚",
 m: "æ——ä¸Šæå­—ï¼ŒæåæŒ‡å‡¶ã€‚é€¢é¸¡å¯å¾—æ•‘ï¼Œä½†å±é¸¡æœ‰å‡¶ï¼Œå«é¸¡ä¹Ÿå‡¶ï¼Œé¸¡çš„æ—¶é—´å¯å¾—æ•‘ã€‚",
 z: "æš‚æ— ",

                             },
        41: {
            n: "å±±æ³½æŸ",
            t: "ä¸€ã€äºŒäººå¯¹é…Œï¼šäºŒäººå¤¹æœ¨ï¼Œæ¥ä¹Ÿã€‚<br>äºŒã€é…’ç“¶å€’æ¡ˆä¹‹ï¼šç›®å‰æ— æŒ‡æœ›ä¹Ÿã€‚<br>ä¸‰ã€çƒåœ¨åœ°ä¸Šï¼šæ‰€æ±‚ä¸æˆçŠ¶ã€‚<br>å››ã€æ–‡ä¹¦äºŒç­–æœ‰å†å‘ŠäºŒå­—ï¼šå†æ¬¡æ±‚ï¼Œæ–¹æˆã€‚",
            x: "æŸä¸‹ç›Šä¸Šï¼Œæƒ©å¿¿çª’æ¬²ã€‚<br>åˆä¹ï¼šå·²äº‹é„å¾€ï¼Œæ— å’ï¼Œé…ŒæŸä¹‹ã€‚<br>ä¹äºŒï¼šåˆ©è´ï¼Œå¾å‡¶ï¼Œå¼—æŸç›Šä¹‹ã€‚<br>å…­ä¸‰ï¼šä¸‰äººè¡Œï¼Œåˆ™æŸä¸€äººã€‚ä¸€äººè¡Œï¼Œåˆ™å¾—å…¶å‹ã€‚<br>å…­å››ï¼šæ¢å…¶ç–¾ï¼Œä½¿é„æœ‰å–œï¼Œæ— å’ã€‚<br>å…­äº”ï¼šæˆ–ç›Šä¹‹ï¼Œåæœ‹ä¹‹é¾Ÿï¼Œå¼—å…‹è¿ï¼Œå…ƒã€‚<br>ä¸Šä¹ï¼šå¼—æŸç›Šä¹‹ï¼Œæ— å’ï¼Œè´ï¼Œåˆ©æœ‰æ”¸å¾€ï¼Œå¾—è‡£æ— å®¶ã€‚",
            d: gd('W')+"ä¸‰å­å±…è¥¿ã€‚",
u:"æŸå±€åœ¨é˜³å®…ä¸Šé€ æˆå„¿å­é—®é¢˜å¤šå¤šï¼Œçˆ¶æ¯æ€»æ˜¯çƒ¦å¿ƒæ‹…å¿§ã€‚ ä¸€ã€ä¸åŒæ—¶ç”Ÿäººï¼Œå©šäº‹å»¶åä¸€å¹´æ–¹æˆï¼Œå¯¹æ–¹åŒä¸€äººã€‚äºŒã€å®˜è¿ä¸é€šï¼Œæ‰€æ±‚ä¸æˆã€‚ä¸‰ã€æ€§å–œæ±‚ä¹ï¼Œä¸æ±‚è¿›æ­¥ï¼Œé¡»ç»äºŒæ¬¡å¤§ç¾ï¼Œæ–¹èƒ½æ‚Ÿã€‚å››ã€å¯¹å®¶åº­æ€åº¦ï¼Œåªä¼šèŠ±é’±ï¼Œä¸ä¼šèµšé’±ï¼Œæ— æ‰€äº‹äº‹ã€‚",
h: "ä¸‰äººæŸä¸€äººã€‚æ”€é¾™é™„å‡¤æ±‚åŠŸåã€‚å§‹æˆç»ˆè´¥ä¸ºå®šæ•°ã€‚ä¸¾äººç»ˆèº«ã€‚ä¸è´ªå¯å¹³å®‰ã€‚çˆ¶ä¸çˆ¶ï¼Œå­ä¸å­ï¼Œä¸­é—´æœ‰ä¸ªä¸å®Œå¦»ã€‚",
 a: "æ˜æœˆå½“ç©ºï¼Œæ¸…é—²åº¦æ—¥ã€‚é‡äº‹åŠ›æ±‚åå¤±ï¼ˆæƒ³äº‰å–ï¼Œåå¤±å»ï¼‰ï¼Œå†æ¬¡å¯æˆã€‚",
 b: "äºŒäººåŒåŠ›ï¼Œæ‰€æ±‚åˆä¸æˆï¼Œå†æ¬¡å‰ã€‚å®˜äº‹ä¸å‡ï¼Œè´¢ç¦„ä¸æ±‚åå‰ã€‚",
 e: "å†å‘Šæ–‡ä¹¦ï¼Œåˆæ¬¡ä¸æˆï¼Œå†æ¬¡æˆã€‚",
 f: "å†å‘Šæ–‡ä¹¦ï¼Œåˆæ¬¡ä¸æˆï¼Œå†æ¬¡æˆã€‚",
 g: "å†å‘Šæ–‡ä¹¦ï¼Œåˆæ¬¡ä¸æˆï¼Œå†æ¬¡æˆã€‚",
 l: "å†å‘Šæ–‡ä¹¦ï¼Œåˆæ¬¡ä¸æˆï¼Œå†æ¬¡æˆã€‚",
 m: "æ˜æœˆå½“ç©ºï¼Œæ— ç¾ã€‚å¦‚æœ‰é‡ç—…æ±‚æ²»ï¼Œåˆæ¬¡ä¸æˆï¼Œå†æ¬¡æˆã€‚",
 z: "æš‚æ— ",

                             },
        42: {
            n: "é£é›·ç›Š",
            t: "ä¸€ã€å®˜äººæŠ±åˆå­ï¼šå€Œäººï¼Œä¸ˆå¤«ä¹Ÿï¼Œäº‹å¿…å…ˆæˆåç ´ã€‚<br>äºŒã€ä¸€äººæ¨è½¦ï¼šå› æ—¶è€ŒåŠ¨ä¹‹è±¡ï¼Œç©ºåç›¸è¯·ã€‚<br>ä¸‰ã€ä¸€é¹¿ä¸€é’±ï¼šæ‰ç¦„ä¿±å¤‡ï¼Œæœ‰å›ç¦„ä¹‹ç¾ï¼Œè´¢æœ‰ç ´æŸï¼Œå¿§å¿ƒå¿¡å¿¡ã€‚<br>å››ã€ä¸ä¸ºè´¢è´§ï¼Œä¸ç•æ—¶å°šä¹‹å˜ï¼Œæ˜çŸ¥å…ˆæˆåç ´ï¼Œä»èµ°é©¬ä¸Šä»»ï¼Œä»¥æŸä¸Šç›Šä¸‹ä¹‹é“ï¼Œå¤©ä¸‹æˆ–äº‹ä¸šäº¦èƒ½å¹³æ²»ã€‚",
            x: "å¢ç›Šï¼Œè§å–„åˆ™è¿ï¼Œæœ‰è¿‡åˆ™æ”¹ã€‚<br>åˆä¹ï¼šåˆ©ç”¨çˆ²å¤§ä½œï¼Œå…ƒï¼Œæ— å’ã€‚<br>å…­äºŒï¼šæˆ–ç›Šä¹‹ï¼Œåæœ‹ä¹‹é¾Ÿï¼Œå¼—å…‹è¿ï¼Œæ°¸è´ï¼Œç‹ç”¨äº«äºå¸ï¼Œã€‚<br>å…­ä¸‰ï¼šç›Šä¹‹ç”¨å‡¶äº‹ï¼Œæ— å’ã€‚æœ‰å­šä¸­è¡Œï¼Œå‘Šå…¬ç”¨åœ­ã€‚<br>å…­å››ï¼šä¸­è¡Œï¼Œå‘Šå…¬ä»ï¼Œåˆ©ç”¨çˆ²ä¾è¿å›½ã€‚<br>ä¹äº”ï¼šæœ‰å­šæƒ å¿ƒï¼Œå‹¿é—®å…ƒï¼Œæœ‰å­šæƒ æˆ‘å¾·ã€‚<br>ä¸Šä¹ï¼šè«ç›Šä¹‹ï¼Œæˆ–å‡»ä¹‹ï¼Œç«‹å¿ƒå‹¿æ’ï¼Œå‡¶ã€‚",
            d: gd('E')+"é•¿å¥³å±…ä¸œã€‚",
u:"ä¸€ã€é•¿å¥³ä¹‹å©šäº‹ä¸æˆï¼Œæˆ–æˆååˆç ´ã€‚äºŒã€è´¢ç¦„è¶³ï¼Œæœ‰ç¥–ä¸šï¼Œå·¥ä½œåˆ™åˆè¿‡äºç”·æ€§ã€‚ä¸‰ã€å¥³èº«ç”·æ€§ï¼Œè´µäººä¸ºç”·äººï¼Œå°äººä¸ºå¥³å­ã€‚å››ã€ä»å®˜è¿åˆ™å‰ï¼Œåˆ‡ä¸å¯è´ªç¦„ï¼Œä¸»å‡¶ã€‚",
h: "æ‰ç¦„å…·å¤‡ï¼Œèº«åœ¨è´µé—¨ã€‚æ‰¿ç»§ç¥–ä¸šï¼Œå‘æ‰¬å…‰å¤§ã€‚æ•°ä¸­å•ä¼ ï¼Œæœ‰å¼Ÿé¡»é˜²ã€‚å¯¿å¦‚æ¾æŸã€‚",
 a: "è¿è‡³æ—¶è¡Œï¼Œæ— å¾€ä¸åˆ©ã€‚é€¢å®˜åç ´ï¼Œæ±‚è´¢å¤§åˆ©ã€‚å…«å­—ï¼šä¼¼å‡¶è¿˜å‰ï¼Œå¤«å¦»å¹³å®‰ã€‚",
 b: "æ—¶æ¥è¿è½¬ã€‚æ±‚è´¢æ±‚å®˜çš†å¾—ã€‚é€¢èµŒåå‡¶ã€‚å¯è¿›ä¸å¯é€€ã€‚é€€å‡¶ã€‚é¡»é˜²ç«å„ï¼Œé˜²çªƒã€‚",
 e: "å®˜äººæŠ¥ç›’ï¼Œä¸€è½¦æ¥æ¥å¼•ï¼Œæ±‚å®˜å¾—å®˜ã€‚",
 f: "ä¸€é¹¿ï¼Œè´¢ç¦„ä¹Ÿï¼Œä¸€ç›’å­ï¼Œé˜²æ­¢å…ˆæˆåç ´ã€‚ä¸²é’±åœ¨åœ°ï¼Œè¢«å·åˆ‡ä¹‹è±¡ï¼Œé˜²çªƒã€‚",
 g: "ä¸€ç›’å­ï¼Œå’Œåˆä¹Ÿï¼Œå¯å©šï¼Œé˜²æ­¢ç¦»å©šã€‚",
 l: "è´¢é¹¿å…·å¤‡ï¼Œæ‰ç¦„å…·å¤‡ï¼Œæœ‰è½¦æ¥å¼•ï¼Œæœ‰ä½ç½®å¯ä¸Šä¹Ÿï¼Œå¯ä¸­ã€‚",
 m: "é‡‘é’±åœ¨åœ°ä¸¤ä¸²ï¼Œå¿§å¿ƒå¿¡å¿¡ï¼Œçƒ§çº¸é’±ä¹‹è±¡ã€‚",
 z: "æš‚æ— ",

                             },
        43: {
            n: "æ³½å¤©å¤¬",
            t: "ä¸€ã€äºŒäººåŒè¡Œï¼šç›¸è¾…ç›¸æˆï¼Œå¯æˆäº‹ä¹Ÿã€‚<br>äºŒã€å‰æ°´åç«ï¼šå‰é™©è€Œåæ˜ï¼Œå®œè¿›å–è±¡ï¼ŒåœŸç”Ÿé‡‘è±¡ã€‚<br>ä¸‰ã€è™è›‡å½“é“ï¼šè™ï¼Œæœ‰æƒå¨ä¹‹äººã€‚è›‡â€”é™©å¥¸ä¹‹å°äººé˜»é“ã€‚<br>å››ã€ä¸€äººæ–©è›‡ï¼šå‹‡å£«ä¹Ÿï¼Œå¾—åå°†ä¹Ÿã€‚<br>äº”ã€ç«¿ä¸Šæœ‰æ–‡å­—ï¼šæ‰¬ç«¿è€Œèµ·ï¼Œæ­£åå‡ºå¸ˆã€‚<br>å…­ã€ç«¿ä¸‹æœ‰é’±ï¼šè¡ŒåŠ¨æœ‰åˆ©ä¹Ÿã€‚<br>ä¸ƒã€é’±ä¸‹æœ‰ç«ï¼šçƒ§é’±çŠ¶ï¼Œä¸»ä¸§æœã€‚",
            x: "å†³ä¹Ÿï¼Œåˆšå†³æŸ”ã€‚æ–½ç¦„åŠä¸‹ã€‚<br>åˆä¹ï¼šå£®äºå‰è¶¾ï¼Œå¾€ä¸èƒœçˆ²å’ã€‚<br>ä¹äºŒï¼šæƒ•å·ï¼Œè«å¤œæœ‰æˆï¼Œå‹¿æ¤ã€‚<br>ä¹ä¸‰ï¼šå£®äºé „ï¼Œæœ‰å‡¶ã€‚å›å­å¤¬å¤¬ï¼Œç‹¬è¡Œé‡é›¨ï¼Œè‹¥æ¿¡æœ‰æ„ ï¼Œæ— å’ã€‚<br>ä¹å››ï¼šè‡€æ— è‚¤ï¼Œå…¶è¡Œæ¬¡ä¸”ï¼Œç‰µç¾Šæ‚”äº¡ï¼Œé—»è¨€ä¸ä¿¡ã€‚<br>ä¹äº”ï¼šè‹‹é™†å¤¬å¤¬ï¼Œä¸­è¡Œæ— å’ã€‚<br>ä¸Šå…­ï¼šæ— å·ï¼Œç»ˆæœ‰å‡¶ã€‚",
            d: gd('NW')+"ä¸‰å¥³å±…è¥¿åŒ—ã€‚",
u:"ä¸€ã€å©šäº‹å»¶å®•ä¸æˆã€‚äºŒã€æ€§åˆšä»æ­¦ï¼Œæ€§æŸ”ä»å®—æ•™ï¼Œå¾äººå¯ä»å…«å­—ä¸­çœ‹å‡ºã€‚ ä¸‰ã€äº‹ä¸šå…ˆä¸»å‡¶åå‰ï¼Œä¸»è‡ªè¡Œå‘å±•ã€‚å››ã€ç§‘ç”²ä¸å…´ã€‚äº”ã€èº«ä½“å¥åº·å·®ï¼Œä¸é•¿å¯¿ï¼Œä¸‰åå²å‰æœ‰å‡¶é™©ã€‚",
h: "ä¸€ç”Ÿè¾›è‹¦ã€‚ç™½æ‰‹æˆå®¶ã€‚æ±‚ç§‘ç”²å‰ï¼Œæ±‚è´¢åˆ©å°‘ã€‚å¥³å‘½ä¸ºå¸ˆé“ï¼Œç»ˆèº«å¯å‰ï¼Œç”·ä¸ºæ­¦å®˜å‰ã€‚æ±‚å®˜æ±‚å¯Œï¼Œæ‹›å®³éš¾å…ã€‚å©šäº‹éš¾æˆã€‚é€¢è™åˆšæ–­ä¹ƒäº¨ã€‚",
 a: "é€¢åœŸé‡‘ä¹‹å¹´ï¼Œå‰é™©è·¯é˜»ã€‚å•†äººæ±‚è´¢ä¸åˆ©ï¼Œåªå‘æ­¦å°†ã€‚é‡è™å¤§è´µï¼Œå¯é€¢å‡¶åŒ–å‰ã€‚å¤«å¦»ç›¸åŠ©ã€‚æ— å­ç›¸ç»§ã€‚",
 b: "å©šäº‹æ˜“æˆã€‚å¤–åœ†å†…æ–¹ï¼Œå¤©åœ°äº¤æ³°ï¼ˆéœ€å¤–åœ†å†…æ–¹ï¼‰ã€‚è´¢æ°”æ¬ æ—ºï¼Œå¾—åˆ©äºŒä¸‰åˆ†ã€‚å®¶æœ‰ä¸§æœã€‚",
 e: "è™è›‡æŒ¡é“ï¼Œå°äººæŒ¡é“ï¼Œå‹‡å£«æ–©è›‡ï¼Œå¾—äººå¸®åŠ©ï¼Œç«æ˜å‰æ°´ï¼Œå®˜å¯å‡ï¼Œæœ€å¥½ä»¥æ˜è€ŒåŠ¨ã€‚",
 f: "ç«ä¸‹ä¸‰é’±ï¼Œæ­¤ä¸ºç«åœŸç”Ÿé”»é‡‘ä¹‹è±¡ï¼Œå¯åšã€‚",
 g: "ä¸¤äººæ‹±æ‰‹ï¼Œå’Œåˆä¹Ÿï¼Œå©šäº‹å¯æˆã€‚",
 l: "æ——ä¸Šé«˜æŒ‚æ–‡å­—ï¼Œé«˜ä¸­ä¹Ÿã€‚",
 m: "é‡ç—…è€…ç«çƒ§ä¸‰é’±ï¼Œçº¸é’±ä¹Ÿï¼Œæœ‰ä¸§è‘¬ä¹‹è™ã€‚",
 z: "æš‚æ— ",

                             },

        44: {
            n: "å¤©é£å§¤",
            t: "ä¸€ã€å®˜äººå°„é¹¿ï¼šä¸ˆå¤«ä¹Ÿï¼Œå–ç¦„çŠ¶ï¼Œé‡å¤–ä¹‹è´¢ï¼Œå°„ï¼Œå‘ä¹Ÿã€‚<br>äºŒã€æ–‡ä¹¦ä¸Šæœ‰å–œå­—ï¼šæ‘‡æ‘‡æ¬²å ï¼Œæ ¹åªä¸€çº¿ï¼Œå¤«å¦»å‡¶ã€‚<br>ä¸‰ã€äºŒäººæ‰§ç´¢ï¼šäº’ç›¸ç‰µç´¯ã€‚<br>å››ã€ç»¿è¡£äººæŒ‡è·¯ï¼šæŒç”Ÿæ­»ç°¿ä¹‹äººï¼Œä¿¡å·®ï¼ˆä»Šæ—¥ï¼‰ã€‚<br>äº”ã€äºŒé‡å±±ï¼šé‡é˜»ä¹Ÿã€‚å‡ºä¹Ÿã€‚",
            x: "é‡ä¹Ÿï¼Œå¥³å£®ï¼Œå‹¿ç”¨å–å¥³ã€‚<br>åˆå…­ï¼šç³»äºé‡‘æŸ…ï¼Œè´ï¼Œæœ‰æ”¸å¾€ï¼Œè§å‡¶ï¼Œç¾¸è±•å­šè¹¢èº…ã€‚<br>ä¹äºŒï¼šåŒ…æœ‰é±¼ï¼Œæ— å’ï¼Œä¸åˆ©å®¾ã€‚<br>ä¹ä¸‰ï¼šè‡€æ— è‚¤ï¼Œå…¶è¡Œæ¬¡ä¸”ï¼Œå‰ï¼Œæ— å¤§å’ã€‚<br>ä¹å››ï¼šåŒ…æ— é±¼ï¼Œèµ·å‡¶ã€‚<br>ä¹äº”ï¼šä»¥æåŒ…ç“œï¼Œå«ç« ï¼Œæœ‰æŸè‡ªå¤©ã€‚<br>ä¸Šä¹ï¼šå§¤å…¶è§’ï¼Œåï¼Œæ— å’ã€‚",
            d: gd('SE')+"çˆ¶å±…ä¸œå—ã€‚",
u:"å¾äººå¸¸è§ä¸ˆå¤«åœ¨å¤–é£æµå¤šäº‹ï¼Œæ¡ƒèŠ±è¿ä¸æ–­ï¼Œå°±æ˜¯æ­¤å±€ç”Ÿæˆã€‚ ä¸€ã€ å•†äººè´¢ç¦„ä¸°ç››ï¼Œåªæ—ºå…­å¹´ï¼Œé¡»æ³¨æ„å‡åƒã€‚äºŒã€ å®˜å¸å—ç‰µè¿ï¼ŒåŒæ—¶ç”Ÿäººå¯èƒ½æ²¡äº‹ã€‚ä¸‰ã€ å¤–æœ‰å¦¾åŠå¤šä½å¥³å‹ã€‚",
h: "å¤–æŸ”å†…åˆšã€‚ç”·ä¸»ä¸€å¦»åˆä¸€å¦»ã€‚å¥³ä¸»ä¸€å¤«åˆä¸€å¤«ã€‚èº«çŸ­æ‰é«˜ã€‚è´¢å®˜åŒç¾ã€‚å”¯æœ‰å©šå§»å¦‚çº¿ï¼Œæ˜“æ–­ã€‚æ•°ä¸­å››äººã€‚ä¸€å¤–ã€äºŒå®˜ã€ä¸€å‡¶ã€‚",
 a: "ç»ˆèº«å¿™ç¢Œã€‚å¤«å¦»åŒåºŠå¼‚æ¢¦ã€‚ä¾¥å¹¸å¾—è´¢ï¼Œå´é˜²å®˜ç´¯ã€‚åˆä¼™æœ‰äº‹ä¸”ä¸å®œã€‚",
 b: "å¾—æ„å¤–è´¢ã€‚å©šäº‹å·²æˆã€‚å‡ºè¡Œå¤§åˆ©ã€‚å¤§å¤´è´µäººï¼Œå°å¤´äº‹å‡¶ï¼Œç§‘ç”²å‰ã€‚",
 e: "å–œå­—æ–‡ä¹¦ï¼Œå®˜äººæ‘†æ‰‹ï¼Œç»³ç´¢ç‰µè¿ï¼Œå¯å‡ï¼Œä½†å‹¿è¦ä¸Šä»»ï¼Œå—ç‰µè¿ä¹Ÿã€‚è´ªæ±¡åŠ å‡¶ã€‚",
 f: "ä¸€é¹¿åœ¨é‡ï¼Œå‘é‡å¤–ä¹‹è´¢ï¼Œå¯åšï¼Œå°¤å…¶åˆ©è‚¡ç¥¨ç­‰ã€‚",
 g: "å¯å©šï¼Œå©šåæ˜“å‡ºè½¨ï¼Œç”·å¥³çš†æ˜¯ã€‚ç¦»å©šæ¬²ä¸ç¦»å©šåªåœ¨ä¸€çº¿ä¹‹é—´ã€‚",
 l: "æ–‡ä¹¦æœ‰å–œï¼Œè¿œå°„ï¼Œå¯ä¸­ã€‚",
 m: "ç»¿è¡£äººæŒ‡è·¯ï¼Œæ­¤ä¸ºç‰›å¤´é©¬é¢æŒ‡å¼•ä¹Ÿã€‚å°å¿ƒå¿ƒè„ç—…ï¼Œä¸­é£ã€‚",
 z: "æš‚æ— ",

                             },

        45: {
            n: "æ³½åœ°èƒ",
            t: "ä¸€ã€è´µäººç£¨ç‰ï¼šè¿›ä¿®ä¹Ÿï¼Œä¸“å¿ƒä¸€è‡´ä¹Ÿï¼Œå…ç ´æŸä¹Ÿã€‚<br>äºŒã€ä¸€åƒ§æŒ‡ï¼šæŒ‡å¼•ä¹Ÿï¼Œå±€å¤–äººä¹Ÿï¼Œå…‰å¤´äººä¹Ÿï¼Œæ›¾å§“äººä¹Ÿã€‚<br>ä¸‰ã€å°å„¿å±±è·¯ï¼šé€€å¼•å±±æ—ï¼Œä»¥é€€ä¸ºè¿›è±¡ï¼Œç¤ºä¸Šå¡ä¹Ÿã€‚å€ªå§“ã€‚<br>å››ã€ä¸€äººæ•‘ç«ï¼šæ•‘ç¾ç¥¸ä¹Ÿï¼›çŠ¹è¡ŒåŒ»æµä¸–æ•‘äººä¹‹é“ä¹Ÿã€‚<br>äº”ã€ä¸€é±¼åœ¨ç«ä¸Šï¼šå¾—æ•‘çŠ¶ï¼Œæˆ–é¤é¥®ä¸šã€‚<br>å…­ã€ä¸€å‡¤å•£ä¹¦ï¼šå–œè®¯è‡³ä¹Ÿã€‚",
            x: "èšä¹Ÿï¼Œé¡ºå¤©å‘½ã€‚é™¤æˆå™¨æˆ’ä¸è™ã€‚<br>åˆå…­ï¼šæœ‰å­šä¸ç»ˆï¼Œä¹ƒä¹±ä¹ƒèƒï¼Œè‹¥å·ï¼Œä¸€æ¡çˆ²ç¬‘ï¼Œå‹¿æ¤ï¼Œå¾€æ— å’ã€‚<br>å…­äºŒï¼šå¼•ï¼Œæ— å’ï¼Œå­šä¹ƒåˆ©ç”¨ç¦´ã€‚<br>å…­ä¸‰ï¼šèƒå¦‚ç£‹å¦‚ï¼Œæ— æ”¸åˆ©ï¼Œå¾€æ— å’ï¼Œå°åã€‚<br>ä¹å››ï¼šå¤§æ— å’ã€‚<br>ä¹äº”ï¼šèƒæœ‰ä½ï¼Œæ— å’ã€‚åŒªå­šï¼Œå…ƒæ°¸è´ï¼Œæ‚”äº¡ã€‚<br>ä¸Šå…­ï¼šèµå’¨æ¶•æ´Ÿï¼Œæ— å’ã€‚",
            d: gd('SW')+"ä¸‰å¥³å±…è¥¿å—ã€‚",
u:"è¾ƒä¸å¤šè§ï¼Œä½†äº¦æœ‰ä¹‹ã€‚ä¸€ã€å¥³å„¿ä¸æƒ³æˆå©šï¼Œå¯¹å¼‚æ€§æ²¡å…´è¶£ã€‚äºŒã€ç»ˆæ—¥è¿›å¾·ä¿®ä¸šã€‚äºŒã€é€€å±…å®¶å†…ï¼Œä»£æ¯è¡ŒèŒï¼Œä¸ºè‰¯æ¯å‹ä¹‹äººã€‚å››ã€å¦‚ä»äº‹é¤é¥®ä¸šåˆ™å¤§åˆ©ï¼Œä¸ºå”¯ä¸€å¸¦å–œä¹‹è·¯ã€‚",
h: "çŸ³ä¸­éšç‰ã€‚å°æ—¶é‡åå¸ˆã€‚ä¸€å­å†…äººï¼Œä¸€å­å¤–äººã€‚å¹³æ­¥é’äº‘ï¼Œç¾éš¾å¹³ï¼Œç§‘ç”²é¡ºï¼Œå¤šæ‰è‰ºï¼Œæ•‘äººäº‹ä¸šï¼ˆå¦‚æ¶ˆé˜²é˜Ÿï¼‰ï¼Œå§‹ç»ˆå¦‚ä¸€ã€‚å‘å…‰å¤´ä¸æ›¾äººï¼Œé±¼ä¸‹æ—¥ï¼Œé²ã€‚ç‰åœ¨å…¶ä¸­ï¼Œé‡æ­¤ç§äººï¼ŒåŠ å‰ã€‚",
 a: "ä¸­å¹´æˆå°±ã€‚ç¦„å‘½ä¹é‡æ¥ã€‚æœ¬å¾…é€€éšï¼Œå¤©ä¸ç”±äººï¼Œä¸°åšä¹‹æ—¶ã€‚ä¸€åƒ§ä¸€å°¼é€¢è´¯é±¼ï¼ŒåŠŸæˆåå°±ã€‚",
 b: "è¿›å¾·ä¿®ä¸šï¼Œè€å¿ƒå¾…æ—¶æœºã€‚å¿…å‰ã€‚æ±‚ç§‘é«˜ä¸­ï¼Œå¯åˆ›æ–°äº‹ä¸šã€‚",
 e: "å‡¤å‡°æ¥ä»ªï¼Œå®˜å‡ã€‚",
 f: "çŸ³ä¸­éšç‰ï¼Œè°¨æ…æ‰“ç£¨ï¼Œå¯æˆï¼Œä½†è¦å°å¿ƒã€‚é¤é¥®ä¸šå¤§æˆã€‚",
 g: "å‡¤å‡°æ¥ä»ªï¼Œå©šæˆã€‚",
 l: "æ­¤ä¸ºé‡åå¸ˆæˆ–è€…å·±ä¸ºåå¸ˆä¹‹å…†ã€‚ç§‘ç”²é«˜ä¸­ã€‚",
 m: "é±¼è¢«æ°´æ•‘ï¼Œæœ‰æ•‘ä¹Ÿã€‚",
 z: "æš‚æ— ",

                             },
        46: {
            n: "åœ°é£å‡",
            t: "ä¸€ã€äº‘ä¸­é›¨ç‚¹ä¸‹ï¼šæ²¾è¡£æ©æ³½ä¹‹è±¡ï¼Œæ˜æš—ä¹‹æ—¶å°†è¿‡ä¹Ÿã€‚<br>äºŒã€æœ¨åŒ ä¸‹å¢¨è§£æœ¨ï¼šæœ‰å°ºåº¦æ³•åˆ™ï¼Œæœ‰ä¾æ®ä¹‹è±¡ã€‚åŒ â€”å°†ä¹Ÿã€‚ä»¥æ­¦åŠ›å»ç¾ä¹Ÿæœ‰æ”¹æœæ¢ä»£ä¹‹è±¡ä¹Ÿã€‚<br>ä¸‰ã€ä¸€äººç£¨é•œï¼šå¯æˆå§‹å¾—ä¹‹è±¡ã€‚<br>å››ã€ä¸€æ¶å­è´Ÿå¤§æœ¨ï¼šæœ‰ä¸å°ä¹‹è´¢ä¹Ÿã€‚<br>äº”ã€æœ‰é•œï¼šæŒ‡æ˜é•œé«˜æ‚¬ï¼Œäºå•†äº‹æŒ‡æœ‰ç«äº‰ä¹Ÿã€‚<br>å…­ã€è“ï¼šéš¾ä¹Ÿï¼Œç™¾åºŸå¾…ä¸ä¹‹è±¡ã€‚",
            x: "è¿›ä¹Ÿï¼Œç§¯å°æˆå¤§ã€‚é¡ºå¾·ã€‚<br>åˆå…­ï¼šå…å‡ï¼Œå¤§ã€‚<br>ä¹äºŒï¼šå­šä¹ƒåˆ©ç”¨ç¦´ï¼Œæ— å’ã€‚<br>ä¹ä¸‰ï¼šå‡è™šé‚‘ã€‚<br>å…­å››ï¼šç‹ç”¨äº«äºå²å±±ï¼Œ ï¼Œæ— å’ã€‚<br>å…­äº”ï¼šè´ï¼Œï¼Œå‡é˜¶ã€‚<br>ä¸Šå…­ï¼šå†¥å‡ï¼Œåˆ©äºä¸æ¯ä¹‹è´ã€‚",
            d: gd('SE')+"æ¯å±…ä¸œå—ã€‚",
u:"å…¶ä¸ºå§¤å¦ä¹‹å¯¹åº”å¦ï¼Œåœ¨åœ°è„‰é“ä¹‹å±¡è§ä¸é²œï¼Œå­¦è€…å½“å·²å¨´ç†Ÿäºå¦ å±€ä¹‹å˜åŒ–ï¼Œç«‹å¯çŸ¥æ™“ã€‚ä¸€ã€å®˜èŒå¤§åˆ©ï¼Œå¹³æ­¥é’äº‘ã€‚äºŒã€äº‹ä¸šè´¢ç¦„ä¸°ç››ã€‚ä¸‰ã€èƒ½æ‰¿ç»§ç¥–ä¸šï¼Œæ›´æ–°é—¨é¢ã€‚å››ã€å¤«å¦»æœ‰ç«äº‰ï¼Œä¸å’Œä¹‹è±¡ã€‚äº”ã€æ­¤å±€ä¸å˜ï¼Œå©šå§»è¿›å…¥ç¬¬ä¸ƒå¹´å¿…æœ‰å‡¶ï¼ŒåŒæ—¶ç”Ÿäººä¸ä¸€å®šä¼šå‘ ç”Ÿï¼Œæ•…é˜³å®…å½±å“ä¸€äººè‡³å¤§ï¼Œè€Œäººä»¬å´èŒ«ç„¶ä¸çŸ¥ã€‚",
h: "ä¹…æ—±é€¢é›¨ï¼Œå…‰è€€ç¥–å®—ã€‚å…­äººå…„å¼Ÿï¼Œå››æ˜äºŒæš—ã€‚ä»»é‡é“è¿œä¹‹æ‰ã€‚æ”¹æœæ¢ä»£ï¼Œæ‰é«˜å…«æ–—ã€‚é€¢æœ¨æœ‰äº‰ï¼Œä¸åºŸè§„çŸ©ï¼Œé€¢å‡¶ä¹Ÿå‰ã€‚å³æ˜¯é™‹è§„ï¼Œäº¦ä¸å¯è¿åã€‚",
 a: "æ˜æš—å°†è¿‡ï¼Œå‡ºé›¨æœ¨å­äººã€‚é€¢é‡‘ç›¸å…‹ã€‚æ”¹æœæ¢ä»£ã€‚å¤«å¦»å…´å®¶å®¶ä¸šå¥½ï¼Œæœ‰è§„æœ‰çŸ©ã€‚",
 b: "é²ç­é—¨ä¸­ï¼Œå–œå¾—éºŸå„¿ã€‚é›¨è¿‡å¤©é’ï¼Œå…´å®¶æœ‰æœ›ã€‚åšå¿ƒå‘é“ï¼Œç»ˆå¿…å‰æœã€‚å©šäº‹å‰ã€‚å¾—å¥³ä¸»è´µã€‚å¤©æœºï¼šå–å®¶å…·ä¹‹äººå¤§è´µã€‚",
 e: "ä¸€ç¯®å­ï¼Œä¸€åŒ äººï¼Œå¼€å§‹éš¾ï¼Œç»ˆå‡ã€‚",
 f: "ä¸€æœ¨ï¼Œå·¨è´¢ä¹Ÿã€‚",
 g: "ç£¨é•œï¼Œè¦å°å¿ƒæ‰ä¼šæˆï¼Œå¦åˆ™ä¸æˆã€‚é˜²æ­¢ç¦»å©šã€‚",
 l: "ä¸€é•œé«˜æ¶ä¸Šï¼Œç£¨é•œï¼Œè¦å°å¿ƒè°¨æ…æ‰ä¼šä¸Šã€‚",
 m: "ä¸€æœ¨+ä¸€äºº=ä¼‘ï¼Œä¸€å®˜+ä¸€æœ¨ç­‰äºæ£ºï¼Œé‡ç—…å°†ä¼‘ã€‚",
 z: "æš‚æ— ",

                             },
        47: {
            n: "æ³½æ°´å›°",
            t: "ä¸€ã€ä¸€è½®ç‹¬åœ¨åœ°ä¸‹ï¼šç‹¬è¡Œä¹Ÿæ— ä¾ä¹Ÿï¼Œæ–¹å‘ä¸æ˜ä¹Ÿã€‚<br>äºŒã€ä¸€äººå§ç—…ï¼Œæ‹›å±éš¾ä¹Ÿã€‚<br>ä¸‰ã€è¯ç‚‰ï¼šæœ‰äººæ¥æ•‘ï¼Œå¾…æ—¶ç¼“è¿›ä¹Ÿã€‚<br>å››ã€è´µäººå€¾æ°´æ•‘æ—±æ± é±¼ï¼šæ—±æ± ï¼Œæ— è´¢ä¹Ÿï¼Œæœ‰è´µäººèµ„æ´ã€‚<br>äº”ã€æ± ä¸­é’è‰ï¼šä»æœ‰ç”Ÿæ°”çŠ¶ã€‚",
            x: "å›°å¢ƒï¼Œæ‰æ™ºéš¾å±•ã€‚è‡´å‘½é‚å¿—ã€‚<br>åˆå…­ï¼šè‡€å›°äºæ ªæœ¨ï¼Œå…¥äºå¹½è°·ï¼Œä¸‰å²ä¸è§Œã€‚<br>ä¹äºŒï¼šå›°äºé…’é£Ÿï¼Œæœ±ç»‚æ–¹æ¥ï¼Œåˆ©ç”¨äº«ç¥€ï¼šå¾å‡¶ï¼Œæ— å’ã€‚<br>å…­ä¸‰ï¼šå›°äºçŸ³ï¼Œæ®äºè’ºè—œï¼Œå…¥äºå…¶å®«ï¼Œä¸è§å…¶å¦»ï¼Œå‡¶ã€‚<br>ä¹å››ï¼šæ¥å¾å¾ï¼Œå›°äºé‡‘è½¦ï¼Œåï¼Œæœ‰ç»ˆã€‚<br>ä¹äº”ï¼šåŠ“åˆ–ï¼Œå›°äºèµ¤ç»‚ï¼Œä¹ƒå¾æœ‰è¯´ï¼Œåˆ©ç”¨ç¥­ç¥€ã€‚<br>ä¸Šå…­ï¼šå›°äºè‘›è—Ÿï¼Œäºè‡²å¼ï¼Œæ›°åŠ¨æ‚”ã€‚æœ‰æ‚”ï¼Œå¾ã€‚",
            d: gd('N')+"ä¸‰å¥³å±…åŒ—ã€‚",
u:"å›°ä¹‹äºäººå¤§çŸ£ï¼Œå¾é“äººå£«èƒ½ä¸ºä¼—ç”Ÿè§£å¼€æ­¤å±€ï¼Œäº¦æ— é‡åŠŸå¾·ä¹Ÿã€‚ ä¸€ã€ä½“å¼±å¤šç—…ï¼Œé™ä¸è¿‡ä¸‰åå²ã€‚äºŒã€æ€§åˆšçƒˆï¼Œç‹¬è¡Œç‹¬æ–­ã€‚ ä¸‰ã€å©šäº‹ä¸æˆï¼Œå¤šæœ‰é˜»æ»ã€‚å››ã€è´¢ç¦„ä¸å®ˆï¼Œåªæœ‰ä¸€çº¿ç”Ÿæœºï¼Œæ•…ä»å•†å¿…å‡¶ã€‚",
h: "çˆ¶å…¨æ¯ä¸å…¨ï¼Œç—…é‡ã€‚åŠ¿å•åŠ›è–„ï¼Œæ±‚æ•‘æ— é—¨ã€‚å·§è‰ºå®‰èº«ï¼ˆå¦‚ç¦å¾·å®«åä¸ƒæ€ï¼Œå·§è‰ºå®‰èº«ï¼‰ã€‚æœ‰å¿—ä¸æˆã€‚ä¸€è¶³æœ‰ç–¾ï¼Œå‰ç”Ÿå·²å®šã€‚é€¢æ°´ä¸»å¤§è´µäººåŠ©ã€‚",
 a: "é³å±…ä¹‹äººï¼Œä¸€äººå§ç—…ã€‚ç‹¬è¡Œæ— ä¾ï¼Œååæœ‰ç”Ÿæ°”ï¼Œä¸æ­»ã€‚ä¸ç”Ÿè´ªå¿µï¼Œæ­£è´¢åˆ°è€ï¼Œå¯åˆ°è€å¹³å®‰ã€‚",
 b: "è¡Œä¸å¾—ä¹Ÿã€‚å®¶äººæœ‰ç¾ã€‚äº‹ä¹ƒæ‹›å›°ã€‚å©šäº‹ä¸æˆã€‚ä¸è´ªä¸æ±‚ï¼Œå”¯æ‚¦å¯è§£ã€‚",
 e: "é±¼è¢«å›°æ— æ°´ï¼Œæ­¤ä¸ºè¢«å›°ä¸å‡ï¼Œè½¦è½®ä¸€ä¸ªï¼Œæ— ä¾æ— é ä¸å‡ã€‚",
 f: "æ± ä¸­æ— æ°´ï¼Œæ— è´¢ä¹Ÿã€‚é±¼è¢«å›°ï¼Œé‡å¤§é™©ä¹Ÿï¼Œä¸åšã€‚",
 g: "æ± ä¸­æ°´ä¸è¶³ï¼Œå½“å‰æ— å¸Œæœ›ã€‚ä»æœ‰äººæ¥æ•‘ï¼Œå°šæœ‰å¯èƒ½ã€‚",
 l: "æ± ä¸­æ°´ä¸è¶³ï¼Œå½“å‰æ— å¸Œæœ›ã€‚ä»æœ‰äººæ¥æ•‘ï¼Œå°šæœ‰å¯èƒ½ã€‚",
 m: "ä¸€äººå§åºŠï¼Œä¸€äººæ•‘é±¼ï¼Œæ­¤ä¸ºé‡ç—…å°šæœ‰æ•‘æ²»å¸Œæœ›ã€‚",
 z: "æš‚æ— ",

                             },
        48: {
            n: "æ°´é£äº•",
            t: "ä¸€ã€é‡‘ç”²ç¥æ‰§ç¬¦ï¼šè´µäººåœ¨ç©ºä¸­ï¼Œç¥¥ç‘ä¹‹å…†ä¹Ÿã€‚<br>äºŒã€å¥³å­æŠ±åˆï¼šå¥½ä¹Ÿï¼Œä½†å…ˆæˆåç ´ã€‚<br>ä¸‰ã€é’±å®æœ‰å…‰èµ·ï¼šè´¢ä¸å¤±ï¼Œä¸éœ²ä¹‹è±¡ï¼Œä¸ä¹…æœ‰ä¸§ä¹Ÿã€‚<br>å››ã€äººè½äº•ä¸­ï¼šç—…é‡è±¡ï¼Œå®˜å¸æ²ˆé™·è±¡ï¼Œæ‹›é™·å®³ä¹Ÿã€‚<br>äº”ã€å®˜äººç”¨ç»³å¼•å‡ºï¼šè´µäººä¸ºå®˜äººï¼Œæ¬²ç›¸æ•‘ä¹Ÿã€‚<br>å…­ã€ç¬¦ï¼šç¬¦ä¹ƒç­–ç•¥æœ‰å‚äººä½œå¯¹ã€‚",
            x: "äº•å…»ï¼Œå…»äººã€‚åŠ³æ°‘åŠç›¸ã€‚<br>åˆå…­ï¼šäº•æ³¥ä¸é£Ÿï¼Œæ—§äº•æ— ç¦½ã€‚<br>ä¹äºŒï¼šäº•è°·å°„é²‹ï¼Œç“®æ•æ¼ã€‚<br>ä¹ä¸‰ï¼šäº•æ¸«ä¸é£Ÿï¼Œçˆ²æˆ‘å¿ƒæ»ï¼Œå¯ç”¨æ±²ï¼Œç‹æ˜å¹¶å—å…¶ç¦ã€‚<br>å…­å››ï¼šäº•ç”ƒï¼Œæ— å’ã€‚<br>ä¹äº”ï¼šäº•æ´Œï¼Œå¯’æ³‰é£Ÿã€‚<br>ä¸Šå…­ï¼šäº•æ”¶å‹¿å¹•ï¼Œæœ‰å­šå…ƒã€‚",
            d: gd('SE')+"äºŒå­å±…ä¸œå—ã€‚",
u:"ä¸€ã€å©šäº‹å¨¶äºŒå©šå¦»ï¼Œä¸”å¦»é•¿ã€‚äºŒã€å¿ƒå¿—ä¸åšï¼Œå—å¤–åœ¨è¯±æƒ‘ï¼Œæ— æ³•è‡ªæ‹”ã€‚ä¸‰ã€ä»å•†å‰ï¼Œæœ‰ç¥–ä¸šæ›´å‰ã€‚å››ã€ä»å®˜æ‹›é™·ï¼Œæ˜¯éä¸æ–­ï¼Œå‡è¿å—é˜»ã€‚",
h: "å››åæœ‰å…«å¤´ä¹å£ï¼ˆå¦‚æœ±ï¼‰ã€‚å¤§é™ä¸å‡ºå››åã€‚ä¸€ç”Ÿè´¢æ¥è´¢å»ã€‚å”¯æœ‰å®˜æ˜¯è´µã€‚é€¢ç”³æ€»æ˜¯å‡¶ã€‚é‡å¥³åˆ™å‰ã€‚",
 a: "å®‰èº«å‹¿åŠ¨ï¼Œå®ˆé“æ— äºã€‚äº•é¢ˆä¹‹æˆ’ã€‚è¯¸äº‹ä¸é¡ºã€‚é€¢ç”³å¹´å°¤å‡¶ã€‚å¤§é™æ•°ç»ˆã€‚å¤«ç•™å¦»ä¸ç•™ã€‚",
 b: "ç—…å±ä¹‹æ—¶ï¼Œå³æœ‰è´µäººåŠ©ã€‚å¾¬äººä½œå¯¹ã€‚ä¸§äº‹ä¸ä¹…ã€‚å…ˆæˆåç ´ã€‚æœ‰è´¢ä¸å¤±ã€‚å¤§é™æ•°ç»ˆã€‚",
 e: "å®˜äººäº•ä¸­ï¼Œé‡é™©ä¹Ÿï¼Œæ‹›å‡¶ã€‚ä¸å‡ã€‚å®˜å¸ï¼Œä¼ ç¥¨ç­‰ç­‰ã€‚",
 f: "é‡‘å®ä¸€å †ï¼Œæœ‰åˆ©å¯å®ˆã€‚å®˜äººäº•ä¸­ï¼Œå†’è¿›é­é™·å®³ï¼Œäº¦å®ˆä¸äº¦è¿›ã€‚",
 g: "å¥³äººæŠ±ç›’å­ï¼Œå©šå§»å¯æˆï¼Œä½†å©šåé‡é™©ï¼Œææœ‰ç¦»å©šã€‚",
 l: "å®˜äººæ‰§ç¬¦ï¼Œæœ‰å¸Œæœ›ä¸­ä¹Ÿã€‚",
 m: "é’±å®å…‰èµ·ï¼Œä¸§çº¸ä¹‹è±¡ï¼Œäººåœ¨äº•ä¸­ï¼Œç”šé˜²è‡ªæ€æˆ–è€…å®«é¢ˆç™Œï¼Œè‚ºç™Œç­‰ã€‚",
 z: "æš‚æ— ",

                             },
        49: {
            n: "æ³½ç«é©",
            t: "ä¸€ã€ä¸€äººæŠŠæŸ¿å…¨ï¼Œä¹ƒäººè‚ºè…‘ä¹‹è¨€ã€‚<br>äºŒã€ä¸€äººæŠŠæŸ¿ä¸å…¨ï¼Œä¸€äººåŠçœŸè¨€ä¹Ÿã€‚<br>ä¸‰ã€ä¸€å…”ï¼šè·ƒè¿›ä¹‹è±¡ã€‚<br>å››ã€ä¸€è™ï¼šå¨æƒä¹‹è±¡ï¼Œå¤§äººä¹‹è±¡ï¼Œè‚–è™ä¹Ÿã€‚<br>äº”ã€å®˜äººæ¨è½¦æœ‰ä¸€å°ï¼šå¦‚ä¸ºæ­¦å®˜ï¼Œåˆ™è®¼è‡³ã€‚ä»Šä¸ºæ–‡å®˜å¸¦å°ï¼Œä¸»å¾—æŒ‚å°å°å¸…ï¼Œé¡»åŠ›æ±‚å˜é©ï¼Œæœå¿…æˆã€‚ä¸ˆå¤«æ¨è½¦ï¼Œä¹ƒæ±‚å©šä¹Ÿï¼Œå¸¦å°å¿…æˆã€‚<br>å…­ã€è™å…”å‘å±±è¡Œï¼šè´¤è‰¯å¤§äººé€€ï¼Œåç»§æœ‰äººè·ƒè¿›åŒè¡Œã€‚<br>ä¸ƒã€å±±å¤´å››ç‚¹ï¼šä¸Šä½ä¹‹äººï¼Œé»‘æš—ä¸æ˜ä¹‹è±¡ã€‚å…«ã€å¤§è·¯ï¼šè½¬å˜ä¸ºæ–°ä¸”é¡ºä¹‹è±¡ã€‚",
            x: "æ”¹é©ï¼Œå»æ—§ã€‚æ²»å†æ˜æ—¶ã€‚<br>åˆä¹ï¼šå·©ç”¨é»„ç‰›ä¹‹é©ã€‚<br>å…­äºŒï¼šå·³æ—¥ä¹ƒé©ä¹‹ï¼Œå¾ ï¼Œæ— å’ã€‚<br>ä¹ä¸‰ï¼šå¾å‡¶ï¼Œè´å‰ã€‚é©è¨€ä¸‰å°±ï¼Œæœ‰å­šã€‚<br>ä¹å››ï¼šæ‚”äº¡ï¼Œæœ‰å­šï¼Œæ”¹å‘½ï¼Œã€‚<br>ä¹äº”ï¼šå¤§äººè™å˜ï¼Œæœªå æœ‰å­šã€‚<br>ä¸Šå…­ï¼šå›å­è±¹å˜ï¼Œå°äººé©é¢ï¼Œå¾å‡¶ï¼Œå±…è´ã€‚",
            d: gd('S')+"ä¸‰å¥³å±…å—ã€‚",
u:"ä¸€ã€ æ­¤å¥³å¤©ç”Ÿåˆšå‹‡ï¼Œä¸”æ˜äº‹ç†ã€‚äºŒã€ æ„Ÿæƒ…å›°æ‰°å¤šã€‚ä¸‰ã€ å©šå§»æ¯”åŒæ—¶ç”Ÿäººæ—©äºŒå¹´ï¼Œä¸”æ¯”å§Šæ—©å©šã€‚",
h: "å…„å¼ŸäºŒäººï¼Œå‘ä¸€äººï¼Œä¸€äººä¸å…¨ã€‚ç™¾é‡Œä¾¯ï¼Œå¾—å°ä¿¡ã€‚ä¸å¯ä»¥é»‘å¿ƒä¸ºå·±ã€‚é€¢è™é€¢å…”å¯å ªå¤§ä»»ã€‚å†ä¸Šä¸€å±‚èµ–å…¶åŠŸã€‚",
 a: "åŠªåŠ›æœ‰æˆã€‚æ™šå¾—å°ã€‚é€¢è™è´µäººåŠ©æ›´å‰ï¼Œè¿è½¬å››æ–¹éšå¿ƒæ„ã€‚å¿ƒæƒ³äº‹æˆã€‚å¤«å¦»å‰ã€‚",
 b: "å‡èŒå¤–è°ƒæŒæƒå¹´ã€‚é€¢è™é€¢å…”ä¸ºè´µäººã€‚æ±‚è´¢ä¸åˆ©åˆ©æ±‚å®˜ã€‚å®ˆåœ¨ä¸€æ–¹å¾…æ—¶æœºã€‚",
 e: "å¸¦å°ä¸Šä»»ï¼Œå‡å®˜ã€‚è™å…”å±±å¤´ï¼Œè™å…”ç‹åˆ˜äººå¹´é€€éšï¼Œä¸å‡ã€‚",
 f: "åœŸä¸Šå››ç‚¹é»‘ä¹Ÿï¼Œä¸Šä½ä¹‹äººé»‘å¿ƒï¼Œä¸èƒ½åšã€‚ä¸€äººæŠŠå¼å…¨ï¼Œä¸€äººæŠŠå¼ä¸å…¨ï¼Œä¿¡æ¯ä¸è¶³ï¼Œä¸èƒ½åšã€‚",
 g: "ä¸€äººæŠŠå¼å…¨ï¼Œä¸€äººæŠŠå¼ä¸å…¨ï¼Œä¸€äººè¯´çœŸè¯ï¼Œä¸€äººè¯´å‡è¯ï¼Œå«ç»™è¯´çœŸè¯é‚£ä¸ªäººã€‚å¸¦å°æ±‚å©šå¿…æˆã€‚é€¢è™å…”ä¸æˆã€‚",
 l: "å¸¦å°ç§‘ç”²å¯ä¸­ã€‚",
 m: "å¤§è·¯æ¨è½¦ï¼Œä¸€æ ‘æç¹å¶èŒ‚ï¼Œæœ‰ç”Ÿå‘½åŠ›ï¼Œç”±æ—§è½¬æ–°ä¹‹è±¡ï¼Œæœ‰æ•‘ã€‚é€¢è™å…”æ— æ•‘ã€‚",
 z: "æš‚æ— ",

                             },
        50: {
            n: "ç«é£é¼",
            t: "ä¸€ã€äº‘ä¸­æœˆç°ï¼šæ˜¾è±¡ï¼Œæ‹¨äº‘è§æœˆä¹‹è±¡ï¼Œæ¸…æ˜ä¹Ÿã€‚<br>äºŒã€é¹Šå—é£ï¼šå†¬è‡³æ¥ä¸´ï¼ŒåŒ—äººæ‰§æ”¿ã€‚<br>ä¸‰ã€ä¸€å­è£¹å¸­å¸½ï¼Œä¸æ˜ä¹‹äººï¼Œæ— çŸ¥ä¹‹äººã€‚æœå–œä¹Ÿã€‚<br>å››ã€ä¸€äººæ‰§åˆ€ï¼šæ­¦å®˜ä¹Ÿï¼ŒæŠ¤å«å°†å†›ã€‚<br>äº”ã€è´µäººç«¯åæ— ç•ï¼šå›ç‹ï¼Œè€æ¿ç­‰äººï¼Œè‡³å…¬æ— ç§ã€‚<br>å…­ã€ä¸€é¼ ï¼šå­å¹´ï¼Œæš—è°‹ä¹‹äººï¼Œå†…æœ‰é˜´è°‹ï¼Œè‚–é¼ äººä¹Ÿã€‚",
            x: "å–æ–°ï¼Œæ­£ä½å‡å‘½ã€‚ç¨³å›ºã€‚<br>åˆå…­ï¼šé¼é¡šè¶¾ï¼Œåˆ©å‡ºå¦ã€‚å¾—å¦¾ä»¥å…¶å­ï¼Œæ— å’ã€‚<br>ä¹äºŒï¼šé¼æœ‰å®ï¼Œæˆ‘ä»‡æœ‰ç–¾ï¼Œä¸æˆ‘èƒ½å³ï¼Œã€‚<br>ä¹ä¸‰ï¼šé¼è€³é©ï¼Œå…¶è¡Œå¡ï¼Œé›‰è†ä¸é£Ÿï¼Œæ–¹é›¨äºæ‚”ï¼Œç»ˆã€‚<br>ä¹å››ï¼šé¼æŠ˜è¶³ï¼Œè¦†å…¬é¤—ï¼Œå…¶å½¢æ¸¥ï¼Œå‡¶ã€‚<br>å…­äº”ï¼šé¼é»„è€³ï¼Œé‡‘é“‰ï¼Œåˆ©è´ã€‚<br>ä¸Šä¹ï¼šé¼ç‰é“‰ï¼Œå¤§ï¼Œæ— ä¸åˆ©ã€‚",
            d: gd('SE')+"æ¬¡å¥³å±…ä¸œå—ã€‚",
u:"æ­¤å±€æœ€åˆ©æœªå©šå°å§ï¼Œæˆ‘å¸¸åˆ©ç”¨æ­¤å±€åŠ©äººæ— æ•°ã€‚ä¸€ã€ å…¶å¿…å«è´µå¤«ã€‚äºŒã€ æœå†³åˆšæ–­ï¼Œä¸æ˜“å—æƒ‘ã€‚ä¸‰ã€ å©šæ¯”å§Šæ—©å©šï¼Œä¸”å†¬å¤©æ–¹æˆã€‚å››ã€ å®˜è¿äº¨é€šï¼Œè´¢ä¸åˆ©ã€‚äº”ã€ é¼ ç”Ÿäººå‡¶ï¼Œä¸å‰ã€‚ å…­ã€ ç§‘ç”²å‰ï¼Œè€ƒè¯•é¡ºåˆ©ã€‚",
h: "å®¶ä¸–æ¸…ç™½ï¼Œå£°åæ˜¾èµ«ã€‚å¤©ç”Ÿå®˜äººä¸ä¸ºå•†ã€‚å¦»æ— å­ï¼Œå¦¾æœ‰å­ã€‚æ˜¯éåˆ†æ˜ã€‚é€¢é¼ æ‹›å®³å‘å—è¿ã€‚å¿Œå¦»ä¸ºé¼ ï¼Œæœ‰å‡¶æ‹›ç¾ã€‚",
 a: "å—ç¦„å‘½æœªæ¸…å®˜ã€‚æƒä¸»ç”Ÿæ€ã€‚å—è¡Œæ—¶æœ‰æš—å®³ã€‚é€¢é¼ åŠ å‡¶ã€‚é€€å‰ã€‚æœ‰å­æ— å©šæ•°ä¸­å®šã€‚",
 b: "å®˜äººè¿å—åœ¨å†¬è‡³ã€‚è°ƒåŠ¨ã€‚ä¾¥å¹¸å¾—è´¢ã€‚é­äººæš—å®³ã€‚å¦’å¿Œé™·å®³ã€‚å©šäº‹ä¸æˆï¼Œå¯¹æ–¹è¡¨é‡Œä¸ä¸€ï¼Œè¦é˜²é™·ã€‚ä¸åˆ©é¼ äººã€‚",
 e: "é›€å—é£ï¼Œå–œè®¯è‡³ä¹Ÿã€‚æ‹œè§å®˜äººï¼Œå®˜å‡ã€‚",
 f: "é›€å—é£ï¼Œå¯å¾—åˆ©ä¹Ÿã€‚é€¢å†¬è‡³æœ€ä½³ã€‚",
 g: "é›€å—é£ï¼Œå©šå§»å–œè®¯è‡³ï¼Œä¸€é¼ ï¼Œå°å¿ƒåé¢æœ‰å›¾è°‹ã€‚",
 l: "é›€å—é£ï¼Œå–œè®¯è‡³ï¼Œé«˜ä¸­ã€‚",
 m: "æœˆæœ‰å…‰ï¼Œä¸‰å°æ˜Ÿäº®ï¼Œé›€å—é£ï¼Œæœ‰æ•‘ã€‚",
 z: "æš‚æ— ",

                             },
        51: {
            n: "éœ‡ä¸ºé›·",
            t: "ä¸€ã€äººç«‹å²©ä¸Šï¼šç‰¹ç«‹ç‹¬è¡Œï¼Œæ‘‡æ‘‡æ¬²å ä¹Ÿã€‚å±é™©ä¹Ÿã€‚<br>äºŒã€ä¸€æ ‘å¼€èŠ±ï¼šæœ‰æœä¹Ÿï¼Œæƒœä¹è¿‡äºçŸ­æš‚ï¼Œå°‘éƒ¨ä»½ä¹‹äººã€‚<br>ä¸‰ã€ä¸€æ–‡ä¹¦ï¼šæ¶ˆæ¯è‡³ï¼Œå…¬æ–‡è‡³ã€‚<br>å››ã€ä¸€äººæ¨è½¦ï¼šè½¬å˜ä¹‹è±¡ï¼Œæ‰§è¡Œå‘½ä»¤è±¡ã€‚<br>äº”ã€ä¸Šæœ‰æ–‡å­—ï¼šå¾—å®˜ä»¤ä¹Ÿã€‚<br>å…­ã€ä¸€å †é’±è´¢è€…ï¼šé’±è´¢æ•£äºåœ°çŠ¶ï¼Œå¿§å¿ƒä¹Ÿï¼Œä¸§äº‹ä¹Ÿï¼Œæ±‚è´¢ä¸åˆ©ï¼Œå ç–¾ç—…å‡¶ã€‚",
            x: "éœ‡æƒŠç™¾é‡Œï¼Œææƒ§ä¿®çœã€‚<br>åˆä¹ï¼šéœ‡æ¥è™©è™©ï¼Œåç¬‘è¨€å“‘å“‘ï¼Œã€‚<br>å…­äºŒï¼šéœ‡æ¥å‰ï¼Œäº¿ä¸§è´ï¼Œè·»äºä¹é™µï¼Œå‹¿é€ï¼Œä¸ƒæ—¥å¾—ã€‚<br>å…­ä¸‰ï¼šéœ‡è‹è‹ï¼Œéœ‡è¡Œæ— çœšã€‚<br>ä¹å››ï¼šéœ‡é‚æ³¥ã€‚<br>å…­äº”ï¼šéœ‡å¾€æ¥å‰ï¼Œäº¿æ— ä¸§æœ‰äº‹ã€‚<br>ä¸Šå…­ï¼šéœ‡ç´¢ç´¢ï¼Œè§†çŸçŸï¼Œå¾å‡¶ã€‚éœ‡ä¸äºå…¶èº¬ï¼Œäºå…¶é‚»ï¼Œæ— å’ï¼Œå©šåª¾æœ‰è¨€ã€‚",
            d: gd('E')+"é•¿å­å±…ä¸œã€‚",
u:"ç”Ÿå±€ä¹‹ä¸­ï¼Œæ­¤å±€å¾ˆç‰¹æ®Šï¼Œæœªç»å¾æ´¾ä¹‹äººæ”¹ï¼Œè‡ªç„¶å±…æ­¤å±€ä¸­äººï¼Œ å…¶å¿…å¤©ç”Ÿå¥½æ‰‹ï¼Œåœ¨å®¶ä¸ºè´µå­æ— ç–‘ã€‚ä¸€ã€ æœ‰æ‰¿ç»§ç¥–ä¸šï¼Œå‘æ‰¬å…‰å¤§ä¹‹å®åŠ›ã€‚äºŒã€ ç§‘ç”²å…´æ—ºï¼Œååˆ—å‰èŒ…ã€‚ä¸‰ã€ å®˜è¿é€šé¡ºï¼Œåªé™æœªå©šå‰ã€‚ å››ã€ ä»å•†äº¦å‰ï¼Œä½†é¡»ä¸ºè´Ÿè´£äººã€‚äº”ã€ å©šå§»æŒ‰å‘½ä¸­èµ°ï¼Œçº¢é¸¾æ˜ŸåŠ¨ä¹‹å¹´ï¼Œå³æˆå©šä¹‹å¹´ã€‚å…­ã€ é¡»æ³¨æ„æ­¤å±€åªç°åœ¨å©šå‰ï¼Œå©šåå¿…ä¸è§ã€‚æƒŸå¤©å¦å¯ç»§ç»­å…¶è¿åŠ¿ã€‚",
h: "ç”Ÿæœ‰ä¸€å£å¥½è¾©æ‰ï¼Œé•¿å­æˆæ ¼ã€‚ä¹¡é‡Œä¹‹é—´æœ‰åå£°ï¼Œç™½æ‰‹å…´å®¶ã€‚ä¸€æœå¾—ç¦„å‘½ã€‚è¿è½¬å››æ–¹ã€‚åªæƒœä¸çŸ¥é“å±…å®‰æ€å±ï¼Œæ•…å¥½æ™¯ä¸é•¿ã€‚å¤§èµ·å¤§è½ã€‚",
 a: "ä½é«˜ä¸ç¨³ã€‚æ‰€æ±‚å¿…è‡³ï¼Œå¿§å¿ƒä¸æ–­ã€‚æ±‚è´¢å¾—è´¢ï¼Œæƒœä¸é•¿ä¹…ï¼Œæˆ’ä¹‹åœ¨ç››ã€‚",
 b: "è´¢å®˜åŒç¾ï¼Œé€¢äº”æˆ´å­ã€‚ä¸€ã€å››å¾—ä»¤ã€‚",
 e: "å…¬æ–‡ï¼Œä¸€äººæ¨è½¦ï¼Œè½¬ä»»å››æ–¹ä¹‹è±¡ï¼Œå‡å®˜ä¹‹è±¡ã€‚",
 f: "ä¸€æ ‘å¼€èŠ±ï¼Œè´¢å®è‹¥å¹²ï¼Œæ—¶é—´çŸ­æš‚æˆ–è€…æ•°é‡è¾ƒå°‘ï¼Œä½†æœ‰åˆ©å¯å›¾ã€‚",
 g: "æ–‡ä¹¦è‡³ï¼Œå©šä¹¦ä¹Ÿï¼Œå¯æˆã€‚",
 l: "ä¸€äººæ¨è½¦ï¼Œæ–‡ä¹¦è‡³ï¼Œå¯é«˜ä¸­ã€‚",
 m: "é‡‘é’±åœ¨åœ°ï¼Œçº¸é’±ä¸§è±¡ã€‚",
 z: "æš‚æ— ",

                             },
        52: {
            n: "è‰®ä¸ºå±±",
            t: "ä¸€ã€å  ä¸Šä¸œåŒ—å­—ï¼šå€™ä¹Ÿï¼Œåœæ»ç­‰å€™ä¹Ÿï¼Œé™ˆå§“ã€‚<br>äºŒã€çŒ´æ‰§æ–‡ä¹¦ï¼šå€™å…¶æ—¶ï¼Œå¾…å…¬æ–‡å‘½ä»¤è‡³ä¹Ÿã€‚<br>ä¸‰ã€å®˜åæ‰§é•œï¼šæ¸…æ˜ä¹‹æ³•å®˜ï¼Œæ”¿æ²»æ¸…æ˜ã€‚<br>å››ã€ä¸‰äººç»³ç›¸ç³»ç¼šï¼šä¸‰äººç›¸ç‰µè¿æ‹›è®¼äº‹ä¹Ÿã€‚",
            x: "æ­¢ä¹Ÿï¼ŒåŠ¨é™ä¸å¤±å…¶æ—¶ã€‚æ€ä¸å‡ºå…¶ä½ã€‚<br>åˆå…­ï¼šè‰®å…¶è¶¾ï¼Œæ— å’ï¼Œåˆ©æ°¸è´ã€‚<br>å…­äºŒï¼šè‰®å…¶è…“ï¼Œä¸æ‹¯å…¶éšï¼Œå…¶å¿ƒä¸å¿«ã€‚<br>ä¹ä¸‰ï¼šè‰®å…¶é™ï¼Œåˆ—å…¶å¤¤ï¼Œå‰è–°å¿ƒã€‚<br>å…­å››ï¼šè‰®å…¶èº«ï¼Œæ— å’ã€‚<br>å…­äº”ï¼šè‰®å…¶è¾…ï¼Œè¨€æœ‰åºï¼Œæ‚”äº¡ã€‚<br>ä¸Šä¹ï¼šæ•¦è‰®ï¼Œã€‚",
            d: gd('NE')+"ä¸‰å­å±…ä¸œåŒ—ã€‚ä¸€ã€ç§‘ç”²é¡ºåˆ©ï¼Œå¿…ä¸­ç†æƒ³ä¹‹å­¦æ ¡ã€‚äºŒã€ å¥åº·å¹³å®‰ï¼Œä¸ºå­å­ã€‚ä¸‰ã€å©šå§»é¡ºåˆ©ï¼Œè¿›å…¥å…«å­—ä¸­çº¢é¸¾æ˜Ÿä¹‹å¹´å¿…å©šã€‚å››ã€ å…¬èŒå¤§åˆ©ã€‚äº”ã€ çŸ¥è¿›é€€ï¼Œä¸ºå¤©ç”Ÿå—äººå–œæ¬¢ä¹‹äººã€‚ã€‚",
u:"æ­¤å±€æœ€åˆ©æœªå©šå°å§ï¼Œæˆ‘å¸¸åˆ©ç”¨æ­¤å±€åŠ©äººæ— æ•°ã€‚ä¸€ã€ å…¶å¿…å«è´µå¤«ã€‚äºŒã€ æœå†³åˆšæ–­ï¼Œä¸æ˜“å—æƒ‘ã€‚ä¸‰ã€ å©šæ¯”å§Šæ—©å©šï¼Œä¸”å†¬å¤©æ–¹æˆã€‚å››ã€ å®˜è¿äº¨é€šï¼Œè´¢ä¸åˆ©ã€‚äº”ã€ é¼ ç”Ÿäººå‡¶ï¼Œä¸å‰ã€‚ å…­ã€ ç§‘ç”²å‰ï¼Œè€ƒè¯•é¡ºåˆ©ã€‚",
h: "äº”æˆ¿å…„å¼ŸäºŒæˆ¿è´µã€‚æ•°ä¸­çŒ´å­ï¼Œä¸‰å­æˆæ ¼ï¼Œä¸»å®˜æ ¼ã€‚æˆæ ¼è€…éå¯Œå³è´µã€‚ç”ŸçŒ´ï¼Œé€¢çŒ´å‘é»„ç”²ï¼ˆé‡‘æ¦œé¢˜åï¼‰ï¼Œå°¤å…¶å¸æ³•äººå¤§å‰ã€‚ä¸å…¥æ ¼äººä¸»æ˜¯éï¼Œå¤šè®¼å¤šç¾æ•°ä¸­å®šï¼Œä¸è´ªä¸æ±‚ç­‰å¾…æ—¶æœºï¼Œä¸ä¸ºåŒ»æ—å³ä¸ºå„’æ—ã€‚ã€‚",
 a: "å®˜æ­¢ä¸è¿›ã€‚é€¢çŒ´å°ä¾¯ï¼Œå¤–å‡ºå½“ä¸»ç®¡ã€‚æ±‚è´¢ä»å•†ï¼Œå®˜è®¼è¿è¿ã€‚ç”³å¹´å¤§å¿Œã€‚ä¸æ±‚ä¾¥å¹¸ï¼Œå¤§å‰ã€‚",
 b: "çŒ´äººé€¢ä¹‹ä¸»å¤§å‰ã€‚èº«ç¶¬ç¦„å‘½ã€‚åˆä¼™å¿…å‡¶ã€‚å—äººè¿ç´¯ã€‚ç§‘ç”²é€¢ä¹‹å¤§å‰ã€‚å©šäº‹äº¦å‰ã€‚",
 e: "å®˜äººæ§é•œï¼ŒçŒ´æ‰§æ–‡ä¹¦ï¼Œå€™ç­‰æ–‡ä¹¦ï¼Œé€¢çŒ´å¹´ã€äººå¤§åˆ©ï¼Œå‡ã€‚",
 f: "å€™äººå¤§åˆ©ï¼Œå…¶ä½™ç‰µè¿å®˜å¸ï¼Œä¸å‰ã€‚åˆä¼™å¤§å‡¶ï¼Œä¸è®ºä½•äººã€‚",
 g: "çŒ´å¹´å¯æˆï¼Œè¦é—®æ—¶é—´çŒ´å¹´æˆ–è€…åå¹´ä¹Ÿå¯¹ã€‚",
 l: "å€™äººé«˜ä¸­ï¼Œé€¢çŒ´é«˜ä¸­ï¼Œå…¶ä½™æ™®é€šåœ°æ–¹è€ƒè¯•å¯ä¸­ã€‚",
 m: "ä¸‰äººç‰µè¿ï¼ŒçŒ´æ‰§æ–‡ä¹¦ï¼Œå€™å¹´äººæœ‰æ•‘ï¼Œå¤šäººæ— æœ‰åŠæ³•ï¼Œå¯æ±‚åŠ©å€™äººæˆ–è€…åå­—å¸¦é™ä¹‹äººã€‚",
 z: "æš‚æ— ",

                             },
        53: {
            n: "é£å±±æ¸",
            t: "ä¸€ã€ä¸€æœ›ç«¿åœ¨çˆ½é«˜å¤„ï¼šå®¶äººæœ›å½’è±¡ã€‚<br>äºŒã€ä¸€è¯ç‚‰åœ¨åœ°ï¼šå¹³å®‰ï¼Œæ— ç¾ä¹Ÿã€‚<br>ä¸‰ã€ä¸€å®˜äººç™»æ¢¯ï¼šå‡å®˜ä¹‹è±¡ï¼Œè¡£é”¦è¿˜ä¹¡ä¹Ÿï¼Œæ£ºä¹Ÿã€‚<br>å››ã€ä¸€æèŠ±åœ¨åœ°ï¼šè½ç¬¬è±¡ï¼Œä¸ä¹…ä¹‹è±¡ã€‚",
            x: "æ¸è¿›ï¼Œå¥³å½’å‰ã€‚å±…è´¤å¾·å–„ä¿—ã€‚<br>åˆå…­ï¼šé¸¿æ¸äºå¹²ï¼Œå°å­å‰ï¼Œæœ‰è¨€ï¼Œæ— å’ã€‚<br>å…­äºŒï¼šé¸¿æ¸äºç£ï¼Œé¥®é£Ÿè¡è¡ï¼Œã€‚<br>ä¹ä¸‰ï¼šé¸¿æ¸äºé™†ï¼Œå¤«å¾ä¸å¤ï¼Œå¦‡å­•ä¸è‚²ï¼Œå‡¶ï¼Œåˆ©å¾¡å¯‡ã€‚<br>å…­å››ï¼šé¸¿æ¸äºæœ¨ï¼Œæˆ–å¾—å…¶æ¡·ï¼Œæ— å’ã€‚<br>ä¹äº”ï¼šé¸¿æ¸äºé™µï¼Œå¦‡ä¸‰å¦‡ä¸å­•ï¼Œç»ˆè«ä¹‹èƒœï¼Œã€‚<br>ä¸Šä¹ï¼šé¸¿æ¸äºé™†ï¼Œå…¶ç¾½å¯ç”¨çˆ²ä»ªï¼Œã€‚",
            d: gd('NE')+"é•¿å¥³å±…ä¸œåŒ—ã€‚",
u:"ä¸€ã€ç§‘ç”²ä¸é¡ºï¼Œç¼ºä¸´é—¨ä¸€è„šã€‚äºŒã€å·¥ä½œå¿ƒå¿µä¸å®šï¼Œå¸¸æ€å˜åŠ¨ã€‚ä¸‰ã€ èº«ä½“å¹³å®‰ï¼Œç¾å°‘ã€‚å››ã€ å¯¹å©šå§»ä¸é‡‡ä¸»åŠ¨ï¼Œå©šäº‹éš¾æˆã€‚äº”ã€ å‡ºä»»å…¬ã€æ•™èŒå¤§åˆ©ã€‚æ­¤å±€å˜åŒ–å¤šï¼Œéšæ—¶æˆä¹‹æ•…å­¦è€…é¡»æ³¨æ„ã€‚",
h: "æ¸è¿›ä¹‹è±¡ï¼Œæ’åç¬¬äºŒï¼Œç§‘ç”²é«˜ä¸­ã€‚äºŒäººä¹…åˆ†ã€‚ä»åŒ»ä»å®˜ä¸¤ç›¸å®œã€‚å©šå§»çŸ­æš‚ã€‚å¤«å¦»èšå°‘æ•£å¤šå¯å‰ã€‚",
 a: "å®˜è¿äº¨é€šã€‚æ±‚è´¢ä¸æˆã€‚ä½æ‰å¹³å®‰ã€‚ä¸»å®˜å¤šç—…ç¾ã€‚",
 b: "å®˜äººé€¢ä¸»å‡è¿ã€‚ç–¾ç—…æœ‰æ•‘ã€‚æ±‚è´¢çŸ­æœŸæœ‰åˆ©ã€‚é•¿æœŸå‡¶ã€‚å©šäº‹å¿…æˆã€‚èŠ±è½äºåœ°ï¼Œè½ç¬¬ç§‘ç”²ã€‚",
 e: "å®˜äººç™»æ¢¯ï¼Œå‡å®˜ã€‚",
 f: "èŠ±å¼€ä¸€æï¼ŒèŠ±æœŸçŸ­æš‚ï¼ŒçŸ­æš‚ä¹‹åˆ©ã€‚",
 g: "æœ›è€…ï¼Œæœ‰æœ›ç»“å©šï¼Œä½†å©šæœŸçŸ­æš‚ï¼Œå¦‚ä¸ºè§‚æœ›ä¹‹äººï¼Œåˆ™ä¸å©šï¼Œçœ‹è‡ªå·±å’Œå¯¹æ–¹æ˜¯ä»€ä¹ˆæ ·çš„äººã€‚",
 l: "ä¸€æèŠ±è½åœ°ï¼Œè½ç¬¬ä¸ä¸­ã€‚",
 m: "ä¸€è¯èŠ¦ï¼Œæ— ç—…ï¼Œä¸éœ€ç”¨è¯ï¼Œäº¦æˆ–è€…é‡ç—…æœ‰æ•‘ã€‚",
 z: "æš‚æ— ",

                             },
        54: {
            n: "é›·æ³½å½’å¦¹",
            t: "ä¸€ã€å®˜äººéª‘é¹¿æŒ‡äº‘ï¼šæµ®äº‘è”½æ—¥ï¼Œä¹˜ä¹±è€Œæ¬²è¿›ã€‚<br>äºŒã€å°é¹¿å­åœ¨åï¼šç”Ÿæ„äººï¼Œéšä»çŠ¶ã€‚<br>ä¸‰ã€æœ›ç«¿ä¸Šæœ‰æ–‡å­—ï¼šæ—¦å¤•è€Œäº¡ï¼Œæ­ç«¿è€Œèµ·ï¼Œæ­£åä¹Ÿã€‚<br>å››ã€äººè½åˆºä¸­ï¼šå¦‚é² åœ¨å–‰ï¼Œå»ä¹‹ä¸å¾—ã€‚<br>äº”ã€ä¸€äººæ‹”å‡ºï¼šä¸€äººç›¸æ•‘ç¤ºå® çŠ¶ã€‚<br>å…­ã€æ­¤å¦é—®ç—…å‡¶ï¼Œé—®è´¢å‰ï¼Œé—®æ”¿å‡¶",
            x: "å¾å‡¶ï¼Œæ— æ”¸åˆ©ã€‚æ°¸ç»ˆçŸ¥æ•ã€‚<br>åˆä¹ï¼šå½’å¦¹ä»¥å¨£ï¼Œè·›èƒ½å±¥ï¼Œå¾ã€‚<br>ä¹äºŒï¼šçœ‡èƒ½è§†ï¼Œåˆ©å¹½äººä¹‹è´ã€‚<br>å…­ä¸‰ï¼šå½’å¦¹ä»¥é¡»ï¼Œåå½’ä»¥å¨£ã€‚<br>ä¹å››ï¼šå½’å¦¹æ„†æœŸï¼Œè¿Ÿå½’æœ‰æ—¶ã€‚<br>å…­äº”ï¼šå¸ä¹™å½’å¦¹ï¼Œå…¶å›ä¹‹è¢‚ï¼Œä¸å¦‚å…¶å¨£ä¹‹è¢‚è‰¯ï¼Œæœˆå‡ æœ›ï¼Œ ã€‚<br>ä¸Šå…­ï¼šå¥³æ‰¿ç­æ— å®ï¼Œå£«åˆ²ç¾Šæ— è¡€ï¼Œæ— æ”¸åˆ©ã€‚",
            d: gd('W')+"é•¿å­å±…è¥¿ã€‚",
u:"ç°ä»£äººä¸ºçˆ±æ»‹ç—…æ‰€è‹¦ï¼Œç›®å‰åŒ»å­¦ç•Œè™½ä»æ— æ³•è®¤å®šå…¶å¿…ç”±åŒæ€§æ‹ ä¼ æŸ“æ¥çš„ï¼Œæˆ‘ä¹Ÿä¸å¦å®šå…¶æ˜¯å¦æ­£ç¡®ï¼Œä½†å¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œå…¶è¡Œä¸ºå¿…ä¸ ä¸ºçˆ¶æ¯æ‰€èƒ½æ¥å—çš„ï¼Œæ­¤å±€æ— äººå‘ç°ï¼Œè‡ªå¤ä»¥æ¥å› é“å¾·æŸç¼šåŠ›å¾ˆå¼ºï¼Œå®¶æ—åŒä½ï¼Œæ•…è¾ƒä¸æ˜“å‘ç”Ÿï¼Œå²æœ‰æ˜è½½å…¶æ–­è¢–ä¹‹ç™–å³è¨€åŒæ€§æ‹ï¼Œä½†ä¸ ä¼¼ä»Šæ—¥ä¹‹æ™®éï¼Œä¸–ç•Œå„å›½çš†ä¸ºæ­¤è‹¦æ¼ä¸å·²ï¼Œå…¶å®æ˜“ç»ä¸­æ—©å·²æ˜ç¡®æŒ‡ å‡ºå…¶ä»ä½•è€Œæ¥ï¼Ÿä¸ºä½•æœ‰äººå¦‚æ­¤ï¼Œæœ‰äººä¸è‹ŸåŒï¼Ÿå¦‚ä½•åŒ–è§£ï¼Ÿç”·åŒæ€§æ‹ å‡ºå½’å¦¹å¦ï¼Œå¥³åŒæ€§æ‹å‡ºç›Šå¦ã€æ—…å¦ã€æ¸å¦ã€é¼å¦ç­‰å˜åŒ–è¾ƒå¤šï¼Œå…¶åŒ– è§£åªé¡»æ­£ä½å³å¯æ”¹å˜ã€‚ç”·åŒæ€§æ‹ï¼Œçˆ¶æ¯çƒ¦å¿§ï¼Œç»ˆè‡´ç¦»å®¶å‡ºèµ°ã€‚äºŒã€ å§”æ›²ä»¥æ±‚ç¦„ã€‚ä¸‰ã€ æ— å©šã€‚å››ã€ è¯¸äº‹ä¸é¡ºï¼Œä½†å¤šæ‰å¤šè‰ºï¼Œèµ°è‰ºæœ¯è·¯çº¿ä½³ã€‚",
h: "äºŒç”·äºŒå¥³å¹¶è¡Œï¼Œçˆ¶æ¯ä¸å…¨ã€‚ç›–å¤´é«˜äººæˆæ­£æ ¼ï¼Œè´¢å®˜åŒç¾ã€‚ä¸æˆæ ¼è€…ï¼Œå•†æœºå¤§åˆ©ï¼Œå·¦å³è¿›è´¢ã€‚æ±‚å®˜ä¸åˆ©ã€‚å©šä¸»äºŒå¦»ï¼Œå¥³ä¸»æ—¥ä¸å‡ºå¤´ã€‚",
 a: "æµ®äº‘è”½æ—¥ï¼Œå¼ƒå…¬ä»å•†ã€‚å­ä»çˆ¶ä¸šè«æ³½å¤§ã€‚é˜²é‡‘åˆ€äººçº¦æŸã€‚ç«äººå¤§è´µã€‚",
 b: "è´¢ç¦„ä¸°æ”¶ã€‚æ±‚å©šä¸åˆ©ã€‚æ±‚å©šéœ€äºŒç”·äºŒå¥³åŒè¡Œæ–¹å‰ã€‚æŠ•é‡‘ä¸åˆ©ã€‚ç›–å¤´é«˜äººå‰ã€‚",
 e: "æµ®äº‘è”½æ—¥ï¼Œä¸å‡ã€‚ç›–å¤´äººå‡ï¼Œå¦‚é«˜ï¼Œæ–‡ç­‰ã€‚",
 f: "æœ‰åˆ©å¯å›¾ï¼Œéœ€è¦äºŒäººå¹¶è¡Œï¼Œè·Ÿéšä»–äººæ±‚åˆ©ã€‚",
 g: "åˆºè½å–‰ä¸­ï¼Œä¸å‰ï¼Œå‹¿å©šã€‚",
 l: "æ–‡å­—é«˜å¤„ï¼Œé«˜ä¸­ä¹Ÿã€‚",
 m: "åˆºè½å–‰ä¸­ï¼Œæœ›åœ¨æ†å¤´ï¼Œæœ‰ä¼¤äº¡ä¹‹é£é™©ï¼Œé—®ç—…è€…å‡¶ã€‚",
 z: "æš‚æ— ",

                             },
        55: {
            n: "é›·ç«ä¸°",
            t: "ä¸€ã€ç«¹ç®€ç°èµ·ï¼šç®€å§“ï¼Œç«¹æœ‰é¡ºè±¡ï¼ŒåšèŠ‚ä¸å˜ä¹‹è±¡ï¼Œç°èµ·ï¼Œä¸­ç©ºä¹‹è±¡ã€‚<br>äºŒã€é¾™è›‡äº¤é”™ï¼šè¾°å·³ä¹‹å¹´ï¼Œæ­£é‚ªç›¸äº‰ï¼Œè›‡è™ºä¹ƒæ¯’è°‹æš—ç®—ä¹Ÿã€‚<br>ä¸‰ã€å®˜äººç€è¡£è£³ç«‹ï¼šå®˜äººã€å€Œäººã€ä¸ˆå¤«ä¹Ÿï¼Œè—äºå†…ä¹Ÿã€‚<br>å››ã€ä¸€åˆå­ï¼šå…ˆæˆåç ´ã€‚<br>äº”ã€äººå¹ç¬™ç«¿ï¼šé—²æƒ…é€¸å¿—ï¼Œä¸»å–œäº‹ä¸´é—¨ã€‚<br>å…­ã€è„šè¸è™ï¼šä¸´å±ä¸ä¹±ä¹Ÿï¼Œé™©åœ¨ä¸‹ä¹Ÿã€‚<br>ä¸ƒã€æ—±æ²¼ä¹‹æ—ï¼šå¿ƒåŠ›äº¤ç˜ä¹Ÿã€‚<br>å…«ã€æ± ä¸­æ— æ°´ï¼šæ—±è±¡ï¼Œç ´è´¢ä¹Ÿã€‚<br>ä¹ã€ç è½ç›˜ä¸­ï¼šå…ˆèšåæ•£ä¹Ÿã€‚",
            x: "ä¸°ç››ï¼Œæ—¥ä¸­åˆ™æ˜ƒã€‚æŠ˜ç‹±è‡´åˆ‘ã€‚<br>åˆä¹ï¼šé‡å…¶é…ä¸»ï¼Œè™½æ—¬æ— å’ï¼Œå¾€æœ‰å°šã€‚<br>å…­äºŒï¼šä¸°å…¶è—“ï¼Œæ—¥ä¸­è§æ–—ï¼Œå¾€å¾—ç–‘ç–¾ï¼Œæœ‰å­šå‘è‹¥ï¼Œ ã€‚<br>ä¹ä¸‰ï¼šä¸°å…¶æ²›ï¼Œæ—¥ä¸­è§æ²«ï¼ŒæŠ˜å…¶å³è‚±ï¼Œæ— å’ã€‚<br>ä¹å››ï¼šä¸°å…¶è–œï¼Œæ—¥ä¸­è§æ–—ï¼Œé‡å…¶å¤·ä¸»ï¼Œã€‚<br>å…­äº”ï¼šæ¥ç« ï¼Œæœ‰åº†èª‰ï¼Œã€‚<br>ä¸Šå…­ï¼šä¸°å…¶å±‹ï¼Œè”€å…¶å®¶ï¼Œçª¥å…¶æˆ·ï¼Œé˜•å…¶æ— äººï¼Œä¸‰å²ä¸è§Œï¼Œå‡¶ã€‚",
            d: gd('S')+"é•¿å­å±…å—ã€‚",
u:"æ­¤å¦å¸¸å‡ºç°åœ¨å„¿å­èº«ä¸Šä¸€ã€ æœªç»æœ¬æ´¾ä¹‹äººæŒ‡ç‚¹ï¼Œä¹ƒè‡ªç„¶å±…æ­¤å±€ä¸­ä¹‹äººï¼Œå…¶ä¸åŒæ—¶ç”Ÿäººä¸åŒï¼Œå©šäº‹å¿…å…ˆæˆåç ´ã€‚äºŒã€ ç§‘ç”²è€ƒè¯•é¡ºåˆ©ã€‚ä¸‰ã€ æ€§åˆšä¸”åšï¼Œæ˜“ä¸äººäº‰ï¼Œå¿…ä¸ºæ„Ÿæƒ…å›°æ‰°ã€‚å››ã€ ä»å•†å¿…ç ´è´¢ã€‚äº”ã€ å¾å®˜è·å‰ã€‚",
h: "è™è›‡é¾™ä¸‰äººï¼Œå…ˆèšåæ•£ã€‚å¤–å®å†…è™šã€‚å®˜è¿ä¸æ˜ï¼Œåœåœ¨é‚£è¾¹ï¼Œè¿›é€€ä¸å¾—ã€‚åŠ¨å¼¹ä¸å¾—ã€‚è‡³ä¸°ä¹‹é“ï¼Œä¸æ±‚åˆ™ä¸°ã€‚é¾™è›‡ä¹‹å¹´å˜åŒ–å¤šã€‚çˆ¶å¤«å—ç´¯ã€‚å¤–å–œå†…å¿§ã€‚ç‹¬ç«‹å·¥ä¸šã€‚æ— äººäº‰åˆ©ã€‚",
 a: "å¤«å¦»å‡¶ï¼Œå¤–å–œå†…å¿§ã€‚å•†æœºä¸åˆ©ï¼Œæ…é˜²ç ´æŸï¼Œå› è¯†äººä¸æ˜ã€‚æ—¶æœºä¸§å¤±ã€‚",
 b: "è´µäººå°äººåŒæ—¶åœ¨ä¾§ã€‚å¤–å–œå†…å¿§ã€‚å®˜äº‹å—ç´¯ã€‚è¯¸äº‹ä¸å®œè¿›ï¼Œå®ˆæˆè«è´ªå¤šã€‚è´¢ç ´ã€‚",
 e: "å®˜äººæ—ç›’ï¼Œç€è¡£å’Œåˆå‡å®˜ä¹‹è±¡ã€‚",
 f: "æ± ä¸­æ— æ°´ï¼Œæ— è´¢ã€‚",
 g: "ä¸€ç›’å­ï¼Œå’Œåˆä¹‹è±¡ï¼Œåªæ˜¯è¦é˜²æ­¢ç¦»å©šã€‚",
 l: "äººå¹ç¬™ç«½ï¼Œå–œäº‹æ¥ä¸´ï¼Œé«˜ä¸­ã€‚",
 m: "ç«¹ä¸­ç°èµ·ï¼Œé‡ç—…ç»“æœä¸ºç°ï¼Œæœ‰ç¦»ä¸–ä¹‹è±¡ã€‚",
 z: "æš‚æ— ",

                             },                56: {
            n: "ç«å±±æ—…",
            t: "ä¸€ã€ä¸‰æ˜Ÿè€…ï¼šä¸‰å°è´µäººï¼Œç›¸ä½ä¹‹äººã€‚<br>äºŒã€è´µäººå°ä¸Šå‚é’“ï¼šå›ä¸»ç›¸æ±‚ï¼Œè€æ¿ç›¸æ±‚äººæ‰ã€‚<br>ä¸‰ã€ç‰µæ°´ç•”äººï¼šè´¤èƒ½ä¹‹äººï¼Œç¦»é‡å…¥æœå°å€™ã€‚æˆ–æ…•æƒåŠ¿è€Œå˜å¿—ã€‚<br>å››ã€ä¸€çŒ´ä¸€ç¾Šï¼šè‚–çŒ´ï¼Œè‚–ç¾Šï¼Œå€™ã€æ¨å§“äººï¼Œæœªç”³å¹´åº”ä¹‹ã€‚<br>äº”ã€å¤§æºªï¼šè„±é™©ä¹Ÿï¼Œæ¸¯å£ä¹Ÿï¼Œæ°´ä¾§ä¹Ÿã€‚",
            x: "æ—…è¡Œï¼Œæ¼‚æ³Šã€‚æ˜æ…ç”¨åˆ‘ã€‚<br>åˆå…­ï¼šæ—…ççï¼Œæ–¯å…¶æ‰€å–ç¾ã€‚<br>å…­äºŒï¼šæ—…å³æ¬¡ï¼Œæ€€å…¶èµ„ï¼Œå¾—ç«¥ä»†è´ã€‚<br>ä¹ä¸‰ï¼šæ—…ç„šå…¶æ¬¡ï¼Œä¸§å…¶ç«¥ä»†ï¼Œè´å‰ã€‚<br>ä¹å››ï¼šæ—…äºå¤„ï¼Œå¾—å…¶èµ„æ–§ï¼Œæˆ‘å¿ƒä¸å¿«ã€‚<br>å…­äº”ï¼šå°„é›‰ï¼Œä¸€çŸ¢äº¡ï¼Œç»ˆä»¥èª‰å‘½ã€‚<br>ä¸Šä¹ï¼šé¸Ÿç„šå…¶å·¢ï¼Œæ—…äººå…ˆç¬‘åå·å’·ï¼Œä¸§ç‰›äºæ˜“ï¼Œå‡¶ã€‚",
            d: gd('NE')+"æ¬¡å¥³å±…ä¸œåŒ—ã€‚",
u:"æ­¤å±€ç‰¹æ®Šï¼Œå­¦è€…é¡»è¯†ã€‚ä¸€ã€ ç§‘ç”²å…´æ—ºäºŒã€ å¥³èº«ç”·æ€ä¸‰ã€ å©šäº‹ä¸æˆï¼Œé¡»é€¢è‚–ç¾Šã€è‚–çŒ´æˆ–äºæœªã€ç”³ä¹‹å¹´æ–¹æœ‰æˆã€‚å››ã€ åŸåºœè¾ƒæ·±ï¼Œç»ˆè‡ªå–å’ã€‚",
h: "ç”Ÿä¸ºå…¬é—¨äººã€‚ä¸­å¹´å‰ï¼ˆ45å‰ï¼‰å¹³æ­¥é’äº‘ã€‚é€¢çŒ´ç¾Šæˆæ ¼ã€‚å¤§åˆ©è¥¿å—ã€‚å¤–åŠ¨é¢‘ã€‚çŒ´å¾—é•¿ä¸€äººåŠ©ï¼Œé€¢ç¾Šå¼€æ³°ï¼Œä½åˆ—ä¸‰å°ã€‚",
 a: "ä½è¿‘ä¸‰å°è´µäººï¼Œä¸æ±‚è‡ªæ¥ã€‚ç¦»é‡å…¥æœã€‚æœªä¸­å¾—åˆ©ã€‚æœªå¹´ã€‚é€¢çŒ´ç¾Šä¸»åˆ©ã€‚é˜²ä¹æç”Ÿæ‚²ã€‚",
 b: "å‡è¿åœ¨å…«æœˆï¼Œå¤§åˆ©è¥¿å—ã€‚ä¸åˆ©å©šäº‹ã€æ±‚è´¢ã€‚å¥³å‘½é€¢ä¹‹ï¼Œé¡»é˜²ä¸€ç›®äººã€‚é€¢çŒ´ç¾Šé¡»å¿Œã€‚æœ‰é™©ã€‚å‰å¤„è—å‡¶ã€‚ç‰¹ä¾‹ï¼šæœ¬å‘½çŒ´ç¾Šåä¸»å¤§å‰ã€‚",
 e: "ä¸‰æ˜Ÿå®˜äººå‚é’“ï¼Œå‡å®˜ä¹‹è±¡ã€‚",
 f: "æ±‚è´¢ä¸åˆ©ï¼Œé€¢å€™ç¾Šäººæ—¶é—´æœ‰åˆ©ã€‚",
 g: "æœ‰ç›¸æ±‚ä¹‹è±¡ï¼Œå¯å©šã€‚é€¢å€™ç¾ŠåŠ å‰ã€‚ç”šé˜²ä¸€ç›®äººï¼Œæœ‰é™©ï¼Œä¸å©šã€‚",
 l: "æœ‰ä¸Šæ¦œä¹‹æœºï¼Œé€¢å€™ç¾Šå¹´æœˆæ—¶é—´äººç­‰å¯ä¸­ã€‚",
 m: "ä¸‰æ˜Ÿæ˜ç…§ï¼Œæœ‰æ•‘ã€‚æ‰¾åŒ»ç”Ÿä¸è¦æ‰¾ä¸€ç›®äººã€‚",
 z: "æš‚æ— ",

                             },
        57: {
            n: "å·½ä¸ºé£",
            t: "ä¸€ã€è´µäººèµè¡£ï¼šå…ˆç ´åæˆè±¡ã€‚<br>äºŒã€ä¸€äººè·ªå—ï¼šè´µç»¶ä¹Ÿã€‚å¦‚å ç–¾ç—…ï¼Œåˆ™ä¸»å¯¿è¡£ï¼Œå‡¶è±¡ã€‚<br>ä¸‰ã€äº‘ä¸­é›ä¼ ä¹¦ï¼šæ„å¤–å–œè®¯ã€‚<br>å››ã€äººåœ¨è™ä¸‹åï¼šèº«å¤„é™©è€Œä¸çŸ¥ã€‚<br>äº”ã€ä¸€äººå°„è™ä¸­ç®­ï¼šè´µäººç›¸æ•‘ã€‚<br>å…­ã€è™èµ°ï¼šè„±é™©ï¼Œå¯…å¹´ä¹Ÿã€‚",
            x: "é¡ºä¹Ÿï¼Œç”³å‘½è¡Œäº‹ã€‚åˆ©å¸‚ä¸‰å€ã€‚<br>åˆå…­ï¼šè¿›é€€ï¼Œåˆ©æ­¦äººä¹‹è´ã€‚<br>ä¹äºŒï¼šå·½åœ¨åºŠä¸‹ï¼Œç”¨å²å·«çº·è‹¥ï¼Œï¼Œæ— å’ã€‚<br>ä¹ä¸‰ï¼šé¢‘å·½ï¼Œåã€‚<br>å…­å››ï¼šæ‚”äº¡ï¼Œç”°è·ä¸‰å“ã€‚<br>ä¹äº”ï¼šè´ï¼Œæ‚”äº¡æ— ä¸åˆ©ï¼Œæ— åˆæœ‰ç»ˆï¼Œå…ˆåºšä¸‰æ—¥ï¼Œååºšä¸‰æ—¥ï¼Œã€‚<br>ä¸Šä¹ï¼šå·½åœ¨åºŠä¸‹ï¼Œä¸§å…¶èµ„æ–§ï¼Œè´å‡¶ã€‚",
            d: gd('SE')+"é•¿å¥³å±…ä¸œå—ã€‚",
u:"æ­¤å±€å¤§åˆ©æœªå©šå¥³ï¼Œå¾æ¯é€¢æœ‰æœªå©šå°å§æ¥æ±‚æ•™ï¼Œéƒ½ä¸åŒå…¶çƒ¦çš„å¸Œ æœ›ä»–èƒ½ä½åœ¨æ­¤å±€ä¸­ï¼Œå¿…ä¸»å©šå§»å¹¸ç¦ã€‚ä¸€ã€ç§‘ç”²å…´æ—ºï¼Œè€ƒè¯•å¿…ä¸­ã€‚äºŒã€ é€¢å‡¶åŒ–å‰ï¼Œç¾äº‹ä¸å…´ã€‚äºŒã€å©šå§»å¿…èƒ½å«å¥½å¤«å©¿ï¼Œé€¢çº¢é¸¾å³åŠ¨ã€‚å››ã€ æ€§æƒ…ç¨³å®šï¼Œå¤„å¿§ä¸æƒ§ã€‚äº”ã€ å¥åº·å¹³å®‰ä¹‹äººã€‚",
h: "ä¸‰äººä¹‹ä¸­ä¼¤ä¸€äººã€‚ä¸‰æ‰é˜²è™åˆé˜²å¯…ã€‚æ­£å®˜å¸¦å°ã€‚å®‰åˆ†å®ˆå·±ã€‚è§æœºè€Œè¿›ï¼Œä¸æ‹›è€»è¾±ï¼Œæœºåœ¨é‡åŠ›",
 a: "å‡ºå°†å…¥ç›¸ï¼Œä¸´ç¶¬ç¦„å‘½ï¼Œé¡»é˜²æš—ç®­ã€‚è™äººéš¾é€ƒã€‚å…¶ä½™å¹³å®‰ã€‚å¥³å‘½é€¢é˜²æš—å®³ï¼Œå‰ä¸­æœ‰é™©ï¼Œå¤«æœ‰éš¾ã€‚",
 b: "è™äººæ‹›å®³ï¼Œè¯¸äº‹å…ˆæˆåç ´ã€‚çŸ¥æ­¢æ–¹å‰ã€‚ç§‘ç”²é«˜ä¸­ã€‚å©šäº‹ä¸é€¢å¯…ï¼Œå¯æˆã€‚é‡å¯…ä¸æˆã€‚äº”çŸ­äººå¤§å‰ï¼Œè¯¸äº‹é¡ºé‚ã€‚",
 e: "ä¸€äººè·ªå—ï¼Œäº‘ä¸­ç‡•ä¼ ä¹¦ï¼Œå–œè®¯è‡³ä¹Ÿï¼Œç¬¬ä¸€æ¬¡ä¸å‡ç¬¬äºŒæ¬¡ä¹Ÿä¼šå‡ã€‚",
 f: "äº‘ä¸­ç‡•ä¼ ä¹¦ï¼Œå–œè®¯è‡³ï¼Œå¯åšã€‚",
 g: "äº‘ä¸­ç‡•ä¼ ä¹¦ï¼Œå–œè®¯è‡³ï¼Œå¯æˆã€‚ç”šé˜²è™ç‹äººã€‚",
 l: "äº‘ä¸­ç‡•ä¼ ä¹¦ï¼Œä¸€è™ä¸­ç®­èµ°ï¼Œè™ç‹ä¹‹äººä¸ä¸­ï¼Œå…¶ä½™é«˜ä¸­ï¼Œé€¢å¯…å¹´ä¸ä¸­ã€‚",
 m: "ä¸€äººè·ªå—ï¼Œè·ªå¯¿ä¹Ÿï¼Œé‡ç—…ä¸ºå‡¶ï¼Œé€¢è™ç‹ä¹‹äººã€æ—¶é—´æ›´å‡¶ã€‚",
 z: "å¾—å·½ä¸ºé£éœ€è¦ç”šé˜²è™ç‹ä¹‹äºº/ä¹‹å¹´",

                             },
        58: {
            n: "å…‘ä¸ºæ³½",
            t: "ä¸€ã€äººåçœ‹ä¸€æ‹…ï¼šä»»åŠ¡å®ŒæˆçŠ¶ï¼Œæœ‰äººç›¸åŠ©è±¡ï¼ŒåŠ©äººä¸ºä¹ä¹‹è´µäººã€‚<br>äºŒã€æœˆåœ¨å¤©è¾¹ï¼šæ¸…æ˜ä¹‹æ²»ã€‚<br>ä¸‰ã€ç§€æ‰ç™»æ¢¯ï¼šé‡‘æ¦œç™»ç§‘è±¡ã€‚<br>å››ã€ä¸€å¥³åœ¨åˆè¾¹ç«‹ï¼šå¥³äººä»‹å…¥ï¼Œå…ˆæˆåç ´ã€‚<br>äº”ã€æ–‡å­—ä¸Šç®­ï¼šå¾—æœºè€Œå‘ï¼Œå°„ï¼šå‘è±¡ã€‚",
            x: "è¯´ä¹Ÿï¼Œæ‚¦ä¹Ÿã€‚æœ‹å‹è®²ä¹ ã€‚<br>åˆä¹ï¼šå’Œå…‘ï¼Œã€‚<br>ä¹äºŒï¼šå­šå…‘ï¼Œï¼Œæ‚”äº¡ã€‚<br>å…­ä¸‰ï¼šæ¥å…‘ï¼Œå‡¶ã€‚<br>ä¹å››ï¼šå•†å…‘æœªå®ï¼Œä»‹ç–¾æœ‰å–œã€‚<br>ä¹äº”ï¼šå­šäºå‰¥ï¼Œæœ‰å‰ã€‚<br>ä¸Šå…­ï¼šå¼•å…‘",
            d: gd('W')+"ä¸‰å¥³å±…è¥¿ã€‚",
u:"ä¸€ã€ æ±‚å©šäº‹å¿…ä¸æˆï¼Œæ„Ÿæƒ…å¤æ‚åˆä¸“ä¸€ä¸äºŒï¼Œå¦‚é‡è™ç‹¼ä¹‹äººå¿…ä¼¤å®³ç”šå¤§ã€‚äºŒã€ æœ‰å¾…å©šä¸­ï¼Œå¤«å‡¶ä¹‹è±¡ï¼Œå©šæ¯”åŒæ—¶ç”Ÿäººï¼Œå»¶åä¸‰å¹´ã€‚ä¸‰ã€ ç§‘ç”²é¡ºç•…ï¼Œå¤šæ‰è‰ºä¹‹å¥³ã€‚å››ã€ å…¬èŒé¡ºé‚ï¼Œä½†ä»å•†å¿…ä¸»ä¸åˆ©ã€‚äº”ã€ ä½“å¥æ— ç¾ï¼Œæ¯è«é‡ï¼Œæœ‰æ— çˆ¶ä¹‹è™ã€‚",
h: "åŒäº²æœ‰ä¸‰äººã€‚ç”Ÿæœ‰å››ç²’ç ï¼Œæ­¤äººèº«æœ‰ç§‘ã€‚å°½æ˜¯è‡ªç”±äººã€‚å©šå§»æœ‰ç ´ã€‚å©†åª³ä¸å’Œä¸ºå®šæ•°ã€‚",
 a: "é‡åå¸ˆï¼Œä¸ç™»é’äº‘ï¼Œä¹Ÿåšå•†äººã€‚åå¸ˆåœ¨åæŒ‡ç‚¹ã€‚é€¢å¥³æœ‰ç ´ï¼Œè«è‡ªè®¤ç”Ÿæ€§é£æµï¼Œæœ‰å¦¾ç”Ÿç¾ã€‚æ¡ƒææ»¡å¤©ä¸‹ã€‚å¥³å‘½åˆ™æ±‚åˆå‰ã€‚å’Œç¦åˆ°è€ï¼Œå‰ã€‚è‹¥ä¸€æ„å­¤è¡Œï¼Œæ¯ååˆ°è€ã€‚",
 b: "é‡‘æ¦œç™»ç§‘ï¼Œç§‘ç”²å¾ˆæ—ºï¼Œä½†äº‹ä¸šåœæ»ï¼Œå”¯å„’æ—äººå‘ï¼Œå¯æˆä¸€æ–¹ä¹‹ä¸»ã€‚å¥³å‘½é¡»é˜²åŠ©å¤«æœ‰åˆ©ï¼Œå©šäº‹åå‡¶ï¼Œå¤«æœ‰å¦¾ã€‚",
 e: "ç§€æ‰ç™»æ¢¯ï¼Œå‡å®˜ä¹‹è±¡ã€‚",
 f: "ä¸€ç›’å­ï¼Œä¸€ç®­ï¼Œå¾—æœºè€Œå‘ï¼Œå…ˆæˆåç ´ã€‚",
 g: "å¦‡äººæºæ‰‹ï¼Œå©šå§»å¤§å‰ã€‚æœ‰ç®­è€Œå°„ï¼Œä¸€ç›’å­ï¼Œé˜²å‡ºè½¨å¯¼è‡´ç¦»å©šã€‚",
 l: "æœˆæ˜ï¼Œç§€æ‰ç™»æ¢¯ï¼Œé«˜ä¸­ä¹‹è±¡ã€‚",
 m: "æœˆåœ¨å¤©è¾¹ï¼Œå¥³äººæ— å¿§ï¼Œç§€æ‰ç™»æ¢¯ï¼Œäºº+æœ¨=ä¼‘ï¼Œæ‹…æ—æœ‰äººï¼Œä¼‘æ¯ä¹‹è±¡ã€‚ä½†é‡ç—…å°†ä¼‘ï¼ˆèµ°äººï¼‰ã€‚",
 z: "æš‚æ— ",

                             },
        59: {
            n: "é£æ°´æ¶£",
            t: "ä¸€ã€å±±ä¸Šæœ‰å¯ºï¼šå‡ºå®¶çŠ¶ï¼Œå¯¹å³™çŠ¶ï¼Œå¯¸åœŸå¯¸é‡‘è±¡ã€‚<br>äºŒã€åƒ§ï¼šåŒ–å¤–ä¹‹äººï¼Œå…‰å¤´äººï¼Œæ›¾å§“äººã€‚<br>ä¸‰ã€ä¸€äººéšåï¼šé€ƒé¿ï¼Œæ±‚åŠ©åŒ–å¤–ä¹‹äººã€‚<br>å››ã€ä¸€é¬¼åœ¨åï¼šä¸ºç¥¸è¿½ç¼‰ä¹‹è±¡ï¼Œå†…å¿ƒæœ‰é¬¼ï¼Œå¤„äº‹ä¸æ˜è±¡ã€‚<br>äº”ã€é‡‘ç”²äººï¼šæ­£ä¹‰ä¹‹å¸ˆï¼Œå¾—æ°‘å¿ƒä¹Ÿã€‚<br>å…­ã€å¯ºï¼ŒåœŸå¤´äººä½œå¯¹ã€‚ç­‰å¾…æ—¶æœºä¹Ÿã€‚",
            x: "æ•£ä¹Ÿï¼Œç¦»æ•£ã€‚äº«äºå¸ç«‹åº™ã€‚<br>åˆå…­ï¼šç”¨æ‹¯é©¬å£®ï¼Œã€‚<br>ä¹äºŒï¼šæ¶£å¥”å…¶æœºï¼Œæ‚”äº¡ã€‚<br>å…­ä¸‰ï¼šæ¶£å…¶èº¬ï¼Œæ— æ‚”ã€‚<br>å…­å››ï¼šæ¶£å…¶ç¾¤ï¼Œå…ƒã€‚æ¶£æœ‰ä¸˜ï¼ŒåŒªå¤·æ‰€æ€ã€‚<br>ä¹äº”ï¼šæ¶£æ±—å…¶å¤§å·ï¼Œæ¶£ç‹å±…ï¼Œæ— å’ã€‚<br>ä¸Šä¹ï¼šæ¶£å…¶è¡€ï¼Œå»é€–å‡ºï¼Œæ— å’ã€‚",
            d: gd('N')+"é•¿å¥³å±…åŒ—ã€‚æ¶£å±€äº¦å¸¸è§ä¹‹ï¼Œå¾äººåˆ©ç”¨é£å¦å¯ç«‹è§£ã€‚ä¸€ã€å¿ƒåœ¨å®—æ•™ï¼Œä¸æƒ³ç»“å©šï¼Œä½†æ˜“å…¥é‚ªé“ã€‚äºŒã€å¿ƒä¸­æœ‰é¬¼ï¼Œè¯¸äº‹ä¸æˆã€‚ä¸‰ã€ç¥¸äº‹è¿è¿ï¼Œå®˜éç‰¢ç‹±ç¾éš¾å…ã€‚ å››ã€å‡ºå®¶åŒ–è§£ç¾å„ï¼Œæ¯äº²ç»ˆæ—¥æ‹…å¿§ã€‚",
u:"æ­¤å±€ç‰¹æ®Šï¼Œå­¦è€…é¡»è¯†ã€‚ä¸€ã€ ç§‘ç”²å…´æ—ºäºŒã€ å¥³èº«ç”·æ€ä¸‰ã€ å©šäº‹ä¸æˆï¼Œé¡»é€¢è‚–ç¾Šã€è‚–çŒ´æˆ–äºæœªã€ç”³ä¹‹å¹´æ–¹æœ‰æˆã€‚å››ã€ åŸåºœè¾ƒæ·±ï¼Œç»ˆè‡ªå–å’ã€‚",
h: "ç”Ÿå…·æ…ˆæ‚²å¿ƒï¼Œè«æ¨äººç”Ÿå®³ã€‚å¤©æœºï¼šå±±æ¡¥æ›²è½¬ï¼Œå…«åƒå¥³é¬¼ï¼ˆé­ï¼‰ã€‚é©æ•…é¼ä¿¡è·¯æ˜¯é˜»ï¼Œå¥½äº‹å¤šç£¨ã€‚å©šå§»äº¦æœ‰é˜»ï¼Œç„¶éœ€è€å¿ƒï¼Œç»ˆæˆçœ·å±ï¼ŒäºŒå…«ä¹‹å¹´ã€‚",
 a: "è«æ¨å¦»å„¿æ— ç¼˜åˆ†ã€‚å‘½ä¸­å”¯å¸¦ä¸€å­¤å†²ã€‚å©šå§»é•¿çŸ­å‰ç”Ÿå®šã€‚æœˆï¼ˆæ¯ï¼Œå¦»ï¼‰ç¼ºèŠ±ï¼ˆå¥³ï¼‰æ®‹æ•°ä¸æ™“ã€‚",
 b: "æ‚£éš¾å°†æ•£ï¼Œåˆ©æ¶‰å¤§å·ã€‚é¡ºè¡Œè€ŒåŠ¨ã€‚å¤«å¦»å¯¹å³™ã€‚åƒ§ï¼ˆå¦‚æ›¾ï¼‰è´µé˜²é¬¼ã€‚çƒŸæ¶ˆäº‘æ•£ï¼Œç¥¸äº‹è¿œç¦»ã€‚",
 e: "æœ‰é¬¼è·Ÿéšï¼Œä¸æˆã€‚",
 f: "æœ‰é¬¼è·Ÿéšï¼Œæ—äººä½œå¯¹ï¼Œæ— åˆ©å¯å›¾ã€‚",
 g: "æœ‰é¬¼ï¼Œä¸èƒ½ç»“å©šã€‚",
 l: "æœ‰é¬¼è·Ÿéšï¼Œä¸ä¸­ã€‚",
 m: "æœ‰é¬¼è·Ÿéšï¼Œå¯æ±‚åŠ©å¯ºåº™ä¹‹äººï¼Œæˆ–è€…æ›¾å§“äººã€‚",
 z: "é‡åˆ°é£æ°´æ¢è¦é•‡å®šï¼Œç­‰å¾…æ—¶æœºï¼Œä¸å¯å†²åŠ¨å…¥åœºã€‚",

                             },

60: {
            n: "æ°´æ³½èŠ‚",
            t: "ä¸€ã€å¤§é›¨ä¸‹ï¼šé˜´æš—ä¸æ˜ï¼Œå‡¶è±¡ã€‚<br>äºŒã€ç«ä¸­é±¼è·ƒï¼šé£è…¾è€Œå¾’åŠ³æ— åŠŸï¼Œåˆé¤é¥®ä¸šã€‚<br>ä¸‰ã€é¸¡åœ¨å±‹ä¸Šï¼šé…‰å¹´è‚–é¸¡äººï¼Œè§£æ•‘ä¹‹æ—¶ä¸äººã€‚å››ã€çŠ¬åœ¨äº•ä¸­ï¼šæ‹›é™·ï¼ŒåŠ¨å¼¹ä¸å¾—ï¼Œä¸çŸ¥èŠ‚åˆ¶è€Œæ‹›å¦‚æ­¤ã€‚äº”ã€å±‹é—¨å¼€ç€ï¼šä»å¯å¼€å¼ ï¼Œé¡»é¸¡äººæ¥åŠ©å¤§å‰ã€‚",
            x: "èŠ‚åˆ¶ï¼Œè‹¦èŠ‚ä¸å¯è´ã€‚åˆ¶æ•°åº¦ã€‚<br>åˆä¹ï¼šä¸å‡ºæˆ·åº­ï¼Œæ— å’ã€‚<br>ä¹äºŒï¼šä¸å‡ºé—¨åº­ï¼Œå‡¶ã€‚<br>å…­ä¸‰ï¼šä¸èŠ‚è‹¥ï¼Œåˆ™å—Ÿè‹¥ï¼Œæ— å’ã€‚<br>å…­å››ï¼šå®‰èŠ‚ï¼Œäº¨ã€‚<br>ä¹äº”ï¼šèŠ‚ï¼Œï¼Œå¾€æœ‰å°šã€‚<br>ä¸Šå…­ï¼šè‹¦èŠ‚ï¼Œè´å‡¶ï¼Œæ‚”äº¡ã€‚",
            d: gd('W')+"æ¬¡å­å±…è¥¿ã€‚",
u:"ä¸€ã€æœ¬äººè‚–é¸¡ï¼Œåˆ™å¿…å¤§è´µã€‚äºŒã€æœ¬äººè‚–çŠ¬ï¼Œåˆ™ä»¥å°åšå¤§ï¼Œæ‹›è‡ªé™·ã€‚ä¸‰ã€è´¢æ— ç§¯ä½™ï¼Œè¡Œé™©æ‹›å‡¶ã€‚å©šäº‹ä¸æˆï¼ŒçŠ¬äººé‡é¸¡åˆ™æˆï¼Œå¦»é•¿ä¸€å²ï¼Œä¸åŒæ—¶ç”Ÿäººä¸åŒï¼Œä¸”å¦»ä¸»å¤§è´µï¼ŒåŠ©å¤«æ¸¡å„ã€‚",
h: "è´¢å¸›ä¸°èŒ‚ï¼Œå¤©æ„ä»é…‰ï¼Œé—¨åº­å‰åº†ã€‚çˆ¶å‰æ¯å‡¶ã€‚è´¢æ•£æ— å¸¸ã€‚é‡çŠ¬åŠ å‡¶ã€‚å•†æœºé€¢é…‰å¤§åˆ©ï¼Œå¼€é—¨å¾—è´¢ã€‚çŠ¬ç”Ÿæš—å®³ï¼Œä½™å‰ã€‚å¤©æœºï¼šé¸¡ç‹¬çŠ¬å››ï¼Œæ•°ä¸­å®šï¼Œå¤«å‡¶å¦»å‰ã€‚",
 a: "é…‰äººé‡ç«‹é—¨æˆ·ï¼Œä¸”å‰ï¼Œå¾—çˆ¶èµ„åŠ©ã€‚çŠ¬äººè‡ªé™·ï¼Œçš†ä¸å‡ºèŠ‚ï¼Œå”¯é¸¡å¯æ•‘ã€‚",
 b: "å“­ç¬‘ä¸å¾—ã€‚è¿›é€€å¤±æ®ã€‚å¤«å‡¶å¦»å‰ã€‚é€¢é…‰é‡ç”Ÿã€‚é€¢çŠ¬é™·äº•ä¸æ‹”ã€‚",
 e: "é±¼è¢«ç«çƒ¤ï¼Œå‡¶ä¹Ÿï¼Œå¤§é›¨ä¸‹ï¼Œå‡¶ä¹Ÿï¼Œä¸å‡ã€‚é¸¡åœ¨å±‹é¡¶ï¼Œé€¢é¸¡äºº/æ—¶é—´å¯å‡ã€‚",
 f: "é±¼è¢«ç«çƒ¤ï¼Œå¤§é›¨ä¸‹ï¼Œé˜´æš—ä¸æ˜ï¼Œå‡¶ä¹Ÿï¼Œé¸¡åœ¨å±‹é¡¶ï¼Œé€¢é¸¡æ—¶é—´æˆ–äººå¯åšï¼Œçƒ§çƒ¤ç­‰é¤é¥®ä¸šå¯åšï¼Œä½†éœ€è¦é¸¡äººä¸»äº‹ï¼Œç‹—äººæˆ–æ—¶é—´å¿…è´¥æ— ç–‘ã€‚",
 g: "å¤§é›¨ä¸‹ï¼Œé˜´æš—ä¸æ˜ï¼Œå‹¿å©šï¼Œé¸¡åœ¨å±‹é¡¶ï¼Œé€¢é¸¡è½¬å‡¶ä¸ºå‰ã€‚",
 l: "å¤§é›¨ä¸‹ï¼Œé˜´æš—ä¸æ˜ï¼Œé¸¡åœ¨å±‹é¡¶ï¼Œé€¢é¸¡å¯ä¸Šï¼Œå…¶ä½™ä¸ä¸Šã€‚",
 m: "å¤§é›¨ä¸‹ï¼Œé˜´æš—ä¸æ˜ï¼Œç—…å±ï¼Œé¸¡åœ¨å±‹é¡¶ï¼Œé€¢é¸¡æœ‰æ•‘ï¼Œé€¢ç‹—æ— æ•‘ï¼ˆæ—¶é—´ï¼Œäººç­‰ï¼‰ã€‚",
 z: "å¾—åˆ°æ°´æ³½èŠ‚é€¢åˆ°ç‹—æ—¶é—´/äººå¤§å‡¶ï¼Œå”¯æœ‰é¸¡æ—¶é—´/äººå¯è§£ã€‚",

                             },
        61: {
            n: "é£æ³½ä¸­å­š",
            t: "ä¸€ã€æœ›å­ä¸Šæ–‡ä¹¦ï¼šç§‘ç”²é«˜ä¸­ï¼Œåˆ‘æ³•æ›´å‰ã€‚<br>äºŒã€äººå‡»æŸï¼šé¢„è­¦ä¹Ÿã€‚<br>ä¸‰ã€è´µäººç”¨ç»³ç‰µé¹¿ï¼šå®ˆæˆï¼Œä¸å¯æ”»ä¹Ÿã€‚<br>å››ã€é›å•£ä¹¦ï¼šå–œäº‹å°†è‡³ï¼Œæœ‰å—å¾™ä¹‹è±¡ã€‚<br>äº”ã€äººç«‹åº­ä¸­ï¼šè…åº­ä¹Ÿï¼Œé˜²å®˜å¸æˆ–æ‰“å®˜å¸ä¿èº«ä¹Ÿ",
            x: "ä¿¡ä¹Ÿï¼Œè¯šä¿¡ã€‚è®®ç‹±ç¼“æ­»ã€‚<br>åˆä¹ï¼šè™ã€‚æœ‰å®ƒï¼Œä¸ç‡•ã€‚<br>ä¹äºŒï¼šé¸£é¹¤åœ¨é˜´ï¼Œå…¶å­å’Œä¹‹ï¼Œæˆ‘æœ‰å¥½çˆµï¼Œå¾ä¸å°”é¡ä¹‹ã€‚<br>å…­ä¸‰ï¼šå¾—æ•Œï¼Œæˆ–é¼“æˆ–ç½¢ï¼Œæˆ–æ³£æˆ–æ­Œã€‚<br>å…­å››ï¼šæœˆå‡ æœ›ï¼Œé©¬åŒ¹äº¡ï¼Œæ— å’ã€‚<br>ä¹äº”ï¼šæœ‰å­šå­ªå¦‚ï¼Œæ— å’ã€‚<br>ä¸Šä¹ï¼šç¿°éŸ³ç™»äºå¤©ï¼Œè´å‡¶ã€‚",
            d: gd('W')+"é•¿å¥³å±…è¥¿ã€‚",
u:"æœ‰å¥³æ¯è¯•å¿…ä¸ºçŠ¶å…ƒï¼Œå³ç”Ÿæ­¤å±€ä¹‹äººä¸€ã€ç§‘ç”²çŠ¶å…ƒï¼Œæ¯è€ƒå¿…ä¸­ã€‚äºŒã€æ­¦èŒå¤§åˆ©ï¼Œå¥³ä¸­è±ªæ°ï¼Œä»Šè§æœ‰å¥³å¸æ³•å®˜å¦‚æ­¤ã€‚ ä¸‰ã€åŒå–œåŒä¸´ï¼Œå¸¸åœ¨å©šå§»ä¸­ä¼´ä¹‹è€Œæ¥é‡‘æ¦œç™»ç§‘ã€‚å››ã€å–œäº‹åˆä¸æˆï¼Œå®¶ä¸­ä¸åŒæ„ï¼Œåæˆã€‚ä½†ä¸åŒæ—¶ç”Ÿäººå»¶åä¸‰å¹´ã€‚",
h: "å…„å¼Ÿåˆ†å®¶ï¼Œä¸ç›¸å¾€æ¥ã€‚çˆ¶è´¢å¿…äº‰ã€‚ä»å®˜å¤§å‰ã€‚æ­¦ä¸ºå¸æ³•ï¼Œæ–‡ä¸ºè´¢å®˜ï¼Œç§‘åå¹¶èŒ‚ã€‚çŠ¹æœ‰ä¸€å­ï¼Œç”Ÿæ˜¯éã€‚å©šäº‹æˆäºè´¢è´§ï¼Œå› åˆ©è€Œç»“ã€‚äº¦å‡¶äºè´¢è´§ã€‚",
 a: "æœ›å­ä¸Šæ–‡ä¹¦ã€‚èŠ‚åˆ¶è´¢å¸›é˜²äººå®³ï¼Œèˆç¦„æ±‚å®˜ä½ä¸Šç­–ã€‚å¤«å¦»æœ¬æ˜¯å‰ä¸–ä¿®ï¼Œä½•å¿…ä¸ºè´¢ç”Ÿäº‰æ‰§ã€‚",
 b: "ç§‘ç”²å¤§å‰ã€‚ç¦„å—é™ï¼Œé¡»é˜²å­åŠ«ã€‚å–œå‡ºæœ›å¤–ä¹‹å¹´ï¼ŒåŒå–œä¸´é—¨ã€‚",
 e: "æœ›å­—ä¸Šæ–‡ä¹¦ï¼Œç‡•æ¥ä¿¡ï¼Œå–œè®¯å°†è‡³ï¼Œå‡å®˜ï¼Œå°¤åˆ©å¸æ³•ã€‚",
 f: "é¹¿è¢«ç‰µå¼•ï¼Œç¦„å—é™åˆ¶ï¼Œå°¤å…¶ä¸èƒ½åšå°å­©å­ç›¸å…³çš„äº§ä¸šã€‚",
 g: "ç‡•æ¥ä¿¡ï¼Œå–œè®¯å°†è‡³ã€‚",
 l: "æœ›å­—ä¸Šæ–‡ä¹¦ï¼Œç‡•æ¥ä¿¡ï¼Œå–œè®¯å°†è‡³ï¼Œé«˜ä¸­ã€‚",
 m: "ç»³å­æ‰“ç»“ï¼Œå­©å­åŠ«éš¾æ˜¯ä¹Ÿï¼Œç‡•æ¥ä¿¡ï¼Œå–œè®¯ï¼Œæœ‰æ•‘ä¹Ÿã€‚",
 z: "æš‚æ— ",

                             },
        62: {
            n: "é›·å±±å°è¿‡",
            t: "ä¸€ã€æ˜æœˆå½“ç©ºï¼šæ”¿æ¸…çŠ¶ï¼Œå…¥æ³•åº­ï¼Œåˆ‘å ‚ã€‚<br>äºŒã€æ—ä¸‹ä¸€äººï¼šæ—å§“äººã€‚<br>ä¸‰ã€äººé™·ç½‘ä¸­ï¼šä¸å¾—è„±èº«ï¼Œå—æŸç¼šã€‚<br>å››ã€ä¸€äººå¼¹å† ï¼šæ±‚å»ä¹‹è±¡ï¼Œä½†æ±‚å»ä¸ºå½¢ï¼ŒæŸç¼šä¸ºç¥ï¼Œåˆåˆ™æœ‰è¡¨é‡Œä¸ä¸€çŠ¶ã€‚<br>äº”ã€ä¸€äººå‰²ç½‘ï¼šè´µäººè§£æ•‘ï¼Œè„±å›°çŠ¶ã€‚<br>å…­ã€çŒ´å­åœ¨å±±å¤´ï¼šä»æ–°å¼€å§‹ä¹‹è¯¾(å€™å†å‡ºå±±)ã€‚",
            x: "å°è¿‡é”™ï¼Œå®œä¸‹ã€‚è¡Œè¿‡ä¹æ­ã€‚<br>åˆå…­ï¼šé£é¸Ÿä»¥å‡¶ã€‚<br>å…­äºŒï¼šè¿‡å…¶ç¥–ï¼Œé‡å…¶å¦£ï¼Œä¸åŠå…¶å›ï¼Œé‡å…¶è‡£ï¼Œæ— å’ã€‚<br>ä¹ä¸‰ï¼šå¼—è¿‡é˜²ä¹‹ï¼Œä»æˆ–æˆ•ä¹‹ï¼Œå‡¶ã€‚<br>ä¹å››ï¼šæ— å’ï¼Œå¼—è¿‡é‡ä¹‹ï¼Œå¾€å‰å¿…æˆ’ï¼Œå‹¿ç”¨æ°¸è´ã€‚<br>å…­äº”ï¼šå¯†äº‘ä¸é›¨ï¼Œè‡ªæˆ‘è¥¿éƒŠï¼Œå…¬å¼‹å–å½¼åœ¨ç©´ã€‚<br>ä¸Šå…­ï¼šå¼—é‡è¿‡ä¹‹ï¼Œé£é¸Ÿç¦»ä¹‹ï¼Œå‡¶ï¼Œæ˜¯è°“ç¾çœšã€‚",
            d: gd('NE')+"é•¿å­å±…ä¸œåŒ—ã€‚",
u:"æ­¤å±€å¾ˆå¤šï¼Œå¾äººå¸¸ä¸è‡ªçŸ¥é™·äºå±€ä¸­ã€‚æ„Ÿæƒ…å›°æ‰°ï¼Œæ‘†è„±ä¸äº†æƒ…å…³ï¼Œä¸ºæƒ…ä¸é¡¾ä¸€åˆ‡ï¼Œæ­¤å°äººä¹Ÿã€‚ äºŒã€è‚–çŒ´ï¼Œå€™å§“äººä¸å¿Œã€‚ä¸‰ã€æ— æ³•å·¥ä½œï¼Œç¥é­‚é¢ å€’ã€‚å››ã€å¸¸è¿‡å¤±ä¼¤äººï¼Œæ•…å©šäº‹ä¸æˆã€‚",
h: "çˆ¶æ¯åŒå…¨ï¼Œè´¢ç¦„ä¸´èº«ï¼Œä¸»å¯Œï¼Œæ¬¡å¥³æˆæ ¼ã€‚å©šäº‹é€¢ç”°å‡¶ï¼Œé‡æ–°å¼€å§‹ï¼Œåˆé€¢ç”°æœ‰è§£ï¼Œå¤©æœºä¹Ÿã€‚ç”°ä¸ºè´µäººã€‚ä¸æˆæ ¼è€…ï¼Œä¸ºå®˜æ˜Ÿã€‚å…¬æ•™å¯æˆã€‚å”¯é˜²å©šçº¦ï¼Œæœ‰å¥³æ— å­ã€‚",
 a: "å®˜è®¼ä¹‹åï¼Œé‡æ–°å¼€å§‹ã€‚æ¯è«ä¸´èº«ï¼Œå•èº«è´µäººã€‚å•äº²å…»å¥³ï¼Œæœ‰å©šåå‡¶ã€‚",
 b: "é˜²ç«å„ï¼Œå¤«å¦»ä¸å’Œï¼Œé™·å…¥ç½‘ä¸­ï¼ŒåŠ¨å¼¹ä¸å¾—ã€‚å”¯å¼ºåŠ›å¯è§£ã€‚è´¢ä¸ç¼ºã€‚å¥³äººé€¢ä¹‹ä¸åˆ©ã€‚åŠ å‡¶ï¼Œæ˜“è¿›éš¾å‡ºã€‚",
 e: "å®˜äººæ±‚å»ï¼Œä¸å‡ä¹‹è±¡ï¼Œç¦»èŒä¹‹è±¡ã€‚è‚–çŒ´æˆ–å€™äººå¯å¾…æ—¶è€Œå‡ã€‚",
 f: "äººå›°ç½‘ä¸­ï¼Œå—å›°ä¹‹è±¡ï¼Œä¸åšï¼Œæ— è´¢åè¢«å›°ã€‚è‚–çŒ´æˆ–å€™äººä¸å›°ï¼Œä½†æ— è´¢ã€‚",
 g: "äººå›°ç½‘ä¸­ï¼Œå©šåå—å›°ï¼Œé€¢åˆ°ç”°å§“ä¹‹äººè·‘è·¯ï¼Œå³ä½¿ä¸é€¢ç”°äººä¹Ÿå—å›°ã€‚",
 l: "è‚–çŒ´æˆ–å€™äººï¼Œæˆ–ç¥äººç­‰åŒéŸ³å­—çš„äººå¯ä¸Šã€‚å…¶ä½™ä¸ä¸Šã€‚",
 m: "äººå›°ç½‘ä¸­ï¼Œå¾…æ—¶æœ‰æ•‘ã€‚",
 z: "å€™äººæˆ–è€…çŒ´æ—¶é—´å¹³å®‰ï¼Œå…¶ä½™è€…è¦å¾…æ—¶è€Œè§£",

                             },
        63: {
            n: "æ°´ç«æ—¢æµ",
            t: "ä¸€ã€äººåœ¨å²¸ä¸Šï¼šæ³£ä¹Ÿï¼Œç­‰å¾…ä¹Ÿï¼Œæ— ç›®çš„ä¹Ÿã€‚<br>äºŒã€ä¸€èˆ¹æ¥ï¼šæ¥å¼•è‡³ä¹Ÿã€‚<br>ä¸‰ã€ä¸€å †é’±ï¼šè´¢ç¦„æ— ç”¨ä¹Ÿï¼Œå¿§å¿ƒå¿¡å¿¡ä¹Ÿï¼Œæœ‰çªƒè±¡ï¼ŒæŠ„å®¶ä¹‹è±¡ã€‚<br>å››ã€äº‘ä¸­é›¨ä¸‹ï¼šé˜´ä¸­æœ‰æœä¹Ÿï¼Œå¤œé—´è‡³å‡Œæ™¨æ—¶ã€‚<br>äº”ã€äºŒå°å„¿ï¼šä¸»å–œä¹Ÿï¼ŒäºŒäººä¹Ÿï¼ŒäºŒäººé›¨ä¸­è¡Œä¹Ÿã€‚<br>å…­ã€æ–‡ä¹¦ä¸€ç­–ï¼šè¯ä»¶ï¼Œå‘½ä»¤ä¹Ÿï¼Œèµ„æ–™ä¹Ÿã€‚",
            x: "å®šä¹Ÿï¼Œåˆå‰ç»ˆä¹±ã€‚æ€æ‚£è±«é˜²ã€‚<br>åˆä¹ï¼šæ›³å…¶è½®ï¼Œæ¿¡å…¶å°¾ï¼Œæ— å’ã€‚<br>å…­äºŒï¼šå¦‡ä¸§å…¶èŒ€ï¼Œå‹¿é€ï¼Œä¸ƒæ—¥å¾—ã€‚<br>ä¹ä¸‰ï¼šé«˜å®—ä¼é¬¼æ–¹ï¼Œä¸‰å¹´å…‹ä¹‹ï¼Œå°äººå‹¿ç”¨ã€‚<br>å…­å››ï¼šç¹»æœ‰è¡£è¢½ï¼Œç»ˆæ—¥æˆ’ã€‚<br>ä¹äº”ï¼šæŸ¬é‚»æ€ç‰›ï¼Œä¸å¦‚è¥¿é‚»ä¹‹ç¦´ç¥­ï¼Œå®å—å…¶ç¦ã€‚<br>ä¸Šå…­ï¼šæ¿¡å…¶é¦–ï¼Œå‰ã€‚",
            d: gd('S')+"æ¬¡å­å±…å—ã€‚",
u:"æ­¤å±€å¾å¸¸ç”¨äºåŒ–è§£å›°å¦ä¹‹å±€ä¸€ã€ä¸é‡è´¢è´§ï¼Œå¤©æ€§å¦‚æ­¤ã€‚äºŒã€å®˜è¿äººå‰ï¼Œä»å•†äº¦å¾—è´¢ï¼Œæ•…è´¢å®˜åŒç¾ã€‚ä¸‰ã€ç§‘ç”²äº¦å‰ï¼Œåˆ©è€ƒè¯•ã€‚å››ã€å…ˆæœ‰å­ï¼Œåæœ‰å©šï¼Œå¦‚åŠ ä¸Šå‘½ä¸­æœ‰å¦¾ï¼Œåˆ™å¿…ä¸»æ­£æˆ¿ä¸€å­ï¼Œåæˆ¿ä¸€å­ã€‚äº”ã€å©šå§»ä¼šæ¯”åŒæ—¶ç”Ÿäººæ…¢å…«å¹´ï¼Œä¹Ÿå¸¸å…ˆæœ‰å¦¾åæœ‰å©šã€‚æ•…å¾äººçŸ¥å¦‚æ­¤ï¼Œå¸¸ä¿Ÿäº‹ä¸šå®‰å®šåï¼Œç”¨é›·å¦åŒ–è§£å©šå§»é—®é¢˜ã€‚",
h: "æ±‚å®˜æ±‚ç§‘ä¸¤ç›¸å®œã€‚å°‘å¹´ç™»ç§‘ã€‚é€¢æ°´å¾—è´¢å‘½ä¸­å®šã€‚ä¸¤å…„å¼Ÿå¾—ç¥–ä¸šã€‚å®˜äººå—ç¦„å‘½äºæ°´å¹´ï¼ˆæˆŒäº¥å¹´ï¼‰ã€‚å©šäº‹å‰ã€‚ç”·æœ‰å­ï¼Œå¥³å‘½æ— å­ã€‚",
 a: "å¾—è´µäººåŠ©ã€‚æ±‚è´¢å¤§å‰ã€‚æ±‚å®˜äº¦å¾—ç¦„å‘½ã€‚ä¸€äººäºŒæ°´è§£ç¾ã€‚æˆŒäº¥ä¹‹å¹´æ˜¯æ—¢æµï¼Œå¹³æ­¥é’äº‘é‚å·±å¿—ã€‚",
 b: "æœ‰çªƒä¹‹å¹´ï¼Œç¦„å‘½è‡³ï¼Œå‰ä¸­å°å‡¶ï¼Œå¤«å¦»å’Œç¦ï¼Œé˜²å¦»æœ‰ç—…ç¾ã€‚é€¢å®˜äººè¿è°ƒå¤–åœ°ä¹‹å¹´ã€‚",
 e: "ä¸€èˆ¹æ¥ï¼Œæ¥å¼•è‡³ï¼Œå‡å®˜ã€‚",
 f: "é›¨ä¸‹ï¼Œæ¶¦æ³½ä¹Ÿï¼Œæœ‰è´¢ã€‚ä½†éœ€é˜²ç›—çªƒã€‚",
 g: "æ–‡ä¹¦è‡³ï¼Œå¯å©šã€‚",
 l: "æ–‡ä¹¦è‡³ï¼Œå¯ä¸­ã€‚",
 m: "é’±æ•£è½åœ°ï¼Œçº¸é’±ï¼Œé‡ç—…ææœ‰è¡€å…‰ã€‚",
 z: "æš‚æ— ",

                             },
        64: {
            n: "ç«æ°´æœªæµ",
            t: "ä¸€ã€ä¸€äººæåˆ€æ–§ï¼šåˆ˜å§“ï¼Œæ­¦å®˜ï¼Œæ‰‹æœ‰ç”Ÿæ€ä¹‹æƒã€‚<br>äºŒã€ä¸€è™åï¼šè‚–è™äººï¼Œç‹å§“ï¼Œè™åä¹ƒæ— å¨ä¹‹è±¡ã€‚<br>ä¸‰ã€ä¸€æ——å“åœ¨å±±ä¸Šï¼šæ­ç«¿è€Œèµ·ï¼Œæ­£ä¹‰ä¹‹å¸ˆã€‚<br>å››ã€ä¸€äººå–æ——ï¼šä»£æ›¿ä¹Ÿï¼Œé«˜å§“ï¼Œå®‹å§“ï¼Œå…¶äººå–ä»£ä¹‹è±¡ã€‚<br>äº”ã€æ¢¯å­æœ‰è‡³å­—ï¼šæ— åˆ€æ—¥è‡³ï¼Œæ¡æ¢å—å›°è±¡ã€‚å…­ã€ï¼ˆé™„æ³¨ï¼šå³ªï¼šè°·å§“ã€‚æ——æ‰¬ï¼šæ¨å§“ã€‚)æœ‰è°·ã€æ¨åˆä¹ƒæ‹›å‡¶è±¡",
            x: "æœªæˆï¼Œæ…è¾¨ç‰©å±…æ–¹ã€‚<br>åˆå…­ï¼šæ¿¡å…¶å°¾ï¼Œåã€‚<br>ä¹äºŒ ï¼šæ›³å…¶è½®ï¼Œè´ã€‚<br>å…­ä¸‰ï¼šæœªæµï¼Œå¾å‡¶ï¼Œåˆ©æ¶‰å¤§å·ã€‚<br>ä¹å››ï¼šè´ ï¼Œæ‚”äº¡ï¼Œéœ‡ç”¨ä¼é¬¼æ–¹ï¼Œä¸‰å¹´æœ‰èµäºå¤§å›½ã€‚<br>å…­äº”ï¼šè´ ï¼Œæ— æ‚”ï¼Œå›å­ä¹‹å…‰ï¼Œæœ‰å­šï¼Œã€‚<br>ä¸Šä¹ï¼šæœ‰å­šäºé¥®é…’ï¼Œæ— å’ï¼Œæ¿¡å…¶é¦–ï¼Œæœ‰å­šå¤±æ˜¯ã€‚",
            d: gd('N')+"æ¬¡å¥³å±…åŒ—ã€‚",
u:"ä¸€ã€å¥³èº«ç”·æ€ï¼Œæ€§åˆšæ˜“æ€’ã€‚ äºŒã€è‚–è™å¥³å­ï¼Œå¿…æ¯åæ— æˆã€‚ä¸‰ã€åˆ˜ã€å®‹ã€é«˜ç­‰å§“äººä»æ­¦å‰ã€‚å››ã€å©šäº‹å¿…ä¸æˆï¼Œä¸åŒæ—¶ç”Ÿäººå©šæ—¶ä¸åŒã€‚äº”ã€ä»å•†æ±‚è´¢æ˜¯éå¤šï¼Œç”šè€Œå®˜å¸ã€äº‰æ‰§ä¸ä¸‹ã€‚é˜³å®…ä¹‹å±€æ¼”ç»åˆ°æ­¤ï¼Œæš‚å‘Šä¸€æ®µè½ï¼Œä¸‹ç¯‡é£ä¸æ°´ç¯‡ï¼Œå…¶ä¸­å¾äººå·² å°†å¤æ¥å¾ˆå¤æ‚ä¹‹ç†è®ºç®€åŒ–åï¼Œå¹¶ç”¨æ˜“æ¥è§£é‡Šè®¡ç®—ï¼Œå­¦è€…å¿…èƒ½ææ˜“æ˜ äº†ï¼ŒåŠ ä¸Šå½•å½±å¸¦ä¹‹è¯´æ˜ï¼Œå¿…å¯ä¸€ç½—ç»åœ¨æ‰‹ï¼Œå³å ªå¤©ä¸åœ°å»ä¹Ÿã€‚",
h: "è™ç‹ä¹‹äººå—æ¡æ¢ã€‚å¯å“å®‹é«˜å¾—åˆ©äººã€‚é«˜å°å€¾è¦†ï¼Œå©šäº‹ä¸æˆï¼Œåæ‹›å‡¶ã€‚æ±‚è´¢æ±‚å®˜ä¸¤ä¸åˆ©ã€‚ä¸€ç”Ÿæ­¦å®˜ä¸»å¤§åˆ©ï¼Œä½™ä¸å‰ã€‚å‘äºä¹±ä¸–ã€‚å¤«å¦‡ä¸å’Œäº‰æ‰§å¤šï¼Œé‡åˆ™å…µæˆç›¸è§ï¼Œæœ‰å¥³ä¸ºè´µã€‚",
 a: "ä¸œå—è¥¿åŒ—ï¼Œå±…æ— å®šæ‰€ã€‚å‡¡äº‹ç¼ºä¸´é—¨ä¸€è„šã€‚è¸è°·æ‰¬æ——ç»ˆå‡¶ï¼Œä¸è´ªä¸åï¼Œæ­£è´¢å¯å®ˆç»ˆèº«ã€‚å¿§ä¸­è§å–œã€‚",
 b: "æœªæµä¹‹å¹´ï¼Œäº‹å¤šå£…æ»ï¼Œæ…å¤„å®ˆæˆï¼Œå‰ã€‚åŠ›äº‰æ‹›æ˜¯éã€‚å©šäº‹ä¸åˆ©ã€‚æ±‚è´¢è°¨æ…å¤šé˜²ï¼ˆå°äººï¼‰ã€‚è™äººå—å›°ä¹‹æ—¶ã€‚",
 e: "ä¸€äººå–æ——ï¼Œå®ç›–å¤´äººå¯å‡ï¼Œæ­¦å°†å¹³å®‰ï¼Œå…¶ä½™ä¸å‡ã€‚è™ç‹ä¹‹äººå—æŸï¼Œä¸åˆ©ã€‚",
 f: "æœ¨+è‡³=æ¡ä¹Ÿï¼Œå—å›°ï¼Œæ— è´¢ã€‚",
 g: "æœ¨+è‡³=æ¡ä¹Ÿï¼Œå—å›°ï¼Œä¸åˆ©ï¼Œå‹¿å©šã€‚",
 l: "ä»¤åœ¨æ——ä¸Šï¼Œä¸€äººå–æ——ï¼Œå®ç›–å¤´äººè€ƒè¯•æœ‰åˆ©ã€‚è‚–è™äººç‹äººï¼Œæˆ–è€…è™å¹´æœˆæ—¥æ—¶çš†ä¸åˆ©ã€‚",
 m: "æœ¨+è‡³=æ¡ä¹Ÿï¼Œå—å›°ï¼Œè‚–è™äººç‹äººï¼Œæˆ–è€…è™å¹´æœˆæ—¥æ—¶åŠ å‡¶ã€‚",
 z: "è™½ä¸ºæœªæµï¼Œä½†å¤©ä¸‹åˆä¹…å¿…åˆ†ï¼Œåˆ†ä¹…å¿…åˆï¼Œç»ˆä¼šæµæ—¢ï¼Œæ­¤ä¹ƒè‡ªç„¶ä¹‹ç†",

                             },
    };


    // 3. ç•Œé¢ç”Ÿæˆé€»è¾‘
    const ids = ['in1','in2','in3'];
    ids.forEach((id, idx) => {
        var element = document.getElementById(id);
        if(!element) {
            console.warn('å…ƒç´  ' + id + ' ä¸å­˜åœ¨ï¼Œè·³è¿‡ç”Ÿæˆ');
            return;
        }
        let h = '';
        for(let i=1; i<=5; i++){
            h+=`<div class="sel-row"><span class="lbl">ç¬¬${i}æ­¥</span><select id="${id}_${i}"><option value="">-</option>`;
            for(let j=1; j<=64; j++) h+=`<option value="${j}">${j}.${DB[j].n}</option>`;
            h+='</select></div>';
        }
        element.innerHTML = h;
    });
    
    // å¦‚æœcalcFlowå·²ç»æ‰§è¡Œè¿‡ï¼Œå°è¯•è‡ªåŠ¨å¡«å……
    if(typeof window.autoFill64GuaFromCalc === 'function') {
        setTimeout(function() {
            window.autoFill64GuaFromCalc();
        }, 100);
    }

    function gen(){
        const out = document.getElementById('out');
        out.innerHTML = '';
        ['å¤©å…ƒå±€'].forEach((tt, idx) => {
            let h = `<div class="res-col"><div class="res-t">${tt}</div>`;
            let has = false;
            for(let i=1; i<=64; i++){
                let v = document.getElementById(`${ids[idx]}_${i}`).value;
                if(v){
                    has = true;
                    let d = DB[v];
                    
                    // è·å–å¦è±¡å¹¶ç”Ÿæˆå¦å›¾
                    let guaDiagramHtml = '';
                    try {
                        const yaos = getGuaYaosByName(d.n);
                        if(yaos) {
                            const yuantang = getDefaultYuantangFor64Gua(yaos);
                            guaDiagramHtml = renderGuaHtml(yaos, yuantang);
                        }
                    } catch(e) {
                        console.warn('ç”Ÿæˆå¦è±¡å¤±è´¥:', e);
                    }
                    
                    h += `
                    <div class="card">
                        <div class="c-head"><span class="c-name">${d.n}</span><span class="c-step">ç¬¬${i}æ­¥</span></div>
                        <details><summary>1. å¦å›¾è§£æ</summary><div class="c-body">${guaDiagramHtml}${d.t}</div></details>
                        <details><summary>2. å¦ä¹‰å¦è¾</summary><div class="c-body">${d.x}</div></details>
                        <details><summary>3. åœ°ç†æ–¹ä½å›¾</summary><div class="c-body">${d.d}</div></details>
                        <details><summary>4. åœ°ç†è§£æ</summary><div class="c-body">${d.u}</div></details>
                        <details><summary>5. å…ˆå¤©å¦</summary><div class="c-body">${d.h}</div></details>
                        <details><summary>6. åå¤©å¦</summary><div class="c-body">${d.a}</div></details>
                        <details><summary>7. æµå¹´å¦</summary><div class="c-body">${d.b}</div></details>
                        <details><summary>8. å¦è§£â€”å®˜è¿</summary><div class="c-body">${d.e}</div></details>
                        <details><summary>9. å¦è§£â€”è´¢è¿</summary><div class="c-body">${d.f}</div></details>
                        <details><summary>10. å¦è§£â€”å©šå§»</summary><div class="c-body">${d.g}</div></details>
                        <details><summary>11. å¦è§£â€”è€ƒè¯•</summary><div class="c-body">${d.l}</div></details>
                        <details><summary>12. å¦è§£â€”ç–¾ç—…</summary><div class="c-body">${d.m}</div></details>
                        <details><summary>12. å¦è§£â€”å…¶ä»–</summary><div class="c-body">${d.z}</div></details>

                    </div>`;
                }
            }
            if(!has) h+='<div style="text-align:center;color:#999;padding:10px;">æœªé€‰æ‹©</div>';
            out.innerHTML += h + '</div>';
        });
    }
</script>
<script>
// ========= 1. å¦å -> å›¾ç‰‡æ–‡ä»¶åæ˜ å°„ï¼ˆæŒ‰ä½ ä¸Šä¼ çš„æ–‡ä»¶åæ¥ï¼‰ =========
// æ£€æŸ¥æ˜¯å¦å·²ç»å£°æ˜ï¼Œé¿å…é‡å¤å£°æ˜
if(typeof GUA_IMAGE_MAP === 'undefined') {
    window.GUA_IMAGE_MAP = {
    "ä¹¾ä¸ºå¤©": "ä¹¾ä¸ºå¤©.jpg",
    "å¤ä¸ºåœ°": "å¤ä¸ºåœ°.jpg",
    "æ°´é›·å±¯": "æ°´é›·å±¯.png",
    "å±±æ°´è’™": "å±±æ°´è’™.png",
    "æ°´å¤©éœ€": "æ°´å¤©éœ€.png",
    "å¤©æ°´è®¼": "å¤©æ°´è®¼.jpg",
    "åœ°æ°´å¸ˆ": "åœ°æ°´å¸ˆ.png",
    "æ°´åœ°æ¯”": "æ°´åœ°æ¯”.png",
    "é£å¤©å°ç•œ": "é£å¤©å°ç•œ.jpg",
    "å¤©æ³½å±¥": "å¤©æ³½å±¥.jpg",
    "åœ°å¤©æ³°": "åœ°å¤©æ³°.jpg",
    "å¤©åœ°å¦": "å¤©åœ°å¦.jpg",
    "å¤©ç«åŒäºº": "å¤©ç«åŒäºº.jpg",
    "ç«å¤©å¤§æœ‰": "ç«å¤©å¤§æœ‰.jpg",
    "åœ°å±±è°¦": "åœ°å±±è°¦.png",
    "é›·åœ°è±«": "é›·åœ°è±«.jpg",
    "æ³½é›·éš": "æ³½é›·éš.jpg",
    "å±±é£è›Š": "å±±é£è›Š.png",
    "åœ°æ³½ä¸´": "åœ°æ³½ä¸´.jpg",
    "é£åœ°è§‚": "é£åœ°è§‚.jpg",
    "ç«é›·å™¬å—‘": "ç«é›·å™¬å—‘.jpg",
    "å±±ç«è´²": "å±±ç«è´².png",
    "å±±åœ°å‰¥": "å±±åœ°å‰¥.png",
    "åœ°é›·å¤": "åœ°é›·å¤.png",
    "å¤©é›·æ— å¦„": "å¤©é›·æ— å¦„.jpg",
    "å±±å¤©å¤§ç•œ": "å±±å¤©å¤§ç•œ.png",
    "å±±é›·é¢": "å±±é›·é¢.png",
    "æ³½é£å¤§è¿‡": "æ³½é£å¤§è¿‡.jpg",
    "åä¸ºæ°´": "åä¸ºæ°´.jpg",
    "ç¦»ä¸ºç«": "ç¦»ä¸ºç«.jpg",
    "æ³½å±±å’¸": "æ³½å±±å’¸.jpg",
    "é›·é£æ’": "é›·é£æ’.jpg",
    "å¤©å±±é¯": "å¤©å±±é¯.jpg",
    "é›·å¤©å¤§å£®": "é›·å¤©å¤§å£®.png",
    "ç«åœ°æ™‹": "ç«åœ°æ™‹.jpg",
    "åœ°ç«æ˜å¤·": "åœ°ç«æ˜å¤·.png",
    "é£ç«å®¶äºº": "é£ç«å®¶äºº.jpg",
    "ç«æ³½ç½": "ç«æ³½ç½.jpg",
    "æ°´å±±è¹‡": "æ°´å±±è¹‡.png",
    "é›·æ°´è§£": "é›·æ°´è§£.jpg",
    "å±±æ³½æŸ": "å±±æ³½æŸ.png",
    "é£é›·ç›Š": "é£é›·ç›Š.jpg",
    "æ³½å¤©å¤¬": "æ³½å¤©å¤¬.jpg",
    "å¤©é£å§¤": "å¤©é£å§¤.jpg",
    "æ³½åœ°èƒ": "æ³½åœ°èƒ.jpg",
    "åœ°é£å‡": "åœ°é£å‡.png",
    "æ³½æ°´å›°": "æ³½æ°´å›°.jpg",
    "æ°´é£äº•": "æ°´é£äº•.png",
    "æ³½ç«é©": "æ³½ç«é©.jpg",
    "ç«é£é¼": "ç«é£é¼.jpg",
    "éœ‡ä¸ºé›·": "éœ‡ä¸ºé›·.jpg",
    "è‰®ä¸ºå±±": "è‰®ä¸ºå±±.jpg",
    "é£å±±æ¸": "é£å±±æ¸.jpg",
    "é›·æ³½å½’å¦¹": "é›·æ³½å½’å¦¹.png",
    "é›·ç«ä¸°": "é›·ç«ä¸°.jpg",
    "ç«å±±æ—…": "ç«å±±æ—….jpg",
    "å·½ä¸ºé£": "å·½ä¸ºé£.jpg",
    "å…‘ä¸ºæ³½": "å…‘ä¸ºæ³½.jpg",
    "é£æ°´æ¶£": "é£æ°´æ¶£.jpg",
    "æ°´æ³½èŠ‚": "æ°´æ³½èŠ‚.png",
    "é£æ³½ä¸­å­š": "é£æ³½ä¸­å­š.jpg",
    "é›·å±±å°è¿‡": "é›·å±±å°è¿‡.jpg",
    "æ°´ç«æ—¢æµ": "æ°´ç«æ—¢æµ.png",
    "ç«æ°´æœªæµ": "ç«æ°´æœªæµ.png"
    };
}

// å¦‚æœå›¾ç‰‡å’Œ html åœ¨åŒä¸€ç›®å½•ï¼Œç”¨ç©ºå­—ç¬¦ä¸²æˆ– "./"
if(typeof GUA_IMG_BASE === 'undefined') {
    window.GUA_IMG_BASE = "gua_images/";   // å¦‚æœä½ æ”¾åœ¨å­ç›®å½•ï¼Œæ¯”å¦‚ gua_images/ï¼Œæ”¹æˆ "gua_images/"
}

// ========= 2. ç”Ÿæˆå¦å›¾å›¾ç‰‡çš„ HTML =========
function makeGuaImageHtml(guaName) {
    const file = GUA_IMAGE_MAP[guaName];
    if (!file) {
        // æ²¡é…ç½®å›¾ç‰‡å°±ä»€ä¹ˆéƒ½ä¸åŠ ï¼ˆä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ˜¾ç¤ºâ€œæš‚æ— å¦å›¾â€ï¼‰
        return "";
    }
    const src = GUA_IMG_BASE + file;
    return `
        <div class="gua-img-box" style="
            text-align:center;
            margin-bottom:10px;
            padding:8px;
            background:#f9f9f9;
            border-radius:6px;
            border:1px solid #eee;
        ">
            <img src="${src}"
                 alt="${guaName} å¦å›¾"
                 title="${guaName} å¦å›¾ï¼ˆç‚¹å‡»æ”¾å¤§ï¼‰"
                 style="max-width:100%;max-height:260px;border-radius:4px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.15);"
                 onclick="openGuaImgModal('${src}','${guaName}')"
                 onerror="this.parentElement.innerHTML='(å¦å›¾å›¾ç‰‡åŠ è½½å¤±è´¥ï¼š${file})';">
            <div style="margin-top:6px;font-size:13px;color:#b35c1e;font-weight:bold;">ã€${guaName}ã€‘å¦å›¾</div>
        </div>
    `;
}

// ========= 3. å¤§å›¾å¼¹çª—ï¼ˆè‡ªåŠ¨å…¨å±ï¼Œç‚¹å‡»å…³é—­ï¼‰ =========
function openGuaImgModal(src, title) {
    const old = document.getElementById('gua-img-modal');
    if (old) old.remove();

    const wrap = document.createElement('div');
    wrap.id = 'gua-img-modal';
    wrap.style.cssText = `
        position:fixed;
        left:0;
        top:0;
        width:100%;
        height:100%;
        background:rgba(0,0,0,0.95);
        z-index:9999;
        display:flex;
        align-items:center;
        justify-content:center;
        cursor:pointer;
    `;
    
    const imgContainer = document.createElement('div');
    imgContainer.style.cssText = `
        position:relative;
        width:100% !important;
        height:100% !important;
        display:flex;
        align-items:center;
        justify-content:center;
        transition: all 0.3s ease;
        box-sizing: border-box;
    `;
    
    const img = document.createElement('img');
    img.src = src;
    img.alt = title;
    img.style.cssText = `
        width: 100vw !important;
        height: 100vh !important;
        max-width: 100vw !important;
        max-height: 100vh !important;
        object-fit: contain !important;
        cursor: pointer;
        transition: all 0.3s ease;
        display: block;
        margin: 0;
        padding: 0;
    `;
    
    const titleDiv = document.createElement('div');
    titleDiv.style.cssText = `
        position:absolute;
        bottom:20px;
        left:50%;
        transform:translateX(-50%);
        color:#fff;
        font-size:18px;
        background:rgba(0,0,0,0.5);
        padding:8px 16px;
        border-radius:4px;
        pointer-events:none;
    `;
    titleDiv.textContent = title + ' å¦å›¾';
    
    // ç‚¹å‡»å›¾ç‰‡æˆ–èƒŒæ™¯å…³é—­
    img.onclick = (e) => {
        e.stopPropagation();
        wrap.remove();
    };
    
    wrap.onclick = (e) => {
        if (e.target === wrap || e.target === imgContainer) {
            wrap.remove();
        }
    };
    
    imgContainer.appendChild(img);
    imgContainer.appendChild(titleDiv);
    wrap.appendChild(imgContainer);
    
    document.body.appendChild(wrap);
}

// ========= 4. é‡å†™ gen()ï¼šåœ¨â€œ1. å¦å›¾â€é‡Œæ’å…¥å›¾ç‰‡ =========
// åˆ©ç”¨ä½ åŸæ¥çš„ DB / idsï¼Œä¸æ”¹åŠ¨å®ƒä»¬ï¼Œåªæ˜¯æŠŠåŸæ¥çš„ gen ç”¨å›¾ç‰‡å¢å¼ºç‰ˆæ›¿æ¢æ‰
(function () {
    if (typeof DB === 'undefined' || typeof ids === 'undefined') {
        console.error('æ‰¾ä¸åˆ° DB æˆ– ids å˜é‡ï¼Œè¯·ç¡®è®¤è„šæœ¬é¡ºåºã€‚');
        return;
    }

    window.gen = function () {
        const out = document.getElementById('out');
        out.innerHTML = '';

        const titles = ['å¤©å…ƒå±€'];

        titles.forEach((tt, idx) => {
            let h = `<div class="res-col"><div class="res-t">${tt}</div>`;
            let has = false;

            for (let i = 1; i <= 64; i++) {
                const sel = document.getElementById(`${ids[idx]}_${i}`);
                if (!sel) continue;
                const v = sel.value;
                if (!v) continue;

                has = true;
                const d = DB[v];
                const guaName = d.n || '';
                const imgHtml = makeGuaImageHtml(guaName);
                
                // è·å–å¦è±¡å¹¶ç”Ÿæˆå¦å›¾
                let guaDiagramHtml = '';
                try {
                    const yaos = getGuaYaosByName(guaName);
                    if(yaos) {
                        const yuantang = getDefaultYuantangFor64Gua(yaos);
                        guaDiagramHtml = renderGuaHtml(yaos, yuantang);
                    }
                } catch(e) {
                    console.warn('ç”Ÿæˆå¦è±¡å¤±è´¥:', e);
                }

                h += `
                <div class="card">
                    <div class="c-head">
                        <span class="c-name">${guaName}</span>
                        <span class="c-step">ç¬¬${i}æ­¥</span>
                    </div>
                    <details>
                        <summary>1 . å¦å›¾è§£æ</summary>
                        <div class="c-body">
                            ${guaDiagramHtml}
                            ${imgHtml}
                            <div>${d.t || ''}</div>
                        </div>
                    </details>
                    <details><summary>2 . å¦ä¹‰å¦è¾</summary><div class="c-body">${d.x || ''}</div></details>
                    <details><summary>3 . åœ°ç†æ–¹ä½å›¾</summary><div class="c-body">${d.d || ''}</div></details>
                    <details><summary>4 . åœ°ç†è§£æ</summary><div class="c-body">${d.u || ''}</div></details>
                    <details><summary>5 . å…ˆå¤©å¦</summary><div class="c-body">${d.h || ''}</div></details>
                    <details><summary>6 . åå¤©å¦</summary><div class="c-body">${d.a || ''}</div></details>
                    <details><summary>7 . æµå¹´å¦</summary><div class="c-body">${d.b || ''}</div></details>
                    <details><summary>8 .  å¦è§£â€”å®˜è¿</summary><div class="c-body">${d.e || ''}</div></details>
                    <details><summary>9 .  å¦è§£â€”è´¢è¿</summary><div class="c-body">${d.f || ''}</div></details>
                    <details><summary>10. å¦è§£â€”å©šå§»</summary><div class="c-body">${d.g || ''}</div></details>
                    <details><summary>11. å¦è§£â€”è€ƒè¯•</summary><div class="c-body">${d.l || ''}</div></details>
                    <details><summary>12. å¦è§£â€”ç–¾ç—…</summary><div class="c-body">${d.m || ''}</div></details>
                    <details><summary>13. å¦è§£â€”å…¶ä»–</summary><div class="c-body">${d.z || ''}</div></details>


                </div>`;
            }

            if (!has) {
                h += '<div style="text-align:center;color:#999;padding:10px;">æœªé€‰æ‹©</div>';
            }

            h += '</div>';
            out.innerHTML += h;
        });
    };

    console.log('âœ… å¦å›¾å›¾ç‰‡åŠŸèƒ½å·²æŒ‚è½½ï¼Œç‚¹å‡»â€œç‚¹å‡»ç”Ÿæˆâ€å³å¯çœ‹åˆ°å¦å›¾ã€‚');
})();
</script><script>
// ========= 1. å¦å -> å›¾ç‰‡æ–‡ä»¶åæ˜ å°„ï¼ˆæŒ‰ä½ ä¸Šä¼ çš„æ–‡ä»¶åæ¥ï¼‰ =========
// æ£€æŸ¥æ˜¯å¦å·²ç»å£°æ˜ï¼Œé¿å…é‡å¤å£°æ˜
if(typeof GUA_IMAGE_MAP === 'undefined') {
    window.GUA_IMAGE_MAP = {
    "ä¹¾ä¸ºå¤©": "ä¹¾ä¸ºå¤©.jpg",
    "å¤ä¸ºåœ°": "å¤ä¸ºåœ°.jpg",
    "æ°´é›·å±¯": "æ°´é›·å±¯.png",
    "å±±æ°´è’™": "å±±æ°´è’™.png",
    "æ°´å¤©éœ€": "æ°´å¤©éœ€.png",
    "å¤©æ°´è®¼": "å¤©æ°´è®¼.jpg",
    "åœ°æ°´å¸ˆ": "åœ°æ°´å¸ˆ.png",
    "æ°´åœ°æ¯”": "æ°´åœ°æ¯”.png",
    "é£å¤©å°ç•œ": "é£å¤©å°ç•œ.jpg",
    "å¤©æ³½å±¥": "å¤©æ³½å±¥.jpg",
    "åœ°å¤©æ³°": "åœ°å¤©æ³°.jpg",
    "å¤©åœ°å¦": "å¤©åœ°å¦.jpg",
    "å¤©ç«åŒäºº": "å¤©ç«åŒäºº.jpg",
    "ç«å¤©å¤§æœ‰": "ç«å¤©å¤§æœ‰.jpg",
    "åœ°å±±è°¦": "åœ°å±±è°¦.png",
    "é›·åœ°è±«": "é›·åœ°è±«.jpg",
    "æ³½é›·éš": "æ³½é›·éš.jpg",
    "å±±é£è›Š": "å±±é£è›Š.png",
    "åœ°æ³½ä¸´": "åœ°æ³½ä¸´.jpg",
    "é£åœ°è§‚": "é£åœ°è§‚.jpg",
    "ç«é›·å™¬å—‘": "ç«é›·å™¬å—‘.jpg",
    "å±±ç«è´²": "å±±ç«è´².png",
    "å±±åœ°å‰¥": "å±±åœ°å‰¥.png",
    "åœ°é›·å¤": "åœ°é›·å¤.png",
    "å¤©é›·æ— å¦„": "å¤©é›·æ— å¦„.jpg",
    "å±±å¤©å¤§ç•œ": "å±±å¤©å¤§ç•œ.png",
    "å±±é›·é¢": "å±±é›·é¢.png",
    "æ³½é£å¤§è¿‡": "æ³½é£å¤§è¿‡.jpg",
    "åä¸ºæ°´": "åä¸ºæ°´.jpg",
    "ç¦»ä¸ºç«": "ç¦»ä¸ºç«.jpg",
    "æ³½å±±å’¸": "æ³½å±±å’¸.jpg",
    "é›·é£æ’": "é›·é£æ’.jpg",
    "å¤©å±±é¯": "å¤©å±±é¯.jpg",
    "é›·å¤©å¤§å£®": "é›·å¤©å¤§å£®.png",
    "ç«åœ°æ™‹": "ç«åœ°æ™‹.jpg",
    "åœ°ç«æ˜å¤·": "åœ°ç«æ˜å¤·.png",
    "é£ç«å®¶äºº": "é£ç«å®¶äºº.jpg",
    "ç«æ³½ç½": "ç«æ³½ç½.jpg",
    "æ°´å±±è¹‡": "æ°´å±±è¹‡.png",
    "é›·æ°´è§£": "é›·æ°´è§£.jpg",
    "å±±æ³½æŸ": "å±±æ³½æŸ.png",
    "é£é›·ç›Š": "é£é›·ç›Š.jpg",
    "æ³½å¤©å¤¬": "æ³½å¤©å¤¬.jpg",
    "å¤©é£å§¤": "å¤©é£å§¤.jpg",
    "æ³½åœ°èƒ": "æ³½åœ°èƒ.jpg",
    "åœ°é£å‡": "åœ°é£å‡.png",
    "æ³½æ°´å›°": "æ³½æ°´å›°.jpg",
    "æ°´é£äº•": "æ°´é£äº•.png",
    "æ³½ç«é©": "æ³½ç«é©.jpg",
    "ç«é£é¼": "ç«é£é¼.jpg",
    "éœ‡ä¸ºé›·": "éœ‡ä¸ºé›·.jpg",
    "è‰®ä¸ºå±±": "è‰®ä¸ºå±±.jpg",
    "é£å±±æ¸": "é£å±±æ¸.jpg",
    "é›·æ³½å½’å¦¹": "é›·æ³½å½’å¦¹.png",
    "é›·ç«ä¸°": "é›·ç«ä¸°.jpg",
    "ç«å±±æ—…": "ç«å±±æ—….jpg",
    "å·½ä¸ºé£": "å·½ä¸ºé£.jpg",
    "å…‘ä¸ºæ³½": "å…‘ä¸ºæ³½.jpg",
    "é£æ°´æ¶£": "é£æ°´æ¶£.jpg",
    "æ°´æ³½èŠ‚": "æ°´æ³½èŠ‚.png",
    "é£æ³½ä¸­å­š": "é£æ³½ä¸­å­š.jpg",
    "é›·å±±å°è¿‡": "é›·å±±å°è¿‡.jpg",
    "æ°´ç«æ—¢æµ": "æ°´ç«æ—¢æµ.png",
    "ç«æ°´æœªæµ": "ç«æ°´æœªæµ.png"
    };
}

// å¦‚æœå›¾ç‰‡å’Œ html åœ¨åŒä¸€ç›®å½•ï¼Œç”¨ç©ºå­—ç¬¦ä¸²æˆ– "./"
if(typeof GUA_IMG_BASE === 'undefined') {
    window.GUA_IMG_BASE = "./";   // å¦‚æœä½ æ”¾åœ¨å­ç›®å½•ï¼Œæ¯”å¦‚ gua_images/ï¼Œæ”¹æˆ "gua_images/"
}

// ========= 2. ç”Ÿæˆå¦å›¾å›¾ç‰‡çš„ HTML =========
function makeGuaImageHtml(guaName) {
    const file = GUA_IMAGE_MAP[guaName];
    if (!file) {
        // æ²¡é…ç½®å›¾ç‰‡å°±ä»€ä¹ˆéƒ½ä¸åŠ ï¼ˆä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ˜¾ç¤ºâ€œæš‚æ— å¦å›¾â€ï¼‰
        return "";
    }
    const src = GUA_IMG_BASE + file;
    return `
        <div class="gua-img-box" style="
            text-align:center;
            margin-bottom:10px;
            padding:8px;
            background:#f9f9f9;
            border-radius:6px;
            border:1px solid #eee;
        ">
            <img src="${src}"
                 alt="${guaName} å¦å›¾"
                 title="${guaName} å¦å›¾ï¼ˆç‚¹å‡»æ”¾å¤§ï¼‰"
                 style="max-width:100%;max-height:260px;border-radius:4px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.15);"
                 onclick="openGuaImgModal('${src}','${guaName}')"
                 onerror="this.parentElement.innerHTML='(å¦å›¾å›¾ç‰‡åŠ è½½å¤±è´¥ï¼š${file})';">
            <div style="margin-top:6px;font-size:13px;color:#b35c1e;font-weight:bold;">ã€${guaName}ã€‘å¦å›¾</div>
        </div>
    `;
}

// ========= 3. å¤§å›¾å¼¹çª—ï¼ˆè‡ªåŠ¨å…¨å±ï¼Œç‚¹å‡»å…³é—­ï¼‰ =========
function openGuaImgModal(src, title) {
    const old = document.getElementById('gua-img-modal');
    if (old) old.remove();

    const wrap = document.createElement('div');
    wrap.id = 'gua-img-modal';
    wrap.style.cssText = `
        position:fixed;
        left:0;
        top:0;
        width:100%;
        height:100%;
        background:rgba(0,0,0,0.95);
        z-index:9999;
        display:flex;
        align-items:center;
        justify-content:center;
        cursor:pointer;
    `;
    
    const imgContainer = document.createElement('div');
    imgContainer.style.cssText = `
        position:relative;
        width:100% !important;
        height:100% !important;
        display:flex;
        align-items:center;
        justify-content:center;
        transition: all 0.3s ease;
        box-sizing: border-box;
    `;
    
    const img = document.createElement('img');
    img.src = src;
    img.alt = title;
    img.style.cssText = `
        width: 100vw !important;
        height: 100vh !important;
        max-width: 100vw !important;
        max-height: 100vh !important;
        object-fit: contain !important;
        cursor: pointer;
        transition: all 0.3s ease;
        display: block;
        margin: 0;
        padding: 0;
    `;
    
    const titleDiv = document.createElement('div');
    titleDiv.style.cssText = `
        position:absolute;
        bottom:20px;
        left:50%;
        transform:translateX(-50%);
        color:#fff;
        font-size:18px;
        background:rgba(0,0,0,0.5);
        padding:8px 16px;
        border-radius:4px;
        pointer-events:none;
    `;
    titleDiv.textContent = title + ' å¦å›¾';
    
    // ç‚¹å‡»å›¾ç‰‡æˆ–èƒŒæ™¯å…³é—­
    img.onclick = (e) => {
        e.stopPropagation();
        wrap.remove();
    };
    
    wrap.onclick = (e) => {
        if (e.target === wrap || e.target === imgContainer) {
            wrap.remove();
        }
    };
    
    imgContainer.appendChild(img);
    imgContainer.appendChild(titleDiv);
    wrap.appendChild(imgContainer);
    
    document.body.appendChild(wrap);
}

// ========= 4. é‡å†™ gen()ï¼šåœ¨â€œ1. å¦å›¾â€é‡Œæ’å…¥å›¾ç‰‡ =========
// åˆ©ç”¨ä½ åŸæ¥çš„ DB / idsï¼Œä¸æ”¹åŠ¨å®ƒä»¬ï¼Œåªæ˜¯æŠŠåŸæ¥çš„ gen ç”¨å›¾ç‰‡å¢å¼ºç‰ˆæ›¿æ¢æ‰
(function () {
    if (typeof DB === 'undefined' || typeof ids === 'undefined') {
        console.error('æ‰¾ä¸åˆ° DB æˆ– ids å˜é‡ï¼Œè¯·ç¡®è®¤è„šæœ¬é¡ºåºã€‚');
        return;
    }

    window.gen = function () {
        const out = document.getElementById('out');
        out.innerHTML = '';

        const titles = ['å¤©å…ƒå±€'];

        titles.forEach((tt, idx) => {
            let h = `<div class="res-col"><div class="res-t">${tt}</div>`;
            let has = false;

            for (let i = 1; i <= 64; i++) {
                const sel = document.getElementById(`${ids[idx]}_${i}`);
                if (!sel) continue;
                const v = sel.value;
                if (!v) continue;

                has = true;
                const d = DB[v];
                const guaName = d.n || '';
                const imgHtml = makeGuaImageHtml(guaName);

                h += `
                <div class="card">
                    <div class="c-head">
                        <span class="c-name">${guaName}</span>
                        <span class="c-step">ç¬¬${i}æ­¥</span>
                    </div>
                    <details>
                        <summary>1. å¦å›¾è§£æ</summary>
                        <div class="c-body">
                            ${imgHtml}
                            <div>${d.t || ''}</div>
                        </div>
                    </details>
                    <details><summary>2. å¦ä¹‰å¦è¾</summary><div class="c-body">${d.x || ''}</div></details>
                    <details><summary>3. åœ°ç†è§£æ</summary><div class="c-body">${d.d || ''}</div></details>
                    <details><summary>4. åœ°ç†è§£æ</summary><div class="c-body">${d.u || ''}</div></details>
                    <details><summary>5. å…ˆå¤©å¦</summary><div class="c-body">${d.h || ''}</div></details>
                    <details><summary>6 . åå¤©å¦</summary><div class="c-body">${d.a || ''}</div></details>
                    <details><summary>7 . æµå¹´å¦</summary><div class="c-body">${d.b || ''}</div></details>
                    <details><summary>8 .  å¦è§£â€”å®˜è¿</summary><div class="c-body">${d.e || ''}</div></details>
                    <details><summary>9 .  å¦è§£â€”è´¢è¿</summary><div class="c-body">${d.f || ''}</div></details>
                    <details><summary>10. å¦è§£â€”å©šå§»</summary><div class="c-body">${d.g || ''}</div></details>
                    <details><summary>11. å¦è§£â€”è€ƒè¯•</summary><div class="c-body">${d.l || ''}</div></details>
                    <details><summary>12. å¦è§£â€”ç–¾ç—…</summary><div class="c-body">${d.m || ''}</div></details>
                    <details><summary>12. å¦è§£â€”å…¶ä»–</summary><div class="c-body">${d.z || ''}</div></details>
                </div>`;
            }

            if (!has) {
                h += '<div style="text-align:center;color:#999;padding:10px;">æœªé€‰æ‹©</div>';
            }

            h += '</div>';
            out.innerHTML += h;
        });
    };

    console.log('âœ… å¦å›¾å›¾ç‰‡åŠŸèƒ½å·²æŒ‚è½½ï¼Œç‚¹å‡»â€œç‚¹å‡»ç”Ÿæˆâ€å³å¯çœ‹åˆ°å¦å›¾ã€‚');
})();
</script>
</body>
</html>

            </div>
        </section>
        
        <!-- æ–‡åŒ–ä¼ æ‰¿é¡µé¢ -->
        <section id="statemenc" class="page-content">
            <!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘¨æ˜“å­¦ä¹ è½¯ä»¶åŠè¯¾ç¨‹ - ä¼ æ‰¿ä¸­åæ–‡æ˜   èµ°å‘ä¸–ç•Œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", "å¾®è½¯é›…é»‘", sans-serif;
        }
        
        body {
            background-color: #f8f5f0;
            color: #333;
            line-height: 1.6;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23f8f5f0"/><path d="M0,50 Q25,40 50,50 T100,50" stroke="%23e8e0d0" fill="none" stroke-width="0.5"/><path d="M0,30 Q25,20 50,30 T100,30" stroke="%23e8e0d0" fill="none" stroke-width="0.5"/><path d="M0,70 Q25,60 50,70 T100,70" stroke="%23e8e0d0" fill="none" stroke-width="0.5"/></svg>');
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(to right, #8B4513, #A0522D, #8B4513);
            color: #f8f5f0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.2);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            letter-spacing: 3px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        header .subtitle {
            font-size: 1.2rem;
            font-weight: 300;
            max-width: 800px;
            margin: 0 auto;
        }
        
        section {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #8B4513;
        }
        
        section h2 {
            color: #8B4513;
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px dashed #e8e0d0;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        section h2:before {
            content: "ã€Š";
            margin-right: 5px;
        }
        
        section h2:after {
            content: "ã€‹";
            margin-left: 5px;
        }
        
        .author {
            text-align: right;
            font-size: 1.2rem;
            font-weight: bold;
            color: #8B4513;
            margin-top: 20px;
        }
        
        .payment-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 1rem;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        }
        
        .payment-table thead tr {
            background-color: #8B4513;
            color: #f8f5f0;
            text-align: left;
            font-weight: bold;
        }
        
        .payment-table th,
        .payment-table td {
            padding: 15px 20px;
            border-right: 1px solid #e8e0d0;
        }
        
        .payment-table tbody tr {
            border-bottom: 1px solid #e8e0d0;
        }
        
        .payment-table tbody tr:nth-of-type(even) {
            background-color: #fcfaf7;
        }
        
        .payment-table tbody tr:last-of-type {
            border-bottom: 2px solid #8B4513;
        }
        
        .payment-table tbody tr:hover {
            background-color: #f8f5f0;
        }
 .payment-methods {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 30px 0;
            width: 90vw 
        }
        
        .payment-methodsss{
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 30px 0;
            width: 100vw 
        }
        
        .payment-method {
            text-align: center;
            margin: 15px;
            padding: 20px;
            background-color: #fcfaf7;
            border-radius: 10px;
            width: 250px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }
        
        .payment-method h3 {
            color: #8B4513;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .payment-placeholder {
            width: 200px;
            height: 200px;
            background-color: #e8e0d0;
            border: 2px dashed #8B4513;
            border-radius: 8px;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #8B4513;
            font-weight: bold;
        }
        
        .yin-de-explanation {
            background-color: #fcfaf7;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #8B4513;
        }
        
        .yin-de-explanation h4 {
            color: #8B4513;
            margin-bottom: 10px;
        }
        
        .important-note {
            background-color: #fff9e6;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #ffcc00;
        }
        
        .important-note h4 {
            color: #b8860b;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .important-note h4:before {
            content: "âš ";
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .contact-info {
            background-color: #f0f7ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #4a6fa5;
        }
        
        .contact-info h4 {
            color: #4a6fa5;
            margin-bottom: 10px;
        }
        
        .footer {
            text-align: center;
            padding: 30px 0;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #e8e0d0;
            margin-top: 30px;
        }
        
        .tagline {
            text-align: center;
            font-style: italic;
            margin: 20px 0;
            font-size: 1.1rem;
           colourï¼š#8B4513
        }
        
        .highlight {
            background-color: rgba(255, 215, 0, 0.2);
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header h1 {
                font-size: 1.8rem;
            }
            
            section {
                padding: 20px;
            }
            
            .payment-table {
                font-size: 0.9rem;
            }
            
            .payment-table th,
            .payment-table td {
                padding: 10px;
            }
            
            .payment-method {
                width: 100%;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>

        
        <section id="announcement">
<div class="tagline" style="color: #8B4513; font-size: 1.2rem;">
            â€œä¸ºä¸–ç•Œä¹‹å¤§åŒè€Œç ”è¯»å¹¶è·µè¡Œã€Šæ˜“ç»ã€‹â€
        </div>

            <h2>å‘ŠåŒå¿—ä¹¦</h2>
            <p>å„ä½åŒå¿—ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä¸­åæ°‘æ—çš„ä¸€å‘˜ï¼Œæˆ‘ä»¬éƒ½å¯¹ä¸­åæ°‘æ—çš„å¤å…´æœ‰ç€å†å²è´£ä»»å’Œå†å²ä½¿å‘½ã€‚åƒå¹´çš„ä¼ æ‰¿ï¼Œæ— æ•°ä»äººå¿—å£«çš„æµ´è¡€å¥‹æ–—ï¼Œç»ˆäºæœ‰äº†ä»Šå¤©æˆ‘å‘ä½ ä»¬è®²è¿°çš„è¯¾ç¨‹å†…å®¹å’Œè¿™ä¸ªè½¯ä»¶ã€‚</p>
            <p>æ— æ•°äººæƒ³å­¦ä¹ ä¼ æ‰¿å´æ²¡æœ‰åˆé€‚çš„å¸ˆæ‰¿ï¼Œæ²¡æœ‰åˆé€‚çš„å› ç¼˜ã€‚ä»Šç‰¹æ­¤å…¬å¸ƒæ­¤è½¯ä»¶åŠè¯¾ç¨‹ï¼Œä»¥æ±‚ä¼—ç”Ÿèƒ½æœ‰å…¥é—¨å­¦ä¹ ä¹‹æ³•é—¨ã€‚æˆ‘ä»¬ä¸å¿…è®¡è¾ƒæ­¤æ³•é—¨ä¸ºä½•äººåˆ›é€ ï¼Œåªéœ€ç²¾è¯šç«­åŠ›ï¼Œå‘æ‰¬å…‰å¤§ï¼Œä¸Šæ…°å…ˆç¥–ï¼Œä¸‹å®‰ä¸­åã€‚å„è¡Œå„ä¸šéƒ½å¯å­¦ä¹ å‘¨æ˜“ï¼Œè¿ç”¨å‘¨æ˜“ï¼Œå‘å±•å„ä¸ªè¡Œä¸šï¼Œä»¥æ±‚ç™¾ä¸šå…´ç››ã€‚äººäººéƒ½å¯å­¦ä¹ å‘¨æ˜“ï¼Œè¿ç”¨å‘¨æ˜“ï¼Œä»¥æ±‚äººäººçš†æ˜å¤©åœ°ä¹‹è‡³ç†ï¼Œè‡ªç„¶ä¹‹è§„å¾‹ï¼Œè¨€å¿µå›å­ï¼Œä»¥è‡´äººäººå‘å¾€ä¹‹å¤§åŒç¤¾ä¼šã€‚</p>
            <br><p>ä½•ä¸ºå¤§åŒï¼Œæ ‡å‡†æœ‰äºŒï¼š</p>
            <ul style="margin-left: 20px; margin-bottom: 15px;">
                <li>ç¬¬ä¸€ï¼Œç§‘å­¦å‘è¾¾ä»¥è‡´ç”Ÿäº§åŠ›å‘è¾¾æ­¤ä¸ºä¸€ä¹Ÿã€‚</li>
                <li>ç¬¬äºŒï¼Œäººå¿ƒæ˜çº²å¸¸ï¼Œæ•¬äº”ä¼¦ï¼Œä»¥è‡´å¤šä¸ºå›å­æ˜¯ä¹Ÿã€‚</li>
            </ul>
            <p>ä»Šå¤©æˆ‘ä»¬çš„ç¤¾ä¼šï¼Œç§‘å­¦å³å°†è¿æ¥æŒ‡æ•°å‹çˆ†å‘ï¼Œå¦‚æ²¡æœ‰æ­£ç¡®ä¹‹ç†å¿µå¼•å¯¼ï¼Œå°†ä¸çŸ¥äººç±»è¿™è‰˜å·¨è½®å°†å»å¾€ä½•æ–¹ã€‚æ˜“ç»ä¸ºäº˜å¤ä¸å˜çš„è‡ªç„¶è§„å¾‹ï¼Œå…¶å¯¹ä¸€åˆ‡ä¸–é—´å®¢è§‚äº‹ç‰©æœ‰ç€å¼•é¢†æŒ‡å¯¼å‘å±•æ–¹å‘çš„ä½œç”¨ï¼Œè¿™æ˜¯äººç±»ç¤¾ä¼šå‘å±•çš„è¿‡ç¨‹ä¸­ä¸å¯æˆ–ç¼ºçš„æ˜ç¯ã€‚æ— è®ºäºå…¬äºç§ï¼Œä»å“ªæ–¹é¢æ¥è®²ï¼Œå­¦ä¹ æ˜“ç»ä¿®èº«å…»æ€§ï¼Œæ˜å¾·ï¼Œå¤å…´ä¸­åï¼Œé€ ç¦ä¸–ç•Œï¼Œéƒ½æ˜¯æˆ‘ä»¬æ¯ä¸€ä½ç‚é»„å­å­™çš„ç”Ÿå‘½ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿåº”å½“æ˜¯å½“å‰äººç±»ä¸­æœ€é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚ä¼ æ‰¿ä¸­åæ–‡æ˜çš„åŒæ—¶ï¼Œè®©ä¸­åæ–‡æ˜èµ°å‘ä¸–ç•Œï¼Œé€ ç¦ä¸–ç•Œã€‚</p>
            <div class="author">é’å²› è‘£å¾·é¾™è€å¸ˆ</div>
        </section>
<section id="announcement">
            <h2>ä¸šåŠ¡é¡¹ç›®åŠè¯¾ç¨‹</h2>
            <p>ä¸ºäº†ä¼ æ‰¿ä¸­å›½æ˜“ç»æ–‡åŒ–ï¼Œç°é¢å‘å…¨å›½å…¨ä¸–ç•Œæ•™æˆä»¥ä¸‹è¯¾ç¨‹åŠå¼€å±•ä»¥ä¸‹ä¸šåŠ¡ï¼š</p>
            <br><p>1ã€é˜³å®…åœ°ç†</p>
            <p>2ã€å±±æ°´å‹˜æµ‹</p>
            <p>3ã€æ˜“ç»æ¨ç®—ï¼ˆæ˜“è±¡ã€æ˜“æ•°ï¼‰</p>
            <p>4ã€ç´«è–‡æ–—æ•°ï¼ˆåŒ…æ‹¬ä¸‰åˆã€å››åŒ–é£æ˜Ÿï¼‰</p>
            <div class="payment-methods"ï¼Œ>
                <div class="payment-method"ï¼Œ>
                    <h3>æ‰«ç åŠ è€å¸ˆåŠ©ç†å¾®ä¿¡</h3>
                    <div class="payment-placeholder"ï¼Œ>
                        å¾®ä¿¡äºŒç»´ç <br/><img src="gua_images/è€å¸ˆåŠ©ç†å¾®ä¿¡ç .png" style="max-width:100%;max-height:260px;border-radius:4px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.15);">
                    </div>
                    <p>è¯·ä½¿ç”¨å¾®ä¿¡æ‰«ç </p>
                </div>
            <h3 style="text-align: center;width: 100%;max-height:260px;margin: 3px 0 20px 0; color: #8B4513;">åŠ©ç†ç”µè¯ï¼š15166397157</h3>
                        <div class="author"></div>
        </section>

        
        <section id="payment">
            <h2>è½¯ä»¶è¯¾ç¨‹æ”¶è´¹æ ‡å‡†</h2>
            <table class="payment-table">
                <thead>
                    <tr>
                        <th><h3>æ˜“ç»æ’ç›˜ç³»ç»Ÿæ”¶è´¹</h3></th>
                        </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><h3>ä¸€å¹´ä½¿ç”¨è´¹10å…ƒ</h3></td>
                    </tr>
                    <tr>
                        <td>
                            <div>å¦‚æœ‰å›°éš¾æŒ‰ç…§ä»¥ä¸‹æ–¹æ³•æ”¶è´¹ï¼š</div>
                            <div class="yin-de-explanation">
                                <h3>å…¶ä»–æ”¯ä»˜æ–¹å¼</h3>
                                <p>éœ€åœ¨ä»–äººéœ€è¦å¸®åŠ©æ—¶ï¼ˆä½¿ç”¨çš„æ¯å¹´ï¼‰åš10ä»¶é˜´å¾·ä¹‹äº‹ã€‚ä½•ä¸ºé˜´å¾·ï¼Œå³å¸®åŠ©ä»–äººä¸å›¾å›æŠ¥ä¹Ÿã€‚ä¸åªæ˜¯å¯¹äººï¼Œä¼—ç”Ÿçš†å¯ã€‚äº‹ä¸è®ºå¤§å°ï¼Œå“ªæ€•å‡ åŒ…åƒåœ¾ã€ä¸€é¤é¥±é¥­è¿™æ ·çš„å°äº‹ä¹Ÿå¯ã€‚å¹¶ä¸”å¸®åŠ©ä»–äººåï¼ˆæœ‰æ¡ä»¶çš„æƒ…å†µä¸‹ï¼‰æé†’ä»–äººå°†é˜´å¾·ä¹‹ç†å¿µä¼ é€’ä¸‹å»ï¼Œä»¥æ±‚æ—©æ—¥ç¤¾ä¼šå¤§åŒã€‚</p>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td colspan="2" style="text-align: center; background-color: #fcfaf7;">
                            <strong>å› æ”¶è´¹æ–¹å¼çš„ä¸åŒï¼Œæ‰€ä»¥è½¯ä»¶åŠè¯¾ç¨‹å¹¶ä¸éœ€è¦å…ˆæ”¯ä»˜å†å­¦ä¹ ä½¿ç”¨ï¼Œå¸Œæœ›å¤§å®¶è‡ªè§‰ã€‚</strong>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="payment-table">
                <thead>
                    <tr>
                        <th><h3>64å¦åˆ†æç³»ç»Ÿæ”¶è´¹</h3></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><h3>ä¸€å¹´ä½¿ç”¨è´¹15å…ƒ</h3></td>
                    </tr>
                    <tr>                        <td>
                            <div>å¦‚æœ‰å›°éš¾æŒ‰ç…§ä»¥ä¸‹æ–¹æ³•æ”¶è´¹ï¼š</div>
                            <div class="yin-de-explanation">
                                <h3>å…¶ä»–æ”¯ä»˜æ–¹å¼</h3>
                                <p>éœ€åœ¨ä»–äººéœ€è¦å¸®åŠ©æ—¶åš150ä»¶é˜´å¾·ä¹‹äº‹ã€‚ä½•ä¸ºé˜´å¾·ï¼Œå³å¸®åŠ©ä»–äººä¸å›¾å›æŠ¥ä¹Ÿã€‚ä¸åªæ˜¯å¯¹äººï¼Œä¼—ç”Ÿçš†å¯ã€‚äº‹ä¸è®ºå¤§å°ï¼Œå“ªæ€•å‡ åŒ…åƒåœ¾ã€ä¸€é¤é¥±é¥­è¿™æ ·çš„å°äº‹ä¹Ÿå¯ã€‚å¹¶ä¸”å¸®åŠ©ä»–äººåï¼ˆæœ‰æ¡ä»¶çš„æƒ…å†µä¸‹ï¼‰æé†’ä»–äººå°†é˜´å¾·ä¹‹ç†å¿µä¼ é€’ä¸‹å»ï¼Œä»¥æ±‚æ—©æ—¥ç¤¾ä¼šå¤§åŒã€‚</p>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td colspan="2" style="text-align: center; background-color: #fcfaf7;">
                            <strong>å› æ”¶è´¹æ–¹å¼çš„ä¸åŒï¼Œæ‰€ä»¥è½¯ä»¶åŠè¯¾ç¨‹å¹¶ä¸éœ€è¦å…ˆæ”¯ä»˜å†å­¦ä¹ ä½¿ç”¨ï¼Œå¸Œæœ›å¤§å®¶è‡ªè§‰ã€‚</strong>
                        </td>
                    </tr>
                </tbody>
            </table>
<table class="payment-table">
                <thead>
                    <tr>
                        <th><h3>è¯¾ç¨‹æ”¶è´¹</h3></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><h3>ä¸€æ¬¡æ€§å­¦ä¹ è´¹ç”¨300å…ƒ</h3></td>
                    </tr>
                    <tr>                        <td>
                            <div>å¦‚æœ‰å›°éš¾æŒ‰ç…§ä»¥ä¸‹æ–¹æ³•æ”¶è´¹ï¼š</div>
                            <div class="yin-de-explanation">
                                <h3>å…¶ä»–æ”¯ä»˜æ–¹å¼</h3>
                                <p>éœ€åœ¨ä»–äººéœ€è¦å¸®åŠ©æ—¶åš100ä»¶é˜´å¾·ä¹‹äº‹ã€‚ä½•ä¸ºé˜´å¾·ï¼Œå³å¸®åŠ©ä»–äººä¸å›¾å›æŠ¥ä¹Ÿã€‚ä¸åªæ˜¯å¯¹äººï¼Œä¼—ç”Ÿçš†å¯ã€‚äº‹ä¸è®ºå¤§å°ï¼Œå“ªæ€•å‡ åŒ…åƒåœ¾ã€ä¸€é¤é¥±é¥­è¿™æ ·çš„å°äº‹ä¹Ÿå¯ã€‚å¹¶ä¸”å¸®åŠ©ä»–äººåï¼ˆæœ‰æ¡ä»¶çš„æƒ…å†µä¸‹ï¼‰æé†’ä»–äººå°†é˜´å¾·ä¹‹ç†å¿µä¼ é€’ä¸‹å»ï¼Œä»¥æ±‚æ—©æ—¥ç¤¾ä¼šå¤§åŒã€‚</p>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td colspan="2" style="text-align: center; background-color: #fcfaf7;">
                            <strong>å› æ”¶è´¹æ–¹å¼çš„ä¸åŒï¼Œæ‰€ä»¥è½¯ä»¶åŠè¯¾ç¨‹å¹¶ä¸éœ€è¦å…ˆæ”¯ä»˜å†å­¦ä¹ ä½¿ç”¨ï¼Œå¸Œæœ›å¤§å®¶è‡ªè§‰ã€‚</strong>
                        </td>
                    </tr>
                </tbody>
            </table>


            <div class="important-note">
                <h4>é‡è¦æé†’</h4>
                <p>è¯·ä¸è¦é”™ä»˜ï¼Œæ”¯ä»˜åå¯¹æ”¯ä»˜é‡‘é¢ä¸€å¾‹ä¸é€€ã€‚</p>
            </div>
            
            <h3 style="text-align: center; margin: 30px 0 20px 0; color: #8B4513;">æ”¯ä»˜æ–¹å¼</h3>
            <div class="payment-methods">
                <div class="payment-method">
                    <h3>å¾®ä¿¡æ”¯ä»˜</h3>
                    <div class="payment-placeholder">
                        å¾®ä¿¡æ”¯ä»˜äºŒç»´ç <br/><img src="gua_images/è‘£å¾·é¾™å¾®ä¿¡æ”¯ä»˜ç .png" style="max-width:100%;max-height:260px;border-radius:4px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.15);">
                    </div>
                    <p>è¯·ä½¿ç”¨å¾®ä¿¡æ‰«æäºŒç»´ç æ”¯ä»˜</p>
                </div>
                
                <div class="payment-method">
                    <h3>æ”¯ä»˜å®æ”¯ä»˜</h3>
                    <div class="payment-placeholder">
                        æ”¯ä»˜å®æ”¯ä»˜äºŒç»´ç <br/><img src="gua_images/è‘£å¾·é¾™æ”¯ä»˜å®æ”¯ä»˜ç .png" style="max-width:100%;max-height:260px;border-radius:4px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.15);">
                    </div>
                    <p>è¯·ä½¿ç”¨æ”¯ä»˜å®æ‰«æäºŒç»´ç æ”¯ä»˜</p>
                </div>
<div class="payment-methodsss">
                <div class="payment-method">
                    <h3>é“¶è¡Œå¡æ”¯ä»˜</h3>
                    <p>å§“åï¼šè‘£å¾·é¾™</p>
                    <p>å¡å·ï¼š6231700190021083768</p>
                </div>
            </div>
        </section>
        
        <section id="correction">
            <h2>æ›´æ­£è¯´æ˜</h2>
            <p>æœ¬è¯¾ç¨‹åŠè½¯ä»¶éš¾å…ä¼šæœ‰ä¸å°½äººæ„çš„åœ°æ–¹ï¼Œå¦‚å„ä½åŒä»æœ‰æ›´å¥½çš„è§è§£ï¼Œå¯å‘é€é‚®ä»¶è‡³æœ¬äººé‚®ç®±ï¼š</p>
            
            <div class="contact-info">
                <h4>è”ç³»é‚®ç®±</h4>
                <p style="font-size: 1.2rem; font-weight: bold;">2224259906@qq.com</p>
                <p>æˆ‘ä¼šå®šæœŸæŸ¥é˜…é‚®ä»¶ï¼Œå¹¶è®¤çœŸè€ƒè™‘å„ä½åŒä»çš„å®è´µæ„è§ã€‚</p>
            </div>
            
            <p>åŒæ—¶æœ¬è½¯ä»¶ä¼šå®šæœŸæ›´æ–°ï¼Œè¯·è‡ªè¡Œåˆ°ç½‘ç«™ä¸‹è½½æœ€æ–°ç‰ˆã€‚</p>
            <p style="margin-top: 15px;">å¸Œæœ›å„ä½åŒå¿—èƒ½å¤Ÿå…±åŒå‚ä¸ï¼Œä¸æ–­å®Œå–„è¿™ä¸€ä¼ æ‰¿ä¸­åæ–‡æ˜çš„é‡è¦å·¥å…·ï¼Œè®©æ˜“ç»æ™ºæ…§æ›´å¥½å¼•é¢†ç¤¾ä¼šçš„å‘å±•ã€‚</p>
        </section>
        
        <div class="footer">
       
        </div>
    </div>
    
    <script>
        // ç®€å•çš„äº¤äº’æ•ˆæœ
        document.addEventListener('DOMContentLoaded', function() {
            // ä¸ºæ¯ä¸ªéƒ¨åˆ†ç«‹å³æ˜¾ç¤ºï¼ˆä¸éœ€è¦æ»šåŠ¨ï¼‰
            const sections = document.querySelectorAll('section');
            
            // ç«‹å³æ˜¾ç¤ºæ‰€æœ‰sectionsï¼Œä¸éœ€è¦ç­‰å¾…æ»šåŠ¨
            sections.forEach(section => {
                section.style.opacity = 1;
                section.style.transform = 'translateY(0)';
                section.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
            });
            
            // ä¸ºæ”¯ä»˜å ä½ç¬¦æ·»åŠ ç‚¹å‡»æç¤º
            const placeholders = document.querySelectorAll('.payment-placeholder');
            placeholders.forEach(placeholder => {
                placeholder.addEventListener('click', function() {
                    const method = this.closest('.payment-method').querySelector('h3').textContent;
                    alert(`è¯·å°†æ‚¨çš„${method}äºŒç»´ç å›¾ç‰‡æ”¾ç½®åœ¨æ­¤ä½ç½®`);
                });
            });
        });
    </script>
</body>
</html>
            </div>
        </section>

            </div>
        </section>
        
        <!-- è‡ªå®šä¹‰é•¿é¡µé¢1 - ç¤ºä¾‹ -->
        <section id="custom1" class="page-content">
            <div class="custom-page">
 <h2>å‘¨æ˜“å…­åå››å¦è¯¦è§£</h2>
                <div class="long-content">
                    <p>ã€Šå‘¨æ˜“ã€‹æ˜¯ä¸­å›½å¤ä»£æœ€é‡è¦çš„ç»å…¸ä¹‹ä¸€ï¼ŒåŒ…å«äº†ä¸°å¯Œçš„å“²å­¦æ€æƒ³å’Œç”Ÿæ´»æ™ºæ…§ã€‚å…­åå››å¦æ˜¯ã€Šå‘¨æ˜“ã€‹çš„æ ¸å¿ƒå†…å®¹ï¼Œæ¯ä¸€å¦éƒ½æœ‰å…¶ç‹¬ç‰¹çš„è±¡å¾æ„ä¹‰å’Œåº”ç”¨ä»·å€¼ã€‚</p>
                    
                    <h3>ä¹¾å¦ (ä·€)</h3>
                    <p>ä¹¾ä¸ºå¤©ï¼Œåˆšå¥ä¸­æ­£ã€‚è±¡å¾å¤©ã€å›ä¸»ã€çˆ¶äº²ã€åˆšå¥ã€åˆ›é€ ã€ä¸»åŠ¨ã€‚ä¹¾å¦å…­çˆ»çš†é˜³ï¼Œä»£è¡¨çº¯é˜³ä¹‹å¦ï¼Œè±¡å¾å¤©é“è¿è¡Œï¼Œè‡ªå¼ºä¸æ¯ã€‚</p>
                    
                    <h3>å¤å¦ (ä·)</h3>
                    <p>å¤ä¸ºåœ°ï¼ŒæŸ”é¡ºåˆ©è´ã€‚è±¡å¾åœ°ã€æ¯äº²ã€è‡£å­ã€æŸ”é¡ºã€æ‰¿è½½ã€åŒ…å®¹ã€‚å¤å¦å…­çˆ»çš†é˜´ï¼Œä»£è¡¨çº¯é˜´ä¹‹å¦ï¼Œè±¡å¾åœ°é“è½½ç‰©ï¼Œåšå¾·è½½ç‰©ã€‚</p>
                    
                    <h3>å±¯å¦ (ä·‚)</h3>
                    <p>æ°´é›·å±¯ï¼ŒåˆšæŸ”å§‹äº¤è€Œéš¾ç”Ÿã€‚è±¡å¾å§‹ç”Ÿã€è‰°éš¾ã€ç§¯èšã€‚å±¯å¦ä¸Šåä¸‹éœ‡ï¼Œåä¸ºæ°´ï¼Œéœ‡ä¸ºé›·ï¼Œäº‘é›·äº¤åŠ ï¼Œè±¡å¾ä¸‡ç‰©å§‹ç”Ÿä¹‹è‰°éš¾ã€‚</p>
                    
                    <h3>è’™å¦ (ä·ƒ)</h3>
                    <p>å±±æ°´è’™ï¼Œå±±ä¸‹å‡ºæ³‰ã€‚è±¡å¾å¯è’™ã€æ•™è‚²ã€ç«¥è’™ã€‚è’™å¦ä¸Šè‰®ä¸‹åï¼Œè‰®ä¸ºå±±ï¼Œåä¸ºæ°´ï¼Œå±±ä¸‹å‡ºæ³‰ï¼Œè±¡å¾å¯è’™æ•™è‚²å¦‚æ³‰æ°´èˆ¬æ»‹æ¶¦å¿ƒç”°ã€‚</p>
                    
                    <div class="grid-container">
                        <div class="grid-item">
                            <h4>éœ€å¦ (ä·„)</h4>
                            <p>æ°´å¤©éœ€ï¼Œäº‘ä¸Šäºå¤©ã€‚è±¡å¾ç­‰å¾…ã€éœ€æ±‚ã€é¥®é£Ÿã€‚éœ€å¦ä¸Šåä¸‹ä¹¾ï¼Œåä¸ºæ°´ï¼Œä¹¾ä¸ºå¤©ï¼Œäº‘åœ¨å¤©ä¸Šï¼Œç­‰å¾…æ—¶æœºã€‚</p>
                        </div>
                        <div class="grid-item">
                            <h4>è®¼å¦ (ä·…)</h4>
                            <p>å¤©æ°´è®¼ï¼Œå¤©ä¸æ°´è¿è¡Œã€‚è±¡å¾äº‰è®¼ã€æ˜¯éã€è¯‰è®¼ã€‚è®¼å¦ä¸Šä¹¾ä¸‹åï¼Œä¹¾ä¸ºå¤©ï¼Œåä¸ºæ°´ï¼Œå¤©å‘è¥¿è¡Œï¼Œæ°´å‘ä¸œæµï¼Œè±¡å¾æ„è§ç›¸å·¦ã€‚</p>
                        </div>
                        <div class="grid-item">
                            <h4>å¸ˆå¦ (ä·†)</h4>
                            <p>åœ°æ°´å¸ˆï¼Œåœ°ä¸‹æœ‰æ°´ã€‚è±¡å¾å†›é˜Ÿã€æˆ˜äº‰ã€ä¼—äººã€‚å¸ˆå¦ä¸Šå¤ä¸‹åï¼Œå¤ä¸ºåœ°ï¼Œåä¸ºæ°´ï¼Œåœ°ä¸‹æœ‰æ°´ï¼Œè±¡å¾éšè—çš„å†›é˜Ÿã€‚</p>
                        </div>
                        <div class="grid-item">
                            <h4>æ¯”å¦ (ä·‡)</h4>
                            <p>æ°´åœ°æ¯”ï¼Œåœ°ä¸Šæœ‰æ°´ã€‚è±¡å¾äº²å¯†ã€æ¯”é™„ã€äº²æ¯”ã€‚æ¯”å¦ä¸Šåä¸‹å¤ï¼Œåä¸ºæ°´ï¼Œå¤ä¸ºåœ°ï¼Œæ°´åœ¨åœ°ä¸Šï¼Œè±¡å¾äº²å¯†æ— é—´ã€‚</p>
                        </div>
                    </div>
                    
                    <h3>å…­åå››å¦åˆ†ç±»</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>å¦åº</th>
                                <th>å¦å</th>
                                <th>å¦è±¡</th>
                                <th>å±æ€§</th>
                                <th>è±¡å¾</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>ä¹¾å¦</td>
                                <td>ä·€</td>
                                <td>çº¯é˜³</td>
                                <td>å¤©ã€åˆ›é€ </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>å¤å¦</td>
                                <td>ä·</td>
                                <td>çº¯é˜´</td>
                                <td>åœ°ã€æ‰¿è½½</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>å±¯å¦</td>
                                <td>ä·‚</td>
                                <td>ä¸‹éœ‡ä¸Šå</td>
                                <td>å§‹ç”Ÿã€è‰°éš¾</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>è’™å¦</td>
                                <td>ä·ƒ</td>
                                <td>ä¸‹åä¸Šè‰®</td>
                                <td>å¯è’™ã€æ•™è‚²</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>éœ€å¦</td>
                                <td>ä·„</td>
                                <td>ä¸‹ä¹¾ä¸Šå</td>
                                <td>ç­‰å¾…ã€éœ€æ±‚</td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td>è®¼å¦</td>
                                <td>ä·…</td>
                                <td>ä¸‹åä¸Šä¹¾</td>
                                <td>äº‰è®¼ã€æ˜¯é</td>
                            </tr>
                            <tr>
                                <td>7</td>
                                <td>å¸ˆå¦</td>
                                <td>ä·†</td>
                                <td>ä¸‹åä¸Šå¤</td>
                                <td>å†›é˜Ÿã€æˆ˜äº‰</td>
                            </tr>
                            <tr>
                                <td>8</td>
                                <td>æ¯”å¦</td>
                                <td>ä·‡</td>
                                <td>ä¸‹å¤ä¸Šå</td>
                                <td>äº²å¯†ã€æ¯”é™„</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="image-container">
                        <p>å…­åå››å¦æ–¹åœ†å›¾</p>
                        <div style="width: 100%; height: 300px; background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                            æ­¤å¤„å¯æ”¾ç½®å…­åå››å¦æ–¹åœ†å›¾
                        </div>
                    </div>
                    
                    <h3>å‘¨æ˜“å“²å­¦æ€æƒ³</h3>
                    <p>ã€Šå‘¨æ˜“ã€‹ä¸ä»…æ˜¯ä¸€éƒ¨å åœä¹‹ä¹¦ï¼Œæ›´æ˜¯ä¸€éƒ¨å“²å­¦ç»å…¸ã€‚å®ƒåŒ…å«äº†ä¸°å¯Œçš„å“²å­¦æ€æƒ³ï¼Œå¦‚é˜´é˜³å¯¹ç«‹ç»Ÿä¸€ã€äº”è¡Œç”Ÿå…‹åˆ¶åŒ–ã€å¤©äººåˆä¸€ç­‰æ€æƒ³ã€‚</p>
                    
                    <p>é˜´é˜³æ€æƒ³æ˜¯ã€Šå‘¨æ˜“ã€‹çš„æ ¸å¿ƒï¼Œè®¤ä¸ºå®‡å®™ä¸‡ç‰©éƒ½æ˜¯ç”±é˜´é˜³ä¸¤ç§å¯¹ç«‹ç»Ÿä¸€çš„åŠ›é‡æ„æˆçš„ã€‚é˜´é˜³ç›¸äº’ä½œç”¨ï¼Œç›¸äº’è½¬åŒ–ï¼Œå½¢æˆäº†å®‡å®™ä¸‡ç‰©çš„å˜åŒ–è§„å¾‹ã€‚</p>
                    
                    <p>äº”è¡Œæ€æƒ³å°†å®‡å®™ä¸‡ç‰©åˆ†ä¸ºé‡‘ã€æœ¨ã€æ°´ã€ç«ã€åœŸäº”ç§åŸºæœ¬å…ƒç´ ï¼Œè®¤ä¸ºè¿™äº”ç§å…ƒç´ ä¹‹é—´å­˜åœ¨ç€ç”Ÿå…‹åˆ¶åŒ–çš„å…³ç³»ï¼Œæ„æˆäº†å®‡å®™ä¸‡ç‰©çš„å˜åŒ–è§„å¾‹ã€‚</p>
                    
                    <p>å¤©äººåˆä¸€æ€æƒ³è®¤ä¸ºäººä¸è‡ªç„¶æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„æ•´ä½“ï¼Œäººåº”è¯¥é¡ºåº”è‡ªç„¶è§„å¾‹ï¼Œä¸è‡ªç„¶å’Œè°ç›¸å¤„ï¼Œæ‰èƒ½è¾¾åˆ°èº«å¿ƒçš„å’Œè°ä¸å¥åº·ã€‚</p>
                    
                    <h3>å‘¨æ˜“åœ¨ç°ä»£çš„åº”ç”¨</h3>
                    <p>ã€Šå‘¨æ˜“ã€‹ä½œä¸ºä¸­å›½å¤ä»£æ™ºæ…§çš„ç»“æ™¶ï¼Œåœ¨ç°ä»£ç¤¾ä¼šä»ç„¶æœ‰ç€å¹¿æ³›çš„åº”ç”¨ä»·å€¼ã€‚å®ƒä¸ä»…å¯ä»¥ç”¨äºä¸ªäººä¿®èº«å…»æ€§ï¼Œè¿˜å¯ä»¥ç”¨äºä¼ä¸šç®¡ç†ã€å†³ç­–åˆ†æã€äººé™…å…³ç³»å¤„ç†ç­‰æ–¹é¢ã€‚</p>
                    
                    <p>åœ¨ä¼ä¸šç®¡ç†ä¸­ï¼Œå‘¨æ˜“çš„é˜´é˜³å¹³è¡¡æ€æƒ³å¯ä»¥å¸®åŠ©ä¼ä¸šç®¡ç†è€…æŠŠæ¡ä¼ä¸šå‘å±•çš„å¹³è¡¡ç‚¹ï¼Œé¿å…è¿‡åº¦æ‰©å¼ æˆ–ä¿å®ˆç»è¥ã€‚äº”è¡Œç”Ÿå…‹æ€æƒ³å¯ä»¥å¸®åŠ©ä¼ä¸šåˆ†æå¸‚åœºç¯å¢ƒï¼Œåˆ¶å®šåˆç†çš„å‘å±•æˆ˜ç•¥ã€‚</p>
                    
                    <p>åœ¨å†³ç­–åˆ†æä¸­ï¼Œå‘¨æ˜“çš„å˜åŒ–æ€æƒ³å¯ä»¥å¸®åŠ©å†³ç­–è€…æŠŠæ¡äº‹ç‰©çš„å‘å±•è¶‹åŠ¿ï¼Œåšå‡ºæ›´åŠ ç§‘å­¦çš„å†³ç­–ã€‚å¦è±¡è§£æå¯ä»¥å¸®åŠ©å†³ç­–è€…ä»å¤šè§’åº¦åˆ†æé—®é¢˜ï¼Œé¿å…ç‰‡é¢æ€§ã€‚</p>
                    
                    <p>åœ¨äººé™…å…³ç³»å¤„ç†ä¸­ï¼Œå‘¨æ˜“çš„å’Œè°æ€æƒ³å¯ä»¥å¸®åŠ©äººä»¬å»ºç«‹å’Œè°çš„äººé™…å…³ç³»ï¼Œé¿å…å†²çªå’ŒçŸ›ç›¾ã€‚å¦è±¡è§£æå¯ä»¥å¸®åŠ©äººä»¬ç†è§£ä»–äººçš„å¿ƒç†çŠ¶æ€ï¼Œæ›´å¥½åœ°æ²Ÿé€šå’Œäº¤æµã€‚</p>
                    
                    <!-- æ›´å¤šå†…å®¹... -->
                    <div style="height: 500px; background: linear-gradient(to bottom, #f8f9fa, #e9ecef); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin: 30px 0;">
                        <p style="font-size: 1.2rem; color: #666;">æ­¤å¤„å¯ä»¥ç»§ç»­æ·»åŠ æ›´å¤šå†…å®¹...</p>
                    </div>
                    
                    <div style="height: 500px; background: linear-gradient(to bottom, #e9ecef, #dee2e6); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin: 30px 0;">
                        <p style="font-size: 1.2rem; color: #666;">é¡µé¢å¯ä»¥æ— é™é•¿ï¼Œæ”¯æŒæ»šåŠ¨...</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- è‡ªå®šä¹‰é•¿é¡µé¢2 - ç¤ºä¾‹ -->
        <section id="custom2" class="page-content">
            <div class="custom-page">
                        <!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘¨æ˜“å­¦ä¹ è½¯ä»¶åŠè¯¾ç¨‹ - ä¼ æ‰¿ä¸­åæ–‡æ˜   èµ°å‘ä¸–ç•Œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", "å¾®è½¯é›…é»‘", sans-serif;
        }
        
        body {
            background-color: #f8f5f0;
            color: #333;
            line-height: 1.6;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23f8f5f0"/><path d="M0,50 Q25,40 50,50 T100,50" stroke="%23e8e0d0" fill="none" stroke-width="0.5"/><path d="M0,30 Q25,20 50,30 T100,30" stroke="%23e8e0d0" fill="none" stroke-width="0.5"/><path d="M0,70 Q25,60 50,70 T100,70" stroke="%23e8e0d0" fill="none" stroke-width="0.5"/></svg>');
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(to right, #8B4513, #A0522D, #8B4513);
            color: #f8f5f0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.2);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            letter-spacing: 3px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        header .subtitle {
            font-size: 1.2rem;
            font-weight: 300;
            max-width: 800px;
            margin: 0 auto;
        }
        
        section {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #8B4513;
        }
        
        section h2 {
            color: #8B4513;
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 20px dashed #e8e0d0;
            display: flex;
            align-items: center;
        }
        
        section h2:before {
            content: "ã€Š";
            margin-right: 5px;
        }
        
        section h2:after {
            content: "ã€‹";
            margin-left: 5px;
        }
        
        .author {
            text-align: right;
            font-size: 1.2rem;
            font-weight: bold;
            color: #8B4513;
            margin-top: 20px;
        }
        
        .payment-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 1rem;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        }
        
        .payment-table thead tr {
            background-color: #8B4513;
            color: #f8f5f0;
            text-align: left;
            font-weight: bold;
        }
        
        .payment-table th,
        .payment-table td {
            padding: 15px 20px;
            border-right: 1px solid #e8e0d0;
        }
        
        .payment-table tbody tr {
            border-bottom: 1px solid #e8e0d0;
        }
        
        .payment-table tbody tr:nth-of-type(even) {
            background-color: #fcfaf7;
        }
        
        .payment-table tbody tr:last-of-type {
            border-bottom: 2px solid #8B4513;
        }
        
        .payment-table tbody tr:hover {
            background-color: #f8f5f0;
        }
 .payment-methods {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 30px 0;
            width: 90vw 
        }
        
        .payment-methodsss{
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 30px 0;
            width: 100vw 
        }
        
        .payment-method {
            text-align: center;
            margin: 15px;
            padding: 20px;
            background-color: #fcfaf7;
            border-radius: 10px;
            width: 250px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }
        
        .payment-method h3 {
            color: #8B4513;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .payment-placeholder {
            width: 200px;
            height: 200px;
            background-color: #e8e0d0;
            border: 2px dashed #8B4513;
            border-radius: 8px;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #8B4513;
            font-weight: bold;
        }
        
        .yin-de-explanation {
            background-color: #fcfaf7;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #8B4513;
        }
        
        .yin-de-explanation h4 {
            color: #8B4513;
            margin-bottom: 10px;
        }
        
        .important-note {
            background-color: #fff9e6;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #ffcc00;
        }
        
        .important-note h4 {
            color: #b8860b;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .important-note h4:before {
            content: "âš ";
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .contact-info {
            background-color: #f0f7ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #4a6fa5;
        }
        
        .contact-info h4 {
            color: #4a6fa5;
            margin-bottom: 10px;
        }
        
        .footer {
            text-align: center;
            padding: 30px 0;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #e8e0d0;
            margin-top: 30px;
        }
        
        .tagline {
            text-align: center;
            font-style: italic;
            margin: 20px 0;
            font-size: 1.1rem;
            colourï¼š#8B4513
        }
        
        .highlight {
            background-color: rgba(255, 215, 0, 0.2);
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header h1 {
                font-size: 1.8rem;
            }
            
            section {
                padding: 20px;
            }
            
            .payment-table {
                font-size: 0.9rem;
            }
            
            .payment-table th,
            .payment-table td {
                padding: 10px;
            }
            
            .payment-method {
                width: 100%;
                margin: 10px 0;
            }
        }
 h3 {
            font-size: 1.3rem;
            margin-bottom: 8px;
            color:  #8B4513;
        }

h5 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color:  #8B4513;
            align-items: center;
        }

h4 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color:  #8B4513;
        }
        
        /* æ–‡ç« åˆ—è¡¨æ ·å¼ */
        .article-list {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px 0;
        }
        
        .article-item {
            margin: 20px 0;
            text-align: left;
        }
        
        .article-link {
            display: block;
            font-size: 1.4rem;
            color: #8B4513;
            text-decoration: none;
            padding: 15px 25px;
            border: 2px solid #8B4513;
            border-radius: 8px;
            transition: all 0.3s ease;
            background-color: #faf8f5;
            font-weight: 500;
            letter-spacing: 1px;
            box-shadow: 0 2px 5px rgba(139, 69, 19, 0.1);
            width: 100%;
            text-align: left;
        }
        
        .article-link:hover {
            background-color: #8B4513;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(139, 69, 19, 0.3);
        }
        
        .article-link:active {
            transform: translateY(0);
        }
        
        @media (max-width: 768px) {
            .article-link {
                font-size: 1.2rem;
                padding: 12px 20px;
            }
        }

    </style>
</head>
<body>
    
                    <div class="article-list" style="margin-bottom: 30px;">
                        <div style="max-width: 600px; margin: 0 auto;">
                            <label for="articleSelector" style="display: block; font-size: 1.2rem; color: #8B4513; margin-bottom: 15px; font-weight: bold; text-align: center;">è¯·é€‰æ‹©æ–‡ç« ï¼š</label>
                            <select id="articleSelector" style="width: 100%; padding: 15px 20px; font-size: 1.2rem; border: 2px solid #8B4513; border-radius: 8px; background-color: #faf8f5; color: #8B4513; cursor: pointer; outline: none; box-shadow: 0 2px 5px rgba(139, 69, 19, 0.1);">
                                <option value="">-- è¯·é€‰æ‹©æ–‡ç«  --</option>
                                <option value="article1">ä¸€ã€ç©ºç©ºå¦‚æ˜¯ï¼Œå–„å¾…å¤©å‘½</option>
                                <option value="article2">äºŒã€å½»åº•æ²»æ„ˆå¿ƒç†ç–¾ç—…</option>
                                <option value="article3">ä¸‰ã€æ—¶åˆ»å‡†å¤‡æˆä¸ºäº¿ä¸‡å¯Œç¿</option>
                                <option value="article4">å››ã€è®©"è¿·ä¿¡"çš„å‘¨æ˜“æ–‡åŒ–æŒ‡å¯¼ç§‘æŠ€çˆ†å‘å‰å¤œ</option>
                                <option value="article5">äº”ã€å¦‚ä½•è·å¾—å±äºè‡ªå·±çš„ä½³å¶</option>
                                <option value="article6">å…­ã€åˆ©ç”¨å¥½å…«å­—å·¥å…·ï¼ŒæŒæ¡å¥½è‡ªå·±çš„äººç”Ÿ</option>
                            </select>
                        </div>
                    </div>



<br><br><h5 id="article1" style="text-align: center;">ç©ºç©ºå¦‚æ˜¯  å–„å¾…å¤©å‘½</h5>
            <p>       å¤©ç”Ÿæˆ‘æå¿…æœ‰ç”¨ï¼Œåƒé‡‘æ•£å°½è¿˜å¤æ¥ã€‚è¿™æ˜¯ä¸€ç§äººç”Ÿå“²å­¦ï¼Œæ›´æ˜¯ä¸€ç§äººç”Ÿæ€åº¦ã€‚</p>
            <br><p>       ä¸ç®¡æœ‰å¤šå¤§çš„åŠŸç»©ï¼Œå¤šä¹ˆå¤§çš„å…¬å¸ï¼Œæˆ‘ä»¬çš„äººç”Ÿåªæœ‰ä¸€ç§ç»“å±€ï¼Œå°±æ˜¯ä¸äº†äº†ä¹‹ï¼Œç»“å±€éƒ½æ˜¯ä¸€æ ·ã€‚æ‰€ä»¥æˆ‘ä»¬çš„äººç”Ÿä¸å¿…è¿‡äºå¿§ç»“ï¼Œä»Šæœæœ‰é…’ä»Šæœé†‰ï¼Œä¹Ÿæ˜¯ä¸€ç§äººç”Ÿæ€åº¦ã€‚ä½†è¿™ä¹ˆè¯´ï¼Œæˆ‘ä»¬å²‚ä¸æ˜¯ä»€ä¹ˆéƒ½ä¸ç”¨åšï¼Ÿé‚£åˆé”™äº†ï¼Œå–„å°½è´£ä»»ï¼Œåªè¦ä½ è‡ªå·±çš„è´£ä»»å°½åˆ°ï¼Œä»Šæœæœ‰é…’ä»Šæœé†‰åˆæœ‰ä½•ä¸å¯ï¼Ÿ</p>
            <br><p>       äººç”Ÿå°±æ˜¯çˆ±æ¨æƒ…ä»‡ï¼Œè‹¦æµ·æ— æ¶¯ã€‚åˆ°åº•ä½•æ—¶æ‰èƒ½æ˜äº†æœ¬å¿ƒï¼Œå›å¤å¤§é“ï¼Œå¤§é“å°±åœ¨æˆ‘ä»¬äº†æ‚Ÿçš„å½“ä¸‹ã€‚æ‰§ç€ï¼Œçƒ¦æ¼ï¼Œçº ç»“ï¼Œä¸è¿‡æ˜¯ç°è±¡çš„æ‰§ç€ï¼Œè¯·é—®ï¼Œä½ æ‰§ç€äº†æ•°ä¸–äº†ï¼Œåœ¨å½“ä¸‹è¿˜ä¸é†’æ‚Ÿåˆ°ä»€ä¹ˆæ—¶å€™é†’æ‚Ÿï¼Ÿï¼</p>
            <br><p>       ä¸è¦æƒ³æˆè¦å»å‡ºå®¶ï¼Œäººç”Ÿçš„æ¯ä¸€ä»¶äº‹éƒ½æ˜¯ä¸€æ¬¡ä¿®è¡Œï¼åªè¦äº†æ‚Ÿè¿™ä¸ªé“ç†ï¼Œå‡ºå®¶åœ¨å®¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå¦‚æœå‡ºå®¶è¿˜æ˜¯è¿™æ ·å­çš„åˆ†åˆ«å¿ƒï¼Œå‡ºå®¶åˆæœ‰ä»€ä¹ˆæ„ä¹‰ã€‚ä¿®è¡Œå¯ä»¥å‡ºå®¶å¯åœ¨å®¶ï¼Œéƒ½ä¸€æ ·ï¼Œå› ç¼˜é™…ä¼šè€Œå·²ï¼Œé‡è¦çš„æ˜¯ä½ ç”¨ä»€ä¹ˆå¿ƒå»é¢å¯¹å› ç¼˜ç½¢äº†ã€‚</p>
            <br><p>       æ¯ä¸ªäººæ¥åˆ°è¿™ä¸ªä¸–ç•Œä¸Šéƒ½æœ‰ä»–è‡ªå·±çš„çˆ±æ¨æƒ…ä»‡ï¼Œéƒ½æœ‰ä»–è‡ªå·±çš„ä½¿å‘½ï¼Œåšå®Œäº†å°±å›å»äº†ã€‚æ²¡æœ‰ä¸€ä¸ªäººä¾‹å¤–ï¼Œéƒ½æ˜¯å¦‚æ­¤ï¼Œæˆ‘ä»¬ä¸è¿‡æ˜¯ç”¨éšç¼˜çš„å¿ƒå»å–„å°½è´£ä»»ï¼Œé¢å¯¹å› ç¼˜é™…ä¼šçš„å„ç§äº‹æƒ…ï¼Œæœ€åå°±åªå‰©ä¸‹æ±‚å¾—å¥½æ­»ï¼Œåˆ«æ— ä»–æ±‚ï¼Œä¸å–„å°½è´£ä»»å°±æ²¡åŠæ³•æ±‚å¾—å¥½æ­»ï¼Œæ‰€ä»¥å¾—å–„å°½è´£ä»»ã€‚</p>
            <br><p>       æ‰€ä»¥æ¯ä¸ªäººæœ€å¥½éƒ½å»æƒ³æƒ³è‡ªå·±çš„å¤©å‘½æ˜¯ä»€ä¹ˆï¼Œåˆ«äººå‡ ä¹æ²¡æœ‰åŠæ³•æŒ‡å¯¼ï¼Œä½ è‡ªå·±è¿™è¾ˆå­è¦ä¿®æ”¹çš„éƒ¨åˆ†å°±æ˜¯è¿™è¾ˆå­çš„å¤©å‘½ï¼Œå¦åˆ™ç™½æ¥äº†å˜›ï¼å½“å¤šå¤§é¢†å¯¼ï¼Œæ²¡ç”¨ã€‚æœ‰å¤šå°‘æˆ¿äº§ï¼Œæ²¡æœ‰ã€‚éƒ½æ˜¯ç©ºçš„ï¼Œä¸€æ ·ä¹Ÿå¸¦ä¸èµ°å˜›ã€‚</p>
            <br><p>       ä¸€æ´¾é’å±±æ™¯è‰²å¹½ï¼Œå‰äººç”°åœ°åäººæ”¶ã€‚åäººæ”¶å¾—ä¼‘æ¬¢å–œï¼Œè¿˜æœ‰æ”¶äººåœ¨åå¤´ã€‚
å–„å°½è´£ä»»ï¼Œéšç¼˜èµå¹ï¼Œä¸å¿˜å§‹ç»ˆï¼Œè¿™ä¸ªä¸å¿˜å§‹ç»ˆå°±æ˜¯ä¸è¦å¿˜è®°ä½ è‡ªå·±çš„å¤©å‘½ã€‚ä¸€åˆ‡éƒ½æ˜¯ç©ºç©ºå¦‚æ˜¯ï¼Œäººç”Ÿå°±æ˜¯ä¸ªå‡è±¡ï¼Œæºå½±è€Œå·²ï¼Œå½“ä¸å¾—çœŸã€‚è¯·å–„å¾…è‡ªå·±çš„å¤©å‘½ï¼</p>

                        <div class="author">é’å²› è‘£å¾·é¾™è€å¸ˆ</div>


            <br><br><h5 id="article2" style="text-align: center;">å½»åº•æ²»æ„ˆå¿ƒç†ç–¾ç—…</h5>
            <p>       äººä¸ºä»€ä¹ˆä¼šæœ‰æŠ‘éƒç­‰å¿ƒç†ç–¾ç—…ï¼Œå¿ƒç†ä¹‹æ´»åŠ¨ä¸æ­£ç¡®ã€‚å¿ƒç†ç–¾ç—…çš„ç—…å› å°±æ˜¯å¿…é¡»ä»¥æ­£ç¡®çš„æ€æƒ³ä½¿ä¹‹äº§ç”Ÿæ­£ç¡®ä¹‹å¿ƒç†æ´»åŠ¨ï¼Œå¿ƒç†ç–¾ç—…è‡ªç„¶å°±ä¸å¤å­˜åœ¨ï¼</p>
            <br><p>       æ‰€ä»¥é‡ç‚¹åº”å½“æ”¾åˆ°å¿ƒç†ç–¾ç—…çš„æ€æƒ³çº æ­£ä¸Šï¼Œè€Œä¸æ˜¯ä¿®å¤æ‰€è°“çš„èº«ä½“æœºèƒ½ä¸Šï¼Œæ¶ˆé™¤å¿ƒç†ç–¾ç—…æ‰€å¸¦æ¥çš„å½±å“ä¸Šã€‚</p>
            <br><p>       å¿ƒç†ç–¾ç—…åˆ†ä¸ºç”Ÿç†æ–¹é¢å’Œå¿ƒç†æ–¹é¢ï¼Œç”Ÿç†æ–¹é¢å¯ç”¨å»ç—°ã€ç¥›æ¹¿ç­‰ä¸­åŒ»æˆ–è€…å…¶ä»–æ–¹æ³•è°ƒç†èº«ä½“ï¼Œä½†ç”Ÿç†å¥½å¿ƒç†ç–¾ç—…ä¾æ—§å­˜åœ¨ã€‚</p>
            <br><p>       è¿™å°±æ˜¯æ²»æ ‡ä¸æ²»æœ¬ï¼Œéœ€æ²»ç–—æ€æƒ³æ–¹é¢çš„ç–¾ç—…ï¼Œæ€æƒ³ç–¾ç—…ä¸»è¦ç”±è´ªæ¬²å’Œå®³æ€•ä¸¤ç§ä¸åˆç†æ€æƒ³å¯¼è‡´ã€‚</p>
            <br><p>       å¦‚ä½•å½»åº•æ²»ç–—æ€æƒ³æ–¹é¢çš„ç–¾ç—…ï¼Œé‚£ä¸ªå°±æ˜¯åšä¸€ä¸ªå›å­ï¼Œä¸€ä¸¾ä¸€åŠ¨çš†ç¬¦åˆå›å­çš„å“æ ¼ï¼Œå‡¡äº‹æœ‰å›å­ä¹‹å°ºå¯¸ï¼Œå–å…¶åˆç†ä¸­åº¸ä¹‹é“ï¼ˆè®ºè¯­ç­‰ä¼ ç»Ÿæ–‡åŒ–æœ‰æ•™ï¼‰ï¼Œè‡ªç„¶èƒ½æ–©æ–­è´ªæ¬²å®³æ€•ï¼Œææƒ§ç­‰å¸¦æ¥çš„æ€æƒ³é—®é¢˜ã€‚ä¸å‘ä¸äº¢ï¼Œå›å­æœ¬è‰²ã€‚å¿ƒç†ç–¾ç—…å¿…ç„¶éšä¹‹å¥½è½¬ã€‚</p>
            <br><p>       å…·ä½“åšæ³•ï¼šå­¦ä¹ å›å­ä¸­åº¸ä¹‹é“ï¼Œæ–©æ–­ä¸åˆç†æ€æƒ³ï¼Œå­¦ä¹ å›å­çš„èƒ†è¯†å’Œå“è¡Œï¼Œé‡åˆ°äº‹æƒ…çš„æ€åº¦å’Œè§£å†³äº‹æƒ…çš„æ–¹æ³•ï¼Œè¿™ç‚¹éå¸¸é‡è¦ã€‚åªè¦åšå›å­å°±èƒ½ä¿è¯ä»»ä½•äººæ€æƒ³å¥åº·ï¼Œæ€æƒ³å¥åº·è‡ªç„¶å¿ƒç†ä¹Ÿå°±å¥åº·ï¼Œè¿™æ˜¯ç¡®å®šçš„ï¼Œå¦‚æœå¿ƒç†ä¸å¥åº·å‡ ä¹éƒ½æ˜¯æ€æƒ³å‡ºç°å·¨å¤§åå·®ï¼å¦‚æœä¸èƒ½åšåˆ°æ€æƒ³å¥åº·ï¼Œçºµä½¿è°ƒç†è‡´èº«ä½“æœºèƒ½å¥åº·ï¼Œä¹Ÿä¸èƒ½æ¢å¤å¿ƒç†å¥åº·ï¼Œæ—¶é—´é•¿ä¹…è¿˜ä¼šåŠ é‡ï¼Œè¿™ä¹Ÿæ˜¯æ¯‹åº¸ç½®ç–‘çš„ã€‚</p>
            <br><p>       å‘Šè¯‰å¤§å®¶ä¸€ä¸ªè®©å¿ƒé™ä¸‹æ¥çš„å¥½æ–¹æ³•ï¼Œæ¯å¤©å†¥æƒ³+é™åï¼Œå¯¹å¿ƒç†ç–¾ç—…æœ‰è¾…åŠ©æ•ˆæœï¼Œéœ€è¦åšæŒã€‚</p>
            <br><p>       å¿ƒç†ç–¾ç—…æ²»ç–—è¿‡ç¨‹æ˜¯æ›²æŠ˜çš„ï¼Œä½†ä¸€å®šæ˜¯èƒ½å½»åº•è½¬å¥½ï¼Œè¨€å¿µå›å­ï¼Œå¿…æœ‰å›å“ã€‚</p>

                        <div class="author">é’å²› è‘£å¾·é¾™è€å¸ˆ</div>

            <br><br><h5 id="article3" style="text-align: center;">æ—¶åˆ»å‡†å¤‡æˆä¸ºäº¿ä¸‡å¯Œç¿</h5>
            <p>       å¦‚ä½•æˆä¸ºäº¿ä¸‡å¯Œç¿ï¼Ÿæ•´ä¸ªä¸–ç•Œçš„äººå‡ ä¹éƒ½ä¸ºä¹‹ç€è¿·ï¼Œä»Šå¤©ï¼Œæˆ‘å°±æŠŠè¿™ä¸ªç­”æ¡ˆå…¬ä¹‹äºä¼—ã€‚</p>
            <br><p>       åŒæ—¶ï¼Œæˆ‘ä»¬åˆå‘ç°äº†ä¸€ä¸ªæ–°é—®é¢˜ï¼Œä¸ºä»€ä¹ˆå‡ ä¹æ‰€æœ‰äººéƒ½æƒ³æˆä¸ºäº¿ä¸‡å¯Œç¿å‘¢ï¼Ÿ</p>
            <br><p>       æ— é™çš„è´­ä¹°åŠ›ï¼Œåˆ«äººé«˜çœ‹ä¸€ç­‰ï¼Œä¹‹å‰ä¸¢å¤±çš„åŠ å€æ‰¾å›æ¥ã€‚æˆ–è®¸è¿˜æœ‰å…¶ä»–çš„ã€‚
é‚£ä¹ˆæˆ‘ä»¬å†æ¥æƒ³æƒ³ï¼Œå¦‚ä½•æˆä¸ºäº¿ä¸‡å¯Œç¿å‘¢ï¼Ÿæˆ–è®¸éœ€è¦ä»˜å‡ºå¤§é‡çš„åŠªåŠ›ï¼Œæœ‰ç€è¶…ä¹å¯»å¸¸çš„æœºé‡ï¼Œä»˜å‡º10å¹´çš„ç”Ÿå‘½ï¼Œäº¦æˆ–è€…æ›´å¤šç›´åˆ°æˆä¸ºç™½å¤´ç¿ï¼Œå¯èƒ½è¿˜éœ€è¦ä»˜å‡ºè‡ªå·±å¥åº·çš„èº«ä½“ã€‚</p>
            <br><p>       é‚£è¿™æ ·å§ï¼Œå¦‚æœä½ ç»è¿‡æ…é‡çš„è€ƒè™‘ï¼Œè‡ªå·±æ„¿æ„ä¸ºäº†1äº¿ç°é‡‘ä»˜å‡º20-40å¹´ç”Ÿå‘½ï¼Œæ¯å¤©è¿™é‡Œç—›é‚£é‡Œéš¾å—ï¼Œæ¯å¤©èº«å¿ƒä¿±ç–²çš„åº”å¯¹å„ç§é£é™©ï¼Œé‚£æˆ‘ä¹Ÿèµæˆä½ çš„é€‰æ‹©ã€‚ä½†æˆ‘çš„æœ‹å‹ï¼Œæˆ‘æ˜¯å’Œä½ å¼€äº†ä¸€ä¸ªå°å°çš„ç©ç¬‘ï¼Œåˆ«å¿˜è®°äº†ï¼Œå°±ç®—ä½ ä»˜å‡ºäº†è¿™äº›ï¼Œä¹Ÿéœ€è¦ä¸€äº›å¯é‡ä¸å¯å¾—çš„é‡å¤§æœºé‡æ‰å¯ä»¥å•Šï¼Œæ‰€ä»¥ï¼Œæœªæ¥çš„äº¿ä¸‡å¯Œç¿ï¼Œä½ ï¼Œå‡†å¤‡å¥½äº†å—ï¼ã€‚</p>

                        <div class="author">é’å²› è‘£å¾·é¾™è€å¸ˆ</div>
    
            <br><br><h5 id="article4" style="text-align: center;">è®©"è¿·ä¿¡"çš„å‘¨æ˜“æ–‡åŒ–<br>æŒ‡å¯¼ç§‘æŠ€çˆ†å‘å‰å¤œ</h5>
            <p>       ä»€ä¹ˆå«è¿·ä¿¡ï¼Œä»€ä¹ˆå«ç§‘å­¦ï¼Ÿ</p>
            <br><p>       è¿·ä¿¡ï¼Œæ˜¯å¯¹äº‹ç‰©å‘å±•å®¢è§‚äº‹å®å’Œå®¢è§‚è§„å¾‹çš„ä¸æ­£ç¡®ï¼Œç›²ç›®ç›¸ä¿¡é”™è¯¯çš„è®¤çŸ¥ã€‚
ç§‘å­¦ï¼Œæ˜¯å¯¹äº‹ç‰©çš„å®¢è§‚è§„å¾‹çš„æ€»ç»“ä¸æ­£ç¡®æŒ‡å¯¼ã€‚</p>
            <br><p>       æ¢å¥è¯è¯´ï¼Œè¿·ä¿¡ä¸ç§‘å­¦æ­£å¥½æ˜¯ä¸€å¯¹åä¹‰è¯ã€‚</p>
            <br><p>       ä¸­å›½ä¼ ç»Ÿæ–‡åŒ–ï¼Œå‘¨æ˜“ç­‰è¢«è®¸å¤šç°ä»£ç§‘æŠ€è€…è§†ä½œè¿·ä¿¡ä¹‹äº§ç‰©ï¼Œè®¤ä¸ºå…¶ä¸ºå°å»ºä¹‹ç³Ÿç²•ï¼Œæ­¤ä¸ºä¸€è§‚å¿µã€‚</p>
            <br><p>       ç§‘æŠ€ä¸ºç§‘å­¦è¿›æ­¥ä¹‹é‡å¤§è¡¨ç°ï¼Œæ­¤ä¸ºè§‚å¿µäºŒä¹Ÿã€‚</p>
            <br><p>       ä»¥ä¸Šä¸¤ä¸ªè§‚å¿µçš†ä¸ºç°ä»£äººå¸¸è§ä¹‹é”™è¯¯ã€‚</p>
            <br><p>       è¥¿æ–¹ä¹‹ç§‘æŠ€æ–‡åŒ–ï¼Œåœ¨äºä¸“é—¨çš„å­¦ç§‘ï¼Œä¸èƒ½ç»Ÿç­¹è€ƒè™‘äº‹ç‰©çš„å‘å±•è§„å¾‹ï¼Œè€Œåœ¨ç°å®å®¢è§‚ä¸–ç•Œä¸­äº‹ç‰©çš„å‘å±•è§„å¾‹æ˜¯ç»Ÿä¸€çš„ï¼Œå„ä¸ªå­¦ç§‘æ˜¯ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œæ‰€ä»¥ç°ä»£äº¤å‡ºæ¥å¾ˆå¤šä¹¦å‘†å­ï¼Œæ²¡æœ‰ç»Ÿç­¹è€ƒè™‘çš„èƒ½åŠ›ï¼Œè®¤ä¸ºè‡ªå·±è¯»åˆ°ç ”ç©¶ç”Ÿæˆ–è€…æˆä¸ºä»€ä¹ˆä¸“å®¶å°±æ˜¯çœŸæœ‰å­¦é—®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‰“è´¥è¡Œä¸šå·¨å¤´çš„ä¸ä¸€å®šæ˜¯åŒè¡Œï¼Œä¹Ÿå¯èƒ½æ˜¯è·¨ç•Œï¼Œå› ä¸ºè·¨ç•Œçš„äººçœ‹åˆ°äº†è®¸å¤šä½ çœ‹ä¸åˆ°ï¼Œå‘ç°ä¸äº†çš„è§„å¾‹ã€‚æ¢å¥è¯è¯´å°±æ˜¯è¿·ä¿¡è‡ªå·±çš„æ­£ç¡®ï¼Œç„¶åæŠŠè¿™ä¸ªè¡Œä¸šåšæˆäº†ä¹¦å‘†å­çš„è¡Œä¸šï¼Œè¢«æ‰“è´¥ä¹Ÿå°±æ˜¯æ—©æ™šçš„äº‹æƒ…ã€‚</p>
            <br><p>       ä¸“å®¶ç ”ç©¶ä¸€ä»¶äº‹æƒ…ï¼Œä¸€é—¨å­¦ç§‘ï¼Œå¿…ç„¶é™·å…¥ç‹­å°çš„æ€ç»´ï¼Œä¸èƒ½åŒå…¶ä»–å­¦ç§‘è”åˆèµ·æ¥è§£å†³é—®é¢˜ï¼Œæ•…è¶Šæ˜¯ä¸“å®¶è¶Šè®¤ä¸ºè‡ªå·±æœ‰å­¦é—®ï¼Œè¶Šæ˜¯ä¸“å®¶è¶Šè¿·ä¿¡è‡ªå·±çš„æ­£ç¡®ï¼Œæˆ‘ä»¬çš„æ•™è‚²ç•Œå°±å­˜åœ¨è¿™æ ·çš„é—®é¢˜ã€‚ä¸“å®¶è¿·ä¿¡è‡ªå·±çš„çŸ¥è¯†æ˜¯å¤§é—®é¢˜ï¼
è€Œä¼ ç»Ÿæ–‡åŒ–æ­£å¥½å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚çœŸæ­£æ‡‚å‘¨æ˜“çš„äººå°±çŸ¥é“å‘¨æ˜“è®²çš„æ˜¯äº‹ç‰©çš„å®¢è§‚è§„å¾‹ï¼Œä¸–ç•Œçš„ä¸€åˆ‡éƒ½åŒ…å«å…¶ä¸­ï¼Œä¸ä»…ä»…æ˜¯ç”¨æ¥ç®—å‘½ï¼Œè¿™æ˜¯ç³Ÿè¹‹äº†å‘¨æ˜“ã€‚å­¦ä¹ å‘¨æ˜“èƒ½å¤Ÿæ‰“å¼€å­¦ä¹ è€…çš„æ€ç»´æ–¹å¼ï¼Œèƒ½å¤Ÿé‡åˆ°ä¸€ä¸ªäº‹ç‰©æ—¶æœ‰å¤šä¸ªæ–¹å‘ï¼Œæ‰“ç ´è¥¿æ–¹çš„1å’Œ2æ€ç»´ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰3ï¼Œæœ‰4ï¼Œäº‹ç‰©çš„å˜åŒ–æœ‰ç€å¤šç§æ–¹å¼æ–¹æ³•ï¼Œå­¦ä¹ è¿‡å‘¨æ˜“çš„äººéƒ½æ˜ç™½ã€‚è€Œå¤§éƒ¨åˆ†ä¼ ç»Ÿæ–‡åŒ–æ˜¯å»ºç«‹åœ¨å‘¨æ˜“çš„åŸºç¡€ä¸Šå»ºç«‹çš„ï¼Œæ•…èƒ½å‘æ•£äººçš„æ€ç»´ï¼Œæ›´æ–°äººçš„æ€æƒ³ã€‚</p>
            <br><p>       å‘¨æ˜“å’Œä¼ ç»Ÿæ–‡åŒ–çš„å­¦ä¹ ä¸ä»…ä»…åœ¨äºå­¦ä¹ å¤äººçš„çŸ¥è¯†ï¼Œä¸»è¦åœ¨äºå­¦ä¹ å¤äººçš„æ€ç»´æ–¹å¼ï¼Œå­¦ä¹ äº‹ç‰©å‘å±•çš„å®¢è§‚è§„å¾‹ï¼Œç”¨äºæŒ‡å¯¼ç°ä»£ç§‘å­¦æŠ€æœ¯çš„å‘å±•ã€‚å¦‚æ²¡æœ‰ä¼ ç»Ÿæ–‡åŒ–ï¼Œå‘¨æ˜“æ€æƒ³å¯¹ç°ä»£ç§‘å­¦æŠ€æœ¯çš„æŒ‡å¯¼ï¼Œåœ¨å½“å‰å³å°†è¿æ¥ç§‘å­¦æŠ€æœ¯çˆ†å‘çš„å‰å¤•ï¼Œç§‘æŠ€åœ¨å‘å±•çš„åŒæ—¶ä¼šæœ‰éå¸¸ä¹‹å¤šçš„å¿½è§†é—®é¢˜ï¼ˆå› ä¸ºå…¶ä¸èƒ½æ•´ä½“çœ‹é—®é¢˜ï¼Œç°å®ä¸–ç•Œåˆæ˜¯ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼‰ï¼Œä¼šå¯¼è‡´è®¸å¤šé‡å¤§çš„å½±å“å’Œç¾éš¾ã€‚å‘¨æ˜“ç­‰ä¼ ç»Ÿæ–‡åŒ–æŒ‡å¯¼å‘å±•ç§‘å­¦æŠ€æœ¯åŠå…¶å¿…è¦ï¼Œåˆ»ä¸å®¹ç¼“ï¼</p>


                        <div class="author">é’å²› è‘£å¾·é¾™è€å¸ˆ</div>

            <br><br><h5 id="article5" style="text-align: center;">å¦‚ä½•è·å¾—å±äºè‡ªå·±çš„ä½³å¶</h5>
            <p>       äººäººéƒ½æƒ³è·å¾—ä½³å¶ï¼Œä½†ä¸ºä»€ä¹ˆä½ ä¼šäº‹ä¸æ„¿è¿ï¼</p>
            <br><p>       ä½•ä¸ºä½³å¶ï¼Œæœ¬æ¥å¤§å®¶çš„çœ‹æ³•æ˜¯ä¸åŒçš„ï¼Œä½†ç°åœ¨ä¹‹æ ‡å‡†ä¼¼ä¹å‡ºç°äº†ã€‚</p>
            <br><p>       é’±æ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼Œæ²¡æœ‰é’±ä¼šæ²¡æœ‰ä¿éšœã€‚æœ€å¥½è‚¤ç™½è²Œç¾å¤§é•¿è…¿ï¼Œé˜³å…‰å¸…æ°”è¿˜æœ‰ç‚¹ç—å¸…ï¼Œå·¥ä½œå­¦å†æ€§æ ¼å¥½ï¼Œæ„Ÿæƒ…ä¸“ä¸€ä»…åªå¯¹æˆ‘å¥½ï¼Œå®¶åº­å¯Œè£•çˆ¶æ¯æœ‰ä¿éšœâ€¦â€¦ï¼Œåœï¼Œåˆ¹è½¦ã€‚</p>
            <br><p>       æ¯ä¸€æ ·è¦æ±‚éƒ½æ˜¯åˆ·æ‰50%çš„äººï¼Œç…§è¿™æ ·è®¡ç®—ï¼Œå‡ ä¸ªè¦æ±‚å°±æ˜¯50%çš„å‡ æ¬¡æ–¹ï¼Œæœ€åå‘ç°è‡ªå·±æ˜¯å°ä¸‘ï¼Œé…ä¸ä¸Šè¿™æ ·çš„é“å¥³é“ä»”ã€‚</p>
            <br><p>       åˆ«æ€¥ï¼Œä¸æ˜¯ä½ é…ä¸ä¸Šï¼Œæ˜¯ä½ æ ¹æœ¬å°±é‡ä¸åˆ°ï¼é‡åˆ°ä¹ŸæŠŠæ¡ä¸ä½ï¼</p>
            <br><p>       åœ¨æˆ‘ä»¬çš„å©šæ‹ç”Ÿæ´»ä¸­ï¼Œä¸æ˜¯æˆ‘ä»¬çœ‹ä¸ä¸Šä»–ä»¬å°±æ˜¯ä»–ä»¬çœ‹ä¸ä¸Šæˆ‘ä»¬ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ªéš¾é¢˜ï¼</p>
            <br><p>       ä½†å©šå§»çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Œå„ä½æƒ³æƒ³ï¼Œæ˜¯äº’è¡¥ï¼Œæ˜¯é™ªä¼´ï¼Œæ˜¯å¹¸ç¦ã€‚äº’è¡¥ï¼Œé™ªä¼´ï¼Œå¹¸ç¦åˆ°åº•å’Œä¸Šé¢æœ‰ä»€ä¹ˆå…³ç³»ï¼è€å­æ¯å¤©ç´ é£Ÿç®€è¡£ä¸€æ ·å¾ˆå¹¸ç¦ï¼Œä¸ç”¨å’Œä½ ä»¬äº‰åŠŸè¯¿è¿‡ï¼Œä¸éœ€è¦é‚£ä¹ˆå¤§çš„å‹åŠ›ï¼Œè€å­å¾ˆå¹¸ç¦å˜›ï¼Œéå¾—ä»€ä¹ˆé‡‘é’±ååˆ©æ‰æ˜¯å¹¸ç¦ï¼Œæ²¡å¬è¯´è¿‡ã€‚é’±å¹¶ä¸èƒ½æ˜¯æˆ‘ä»¬å©šæ‹çš„æ ‡å‡†ï¼Œä¸ä»…ä»…æ˜¯å¦‚æ­¤ï¼Œé’±ä¼šç»™æˆ‘ä»¬çš„å©šå§»ç”Ÿæ´»å¸¦æ¥è®¸å¤šé‡å¤§é—®é¢˜ï¼Œå¤šå°‘å®¶åº­å› ä¸ºé’±åˆ†å´©ç¦»æï¼Œæ°æ°æ˜¯ä¸å¹¸ç¦çš„ï¼Œæ‰€ä»¥é’±å’Œå¹¸ç¦æ²¡æœ‰å¿…ç„¶å…³ç³»ã€‚</p>
            <br><p>       ä¸æ˜¯ä½ æ‰¾ä¸åˆ°ä½³å¶ï¼Œè€Œæ˜¯ä½ çš„è§‚å¿µå‡ºç°äº†åå·®ï¼é—¨å½“æˆ·å¯¹ä»£è¡¨äº†çŸ¥è¯†ä¸ä¿®å…»åŸºæœ¬ä¸€è‡´ï¼Œå‡å°‘äº†å¾ˆå¤šæœªæ¥ä¼šå‘ç”Ÿçš„å®¶åº­çŸ›ç›¾ï¼Œå°±æ¯”å¦‚æ¶ˆè´¹è§‚å¿µã€‚å“å¾·ä¸ä¿®å…»æ˜¯ä½ è½é­„æ—¶ä»–çš„ä¿¡å¿µä¸ä¿è¯ï¼Œå“ªæœ‰ä»€ä¹ˆæ°¸è¿œçš„çˆ±æƒ…ï¼Œæ°¸è¿œçš„éš¾å—è¿˜å·®ä¸å¤šã€‚èƒ¸æ€€å†³å®šäº†æ˜¯ä¸æ˜¯ä¸è‡ªå·±å¿—åŒé“åˆçš„äººã€‚</p>
            <br><p>       æ‰€ä»¥ï¼Œä½ è¿˜è®¤ä¸ºé’±å’Œç›¸è²Œæœ€é‡è¦å—ï¼Ÿï¼</p>
            <br><p>       å¦‚ä½•æ‰¾åˆ°è‡ªå·±çš„ä½³å¶ï¼Œæˆ‘åœ¨ä¸Šè¿°å·²ç»ç»™å‡ºäº†ç­”æ¡ˆï¼Œåªè¦ç”¨å¿ƒè‡ªç„¶èƒ½è¯»æ˜ç™½ï¼Œä¸è¦è®©è‡ªå·±çš„äººç”Ÿä¸‡åŠ«ä¸å¤ï¼</p>
                        <div class="author">é’å²› è‘£å¾·é¾™è€å¸ˆ</div>


            <br><br><h5 id="article6" style="text-align: center;">åˆ©ç”¨å¥½å…«å­—å·¥å…·<br>æŒæ¡è‡ªå·±çš„äººç”Ÿ</h5>
            <p>       å…«å­—çœŸçš„å¯å–å—ï¼Ÿä¸ºä»€ä¹ˆåŒæ ·å…«å­—çš„äººå‘½è¿ä¸ä¸€æ ·ï¼Ÿ</p>
            <br><p>       å‘½è¿çœŸçš„ä¸€å®šå—ï¼Œæˆ‘çš„ä¸€åˆ‡éƒ½æ˜¯å®‰æ’å¥½äº†å—ï¼Ÿ</p>
            <br><p>       äººç”Ÿå­˜åœ¨ç€å‘½è¿ï¼Œè¿™æ˜¯æ¯‹åº¸ç½®ç–‘çš„ã€‚æ—¢ç„¶å­˜åœ¨å‘½è¿å°±å¯ä»¥ç®—ï¼Œæ²¡æœ‰ä»€ä¹ˆæ˜¯ä¸èƒ½ç®—çš„ã€‚å°±åƒæˆ‘ä»¬æ’­ç§è®¡ç®—ä¸€ç‰‡ç²®é£Ÿï¼Œæ ½æ¤ä¸åŒçš„å“ç§çš„æ ‘è®©å…¶é•¿æˆä¸åŒå“ç§çš„æ ‘ï¼Œè¿™é‡Œé¢å°±æ˜¯åŒ…å«äº†æ•°ï¼Œæœ‰äº†æ•°ï¼Œå°±æœ‰äº†è±¡ã€‚æ‰€ä»¥ä¸–ç•Œä¸Šæ²¡æœ‰æ˜¯ä¸èƒ½è®¡ç®—çš„ï¼Œä½†å´ä¸æ˜¯ç”¨å…«å­—æ¥è®¡ç®—çš„ã€‚</p>
            <br><p>       åŒæ ·çš„å…«å­—ï¼Œç¯å¢ƒä¸åŒï¼Œå‡ºå‘ç‚¹ä¸ä¸€æ ·ï¼Œç»“å±€å°±ä¸ä¸€æ ·ã€‚åŒæ ·çš„å…«å­—ï¼Œä¸åŒçš„æ€§åˆ«ï¼Œæ€§æ ¼ï¼Œç»“æœä¸ä¸€æ ·ã€‚åŒæ ·çš„å…«å­—ï¼Œé€‰æ‹©ä¸ä¸€æ ·ï¼Œè¿‡ç¨‹éƒ½ä¸ä¸€æ ·ï¼Œç»“å±€ä¹Ÿå°±è‡ªç„¶ä¸ä¸€æ ·ã€‚å½±å“ç›¸åŒå…«å­—ç»“å±€ä¸ä¸€æ ·çš„æ–¹é¢å¾ˆå¤šï¼Œæœ‰å®¶åº­ï¼Œæ€§åˆ«ï¼Œåœ°ç†ï¼Œæ€§æ ¼ï¼Œæˆé•¿ç¯å¢ƒç­‰ç­‰ã€‚æˆ‘è¿™é‡Œä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹ï¼ŒåŒæ ·æ˜¯å‘¨æ˜“æµå¹´å¦é£æ³½ä¸­å­šï¼Œæœ‰äººå»è€ƒè¯•ï¼Œæœ‰äººå»ç»å•†ã€‚é£æ³½ä¸­å­šæœ€åˆ©è€ƒè¯•ä½†æœ€ä¸åˆ©ç»å•†ï¼Œé€‰æ‹©ä¸ä¸€æ ·ï¼Œç»“æœè‡ªç„¶ä¸ä¸€æ ·ï¼Œè¿™å¯æ˜¯ä¸€ä¸ªå…«å­—ï¼å…¶ä½™çš„æ˜¯åŒæ ·çš„é“ç†ã€‚è¿™å°±æ˜¯å…«å­—ä¸èƒ½ç›¸å¯¹æ¯”çš„åŸå› ã€‚</p>
            <br><p>       å…«å­—æœ‰æ²¡æœ‰ç”¨å¤„å‘¢ï¼Œæœ‰ï¼</p>
            <br><p>       å…«å­—æ˜¯æˆ‘ä»¬è‡ªå·±äººç”Ÿå„ä¸ªé˜¶æ®µçš„è±¡å’Œæ•°çš„æ€»ç»“ï¼Œå’Œåˆ«äººæ²¡æœ‰å…³ç³»ï¼Œä¸è¦æ‹¿å»å’Œåˆ«äººå¯¹æ¯”ï¼</p>
            <br><p>       æˆ‘ä»¬ä»Šå¹´æˆ–è€…ä¸€ç”Ÿé€‚åˆå¹²ä»€ä¹ˆå°±å¹²ä»€ä¹ˆï¼Œä¸è¦ä¸è‡ªå·±çš„å¤©å‘½ç›¸æŠ—äº‰ï¼è¿™ç‚¹éå¸¸é‡è¦ï¼Œä¸€æ„å­¤è¡Œä¹‹äººè¿èƒŒäº†è‡ªå·±äººç”Ÿçš„å®¢è§‚è§„å¾‹å¿…è´¥ï¼è¦å­¦ä¼šä½¿ç”¨è‡ªå·±çš„äººç”Ÿå¯†ç ï¼Œå…«å­—å°±æ˜¯è¿™ä¸ªå¯†ç ï¼</p>
            <br><p>       æˆ‘ä»¬çš„äººç”Ÿéƒ½æ˜¯å®‰æ’å¥½äº†å—ï¼Ÿ</p>
            <br><p>       ç­”æ¡ˆæ˜¯å¾ˆéš¾è®²ï¼Œæ˜¯ï¼Œä¹Ÿä¸æ˜¯ã€‚æˆ‘ä»¬çš„æœªæ¥å·²ç»å­˜åœ¨äº†ï¼Œè¿‡å»ç°åœ¨æœªæ¥éƒ½æ˜¯åŒæ—¶å­˜åœ¨çš„ï¼Œæˆ‘ä»¬çš„æœªæ¥ä»è¿™ä¸ªè§’åº¦è®²ç¡®å®æ˜¯å·²ç»ç¡®å®šäº†ã€‚ä½†é‚£ä¸ªç¡®å®šçš„æœªæ¥å´æ˜¯ç”±ç°åœ¨å’Œè¿‡å»çš„è‡ªå·±åšå‡ºçš„ç§ç§é€‰æ‹©æ—©å°±äº†é‚£ä¸ªç¡®å®šçš„æœªæ¥ã€‚æ‰€ä»¥æœªæ¥åˆæ˜¯ä¸ç¡®å®šçš„ï¼Œæ˜¯ç”±æˆ‘ä»¬çš„é€‰æ‹©å’Œè¡Œä¸ºå†³å®šçš„ã€‚å®‰æ’å‘½è¿çš„ä¸æ˜¯åˆ«äººï¼Œæ­£æ˜¯æˆ‘ä»¬è‡ªå·±ï¼</p>
            <br><p>       æ‰€ä»¥ä¸è¦å†æŠŠå‘½è¿äº¤ç»™ç„å­¦ï¼Œå®ƒå¯ä»¥æŒ‡å¯¼æˆ‘ä»¬ï¼Œä¸å¯ä»¥è®©å®ƒè¿·æƒ‘æˆ‘ä»¬ï¼è®©å®ƒæˆä¸ºæˆ‘ä»¬äººç”Ÿè·¯ä¸Šçš„å·¥å…·ï¼ä¸è¦è¿·ä¿¡ï¼çæƒœç°åœ¨çš„æ¯ä¸€æ¬¡æŠ‰æ‹©ï¼Œå®ƒæ­£å½±å“ç€è‡ªå·±å’Œä¸–ç•Œçš„æœªæ¥ã€‚</p>

                        <div class="author">é’å²› è‘£å¾·é¾™è€å¸ˆ</div>


       
        </div>
    </div>
    
    <script>
        // ç®€å•çš„äº¤äº’æ•ˆæœ
        document.addEventListener('DOMContentLoaded', function() {
            // ä¸ºæ¯ä¸ªéƒ¨åˆ†ç«‹å³æ˜¾ç¤ºï¼ˆä¸éœ€è¦æ»šåŠ¨ï¼‰
            const sections = document.querySelectorAll('section');
            
            // ç«‹å³æ˜¾ç¤ºæ‰€æœ‰sectionsï¼Œä¸éœ€è¦ç­‰å¾…æ»šåŠ¨
            sections.forEach(section => {
                section.style.opacity = 1;
                section.style.transform = 'translateY(0)';
                section.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
            });
            
            // ä¸ºæ”¯ä»˜å ä½ç¬¦æ·»åŠ ç‚¹å‡»æç¤º
            const placeholders = document.querySelectorAll('.payment-placeholder');
            placeholders.forEach(placeholder => {
                placeholder.addEventListener('click', function() {
                    const method = this.closest('.payment-method').querySelector('h3').textContent;
                    alert(`è¯·å°†æ‚¨çš„${method}äºŒç»´ç å›¾ç‰‡æ”¾ç½®åœ¨æ­¤ä½ç½®`);
                });
            });
            
            // æ–‡ç« é€‰æ‹©ä¸‹æ‹‰æ¡†åŠŸèƒ½
            const articleSelector = document.getElementById('articleSelector');
            if (articleSelector) {
                // è·å–æ‰€æœ‰æ–‡ç« æ ‡é¢˜
                const articleIds = ['article1', 'article2', 'article3', 'article4', 'article5', 'article6'];
                const articleContainers = {};
                
                // ä¸ºæ¯ç¯‡æ–‡ç« åˆ›å»ºåŒ…è£…å®¹å™¨
                articleIds.forEach(articleId => {
                    const titleElement = document.getElementById(articleId);
                    if (titleElement) {
                        // åˆ›å»ºå®¹å™¨
                        const container = document.createElement('div');
                        container.className = 'article-wrapper';
                        container.id = articleId + '-wrapper';
                        container.style.display = 'none';
                        
                        // æ‰¾åˆ°æ–‡ç« çš„æ‰€æœ‰å†…å®¹ï¼ˆä»å½“å‰h5åˆ°ä¸‹ä¸€ä¸ªh5ä¹‹é—´ï¼‰
                        let current = titleElement;
                        const fragment = document.createDocumentFragment();
                        
                        // æ·»åŠ æ ‡é¢˜
                        const titleClone = titleElement.cloneNode(true);
                        fragment.appendChild(titleClone);
                        
                        // æ”¶é›†å†…å®¹ç›´åˆ°ä¸‹ä¸€ä¸ªæ–‡ç« æ ‡é¢˜
                        let next = titleElement.nextSibling;
                        while (next) {
                            if (next.nodeType === 1 && next.tagName === 'H5' && next.id && next.id.startsWith('article') && next.id !== articleId) {
                                break; // é‡åˆ°ä¸‹ä¸€ä¸ªæ–‡ç« æ ‡é¢˜ï¼Œåœæ­¢
                            }
                            const nodeToMove = next;
                            next = next.nextSibling;
                            fragment.appendChild(nodeToMove);
                        }
                        
                        container.appendChild(fragment);
                        
                        // æ’å…¥å®¹å™¨
                        titleElement.parentNode.insertBefore(container, titleElement);
                        
                        // éšè—åŸå§‹å†…å®¹
                        titleElement.style.display = 'none';
                        let hideNext = titleElement.nextSibling;
                        while (hideNext && hideNext !== container) {
                            if (hideNext.nodeType === 1 && hideNext.tagName === 'H5' && hideNext.id && hideNext.id.startsWith('article') && hideNext.id !== articleId) {
                                break;
                            }
                            const toHide = hideNext;
                            hideNext = hideNext.nextSibling;
                            if (toHide !== container) {
                                toHide.style.display = 'none';
                            }
                        }
                        
                        articleContainers[articleId] = container;
                    }
                });
                
                // ä¸‹æ‹‰æ¡†é€‰æ‹©äº‹ä»¶
                articleSelector.addEventListener('change', function() {
                    const selectedId = this.value;
                    
                    // éšè—æ‰€æœ‰æ–‡ç« 
                    Object.values(articleContainers).forEach(container => {
                        if (container) container.style.display = 'none';
                    });
                    
                    // æ˜¾ç¤ºé€‰ä¸­çš„æ–‡ç« 
                    if (selectedId && articleContainers[selectedId]) {
                        articleContainers[selectedId].style.display = 'block';
                        setTimeout(() => {
                            articleContainers[selectedId].scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }, 100);
                    }
                });
            }
        });
    </script>
</body>
</html>
</div>
        </section>
        
<!-- ç´«å¾®æ–—æ•°æ’ç›˜é¡µé¢ -->
        <section id="ziwei" class="page-content">
<!-- 1. é¡¶éƒ¨æ§åˆ¶æ  -->
<div class="control-bar">
    <div class="font-bold text-red-800 text-lg mr-2"><i class="fa fa-star"></i> ç´«å¾®æ–—æ•° v15.0</div>
    
    <!-- åŸºç¡€æ’ç›˜ -->
    <div class="flex flex-col gap-1 border-r pr-2">
        <div class="flex items-center gap-1">
            <input type="text" id="name" placeholder="å§“å" style="width: 80px; padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
            <select id="gender" onchange="ZW.calc()"><option value="1">ç”·</option><option value="0">å¥³</option></select>
            <input type="datetime-local" id="birth-date" onchange="ZW.calc()" class="w-40">
        </div>
        <div id="ts-container"></div>
    </div>

    <!-- æµè¿ä½“ç³» -->
    <div class="flex flex-col gap-0.5">
        <div class="flex items-center gap-1">
            <span class="font-bold text-blue-700 text-xs">æµè¿:</span>
            <!-- å¤§é™ (åå¹´) -->
            <select id="sel-da" onchange="ZW.updateFlow('da')" class="bg-blue-50 border-blue-200 font-bold text-blue-900 w-28"></select>
            <!-- æµå¹´ -->
            <select id="sel-yr" onchange="ZW.updateFlow('yr')" class="bg-red-50 border-red-200 font-bold text-red-900 w-20"></select>
        </div>
        <!-- æœˆæ—¥æ—¶ -->
        <div class="flex items-center gap-1">
            <select id="sel-mo" onchange="ZW.updateFlow('mo')" class="w-16"></select>
            <select id="sel-dy" onchange="ZW.updateFlow('dy')" class="w-16"></select>
            <select id="sel-hr" onchange="ZW.updateFlow('hr')" class="w-16"></select>
        </div>
    </div>

    <div class="flex-1"></div>
</div>

<!-- å‘½ä¾‹ç®¡ç†æ¨¡å—ï¼ˆç´«è–‡æ–—æ•°ï¼‰ -->
<div class="container" style="margin-bottom: 10px; margin-top: 10px;">
    <div class="panel mingli-panel">
        <div class="panel-head">
            <span>å‘½ä¾‹ç®¡ç†</span>
            <div style="display: flex; gap: 10px; align-items: center;">
                <button class="btn btn-primary" onclick="showMingliDialogZiwei()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">ä¿å­˜<br>å‘½ä¾‹</button>
                <button class="btn btn-primary" onclick="showMingliList()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">é€‰æ‹©<br>å‘½ä¾‹</button>
                <button class="btn btn-primary" onclick="exportMingliData()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">å¯¼å‡º<br>æ•°æ®</button>
                <input type="file" id="mingliImportFileZiwei" accept=".json" style="display: none;" onchange="importMingliData(event)">
                <button class="btn btn-primary" onclick="document.getElementById('mingliImportFileZiwei').click()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">å¯¼å…¥<br>æ•°æ®</button>
                <button class="btn btn-primary" onclick="downloadMingliZiwei()" style="background:#f9f9f9;text-align:center; color:black; padding: 4px 6px !important; line-height: 1.2; white-space: normal; width: auto; min-width: auto;">ä¸‹è½½<br>å‘½ä¾‹</button>
            </div>
        </div>
    </div>
</div>

<!-- 2. æ’ç›˜ä¸»åŒº -->
<div class="chart-container" id="grid-box">
    <!-- 12å®«ä½ JSç”Ÿæˆ -->
    
    <!-- ä¸­å®«ä¿¡æ¯ -->
    <div class="center-zone">
        <div style="font-size: 11px; line-height: 1.4; width: 100%;">
            <div style="margin-bottom: 4px;">
                <span style="font-weight: bold;">å§“å:</span> <span id="txt-name">åŒ¿å</span>
            </div>
            <div style="margin-bottom: 4px;">
                <span id="txt-gender-wuxing"></span>
            </div>
            <div style="margin-bottom: 4px;">
                <span style="font-weight: bold;">çœŸå¤ªé˜³æ—¶:</span> <span id="txt-true-solar-time"></span>
            </div>
            <div style="margin-bottom: 4px;">
                <span style="font-weight: bold;">é’Ÿè¡¨æ—¶é—´:</span> <span id="txt-clock-time"></span>
            </div>
            <div style="margin-bottom: 4px;">
                <span style="font-weight: bold;">å†œå†:</span> <span id="txt-lunar-date"></span>
            </div>
            <div style="margin-bottom: 4px;">
                <span style="font-weight: bold;">å‘½ä¸»:</span> <span id="txt-mingzhu"></span> 
                <span style="font-weight: bold;">èº«ä¸»:</span> <span id="txt-shenzhu"></span> 
                <span style="font-weight: bold;">å­æ–—:</span> <span id="txt-zidou"></span>
            </div>
            
            <div style="margin-top: 6px; margin-bottom: 4px; border-top: 1px solid #ddd; padding-top: 4px;">
                <div style="font-weight: bold; margin-bottom: 2px; font-size: 10px;">èŠ‚æ°”å››æŸ±</div>
                <div id="bazi-jieqi" style="font-family: monospace; font-size: 11px; line-height: 1.4;"></div>
            </div>
            
            <div style="margin-bottom: 4px; border-top: 1px solid #ddd; padding-top: 4px;">
                <div style="font-weight: bold; margin-bottom: 2px; font-size: 10px;">éèŠ‚æ°”å››æŸ±</div>
                <div id="bazi-normal" style="font-family: monospace; font-size: 11px; line-height: 1.4;"></div>
            </div>
            
            <div style="margin-top: 6px; border-top: 1px solid #ddd; padding-top: 4px;">
                <div id="txt-dayun-start" style="font-size: 10px; margin-bottom: 2px;"></div>
                <div id="txt-dayun" style="font-size: 10px; line-height: 1.4;"></div>
            </div>
        </div>
    </div>
</div>

<!-- 3. æµè¿è¡¨æ ¼ï¼ˆå¤§é™ã€æµå¹´å°é™ã€æµæœˆã€æµæ—¥ã€æµæ—¶ï¼‰- æ¨ªå‘æ»šåŠ¨ï¼Œç‚¹å‡»æ›´æ–°å‘½ç›˜ -->
<div style="max-width: 1100px; margin: 20px auto; background: #fff; padding: 15px;">
    <div style="display: flex; flex-direction: column; gap: 8px;">
        <!-- å¤§é™è¡¨æ ¼ - æ¨ªå‘æ»šåŠ¨ -->
        <div class="table-scroll-container" style="overflow-x: auto; border: 1px solid #ddd; background: #f9f9f9;">
            <div id="daxian-table" style="display: flex; min-width: max-content;">
                <div style="padding: 8px 12px; border-right: 1px solid #ddd; background: #f5f7fa; font-weight: bold; min-width: 80px; flex-shrink: 0; text-align: center;">å¤§é™</div>
                <div id="daxian-content" style="display: flex;"></div>
                <div style="padding: 8px 12px; border-left: 1px solid #ddd; color: #999; min-width: 30px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; font-size: 14px; cursor: pointer; user-select: none;" onclick="this.parentElement.parentElement.scrollBy({left: 200, behavior: 'smooth'})" title="å‘å³æ»šåŠ¨">â–·</div>
            </div>
        </div>
        
        <!-- æµå¹´å°é™è¡¨æ ¼ - æ¨ªå‘æ»šåŠ¨ -->
        <div class="table-scroll-container" style="overflow-x: auto; border: 1px solid #ddd; background: #f9f9f9; position: relative;">
            <div id="liunian-table" style="display: flex; min-width: max-content; position: relative; z-index: 1;">
                <div style="padding: 8px 12px; border-right: 1px solid #ddd; background: #f5f7fa; font-weight: bold; min-width: 80px; flex-shrink: 0; text-align: center;">æµå¹´ å°é™</div>
                <div id="liunian-content" style="display: flex; position: relative; z-index: 2; pointer-events: auto;"></div>
                <div style="padding: 8px 12px; border-left: 1px solid #ddd; color: #999; min-width: 30px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; font-size: 14px; cursor: pointer; user-select: none; position: relative; z-index: 2;" onclick="this.parentElement.parentElement.scrollBy({left: 200, behavior: 'smooth'})" title="å‘å³æ»šåŠ¨">â–·</div>
            </div>
        </div>
        
        <!-- æµæœˆè¡¨æ ¼ - æ¨ªå‘æ»šåŠ¨ -->
        <div class="table-scroll-container" style="overflow-x: auto; border: 1px solid #ddd; background: #f9f9f9;">
            <div id="liuyue-table" style="display: flex; min-width: max-content;">
                <div style="padding: 8px 12px; border-right: 1px solid #ddd; background: #f5f7fa; font-weight: bold; min-width: 80px; flex-shrink: 0; text-align: center;">æµæœˆ</div>
                <div id="liuyue-content" style="display: flex;"></div>
                <div style="padding: 8px 12px; border-left: 1px solid #ddd; color: #999; min-width: 30px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; font-size: 14px; cursor: pointer; user-select: none;" onclick="this.parentElement.parentElement.scrollBy({left: 200, behavior: 'smooth'})" title="å‘å³æ»šåŠ¨">â–·</div>
            </div>
        </div>
        
        <!-- æµæ—¥è¡¨æ ¼ - æ¨ªå‘æ»šåŠ¨ -->
        <div class="table-scroll-container" style="overflow-x: auto; border: 1px solid #ddd; background: #f9f9f9;">
            <div id="liuri-table" style="display: flex; min-width: max-content;">
                <div style="padding: 8px 12px; border-right: 1px solid #ddd; background: #f5f7fa; font-weight: bold; min-width: 80px; flex-shrink: 0; text-align: center;">æµæ—¥</div>
                <div id="liuri-content" style="display: flex;"></div>
                <div style="padding: 8px 12px; border-left: 1px solid #ddd; color: #999; min-width: 30px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; font-size: 14px; cursor: pointer; user-select: none;" onclick="this.parentElement.parentElement.scrollBy({left: 200, behavior: 'smooth'})" title="å‘å³æ»šåŠ¨">â–·</div>
            </div>
        </div>
        
        <!-- æµæ—¶è¡¨æ ¼ - æ¨ªå‘æ»šåŠ¨ -->
        <div class="table-scroll-container" style="overflow-x: auto; border: 1px solid #ddd; background: #f9f9f9;">
            <div id="liushi-table" style="display: flex; min-width: max-content;">
                <div style="padding: 8px 12px; border-right: 1px solid #ddd; background: #f5f7fa; font-weight: bold; min-width: 80px; flex-shrink: 0; text-align: center;">æµæ—¶</div>
                <div id="liushi-content" style="display: flex;"></div>
                <div style="padding: 8px 12px; border-left: 1px solid #ddd; color: #999; min-width: 30px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; font-size: 14px; cursor: pointer; user-select: none;" onclick="this.parentElement.parentElement.scrollBy({left: 200, behavior: 'smooth'})" title="å‘å³æ»šåŠ¨">â–·</div>
            </div>
        </div>
    </div>
</div>

        </section>
        
<!-- è½¯ä»¶å£°æ˜é¡µé¢ -->
<!-- ç™»å½•/æ³¨å†Œé¡µé¢ -->
        <section id="login" class="page-content">
            <div class="login-wrapper">
                <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">ç”¨æˆ·ç™»å½•/æ³¨å†Œ</h2>
                
                <!-- ç™»å½•çŠ¶æ€æ˜¾ç¤º -->
                <div id="userInfoPanel" style="display: none; background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 15px; color: #2c3e50;">ç”¨æˆ·ä¿¡æ¯</h3>
                    <div id="userInfoContent"></div>
                    <button onclick="logout()" style="margin-top: 15px; padding: 10px 20px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer; width: 100%;">é€€å‡ºç™»å½•</button>
                </div>
                
                <!-- ç™»å½•/æ³¨å†Œè¡¨å• -->
                <div id="loginFormPanel">
                    <!-- ç™»å½•æ–¹å¼é€‰æ‹© -->
                    <div class="login-tabs">
                        <button class="login-tab active" onclick="switchLoginTab('login')">ç™»å½•</button>
                        <button class="login-tab" onclick="switchLoginTab('register')">æ³¨å†Œ</button>
                    </div>
                    
                    <!-- IDç™»å½• -->
                    <div class="login-section" id="loginIdSection">
                        <h3>IDç™»å½•</h3>
                        <div class="form-group">
                            <label>50ä½å”¯ä¸€ID</label>
                            <input type="text" id="loginIdInput" placeholder="è¯·è¾“å…¥æ‚¨çš„50ä½å”¯ä¸€ID" maxlength="50">
                            <button onclick="loginWithId()" class="btn-primary">IDç™»å½•</button>
                        </div>
                    </div>
                    
                    <!-- é‚®ç®±ç™»å½• -->
                    <div class="login-section" id="loginEmailSection">
                        <h3>é‚®ç®±ç™»å½•</h3>
                        <div class="form-group">
                            <label>é‚®ç®±åœ°å€</label>
                            <input type="email" id="loginEmailInput" placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€">
                        </div>
                        <div class="form-group">
                            <label>éªŒè¯ç </label>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="loginCodeInput" placeholder="è¯·è¾“å…¥éªŒè¯ç " maxlength="6" style="flex: 1;">
                                <button onclick="sendLoginCode()" id="sendLoginCodeBtn" class="btn-secondary">å‘é€éªŒè¯ç </button>
                            </div>
                            <div id="loginCodeCountdown" style="display: none; color: #666; font-size: 12px; margin-top: 5px;"></div>
                        </div>
                        <button onclick="loginWithEmail()" class="btn-primary">é‚®ç®±ç™»å½•</button>
                    </div>
                    
                    <!-- é‚®ç®±æ³¨å†Œ -->
                    <div class="login-section" id="registerEmailSection" style="display: none;">
                        <h3>é‚®ç®±æ³¨å†Œ</h3>
                        <div class="form-group">
                            <label>é‚®ç®±åœ°å€</label>
                            <input type="email" id="registerEmailInput" placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€">
                        </div>
                        <div class="form-group">
                            <label>éªŒè¯ç </label>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="registerCodeInput" placeholder="è¯·è¾“å…¥éªŒè¯ç " maxlength="6" style="flex: 1;">
                                <button onclick="sendRegisterCode()" id="sendRegisterCodeBtn" class="btn-secondary">å‘é€éªŒè¯ç </button>
                            </div>
                            <div id="registerCodeCountdown" style="display: none; color: #666; font-size: 12px; margin-top: 5px;"></div>
                        </div>
                        <div class="form-group">
                            <label>æ˜µç§°ï¼ˆå¯é€‰ï¼‰</label>
                            <input type="text" id="registerNicknameInput" placeholder="è¯·è¾“å…¥æ˜µç§°">
                        </div>
                        <button onclick="registerWithEmail()" class="btn-primary">æ³¨å†Œ</button>
                    </div>
                    
                    <!-- ç¬¬ä¸‰æ–¹ç™»å½• -->
                    <div class="login-section">
                        <h3>ç¬¬ä¸‰æ–¹ç™»å½•</h3>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button onclick="loginWithAlipay()" class="btn-third-party" style="background: #1677ff;">
                                <span>ğŸ“±</span> æ”¯ä»˜å®ç™»å½•
                            </button>
                            <button onclick="loginWithWechat()" class="btn-third-party" style="background: #07c160;">
                                <span>ğŸ’¬</span> å¾®ä¿¡ç™»å½•
                            </button>
                        </div>
                        <p style="font-size: 12px; color: #666; margin-top: 10px;">é¦–æ¬¡ä½¿ç”¨ç¬¬ä¸‰æ–¹ç™»å½•å°†è‡ªåŠ¨åˆ›å»ºè´¦å·å¹¶åˆ†é…50ä½å”¯ä¸€ID</p>
                    </div>
                    
                    <!-- æ¶ˆæ¯æç¤º -->
                    <div id="loginMessage" style="margin-top: 20px; padding: 10px; border-radius: 5px; display: none;"></div>
                </div>
            </div>
        </section>

        <!-- å……å€¼æ”¯ä»˜é¡µé¢ -->
        <section id="recharge" class="page-content">
            <div class="recharge-wrapper" style="max-width: 800px; margin: 0 auto; padding: 20px;">
                <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">å‘¨æ˜“å°åŠ©æ‰‹å……å€¼</h2>
                
                <!-- ä½™é¢æ˜¾ç¤º -->
                <div id="balancePanel" style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 15px; color: #2c3e50;">è´¦æˆ·ä½™é¢</h3>
                    <div id="balanceContent" style="font-size: 18px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>å½“å‰ä½™é¢ï¼š</span>
                            <span id="currentBalance" style="font-weight: bold; color: #667eea; font-size: 24px;">Â¥0.00</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>å¯ç”¨æ¬¡æ•°ï¼š</span>
                            <span id="availableTimes" style="font-weight: bold; color: #28a745;">0æ¬¡</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 14px; color: #666;">
                            <span>ç´¯è®¡å……å€¼ï¼š</span>
                            <span id="totalRecharged">Â¥0.00</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 14px; color: #666;">
                            <span>ç´¯è®¡ä½¿ç”¨ï¼š</span>
                            <span id="totalUsed">Â¥0.00</span>
                        </div>
                    </div>
                </div>
                
                <!-- å……å€¼è¡¨å• -->
                <div id="rechargeForm" style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 15px; color: #2c3e50;">å……å€¼</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                        ğŸ’° ä½¿ç”¨ä¸€æ¬¡1æ¯›é’±ï¼ˆ0.1å…ƒï¼‰ï¼Œåæ¬¡èµ·å……ï¼ˆæœ€å°‘å……å€¼1å…ƒï¼‰
                    </p>
                    
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; color: #333;">å……å€¼æ¬¡æ•°</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <button onclick="adjustRechargeTimes(-10)" style="padding: 8px 15px; border: 1px solid #ddd; background: white; border-radius: 5px; cursor: pointer;">-10</button>
                            <input type="number" id="rechargeTimes" value="10" min="10" step="10" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; text-align: center;">
                            <button onclick="adjustRechargeTimes(10)" style="padding: 8px 15px; border: 1px solid #ddd; background: white; border-radius: 5px; cursor: pointer;">+10</button>
                        </div>
                        <div style="margin-top: 10px; color: #666; font-size: 14px;">
                            <span>å……å€¼é‡‘é¢ï¼š<strong id="rechargeAmount" style="color: #667eea; font-size: 18px;">Â¥1.00</strong></span>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; color: #333;">æ”¯ä»˜æ–¹å¼</label>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <label style="flex: 1; min-width: 120px; padding: 12px; border: 2px solid #ddd; border-radius: 8px; cursor: pointer; text-align: center; transition: all 0.3s;">
                                <input type="radio" name="paymentMethod" value="wechat" checked style="margin-right: 5px;">
                                <span>ğŸ’¬ å¾®ä¿¡æ”¯ä»˜</span>
                            </label>
                            <label style="flex: 1; min-width: 120px; padding: 12px; border: 2px solid #ddd; border-radius: 8px; cursor: pointer; text-align: center; transition: all 0.3s;">
                                <input type="radio" name="paymentMethod" value="alipay" style="margin-right: 5px;">
                                <span>ğŸ“± æ”¯ä»˜å®</span>
                            </label>
                            <label style="flex: 1; min-width: 120px; padding: 12px; border: 2px solid #ddd; border-radius: 8px; cursor: pointer; text-align: center; transition: all 0.3s;">
                                <input type="radio" name="paymentMethod" value="bank" style="margin-right: 5px;">
                                <span>ğŸ¦ é“¶è¡Œå¡</span>
                            </label>
                        </div>
                    </div>
                    
                    <button onclick="createRechargeOrder()" class="btn-primary" style="width: 100%; padding: 12px; background: #667eea; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; margin-top: 10px;">åˆ›å»ºå……å€¼è®¢å•</button>
                    
                    <div id="rechargeMessage" style="margin-top: 15px; padding: 10px; border-radius: 5px; display: none;"></div>
                </div>
                
                <!-- å……å€¼è®°å½• -->
                <div id="rechargeRecords" style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 15px; color: #2c3e50;">å……å€¼è®°å½•</h3>
                    <div id="rechargeRecordsList" style="min-height: 100px;">
                        <p style="color: #666; text-align: center;">æš‚æ— å……å€¼è®°å½•</p>
                    </div>
                </div>
                
                <!-- ä½¿ç”¨è®°å½• -->
                <div id="usageRecords" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-bottom: 15px; color: #2c3e50;">ä½¿ç”¨è®°å½•</h3>
                    <div id="usageRecordsList" style="min-height: 100px;">
                        <p style="color: #666; text-align: center;">æš‚æ— ä½¿ç”¨è®°å½•</p>
                    </div>
                </div>
            </div>
        </section>

<div class="headert">  å¼˜æ‰¬æ˜“ç»æ™ºæ…§ Â· ä¼ æ’­ä¸­åæ–‡æ˜<br>ç‰ˆæƒæ‰€æœ‰ Â· ä¾µæƒå¿…ç©¶
</div>


    </div>

    <script>
        // ========================================
        // ç´«å¾®æ–—æ•°æ’ç›˜åŠŸèƒ½ï¼ˆæ¥è‡ªæˆåŠŸç‰ˆæœ¬.htmlï¼‰
        // ========================================
        // å…¨å±€é…ç½®ä¸å¸¸é‡
        const GANS = ['ç”²','ä¹™','ä¸™','ä¸','æˆŠ','å·±','åºš','è¾›','å£¬','ç™¸'];
        const ZHIS = ['å­','ä¸‘','å¯…','å¯','è¾°','å·³','åˆ','æœª','ç”³','é…‰','æˆŒ','äº¥'];
        const P_NAMES = ['å‘½å®«','å…„å¼Ÿ','å¤«å¦»','å­å¥³','è´¢å¸›','ç–¾å„','è¿ç§»','äº¤å‹','å®˜ç¦„','ç”°å®…','ç¦å¾·','çˆ¶æ¯'];
        // CSS Grid è›‡å½¢æ’åˆ—å¯¹åº” (0=å­, 11=äº¥)
        const GRID_POS = {
            5:'1/1', 6:'1/2', 7:'1/3', 8:'1/4', // å·³åˆæœªç”³
            4:'2/1',                   9:'2/4', // è¾°    é…‰
            3:'3/1',                   10:'3/4',// å¯    æˆŒ
            2:'4/1', 1:'4/2', 0:'4/3', 11:'4/4' // å¯…ä¸‘å­äº¥
        };

        // ç´«å¾®æ–—æ•°æ ¸å¿ƒå¼•æ“ (v15.0)
        const ZW = {
            solar: null, lunar: null, gender: 1, wuxing: 2,
            mingIdx: 0, shenIdx: 0,
            palaces: [], // å­˜12å®«æ•°æ® {gan, zhi}

            init: function() {
                // #region agent log
                fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.init',message:'ZW.initå¼€å§‹æ‰§è¡Œ',data:{hasSolar:typeof Solar !== 'undefined',hasLunar:typeof Lunar !== 'undefined'},timestamp:Date.now(),sessionId:'debug-session',runId:'zw-init',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                
                // æ£€æŸ¥æ˜¯å¦åœ¨ziweié¡µé¢
                const ziweiSection = document.getElementById('ziwei');
                if(!ziweiSection) {
                    console.warn('ZW.init: ziwei section not found');
                    // #region agent log
                    fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.init',message:'ziwei sectionæœªæ‰¾åˆ°',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'zw-init',hypothesisId:'A'})}).catch(()=>{});
                    // #endregion
                    return;
                }
                
                // æ£€æŸ¥Solaråº“æ˜¯å¦å·²åŠ è½½
                if(typeof Solar === 'undefined') {
                    console.error('ZW.init: Solaråº“æœªåŠ è½½ï¼Œæ— æ³•åˆå§‹åŒ–');
                    // #region agent log
                    fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.init',message:'Solaråº“æœªåŠ è½½ï¼Œæ— æ³•åˆå§‹åŒ–',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'zw-init',hypothesisId:'A'})}).catch(()=>{});
                    // #endregion
                    // ä¸æ˜¾ç¤ºalertï¼Œè®©ç”¨æˆ·çœ‹åˆ°é¡µé¢ï¼Œåªæ˜¯åŠŸèƒ½å—é™
                    return;
                }
                
                // é»˜è®¤å½“å‰æ—¶é—´
                let d = new Date();
                d.setMinutes(d.getMinutes() - d.getTimezoneOffset());
                const birthDate = document.getElementById('birth-date');
                if(birthDate) birthDate.value = d.toISOString().slice(0,16);
                
                this.createGrid();
                this.initFlowOptions();
                this.calc();
            },

            createGrid: function() {
                const box = document.getElementById('grid-box');
                if(!box) return;
                
                // ä¿å­˜ä¸­å®«å†…å®¹
                const centerZone = box.querySelector('.center-zone');
                let centerZoneHTML = null;
                if(centerZone) {
                    centerZoneHTML = centerZone.outerHTML;
                }
                
                box.innerHTML = '';
                
                // é‡æ–°æ·»åŠ ä¸­å®«
                if(centerZoneHTML) {
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = centerZoneHTML;
                    const restoredCenterZone = tempDiv.firstElementChild;
                    if(restoredCenterZone) {
                        box.appendChild(restoredCenterZone);
                    }
                }
                
                for(let i=0; i<12; i++) {
                    let div = document.createElement('div');
                    div.className = 'palace';
                    div.id = `p-${i}`;
                    div.style.gridArea = GRID_POS[i];
                    div.onclick = () => this.setTaiji(i);
                    div.innerHTML = `
                        <div class="dir-label ${this.getDirClass(i)}">${this.getDirText(i)}</div>
                        <div class="rel-label" id="rel-${i}"></div>
                        <div class="star-box-main" id="s-main-${i}"></div>
                        <div class="star-box-sub" id="s-sub-${i}"></div>
                        <div class="limit-bar" id="lim-${i}"></div>
                        <div class="p-dates" id="pdates-${i}"></div>
                        <div class="p-footer">
                            <span class="p-ganzhi" id="pgz-${i}"></span>
                            <span class="p-name" id="pn-${i}"></span>
                        </div>
                    `;
                    box.appendChild(div);
                }
                
                // å¦‚æœä¸­å®«ä¸å­˜åœ¨ï¼Œåˆ›å»ºå®ƒ
                if(!box.querySelector('.center-zone')) {
                    const centerDiv = document.createElement('div');
                    centerDiv.className = 'center-zone';
                    centerDiv.innerHTML = `
                        <div style="font-size: 11px; line-height: 1.4; width: 100%;">
                            <div style="margin-bottom: 4px;">
                                <span style="font-weight: bold;">å§“å:</span> <span id="txt-name">åŒ¿å</span>
                            </div>
                            <div style="margin-bottom: 4px;">
                                <span id="txt-gender-wuxing"></span>
                            </div>
                            <div style="margin-bottom: 4px;">
                                <span style="font-weight: bold;">çœŸå¤ªé˜³æ—¶:</span> <span id="txt-true-solar-time"></span>
                            </div>
                            <div style="margin-bottom: 4px;">
                                <span style="font-weight: bold;">é’Ÿè¡¨æ—¶é—´:</span> <span id="txt-clock-time"></span>
                            </div>
                            <div style="margin-bottom: 4px;">
                                <span style="font-weight: bold;">å†œå†:</span> <span id="txt-lunar-date"></span>
                            </div>
                            <div style="margin-bottom: 4px;">
                                <span style="font-weight: bold;">å‘½ä¸»:</span> <span id="txt-mingzhu"></span> 
                                <span style="font-weight: bold;">èº«ä¸»:</span> <span id="txt-shenzhu"></span> 
                                <span style="font-weight: bold;">å­æ–—:</span> <span id="txt-zidou"></span>
                            </div>
                            <div style="margin-top: 6px; margin-bottom: 4px; border-top: 1px solid #ddd; padding-top: 4px;">
                                <div style="font-weight: bold; margin-bottom: 2px; font-size: 10px;">èŠ‚æ°”å››æŸ±</div>
                                <div id="bazi-jieqi" style="font-family: monospace; font-size: 11px; line-height: 1.4;"></div>
                            </div>
                            <div style="margin-bottom: 4px; border-top: 1px solid #ddd; padding-top: 4px;">
                                <div style="font-weight: bold; margin-bottom: 2px; font-size: 10px;">éèŠ‚æ°”å››æŸ±</div>
                                <div id="bazi-normal" style="font-family: monospace; font-size: 11px; line-height: 1.4;"></div>
                            </div>
                            <div style="margin-top: 6px; border-top: 1px solid #ddd; padding-top: 4px;">
                                <div id="txt-dayun-start" style="font-size: 10px; margin-bottom: 2px;"></div>
                                <div id="txt-dayun" style="font-size: 10px; line-height: 1.4;"></div>
                            </div>
                        </div>
                    `;
                    box.appendChild(centerDiv);
                }
            },

            getDirClass: function(i) {
                if([5,6,7].includes(i)) return 'dir-s';
                if([11,0,1].includes(i)) return 'dir-n';
                if([2,3,4].includes(i)) return 'dir-e';
                return 'dir-w';
            },
            getDirText: function(i) {
                if(i===6) return 'å—'; if(i===0) return 'åŒ—';
                if(i===3) return 'ä¸œ'; if(i===9) return 'è¥¿'; return '';
            },

            calc: function() {
                // #region agent log
                fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.calc',message:'ZW.calcå‡½æ•°å¼€å§‹æ‰§è¡Œ',data:{typeofSolar:typeof Solar,typeofLunar:typeof Lunar},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'J'})}).catch(()=>{});
                // #endregion
                
                // æ£€æŸ¥Solaræ˜¯å¦å·²å®šä¹‰
                if(typeof Solar === 'undefined') {
                    console.error('Solar is not defined. Please ensure lunar-javascript library is loaded.');
                    // #region agent log
                    fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.calc',message:'Solaræœªå®šä¹‰ï¼Œæ— æ³•æ‰§è¡Œè®¡ç®—',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'K'})}).catch(()=>{});
                    // #endregion
                    alert('å†œå†åº“æœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚');
                    return;
                }
                
                const val = document.getElementById('birth-date');
                
                // #region agent log
                fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.calc',message:'æ£€æŸ¥birth-dateå…ƒç´ ',data:{hasVal:!!val,valValue:val ? val.value : null,valValueLength:val && val.value ? val.value.length : 0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'L'})}).catch(()=>{});
                // #endregion
                
                if(!val || !val.value) {
                    // #region agent log
                    fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.calc',message:'birth-dateå…ƒç´ ä¸å­˜åœ¨æˆ–å€¼ä¸ºç©ºï¼Œæå‰è¿”å›',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'M'})}).catch(()=>{});
                    // #endregion
                    return;
                }
                
                this.gender = parseInt(document.getElementById('gender').value || '1');
                
                // #region agent log
                var dateValue = val.value;
                var dateObj = null;
                try {
                    dateObj = new Date(dateValue);
                } catch(e) {
                    fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.calc',message:'æ—¥æœŸè§£æå¤±è´¥',data:{dateValue:dateValue,error:e.message},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'N'})}).catch(()=>{});
                }
                fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.calc',message:'å‡†å¤‡åˆ›å»ºSolarå¯¹è±¡',data:{dateValue:dateValue,dateObj:dateObj ? dateObj.toString() : null,isValidDate:dateObj && !isNaN(dateObj.getTime())},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'O'})}).catch(()=>{});
                // #endregion
                
                try {
                    this.solar = Solar.fromDate(new Date(val.value));
                    this.lunar = this.solar.getLunar();
                    
                    // #region agent log
                    fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.calc',message:'Solarå’ŒLunarå¯¹è±¡åˆ›å»ºæˆåŠŸ',data:{hasSolar:!!this.solar,hasLunar:!!this.lunar},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'P'})}).catch(()=>{});
                    // #endregion
                } catch(e) {
                    // #region agent log
                    fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.calc',message:'Solaræˆ–Lunarå¯¹è±¡åˆ›å»ºå¤±è´¥',data:{error:e.message,errorStack:e.stack,dateValue:dateValue},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'Q'})}).catch(()=>{});
                    // #endregion
                    throw e;
                }
                
                this.clearUI();
                
                // 1. å®šå‘½èº«å®« (å¯…é¦–èµ·æœˆ)
                // æ ‡å‡†ç®—æ³•ï¼šä»å¯…å®«ï¼ˆåœ°æ”¯2ï¼‰èµ·ï¼Œé¡ºæ—¶é’ˆæ•°åˆ°å‡ºç”Ÿæœˆï¼Œç„¶åé€†æ—¶é’ˆæ•°åˆ°å‡ºç”Ÿæ—¶è¾°
                // å‘½å®« = å¯…å®« + æœˆ - æ—¶
                // èº«å®« = å¯…å®« + æœˆ + æ—¶
                // æ³¨æ„ï¼šæœˆä»½ä»1å¼€å§‹ï¼Œä½†è®¡ç®—æ—¶åº”è¯¥ç”¨å®é™…æœˆä»½æ•°ï¼ˆåŒ…æ‹¬é—°æœˆï¼‰
                const mo = this.lunar.getMonth();
                const hr = ZHIS.indexOf(this.lunar.getTimeZhi());
                
                // æ·»åŠ è¯¦ç»†æ—¥å¿—ç”¨äºè°ƒè¯•
                if(console && console.log) {
                    console.log('=== å‘½å®«èº«å®«å®šä½ ===');
                    console.log('å†œå†æœˆä»½:', mo, 'æ—¶æ”¯:', this.lunar.getTimeZhi(), 'æ—¶æ”¯ç´¢å¼•:', hr);
                    console.log('è®¡ç®—è¿‡ç¨‹: å¯…å®«(2) + æœˆ(' + mo + ') - æ—¶(' + hr + ') = ' + (2 + mo - hr));
                }
                
                // ä¿®æ­£ï¼šæœˆä»½åº”è¯¥ç›´æ¥ç”¨moï¼Œä¸éœ€è¦å‡1ï¼ˆå› ä¸ºgetMonth()è¿”å›çš„æ˜¯1-12ï¼‰
                // ä½†æ ¹æ®æ ‡å‡†ç®—æ³•ï¼Œåº”è¯¥æ˜¯ï¼šä»å¯…å®«èµ·ï¼Œæ•°åˆ°ç¬¬moä¸ªæœˆï¼Œæ‰€ä»¥æ˜¯ 2 + (mo - 1)
                // ç„¶åé€†æ—¶é’ˆæ•°hrä¸ªæ—¶è¾°ï¼Œæ‰€ä»¥æ˜¯ 2 + (mo - 1) - hr
                // ä½†è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šå¦‚æœmo=1ï¼ˆæ­£æœˆï¼‰ï¼Œåº”è¯¥æ˜¯ 2 + 0 - hr = 2 - hrï¼Œè¿™ä¸å¯¹
                // æ ‡å‡†ç®—æ³•åº”è¯¥æ˜¯ï¼šä»å¯…å®«èµ·ï¼Œæ­£æœˆå°±åœ¨å¯…å®«ï¼Œæ‰€ä»¥æ˜¯ 2 + (mo - 1)
                // ç„¶åé€†æ—¶é’ˆæ•°hrä¸ªæ—¶è¾°
                this.mingIdx = (2 + mo - 1 - hr + 12) % 12;
                this.shenIdx = (2 + mo - 1 + hr) % 12;
                
                if(console && console.log) {
                    console.log('å‘½å®«ä½ç½®:', ZHIS[this.mingIdx], '(ç´¢å¼•:', this.mingIdx + ')');
                    console.log('èº«å®«ä½ç½®:', ZHIS[this.shenIdx], '(ç´¢å¼•:', this.shenIdx + ')');
                }

                // 2. æ’å®«å¹² (äº”è™é)
                const yGan = GANS.indexOf(this.lunar.getYearGan());
                // äº”è™éå£è¯€ï¼šç”²å·±ä¹‹å¹´ä¸™ä½œé¦–ï¼Œä¹™åºšä¹‹å¹´æˆŠä¸ºå¤´ï¼Œä¸™è¾›ä¹‹å¹´å¯»åºšèµ·ï¼Œä¸å£¬å£¬å¯…é¡ºæ°´æµï¼Œè‹¥é—®æˆŠç™¸ä½•å¤„èµ·ï¼Œç”²å¯…ä¹‹ä¸Šå¥½è¿½æ±‚
                // ç”²=0->ä¸™=2, ä¹™=1->æˆŠ=4, ä¸™=2->åºš=6, ä¸=3->å£¬=8, æˆŠ=4->ç”²=0, å·±=5->ä¸™=2, åºš=6->æˆŠ=4, è¾›=7->åºš=6, å£¬=8->å£¬=8, ç™¸=9->ç”²=0
                // ç®€åŒ–å…¬å¼ï¼š(yGan % 5) * 2 + 2 éªŒè¯ï¼šç”²(0)->2, ä¹™(1)->4, ä¸™(2)->6, ä¸(3)->8, æˆŠ(4)->0, å·±(5)->2, åºš(6)->4, è¾›(7)->6, å£¬(8)->8, ç™¸(9)->0 âœ“
                const startGan = (yGan % 5) * 2 + 2; // å¯…å®«å¤©å¹²
                
                if(console && console.log) {
                    console.log('å¹´å¹²:', GANS[yGan], 'å¯…å®«å¤©å¹²:', GANS[startGan % 10], '(äº”è™ééªŒè¯)');
                }
                
                this.palaces = [];
                for(let i=0; i<12; i++) {
                    let gan = (startGan + (i - 2) + 120) % 10;
                    this.palaces[i] = {gan: gan, zhi: i};
                    
                    const pgz = document.getElementById(`pgz-${i}`);
                    if(pgz) pgz.innerText = GANS[gan] + ZHIS[i];
                    
                    // å®«åï¼ˆä»å‘½å®«å¼€å§‹é€†æ—¶é’ˆæ’åˆ—ï¼‰
                    // æ ‡å‡†ï¼šå‘½å®«åœ¨mingIdxï¼Œç„¶åé€†æ—¶é’ˆæ’åˆ—å…¶ä»–å®«ä½
                    // å¦‚æœå‘½å®«åœ¨iä½ç½®ï¼Œé‚£ä¹ˆè¯¥å®«ä½å¯¹åº”çš„åç§°ç´¢å¼•æ˜¯ (i - mingIdx + 12) % 12
                    let pIdx = (i - this.mingIdx + 12) % 12;
                    let name = P_NAMES[pIdx];
                    if(i === this.shenIdx && i !== this.mingIdx) name += "(èº«)";
                    const pn = document.getElementById(`pn-${i}`);
                    // æ–‡å¢¨å¤©æœºæ ¼å¼ï¼šå®«å + ç©ºæ ¼ + å¹²æ”¯ï¼Œå¦‚"å‘½å®« ç™¸æœª"
                    if(pn) pn.innerText = name + ' ' + GANS[gan] + ZHIS[i];
                    
                    // è°ƒè¯•æ—¥å¿—ï¼šè¾“å‡ºæ‰€æœ‰å®«ä½çš„åˆ†é…
                    if(console && console.log && i === 0) {
                        console.log('=== 12å®«ä½åˆ†é… ===');
                    }
                    if(console && console.log) {
                        console.log('åœ°æ”¯', ZHIS[i], '(' + i + '): å¹²æ”¯=' + GANS[gan] + ZHIS[i] + ', å®«å=' + name + ', ç›¸å¯¹å‘½å®«ç´¢å¼•=' + pIdx);
                    }

                    // äº”è¡Œå±€ (å‘½å®«çº³éŸ³)
                    if(i === this.mingIdx) {
                        let nayin = LunarUtil.NAYIN[GANS[gan] + ZHIS[i]];
                        this.wuxing = {'æ°´':2,'æœ¨':3,'é‡‘':4,'åœŸ':5,'ç«':6}[nayin.substr(2,1)];
                        const txtJu = document.getElementById('txt-ju');
                        if(txtJu) txtJu.innerText = nayin;
                    }
                }
                
                // 3. å®‰æ˜Ÿ (é™ˆæŠŸ/å¤©çºª èåˆç‰ˆ)
                this.placeStars();
                
                // 4. ä¸­å®«å…«å­—
                console.log('å‡†å¤‡è°ƒç”¨renderCenter', {lunar: !!this.lunar, solar: !!this.solar, gender: this.gender, wuxing: this.wuxing});
                try {
                    this.renderCenter();
                } catch(e) {
                    console.error('renderCenterè°ƒç”¨å¤±è´¥:', e);
                }
                
                // 5. æµè¿é€»è¾‘
                this.refreshDaXian();
                this.updateFlow();
                this.updatePalaceDates(); // æ›´æ–°å®«ä½æ—¥æœŸå¹´é¾„ä¿¡æ¯
                
                // 6. åˆå§‹åŒ–æµè¿è¡¨æ ¼
                const yrEl = document.getElementById('sel-yr');
                const yr = yrEl && yrEl.value ? parseInt(yrEl.value) : new Date().getFullYear();
                if(typeof this.updateFlowTables === 'function') {
                    this.updateFlowTables(yr);
                }
            },

            clearUI: function() {
                for(let i=0; i<12; i++) {
                    const sm = document.getElementById(`s-main-${i}`);
                    if(sm) {
                        sm.innerHTML = '';
                        sm.style.display = 'none'; // éšè—s-mainå®¹å™¨ï¼Œåªä½¿ç”¨s-subå®¹å™¨
                    }
                    const ss = document.getElementById(`s-sub-${i}`);
                    if(ss) {
                        ss.innerHTML = '';
                        ss.style.display = 'flex'; // ç¡®ä¿s-subå®¹å™¨æ˜¾ç¤º
                    }
                    const lim = document.getElementById(`lim-${i}`);
                    if(lim) lim.innerHTML = '';
                    const rel = document.getElementById(`rel-${i}`);
                    if(rel) rel.innerText = '';
                    const p = document.getElementById(`p-${i}`);
                    if(p) p.classList.remove('active','sanfang','duigong');
                }
            },

            placeStars: function() {
                const L = this.lunar;
                const D = L.getDay(); const M = L.getMonth();
                const H = ZHIS.indexOf(L.getTimeZhi());
                const YG = GANS.indexOf(L.getYearGan());
                const YZ = ZHIS.indexOf(L.getYearZhi());
                
                // æ’ç›˜è¿‡ç¨‹æ—¥å¿—ï¼ˆç”¨äºä¸æ–‡å¢¨å¤©æœºå¯¹æ¯”ï¼‰
                if(console && console.log) {
                    console.log('=== ç´«å¾®æ–—æ•°æ’ç›˜è¿‡ç¨‹ ===');
                    console.log('å†œå†:', L.toString(), 'æ—¥:', D, 'æœˆ:', M, 'æ—¶æ”¯:', L.getTimeZhi());
                    console.log('å¹´å¹²:', L.getYearGan(), 'å¹´æ”¯:', L.getYearZhi());
                    console.log('äº”è¡Œå±€:', this.wuxing, 'å‘½å®«:', ZHIS[this.mingIdx], 'èº«å®«:', ZHIS[this.shenIdx]);
                }
                
                // 1. ç´«å¾®å¤©åºœç³» (ç”²çº§ä¸»æ˜Ÿ)
                let zw = this.getZiweiPos(this.wuxing, D);
                let tf = (4 - zw + 12) % 12; // å¯…ç”³å¯¹è§’ï¼ˆéªŒè¯ï¼šå¯…=2ï¼Œç”³=8ï¼Œ2+8=10ï¼Œ10%12=10ï¼Œä½†å®é™…åº”è¯¥æ˜¯(4-zw+12)%12ï¼Œå½“zwåœ¨å¯…æ—¶ï¼Œtfåœ¨ç”³ï¼‰
                
                if(console && console.log) {
                    console.log('ç´«å¾®æ˜Ÿä½ç½®:', ZHIS[zw], '(ç®—æ³•: wuxing=' + this.wuxing + ', day=' + D + ')');
                    console.log('å¤©åºœæ˜Ÿä½ç½®:', ZHIS[tf], '(å¯…ç”³å¯¹è§’éªŒè¯)');
                }
                
                const S_ZW = [ // [name, offset, class]
                    ['ç´«å¾®',0,'s-jia'], ['å¤©æœº',-1,'s-jia'], ['å¤ªé˜³',-3,'s-jia'],
                    ['æ­¦æ›²',-4,'s-jia'], ['å¤©åŒ',-5,'s-jia'], ['å»‰è´',-8,'s-jia']
                ];
                const S_TF = [
                    ['å¤©åºœ',0,'s-jia'], ['å¤ªé˜´',1,'s-jia'], ['è´ªç‹¼',2,'s-jia'],
                    ['å·¨é—¨',3,'s-jia'], ['å¤©ç›¸',4,'s-jia'], ['å¤©æ¢',5,'s-jia'],
                    ['ä¸ƒæ€',6,'s-jia'], ['ç ´å†›',10,'s-jia']
                ];
                
                S_ZW.forEach(s => this.addStar((zw+s[1]+12)%12, s[0], s[2], true));
                S_TF.forEach(s => this.addStar((tf+s[1]+12)%12, s[0], s[2], true));

                // 2. å…­å‰å…­ç… (ç”²çº§è¾…æ›œ)
                let lu = [2,3,5,6,5,6,8,9,11,0][YG]; // ç¦„å­˜
                this.addStar(lu, 'ç¦„å­˜', 's-ji');
                this.addStar((lu+1)%12, 'æ“ç¾Š', 's-sha');
                this.addStar((lu-1+12)%12, 'é™€ç½—', 's-sha');
                
                this.addStar([1,0,11,11,1,0,1,6,5,5][YG], 'å¤©é­', 's-ji');
                this.addStar([7,8,9,9,7,8,7,2,3,3][YG], 'å¤©é’º', 's-ji');
                
                this.addStar((4+M-1)%12, 'å·¦è¾…', 's-ji');
                this.addStar((10-(M-1)+12)%12, 'å³å¼¼', 's-ji');
                this.addStar((4+H)%12, 'æ–‡æ›²', 's-ji');
                this.addStar((10-H+12)%12, 'æ–‡æ˜Œ', 's-ji');
                
                this.addStar((11+H)%12, 'åœ°åŠ«', 's-sha');
                this.addStar((11-H+12)%12, 'åœ°ç©º', 's-sha');
                
                // ç«é“ƒ
                const FIRE_BELL = {
                    2:[1,3], 6:[1,3], 10:[1,3],
                    8:[2,10], 0:[2,10], 4:[2,10],
                    5:[3,10], 9:[3,10], 1:[3,10],
                    11:[9,10], 3:[9,10], 7:[9,10]
                };
                let fb = FIRE_BELL[YZ];
                this.addStar((fb[0]+H)%12, 'ç«æ˜Ÿ', 's-sha');
                this.addStar((fb[1]+H)%12, 'é“ƒæ˜Ÿ', 's-sha');

                // 3. ä¹™çº§/æ‚æ›œ (å¤©çºªè¡¥å…¨)
                let luan = (3 - YZ + 12) % 12;
                this.addStar(luan, 'çº¢é¸¾', 's-yi');
                this.addStar((luan+6)%12, 'å¤©å–œ', 's-yi');
                
                let ma = [2,11,8,5][YZ%4];
                this.addStar(ma, 'å¤©é©¬', 's-ji');
                
                this.addStar([7,4,5,2,3,9,11,9,10,6][YG], 'å¤©å®˜', 's-yi');
                this.addStar([9,8,0,11,3,2,6,5,6,5][YG], 'å¤©ç¦', 's-yi');
                
                this.addStar((9+M-1)%12, 'å¤©åˆ‘', 's-yi');
                this.addStar((1+M-1)%12, 'å¤©å§š', 's-yi');
                
                const GU_GUA = {
                    11:[2,10], 0:[2,10], 1:[2,10],
                    2:[5,1], 3:[5,1], 4:[5,1],
                    5:[8,4], 6:[8,4], 7:[8,4],
                    8:[11,7], 9:[11,7], 10:[11,7]
                };
                let gg = GU_GUA[YZ];
                this.addStar(gg[0], 'å­¤è¾°', 's-bing');
                this.addStar(gg[1], 'å¯¡å®¿', 's-bing');
                
                this.addStar((6-YZ+12)%12, 'å¤©å“­', 's-bing');
                this.addStar((6+YZ)%12, 'å¤©è™š', 's-bing');
                
                this.addStar((4+YZ)%12, 'é¾™æ± ', 's-yi');
                this.addStar((10-YZ+12)%12, 'å‡¤é˜', 's-yi');
                
                // 4. åšå£«åäºŒç¥ (éšç¦„å­˜)
                const BS = ['åšå£«','åŠ›å£«','é’é¾™','å°è€—','å°†å†›','å¥ä¹¦','é£å»‰','å–œç¥','ç—…ç¬¦','å¤§è€—','ä¼å…µ','å®˜åºœ'];
                let isYang = (YG%2===0);
                let isShun = (isYang && this.gender===1) || (!isYang && this.gender===0);
                BS.forEach((n,i) => this.addStar(isShun ? (lu+i)%12 : (lu-i+12)%12, n, 's-bing'));
                
                // 5. é•¿ç”ŸåäºŒç¥ (äº”è¡Œå±€)
                const CS_MAP = {2:8, 3:11, 4:5, 5:8, 6:2};
                const CS = ['é•¿ç”Ÿ','æ²æµ´','å† å¸¦','ä¸´å®˜','å¸æ—º','è¡°','ç—…','æ­»','å¢“','ç»','èƒ','å…»'];
                let csStart = CS_MAP[this.wuxing];
                CS.forEach((n,i) => this.addStar(isShun ? (csStart+i)%12 : (csStart-i+12)%12, n, 's-bing'));
            },

            addStar: function(idx, name, cls, isMain) {
                // æ‰€æœ‰æ˜Ÿå®¿éƒ½ç›´æ¥æ·»åŠ åˆ°s-subå®¹å™¨ï¼Œä»å·¦åˆ°å³æ’åˆ—ï¼Œè‡ªåŠ¨æ¢è¡Œ
                let container = document.getElementById(`s-sub-${idx}`);
                if(!container) return;
                
                // æ ¹æ®classç¡®å®šç­‰çº§é¡ºåºï¼ˆç”¨äºç¡®ä¿æ­£ç¡®çš„æ·»åŠ é¡ºåºï¼‰
                let order = 0;
                if(cls === 's-jia') order = 1;      // ç”²çº§ä¸»æ˜Ÿ - ç¬¬ä¸€ä¼˜å…ˆçº§
                else if(cls === 's-ji') order = 2;   // å‰æ˜Ÿï¼ˆç”²çº§è¾…æ›œï¼‰- ç¬¬äºŒä¼˜å…ˆçº§
                else if(cls === 's-sha') order = 2; // ç…æ˜Ÿï¼ˆç”²çº§è¾…æ›œï¼‰- ç¬¬äºŒä¼˜å…ˆçº§
                else if(cls === 's-yi') order = 3;   // ä¹™çº§æ‚æ›œ - ç¬¬ä¸‰ä¼˜å…ˆçº§
                else if(cls === 's-bing') order = 4; // ä¸™çº§ç¥ç… - ç¬¬å››ä¼˜å…ˆçº§
                else if(cls === 's-flow') order = 5; // æµæ›œ - ç¬¬äº”ä¼˜å…ˆçº§
                else order = 6;
                
                let s = document.createElement('span');
                s.className = `star ${cls}`;
                s.setAttribute('data-order', order); // æ·»åŠ é¡ºåºå±æ€§ï¼Œç”¨äºæ’åº
                // å°†åç§°æ‹†åˆ†æˆå•ä¸ªå­—ç¬¦å¹¶ç«–å‘æ’åˆ—
                let chars = name.split('');
                chars.forEach(char => {
                    let charSpan = document.createElement('span');
                    charSpan.className = 'star-char';
                    charSpan.innerText = char;
                    s.appendChild(charSpan);
                });
                
                // ç›´æ¥æ·»åŠ åˆ°å®¹å™¨ï¼ŒæŒ‰ç…§é¡ºåºæ’å…¥
                let children = Array.from(container.children);
                let insertIndex = children.findIndex(child => {
                    let childOrder = parseInt(child.getAttribute('data-order') || '999');
                    return childOrder > order;
                });
                
                if(insertIndex === -1) {
                    container.appendChild(s);
                } else {
                    container.insertBefore(s, children[insertIndex]);
                }
                
                // #region agent log
                fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:addStar',message:'æ·»åŠ æ˜Ÿå®¿',data:{idx:idx,name:name,cls:cls,order:order,containerChildren:container.children.length},timestamp:Date.now(),sessionId:'debug-session',runId:'star-layout',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
            },
            
            getZiweiPos: function(x, d) {
                let div = Math.floor(d/x);
                let rem = d%x;
                if(rem===0) return (2+div-1)%12;
                let c = x - rem;
                return (c%2!==0) ? ((2+div-c+12)%12) : ((2+div+c)%12);
            },

            initFlowOptions: function() {
                let yr = document.getElementById('sel-yr');
                if(!yr) return;
                let cur = new Date().getFullYear();
                // å¼ºåˆ¶æ¸…ç©ºæ‰€æœ‰é€‰é¡¹
                yr.innerHTML = '';
                // å¹´ä»½èŒƒå›´ï¼šä»å½“å‰å¹´ä»½-80å¹´åˆ°2200å¹´
                const startYear = cur - 80;
                const endYear = 2200;
                // #region agent log
                console.log('initFlowOptions: åˆå§‹åŒ–å¹´ä»½èŒƒå›´', {startYear, endYear, cur, optionsBefore: yr.options.length});
                // #endregion
                // ç¡®ä¿å¾ªç¯åˆ°2200å¹´
                for(let i=startYear; i<=endYear; i++) {
                    const option = new Option(i+'å¹´', i);
                    yr.add(option);
                }
                // #region agent log
                const lastOption = yr.options[yr.options.length-1];
                console.log('initFlowOptions: å¹´ä»½é€‰é¡¹æ•°é‡', yr.options.length, 'æœ€åä¸€å¹´:', lastOption?.value, 'æœ€åä¸€å¹´æ–‡æœ¬:', lastOption?.text);
                // éªŒè¯æ˜¯å¦çœŸçš„åˆ°2200å¹´
                if(parseInt(lastOption?.value) !== 2200) {
                    console.error('initFlowOptions: é”™è¯¯ï¼æœ€åä¸€å¹´ä¸æ˜¯2200å¹´ï¼Œè€Œæ˜¯', lastOption?.value);
                }
                // #endregion
                yr.value = cur;
                
                let fill = (id, n, s) => {
                    let sel = document.getElementById(id);
                    if(!sel) return;
                    sel.innerHTML = '';
                    for(let i=1; i<=n; i++) sel.add(new Option(i+s, i));
                };
                fill('sel-mo', 12, 'æœˆ');
                fill('sel-dy', 30, 'æ—¥');
                let selHr = document.getElementById('sel-hr');
                if(selHr) {
                    selHr.innerHTML = '';
                    ZHIS.forEach((z,i) => selHr.add(new Option(z+'æ—¶', i)));
                }
            },
            
            refreshDaXian: function() {
                let sel = document.getElementById('sel-da');
                if(!sel) return;
                sel.innerHTML = '<option value="">å¤§é™(è‡ªåŠ¨)</option>';
                let isYang = (GANS.indexOf(this.lunar.getYearGan())%2===0);
                let isShun = (isYang && this.gender===1) || (!isYang && this.gender===0);
                
                // è®¡ç®—éœ€è¦æ˜¾ç¤ºçš„å¤§é™æ•°é‡ï¼šä»wuxingåˆ°100å²ï¼Œæ¯10å¹´ä¸€ä¸ªå¤§é™
                const maxAge = 100; // æœ€å¤§å¹´é¾„
                const maxDaxianCount = Math.ceil((maxAge - this.wuxing + 1) / 10); // éœ€è¦çš„å¤§é™æ•°é‡
                for(let i=0; i<maxDaxianCount; i++) {
                    let s = this.wuxing + i*10;
                    // å¦‚æœèµ·å§‹å¹´é¾„è¶…è¿‡100å²ï¼Œåœæ­¢
                    if(s > maxAge) break;
                    let idx = isShun ? (this.mingIdx + i)%12 : (this.mingIdx - i + 12)%12;
                    let gz = GANS[this.palaces[idx].gan] + ZHIS[idx];
                    sel.add(new Option(`${s}-${s+9} ${gz}`, i));
                }
            },
            
            updatePalaceDates: function() {
                if(!this.solar || !this.lunar || !this.palaces || this.palaces.length === 0) return;
                
                let isYang = (GANS.indexOf(this.lunar.getYearGan())%2===0);
                let isShun = (isYang && this.gender===1) || (!isYang && this.gender===0);
                const birthYear = this.solar.getYear();
                
                // è·å–å†œå†æœˆä»½å’Œæ—¶è¾°ä¿¡æ¯
                const lunarMonth = this.lunar.getMonth();
                const lunarDay = this.lunar.getDay();
                const timeZhi = this.lunar.getTimeZhi();
                
                // #region agent log
                var lunarMethods = [];
                for(var key in this.lunar) {
                    if(typeof this.lunar[key] === 'function') {
                        lunarMethods.push(key);
                    }
                }
                fetch('http://127.0.0.1:7248/ingest/5193229f-9608-4e0f-8842-9594b64d643d',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updatePalaceDates',message:'æ£€æŸ¥lunarå¯¹è±¡æ–¹æ³•',data:{lunarMonth:lunarMonth,lunarDay:lunarDay,hasIsLeapMonth:typeof this.lunar.isLeapMonth === 'function',hasIsLeap:typeof this.lunar.isLeap === 'function',hasGetLeapMonth:typeof this.lunar.getLeapMonth === 'function',methods:lunarMethods.slice(0,20)},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'R'})}).catch(()=>{});
                // #endregion
                
                const monthNames = ['æ­£', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'ä¸ƒ', 'å…«', 'ä¹', 'å', 'å†¬', 'è…Š'];
                const dayNames = ['åˆä¸€', 'åˆäºŒ', 'åˆä¸‰', 'åˆå››', 'åˆäº”', 'åˆå…­', 'åˆä¸ƒ', 'åˆå…«', 'åˆä¹', 'åˆå',
                    'åä¸€', 'åäºŒ', 'åä¸‰', 'åå››', 'åäº”', 'åå…­', 'åä¸ƒ', 'åå…«', 'åä¹', 'äºŒå',
                    'å»¿ä¸€', 'å»¿äºŒ', 'å»¿ä¸‰', 'å»¿å››', 'å»¿äº”', 'å»¿å…­', 'å»¿ä¸ƒ', 'å»¿å…«', 'å»¿ä¹', 'ä¸‰å'];
                
                // è®¡ç®—æœˆä»½æ–‡æœ¬ï¼ˆå¤„ç†é—°æœˆï¼‰
                // lunar-javascriptåº“ä¸­ï¼Œå¦‚æœæœˆä»½>12è¡¨ç¤ºé—°æœˆ
                let monthText = '';
                var isLeapMonth = false;
                var displayMonth = lunarMonth;
                
                // å°è¯•å¤šç§æ–¹æ³•åˆ¤æ–­é—°æœˆ
                if(typeof this.lunar.isLeap === 'function') {
                    isLeapMonth = this.lunar.isLeap();
                } else if(typeof this.lunar.isLeapMonth === 'function') {
                    isLeapMonth = this.lunar.isLeapMonth();
                } else if(lunarMonth > 12) {
                    // å¦‚æœæœˆä»½å¤§äº12ï¼Œè¡¨ç¤ºæ˜¯é—°æœˆï¼ˆlunar-javascriptåº“çš„å¸¸è§åšæ³•ï¼‰
                    isLeapMonth = true;
                    displayMonth = lunarMonth - 12;
                } else if(typeof this.lunar.getLeapMonth === 'function') {
                    // æ£€æŸ¥å½“å‰å¹´ä»½æ˜¯å¦æœ‰é—°æœˆï¼Œä»¥åŠå½“å‰æœˆä»½æ˜¯å¦æ˜¯é—°æœˆ
                    var leapMonth = this.lunar.getLeapMonth();
                    isLeapMonth = (leapMonth > 0 && lunarMonth === leapMonth);
                }
                
                if(isLeapMonth) {
                    monthText = 'é—°' + monthNames[displayMonth - 1] + 'æœˆ';
                } else {
                    monthText = monthNames[displayMonth - 1] + 'æœˆ';
                }
                
                // è®¡ç®—æ—¥æœŸæ–‡æœ¬
                const dayText = dayNames[lunarDay - 1] || (lunarDay + 'æ—¥');
                const dateTimeText = monthText + dayText + timeZhi + 'æ—¶';
                
                // ä¸ºæ¯ä¸ªå®«ä½è®¡ç®—å¹¶æ˜¾ç¤ºæ—¥æœŸå¹´é¾„ä¿¡æ¯
                for(let i=0; i<12; i++) {
                    const pdatesEl = document.getElementById(`pdates-${i}`);
                    if(!pdatesEl) continue;
                    
                    // æ‰¾åˆ°è¯¥å®«ä½å¯¹åº”çš„å¤§é™ç´¢å¼•ï¼ˆè®¡ç®—åˆ°100å²ï¼‰
                    let daxianIndex = -1;
                    const maxAge = 100;
                    const maxDaxianCount = Math.ceil((maxAge - this.wuxing + 1) / 10);
                    for(let j=0; j<maxDaxianCount; j++) {
                        let idx = isShun ? (this.mingIdx + j)%12 : (this.mingIdx - j + 12)%12;
                        if(idx === i) {
                            daxianIndex = j;
                            break;
                        }
                    }
                    
                    let html = '';
                    if(daxianIndex >= 0) {
                        // è®¡ç®—å¤§é™å¯¹åº”çš„å¹´ä»½å’Œå¹´é¾„
                        let startAge = this.wuxing + daxianIndex * 10;
                        let endAge = startAge + 9;
                        let startYear = birthYear + startAge - 1;
                        let endYear = birthYear + endAge - 1;
                        
                        // å¹´ä»½ä¿¡æ¯ï¼šæ ¹æ®å›¾ç‰‡æè¿°ï¼Œæ˜¾ç¤ºè¿ç»­çš„å¤§é™å¹´ä»½ï¼ˆæ¯12å¹´æ˜¾ç¤ºä¸€æ¬¡å¯¹åº”å¹´ä»½ï¼‰
                        // å¦‚"2013å¹´2025å¹´2037å¹´"ï¼ˆè¿™äº›å¹´ä»½åœ¨è¯¥å®«ä½å¯¹åº”çš„åœ°æ”¯å¹´ä»½ï¼‰
                        let years = [];
                        let ages = [];
                        // éå†æ•´ä¸ªå¤§é™æœŸé—´çš„å¹´ä»½ï¼Œæ¯12å¹´æ˜¾ç¤ºä¸€æ¬¡ï¼ˆå¯¹åº”åœ°æ”¯å¾ªç¯ï¼‰
                        for(let age = startAge; age <= endAge; age++) {
                            let year = birthYear + age - 1;
                            // è®¡ç®—è¯¥å¹´ä»½çš„åœ°æ”¯ï¼Œå¦‚æœä¸å½“å‰å®«ä½åœ°æ”¯ç›¸åŒåˆ™æ˜¾ç¤º
                            let lYr = Lunar.fromYmd(year, 1, 1);
                            let yZhi = ZHIS.indexOf(lYr.getYearZhi());
                            if(yZhi === i) {
                                years.push(year + 'å¹´');
                                ages.push(age + 'å²');
                            }
                        }
                        
                        if(years.length > 0) {
                            html += '<div>' + years.join('') + ages.join('') + '</div>';
                        }
                    }
                    
                    // æ—¥æœŸæ—¶é—´ä¿¡æ¯ï¼ˆåªåœ¨å¯¹åº”å®«ä½æ˜¾ç¤ºï¼Œæ ¹æ®å›¾ç‰‡åœ¨å‘½å®«æ˜¾ç¤ºï¼‰
                    if(i === this.mingIdx) {
                        html += '<div>' + dateTimeText + '</div>';
                    }
                    
                    // æ˜¾ç¤ºå¹²æ”¯ä¿¡æ¯
                    let gan = this.palaces[i].gan;
                    let zhi = ZHIS[i];
                    html += '<div>' + GANS[gan] + ZHIS[i] + '</div>';
                    
                    pdatesEl.innerHTML = html;
                }
            },

            updateFlow: function(type, explicitYr) {
                // #region agent log
                fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.updateFlow',message:'updateFlowå¼€å§‹æ‰§è¡Œ',data:{type:type,hasLunar:!!this.lunar,hasSolar:!!this.solar},timestamp:Date.now(),sessionId:'debug-session',runId:'flow-update',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                
                // æ¸…é™¤æ—§æ ‡è®°ï¼ˆä»…åœ¨ziwei sectionå†…ï¼‰
                const ziweiSection = document.getElementById('ziwei');
                if(!ziweiSection) {
                    // #region agent log
                    fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.updateFlow',message:'ziweiSectionä¸å­˜åœ¨',data:{type:type},timestamp:Date.now(),sessionId:'debug-session',runId:'flow-update',hypothesisId:'A'})}).catch(()=>{});
                    // #endregion
                    return;
                }
                
                // æ ¹æ®ç±»å‹æ¸…é™¤å¯¹åº”çš„æ ‡è®°ï¼ˆå…³é”®ï¼šç¡®ä¿æ—§çš„æ ‡è®°è¢«å®Œå…¨æ¸…é™¤ï¼‰
                if(type === 'da') {
                    // ç‚¹å‡»å¤§é™ï¼šæ¸…é™¤æ‰€æœ‰æµå¹´/æµæœˆ/æµæ—¥/æµæ—¶æ ‡è®°ï¼Œä½†ä¿ç•™æœ¬å‘½å››åŒ–å’Œå¤§é™æ ‡è®°
                    ziweiSection.querySelectorAll('.limit-tag').forEach(e=>{
                        let text = e.innerText.trim();
                        // æ¸…é™¤æ‰€æœ‰æµå¹´æ ‡è®°ï¼ˆæ•°å­—+å¹´ï¼‰
                        if(/^\d+å¹´$/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰æµæœˆæ ‡è®°ï¼ˆæ•°å­—+æœˆï¼Œå¦‚"1æœˆ"ã€"8æœˆ"ç­‰ï¼‰
                        if(/^\d+æœˆ$/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰æµæ—¥æ ‡è®°ï¼ˆæ•°å­—+æ—¥ æˆ– å†œå†æ—¥æœŸæ ¼å¼ï¼šåˆä¸€ã€åˆäºŒç­‰ï¼‰
                        if(/^\d+æ—¥$/.test(text) || /^(åˆ|å|å»¿|å…)/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰æµæ—¶æ ‡è®°ï¼ˆåœ°æ”¯+æ—¶ï¼‰
                        if(/^(å­|ä¸‘|å¯…|å¯|è¾°|å·³|åˆ|æœª|ç”³|é…‰|æˆŒ|äº¥)æ—¶$/.test(text)) e.remove();
                    });
                    // æ¸…é™¤æµå¹´å››åŒ–å’Œæµæ›œ
                    ziweiSection.querySelectorAll('.hua').forEach(e=>{
                        let tag = e.querySelector('.h-tag');
                        if(tag && tag.innerText.trim() === 'æµ') e.remove();
                    });
                    ziweiSection.querySelectorAll('.s-flow').forEach(e=>e.remove());
                } else if(type === 'yr') {
                    // ç‚¹å‡»æµå¹´ï¼šæ¸…é™¤æ‰€æœ‰æ—§çš„æµå¹´å’Œå°é™æ ‡è®°ï¼Œç„¶åæ¸…é™¤æµæœˆ/æµæ—¥/æµæ—¶æ ‡è®°
                    ziweiSection.querySelectorAll('.limit-tag').forEach(e=>{
                        let text = e.innerText.trim();
                        // æ¸…é™¤æ‰€æœ‰æ—§çš„æµå¹´æ ‡è®°ï¼ˆæ•°å­—+å¹´ï¼‰
                        if(/^\d+å¹´$/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰å°é™æ ‡è®°ï¼ˆæ•°å­—+å²ï¼‰
                        if(/^\d+å²$/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰æµæœˆæ ‡è®°ï¼ˆæ•°å­—+æœˆï¼Œå¦‚"1æœˆ"ã€"8æœˆ"ç­‰ï¼‰
                        if(/^\d+æœˆ$/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰æµæ—¥æ ‡è®°ï¼ˆæ•°å­—+æ—¥ æˆ– å†œå†æ—¥æœŸæ ¼å¼ï¼šåˆä¸€ã€åˆäºŒç­‰ï¼‰
                        if(/^\d+æ—¥$/.test(text) || /^(åˆ|å|å»¿|å…)/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰æµæ—¶æ ‡è®°ï¼ˆåœ°æ”¯+æ—¶ï¼‰
                        if(/^(å­|ä¸‘|å¯…|å¯|è¾°|å·³|åˆ|æœª|ç”³|é…‰|æˆŒ|äº¥)æ—¶$/.test(text)) e.remove();
                    });
                    // æ¸…é™¤æ—§çš„æµå¹´å››åŒ–å’Œæµæ›œ
                    ziweiSection.querySelectorAll('.hua').forEach(e=>{
                        let tag = e.querySelector('.h-tag');
                        if(tag && tag.innerText.trim() === 'æµ') e.remove();
                    });
                    ziweiSection.querySelectorAll('.s-flow').forEach(e=>e.remove());
                } else if(type === 'mo') {
                    // ç‚¹å‡»æµæœˆï¼šæ¸…é™¤æ‰€æœ‰æ—§çš„æµæœˆæ ‡è®°ï¼Œç„¶åæ¸…é™¤æµæ—¥/æµæ—¶æ ‡è®°
                    ziweiSection.querySelectorAll('.limit-tag').forEach(e=>{
                        let text = e.innerText.trim();
                        // æ¸…é™¤æ‰€æœ‰æ—§çš„æµæœˆæ ‡è®°ï¼ˆæ­£æœˆåˆ°è…Šæœˆï¼‰
                        if(/^(æ­£æœˆ|äºŒæœˆ|ä¸‰æœˆ|å››æœˆ|äº”æœˆ|å…­æœˆ|ä¸ƒæœˆ|å…«æœˆ|ä¹æœˆ|åæœˆ|å†¬æœˆ|è…Šæœˆ)$/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰æµæ—¥æ ‡è®°ï¼ˆæ•°å­—+æ—¥ æˆ– å†œå†æ—¥æœŸæ ¼å¼ï¼šåˆä¸€ã€åˆäºŒç­‰ï¼‰
                        if(/^\d+æ—¥$/.test(text) || /^(åˆ|å|å»¿|å…)/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰æµæ—¶æ ‡è®°ï¼ˆåœ°æ”¯+æ—¶ï¼‰
                        if(/^(å­|ä¸‘|å¯…|å¯|è¾°|å·³|åˆ|æœª|ç”³|é…‰|æˆŒ|äº¥)æ—¶$/.test(text)) e.remove();
                    });
                } else if(type === 'dy') {
                    // ç‚¹å‡»æµæ—¥ï¼šæ¸…é™¤æ‰€æœ‰æ—§çš„æµæ—¥æ ‡è®°ï¼Œç„¶åæ¸…é™¤æµæ—¶æ ‡è®°
                    ziweiSection.querySelectorAll('.limit-tag').forEach(e=>{
                        let text = e.innerText.trim();
                        // æ¸…é™¤æ‰€æœ‰æ—§çš„æµæ—¥æ ‡è®°ï¼ˆæ•°å­—+æ—¥ æˆ– å†œå†æ—¥æœŸæ ¼å¼ï¼šåˆä¸€ã€åˆäºŒç­‰ï¼‰
                        if(/^\d+æ—¥$/.test(text) || /^(åˆ|å|å»¿|å…)/.test(text)) e.remove();
                        // æ¸…é™¤æ‰€æœ‰æµæ—¶æ ‡è®°ï¼ˆåœ°æ”¯+æ—¶ï¼‰
                        if(/^(å­|ä¸‘|å¯…|å¯|è¾°|å·³|åˆ|æœª|ç”³|é…‰|æˆŒ|äº¥)æ—¶$/.test(text)) e.remove();
                    });
                } else if(type === 'hr') {
                    // ç‚¹å‡»æµæ—¶ï¼šåªæ¸…é™¤æµæ—¶æ ‡è®°
                    ziweiSection.querySelectorAll('.limit-tag').forEach(e=>{
                        let text = e.innerText.trim();
                        // æ¸…é™¤æ‰€æœ‰æµæ—¶æ ‡è®°ï¼ˆåœ°æ”¯+æ—¶ï¼‰
                        if(/^(å­|ä¸‘|å¯…|å¯|è¾°|å·³|åˆ|æœª|ç”³|é…‰|æˆŒ|äº¥)æ—¶$/.test(text)) e.remove();
                    });
                } else {
                    // å…¶ä»–æƒ…å†µï¼šå…¨éƒ¨æ¸…é™¤
                    ziweiSection.querySelectorAll('.limit-tag').forEach(e=>e.remove());
                    ziweiSection.querySelectorAll('.hua').forEach(e=>e.remove());
                    ziweiSection.querySelectorAll('.s-flow').forEach(e=>e.remove());
                }

                let yrEl = document.getElementById('sel-yr');
                let daValEl = document.getElementById('sel-da');
                if(!yrEl || !daValEl) return;
                // ä¼˜å…ˆä½¿ç”¨æ˜¾å¼ä¼ å…¥çš„å¹´ä»½ï¼Œå¦åˆ™ä½¿ç”¨sel-yrçš„å€¼ï¼Œå¦‚æœè¿˜æ²¡æœ‰åˆ™ä½¿ç”¨å½“å‰å¹´ä»½
                let yr;
                if(explicitYr !== undefined && explicitYr !== null && !isNaN(explicitYr)) {
                    yr = parseInt(explicitYr);
                } else {
                    yr = parseInt(yrEl.value);
                    if(!yr || isNaN(yr)) {
                        yr = new Date().getFullYear();
                        // å¦‚æœsel-yræ²¡æœ‰å€¼ï¼Œå°è¯•ä»å¤§é™è®¡ç®—é»˜è®¤å¹´ä»½
                        if(daValEl.value !== '') {
                            const daIndex = parseInt(daValEl.value);
                            const birthYear = this.solar.getYear();
                            const startAge = this.wuxing + daIndex * 10;
                            yr = birthYear + startAge - 1; // å¤§é™çš„ç¬¬ä¸€ä¸ªå¹´ä»½
                        }
                    }
                }
                const daVal = daValEl.value;
                let age = yr - this.solar.getYear() + 1;

                // å¦‚æœåªæ˜¯æ›´æ–°æœˆæ—¥æ—¶ï¼Œè·³è¿‡æœ¬å‘½å››åŒ–å’Œå¤§é™çš„è®¡ç®—ï¼ˆä¿ç•™ä¹‹å‰çš„çŠ¶æ€ï¼‰
                if(!type || !['mo','dy','hr'].includes(type)) {
                    // 1. æœ¬å‘½å››åŒ–
                    this.flyHua(GANS.indexOf(this.lunar.getYearGan()), 'æœ¬', 'h-ji');

                    // 2. å¤§é™ï¼ˆåªåœ¨éæµå¹´æ›´æ–°æ—¶æ·»åŠ ï¼Œé¿å…é‡å¤ï¼‰
                    if(type !== 'yr') {
                        let isYang = (GANS.indexOf(this.lunar.getYearGan())%2===0);
                        let isShun = (isYang && this.gender===1) || (!isYang && this.gender===0);
                        let daStep = (daVal === "") ? Math.floor((age < this.wuxing ? 0 : age - this.wuxing)/10) : parseInt(daVal);
                        let daIdx = isShun ? (this.mingIdx + daStep)%12 : (this.mingIdx - daStep + 12)%12;
                        
                        // å…ˆæ¸…é™¤æ—§çš„"å¤§é™"æ ‡è®°
                        const ziweiSection = document.getElementById('ziwei');
                        if(ziweiSection) {
                            ziweiSection.querySelectorAll('.limit-tag').forEach(e=>{
                                if(e.innerText.trim() === 'å¤§é™') e.remove();
                            });
                        }
                        this.addLimit(daIdx, 'å¤§é™', '');
                        this.flyHua(this.palaces[daIdx].gan, 'å¤§', 'h-quan');
                    }

                    // 3. æµå¹´å’Œå°é™ï¼ˆåªæ˜¾ç¤ºå½“å‰é€‰æ‹©çš„ï¼Œç‚¹å‡»æ–°çš„æ›¿æ¢æ—§çš„ï¼‰
                    const birthYear = this.solar.getYear();
                    const currentYear = yr;
                    let lYr = Lunar.fromYmd(currentYear, 1, 1);
                    let yZhi = ZHIS.indexOf(lYr.getYearZhi());
                    let yGan = GANS.indexOf(lYr.getYearGan());
                    
                    // åªæ˜¾ç¤ºå½“å‰é€‰æ‹©çš„æµå¹´ï¼ˆæ›¿æ¢æ—§çš„ï¼‰
                    this.addLimit(yZhi, `${currentYear}å¹´`, '');
                    this.flyHua(yGan, 'æµ', 'h-lu');
                    
                    // æµæ›œ
                    let fLu = [2,3,5,6,5,6,8,9,11,0][yGan];
                    this.addFlowStar(fLu, 'æµç¦„');
                    this.addFlowStar((fLu+1)%12, 'æµç¾Š');
                    this.addFlowStar((fLu-1+12)%12, 'æµé™€');
                    this.addFlowStar([1,0,11,11,1,0,1,6,5,5][yGan], 'æµé­');
                    this.addFlowStar([7,8,9,9,7,8,7,2,3,3][yGan], 'æµé’º');
                    
                    // åªæ˜¾ç¤ºå½“å‰å¹´é¾„çš„å°é™ï¼ˆæ›¿æ¢æ—§çš„ï¼‰
                    const XX_START = {2:4, 6:4, 10:4, 8:10, 0:10, 4:10, 11:1, 3:1, 7:1, 5:7, 9:7, 1:7};
                    let xxStart = XX_START[ZHIS.indexOf(this.lunar.getYearZhi())];
                    let currentAge = currentYear - birthYear + 1;
                    let xxIdx = (this.gender===1) ? (xxStart + currentAge - 1)%12 : (xxStart - currentAge + 1 + 12)%12;
                    this.addLimit(xxIdx, `${currentAge}å²`, '');
                }
                
                // è·å–æµå¹´ä¿¡æ¯ï¼ˆç”¨äºæµæœˆæµæ—¥æµæ—¶è®¡ç®—ï¼‰
                let lYr = Lunar.fromYmd(yr, 1, 1);
                let yZhi = ZHIS.indexOf(lYr.getYearZhi());
                
                // å¦‚æœä¹‹å‰æ²¡æœ‰è®¡ç®—è¿‡ï¼Œç¡®ä¿æµå¹´å·²æ˜¾ç¤ºï¼ˆä½¿ç”¨å¹´ä»½æ ¼å¼ï¼Œä¸æ˜¯"æµå¹´"æ–‡å­—ï¼‰
                if(type && ['mo','dy','hr'].includes(type)) {
                    let existingLimit = ziweiSection.querySelector(`#lim-${yZhi} .limit-tag`);
                    if(!existingLimit) {
                        this.addLimit(yZhi, `${yr}å¹´`, '');
                    }
                }

                // 5. æµæœˆæµæ—¥æµæ—¶ï¼ˆæ ¹æ®é€‰æ‹©æ˜¾ç¤ºï¼Œç¡®ä¿åªæ˜¾ç¤ºå½“å‰é€‰æ‹©çš„å†…å®¹ï¼‰
                let moEl = document.getElementById('sel-mo');
                let dyEl = document.getElementById('sel-dy');
                let hrEl = document.getElementById('sel-hr');
                
                // å¦‚æœé€‰æ‹©äº†æµå¹´ï¼Œæ˜¾ç¤º12ä¸ªæœˆçš„æµæœˆï¼ˆç‚¹å‡»æµå¹´æ—¶ï¼‰
                // æ ¹æ®æ–‡å¢¨å¤©æœºï¼šæµæœˆæ˜¾ç¤ºä¸ºæ•°å­—æ ¼å¼ï¼Œå¦‚"8æœˆ"ï¼ˆä¸æ˜¯"å…«æœˆ"ï¼‰
                if(yrEl && yrEl.value && (type === 'yr' || type === 'da' || !type)) {
                    let lYrFlow = Lunar.fromYmd(yr, 1, 1);
                    let yZhiFlow = ZHIS.indexOf(lYrFlow.getYearZhi());
                    
                    // æ˜¾ç¤º12ä¸ªæœˆçš„æµæœˆï¼ˆæ ¼å¼ï¼š1æœˆã€2æœˆ...12æœˆï¼‰
                    for(let mo = 1; mo <= 12; mo++) {
                        let moIdx = (yZhiFlow + mo - 1) % 12;
                        this.addLimit(moIdx, `${mo}æœˆ`, '');
                    }
                }
                
                // å¦‚æœé€‰æ‹©äº†æµæœˆï¼Œæ˜¾ç¤ºè¯¥æœˆçš„æ‰€æœ‰æµæ—¥ï¼ˆç‚¹å‡»æµæœˆæ—¶ï¼‰
                if(moEl && moEl.value && yrEl && yrEl.value && (type === 'mo' || type === 'yr' || type === 'da' || !type)) {
                    const selectedYr = parseInt(yrEl.value);
                    const selectedMo = parseInt(moEl.value);
                    let lYrFlow = Lunar.fromYmd(selectedYr, 1, 1);
                    let yZhiFlow = ZHIS.indexOf(lYrFlow.getYearZhi());
                    let moIdx = (yZhiFlow + selectedMo - 1) % 12;
                    
                    // è®¡ç®—è¯¥æœˆçš„å®é™…å¤©æ•°ï¼ˆå…¬å†æœˆä»½å¯¹åº”çš„å†œå†æœˆä»½å¤©æ•°ï¼‰
                    let daysInMonth = 30; // é»˜è®¤30å¤©
                    try {
                        // è·å–è¯¥å…¬å†æœˆä»½çš„ç¬¬ä¸€å¤©å¯¹åº”çš„å†œå†ä¿¡æ¯
                        let solarDate = new Date(selectedYr, selectedMo - 1, 1);
                        let lunarDate = Solar.fromDate(solarDate).getLunar();
                        // è·å–è¯¥å†œå†æœˆçš„å¤©æ•°
                        // lunar-javascriptåº“ä¸­ï¼Œå¦‚æœgetDayCountä¸å­˜åœ¨ï¼Œå°è¯•å…¶ä»–æ–¹æ³•
                        if(typeof lunarDate.getDayCount === 'function') {
                            daysInMonth = lunarDate.getDayCount();
                        } else if(typeof lunarDate.getDayCountInMonth === 'function') {
                            daysInMonth = lunarDate.getDayCountInMonth();
                        } else {
                            // å¤‡ç”¨æ–¹æ³•ï¼šè·å–è¯¥æœˆçš„æœ€åä¸€å¤©ï¼Œè®¡ç®—å¤©æ•°
                            // æˆ–è€…ä½¿ç”¨å…¬å†æœˆä»½çš„å¤©æ•°
                            daysInMonth = new Date(selectedYr, selectedMo, 0).getDate();
                        }
                    } catch(e) {
                        console.warn('è®¡ç®—å†œå†æœˆä»½å¤©æ•°å¤±è´¥:', e);
                        // å¦‚æœè®¡ç®—å¤±è´¥ï¼Œä½¿ç”¨å…¬å†æœˆä»½çš„å¤©æ•°ä½œä¸ºå¤‡ç”¨
                        daysInMonth = new Date(selectedYr, selectedMo, 0).getDate();
                    }
                    
                    // æ˜¾ç¤ºè¯¥æœˆçš„æ‰€æœ‰æµæ—¥ï¼ˆæ ¹æ®å®é™…å¤©æ•°ï¼Œä½¿ç”¨å†œå†æ—¥æœŸæ ¼å¼ï¼šåˆä¸€ã€åˆäºŒç­‰ï¼‰
                    for(let dy = 1; dy <= daysInMonth; dy++) {
                        let dyIdx = (moIdx + dy - 1) % 12;
                        // è½¬æ¢ä¸ºå†œå†æ—¥æœŸæ ¼å¼ï¼šåˆä¸€ã€åˆäºŒ...åˆåã€åä¸€...äºŒåã€å»¿ä¸€...ä¸‰å
                        let dayName = dy <= 10 ? `åˆ${['','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹','å'][dy]}` : 
                                       dy < 20 ? `å${['','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹'][dy-10]}` :
                                       dy === 20 ? 'äºŒå' :
                                       dy < 30 ? `å»¿${['','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹'][dy-20]}` :
                                       dy === 30 ? 'ä¸‰å' : `å…${['','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹'][dy-30]}`;
                        this.addLimit(dyIdx, dayName, '');
                    }
                }
                
                // å¦‚æœé€‰æ‹©äº†æµæ—¥ï¼Œæ˜¾ç¤ºè¯¥æ—¥çš„12ä¸ªæ—¶è¾°ï¼ˆç‚¹å‡»æµæ—¥æ—¶ï¼‰
                if(dyEl && dyEl.value && moEl && moEl.value && yrEl && yrEl.value && (type === 'dy' || type === 'mo' || type === 'yr' || type === 'da' || !type)) {
                    const selectedYr = parseInt(yrEl.value);
                    const selectedMo = parseInt(moEl.value);
                    const selectedDy = parseInt(dyEl.value);
                    let lYrFlow = Lunar.fromYmd(selectedYr, 1, 1);
                    let yZhiFlow = ZHIS.indexOf(lYrFlow.getYearZhi());
                    let moIdx = (yZhiFlow + selectedMo - 1) % 12;
                    let dyIdx = (moIdx + selectedDy - 1) % 12;
                    
                    // æ˜¾ç¤º12ä¸ªæ—¶è¾°çš„æµæ—¶
                    for(let hr = 0; hr < 12; hr++) {
                        let hrIdx = (dyIdx + hr) % 12;
                        this.addLimit(hrIdx, ZHIS[hr] + 'æ—¶', '');
                    }
                }
                
                // 6. å®«å¹²è‡ªåŒ–
                if(!type || !['mo','dy','hr'].includes(type)) {
                    for(let i=0; i<12; i++) this.flyHua(this.palaces[i].gan, 'è‡ª', 'h-ke', i);
                }
                
                // 7. æ›´æ–°æµè¿è¡¨æ ¼
                // #region agent log
                fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.updateFlow',message:'å‡†å¤‡æ›´æ–°æµè¿è¡¨æ ¼',data:{yr:yr,typeofUpdateFlowTables:typeof this.updateFlowTables,selYrValue:yrEl?yrEl.value:null},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                // ç¡®ä¿sel-yræœ‰å€¼ï¼ˆå¦‚æœyræ˜¯ä»explicitYrä¼ å…¥çš„ï¼Œç¡®ä¿sel-yrä¹Ÿè¢«è®¾ç½®ï¼‰
                if(yrEl && yr) {
                    // æ£€æŸ¥yræ˜¯å¦åœ¨é€‰é¡¹ä¸­
                    let optionExists = false;
                    for(let i = 0; i < yrEl.options.length; i++) {
                        if(parseInt(yrEl.options[i].value) === yr) {
                            optionExists = true;
                            break;
                        }
                    }
                    if(!optionExists) {
                        // å¦‚æœé€‰é¡¹ä¸å­˜åœ¨ï¼Œæ·»åŠ å®ƒ
                        const option = new Option(yr + 'å¹´', yr);
                        yrEl.add(option);
                    }
                    // è®¾ç½®å€¼
                    if(!yrEl.value || yrEl.value === '') {
                        yrEl.value = yr;
                    }
                }
                this.updateFlowTables(yr);
            },
            
            updateFlowTables: function(yr) {
                // #region agent log
                fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.updateFlowTables',message:'å¼€å§‹æ›´æ–°æµè¿è¡¨æ ¼',data:{yr:yr,hasLunar:!!this.lunar,hasPalaces:!!this.palaces,palacesLength:this.palaces?this.palaces.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                
                if(!this.lunar || !this.palaces || this.palaces.length === 0) {
                    // #region agent log
                    fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:ZW.updateFlowTables',message:'æ¡ä»¶ä¸æ»¡è¶³ï¼Œè·³è¿‡æ›´æ–°',data:{hasLunar:!!this.lunar,hasPalaces:!!this.palaces,palacesLength:this.palaces?this.palaces.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'C'})}).catch(()=>{});
                    // #endregion
                    return;
                }
                
                // æ›´æ–°å¤§é™è¡¨æ ¼
                this.updateDaxianTable();
                
                // æ›´æ–°æµå¹´å°é™è¡¨æ ¼
                this.updateLiunianTable(yr);
                
                // æ›´æ–°æµæœˆæµæ—¥æµæ—¶è¡¨æ ¼ï¼ˆç¡®ä¿sel-yræœ‰å€¼ï¼‰
                const yrEl = document.getElementById('sel-yr');
                if(yrEl && yrEl.value) {
                    this.updateLiuyueTable();
                    this.updateLiuriTable();
                    this.updateLiushiTable();
                }
            },
            
            updateDaxianTable: function() {
                const content = document.getElementById('daxian-content');
                if(!content) return;
                
                content.innerHTML = '';
                const self = this; // ä¿å­˜thiså¼•ç”¨
                let isYang = (GANS.indexOf(this.lunar.getYearGan())%2===0);
                let isShun = (isYang && this.gender===1) || (!isYang && this.gender===0);
                
                const daEl = document.getElementById('sel-da');
                const currentDa = daEl && daEl.value !== '' ? parseInt(daEl.value) : null;
                
                // ç«¥é™ï¼ˆæ–‡å¢¨å¤©æœºæ ¼å¼ï¼šèµ·çœ¼å‰(å®£é™)ï¼‰
                let cell = document.createElement('div');
                cell.style.cssText = 'padding: 8px 12px; border-right: 1px solid #ddd; cursor: pointer; white-space: nowrap; min-width: 100px; text-align: center; transition: background 0.2s;';
                if(currentDa === null) {
                    cell.style.background = '#fff3cd';
                }
                cell.innerText = 'èµ·çœ¼å‰(å®£é™)';
                cell.onmouseenter = () => { if(currentDa !== null) cell.style.background = '#e9ecef'; };
                cell.onmouseleave = () => { if(currentDa !== null) cell.style.background = ''; };
                cell.onclick = () => {
                    if(daEl) {
                        daEl.value = '';
                        // æ¢å¤é»˜è®¤æ˜¾ç¤ºï¼Œä½¿ç”¨å½“å‰å¹´ä»½
                        const yrEl = document.getElementById('sel-yr');
                        const currentYr = yrEl && yrEl.value ? parseInt(yrEl.value) : new Date().getFullYear();
                        if(yrEl) {
                            yrEl.value = currentYr;
                        }
                        ZW.updateFlow('da');
                        // æ›´æ–°æµå¹´å°é™è¡¨æ ¼ï¼ˆå› ä¸ºå¤§é™æ”¹å˜äº†ï¼Œæ¢å¤é»˜è®¤æ˜¾ç¤ºï¼‰
                        setTimeout(() => {
                            ZW.updateLiunianTable(currentYr);
                        }, 100);
                    }
                };
                content.appendChild(cell);
                
                // å„å¤§å¤§é™ï¼ˆæ˜¾ç¤ºåˆ°100å²å·¦å³ï¼Œå¤§çº¦10ä¸ªå¤§é™ï¼‰
                // è®¡ç®—éœ€è¦æ˜¾ç¤ºçš„å¤§é™æ•°é‡ï¼šä»wuxingåˆ°100å²ï¼Œæ¯10å¹´ä¸€ä¸ªå¤§é™
                const maxAge = 100; // æœ€å¤§å¹´é¾„
                const maxDaxianCount = Math.ceil((maxAge - this.wuxing + 1) / 10); // éœ€è¦çš„å¤§é™æ•°é‡
                for(let i=0; i<maxDaxianCount; i++) {
                    let s = this.wuxing + i*10;
                    // å¦‚æœèµ·å§‹å¹´é¾„è¶…è¿‡100å²ï¼Œåœæ­¢
                    if(s > maxAge) break;
                    let idx = isShun ? (this.mingIdx + i)%12 : (this.mingIdx - i + 12)%12;
                    let gz = GANS[this.palaces[idx].gan] + ZHIS[idx];
                    
                    cell = document.createElement('div');
                    cell.style.cssText = 'padding: 8px 12px; border-right: 1px solid #ddd; cursor: pointer; white-space: nowrap; min-width: 100px; text-align: center; transition: background 0.2s; position: relative; z-index: 10;';
                    if(i === currentDa) {
                        cell.style.background = '#fff3cd';
                    }
                    // æ–‡å¢¨å¤©æœºæ ¼å¼ï¼šå¹´é¾„èŒƒå›´ + å¹²æ”¯é™ï¼Œå¦‚"3-12" + "å£¬åˆé™"
                    cell.innerHTML = `${s}-${s+9}<br>${gz}é™`;
                    cell.onmouseenter = () => { if(i !== currentDa) cell.style.background = '#e9ecef'; };
                    cell.onmouseleave = () => { if(i !== currentDa) cell.style.background = ''; };
                    cell.onclick = (e) => {
                        e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                        e.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º
                        const sel = document.getElementById('sel-da');
                        if(sel) {
                            sel.value = i;
                            
                            // #region agent log
                            fetch('http://127.0.0.1:7245/ingest/2e765a66-50eb-4f53-af9f-2607f8b1e582',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updateDaxianTable-cell.onclick',message:'ç‚¹å‡»å¤§é™',data:{daxianIndex:i,displayedRange:`${self.wuxing + i*10}-${self.wuxing + i*10 + 9}`,wuxing:self.wuxing},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                            // #endregion
                            
                            // è®¡ç®—è¿™ä¸ªå¤§é™çš„å¹´ä»½èŒƒå›´ï¼ˆä½¿ç”¨selfè€Œä¸æ˜¯thisï¼‰
                            let isYang2 = (GANS.indexOf(self.lunar.getYearGan())%2===0);
                            let isShun2 = (isYang2 && self.gender===1) || (!isYang2 && self.gender===0);
                            const birthYear = self.solar.getYear();
                            const startAge = self.wuxing + i * 10;
                            const endAge = startAge + 9; // å¤§é™æ˜¯10å¹´
                            const startYear = birthYear + startAge - 1;
                            const endYear = birthYear + endAge - 1;
                            
                            // #region agent log
                            fetch('http://127.0.0.1:7245/ingest/2e765a66-50eb-4f53-af9f-2607f8b1e582',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updateDaxianTable-cell.onclick',message:'è®¡ç®—å¤§é™å¹´ä»½èŒƒå›´',data:{birthYear:birthYear,startAge:startAge,startYear:startYear,endYear:endYear,ageRange:`${startAge}-${startAge+9}`,yearRange:`${startYear}-${endYear}`},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
                            // #endregion
                            
                            // æ£€æŸ¥å½“å‰æµå¹´æ˜¯å¦åœ¨æ–°å¤§é™èŒƒå›´å†…ï¼Œå¦‚æœä¸åœ¨ï¼Œé€‰æ‹©å¤§é™çš„ç¬¬ä¸€ä¸ªå¹´ä»½
                            const yrEl = document.getElementById('sel-yr');
                            let newYear = startYear;
                            if(yrEl && yrEl.value) {
                                const currentYr = parseInt(yrEl.value);
                                if(currentYr >= startYear && currentYr <= endYear) {
                                    newYear = currentYr; // å½“å‰å¹´ä»½åœ¨å¤§é™èŒƒå›´å†…ï¼Œä¿æŒ
                                }
                            }
                            
                            // #region agent log
                            fetch('http://127.0.0.1:7245/ingest/2e765a66-50eb-4f53-af9f-2607f8b1e582',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updateDaxianTable-cell.onclick',message:'é€‰æ‹©æµå¹´',data:{newYear:newYear,selValue:i},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                            // #endregion
                            
                            // è®¾ç½®æ–°çš„æµå¹´ï¼ˆå¿…é¡»åœ¨updateFlowä¹‹å‰è®¾ç½®ï¼‰
                            if(yrEl) {
                                yrEl.value = newYear;
                            }
                            
                            // å…ˆæ›´æ–°æµå¹´è¡¨æ ¼ï¼Œå†è°ƒç”¨updateFlow
                            ZW.updateLiunianTable(newYear);
                            
                            // ç„¶åæ›´æ–°æµè¿æ ‡è®°
                            ZW.updateFlow('da');
                        }
                    };
                    content.appendChild(cell);
                }
            },
            
            updateLiunianTable: function(yr) {
                const content = document.getElementById('liunian-content');
                if(!content) return;
                
                // åœ¨æ¸…ç©ºè¡¨æ ¼ä¹‹å‰ï¼Œå…ˆä¿å­˜sel-yrçš„å€¼ï¼ˆå¦‚æœä¼ å…¥çš„yrä¸ºç©ºï¼Œåˆ™ä»DOMè¯»å–ï¼‰
                const yrEl = document.getElementById('sel-yr');
                let savedYr = yr;
                if(!savedYr || isNaN(savedYr)) {
                    if(yrEl && yrEl.value) {
                        savedYr = parseInt(yrEl.value);
                    } else {
                        savedYr = new Date().getFullYear();
                    }
                }
                
                content.innerHTML = '';
                const birthYear = this.solar.getYear();
                const currentYear = savedYr;
                
                // ç¡®ä¿sel-yræœ‰æ­£ç¡®çš„å€¼ï¼Œå¹¶ä¸”è¯¥å¹´ä»½åœ¨é€‰é¡¹ä¸­
                if(yrEl && savedYr) {
                    // æ£€æŸ¥savedYræ˜¯å¦åœ¨é€‰é¡¹ä¸­
                    let optionExists = false;
                    for(let i = 0; i < yrEl.options.length; i++) {
                        if(parseInt(yrEl.options[i].value) === savedYr) {
                            optionExists = true;
                            break;
                        }
                    }
                    if(!optionExists) {
                        // å¦‚æœé€‰é¡¹ä¸å­˜åœ¨ï¼Œæ·»åŠ å®ƒ
                        const option = new Option(savedYr + 'å¹´', savedYr);
                        yrEl.add(option);
                    }
                    // è®¾ç½®å€¼
                    if(!yrEl.value || yrEl.value === '') {
                        yrEl.value = savedYr;
                    }
                }
                
                // #region agent log
                fetch('http://127.0.0.1:7245/ingest/2e765a66-50eb-4f53-af9f-2607f8b1e582',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updateLiunianTable',message:'å¼€å§‹æ›´æ–°æµå¹´è¡¨æ ¼',data:{yr:yr,birthYear:birthYear,currentYear:currentYear,wuxing:this.wuxing},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                
                // æ£€æŸ¥æ˜¯å¦é€‰æ‹©äº†å¤§é™
                const daEl = document.getElementById('sel-da');
                let yearRange = null;
                if(daEl && daEl.value !== '') {
                    // å¦‚æœé€‰æ‹©äº†å¤§é™ï¼Œè®¡ç®—è¯¥å¤§é™å¯¹åº”çš„å¹´ä»½èŒƒå›´
                    const daIndex = parseInt(daEl.value);
                    let isYang = (GANS.indexOf(this.lunar.getYearGan())%2===0);
                    let isShun = (isYang && this.gender===1) || (!isYang && this.gender===0);
                    
                    // è®¡ç®—å¤§é™çš„èµ·å§‹å¹´é¾„
                    const startAge = this.wuxing + daIndex * 10;
                    const endAge = startAge + 9;
                    
                    // è®¡ç®—å¯¹åº”çš„å¹´ä»½èŒƒå›´
                    const startYear = birthYear + startAge - 1;
                    const endYear = birthYear + endAge - 1;
                    
                    // #region agent log
                    fetch('http://127.0.0.1:7245/ingest/2e765a66-50eb-4f53-af9f-2607f8b1e582',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updateLiunianTable',message:'è®¡ç®—å¤§é™å¹´ä»½èŒƒå›´',data:{daIndex:daIndex,daIndexType:typeof daIndex,selValue:daEl.value,startAge:startAge,endAge:endAge,startYear:startYear,endYear:endYear,ageRange:`${startAge}-${endAge}`,yearRange:`${startYear}-${endYear}`},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
                    // #endregion
                    
                    yearRange = { start: startYear, end: endYear };
                }
                
                // ç¡®å®šè¦æ˜¾ç¤ºçš„å¹´ä»½èŒƒå›´
                let displayStartYear, displayEndYear;
                if(yearRange) {
                    // å¦‚æœé€‰æ‹©äº†å¤§é™ï¼Œåªæ˜¾ç¤ºè¯¥å¤§é™å¯¹åº”çš„å¹´ä»½
                    displayStartYear = yearRange.start;
                    displayEndYear = yearRange.end;
                } else {
                    // å¦‚æœæ²¡æœ‰é€‰æ‹©å¤§é™ï¼Œæ˜¾ç¤ºå½“å‰å¹´ä»½å‰åå„20å¹´
                    displayStartYear = currentYear - 20;
                    displayEndYear = currentYear + 20;
                }
                
                // #region agent log
                fetch('http://127.0.0.1:7245/ingest/2e765a66-50eb-4f53-af9f-2607f8b1e582',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updateLiunianTable',message:'ç¡®å®šæ˜¾ç¤ºå¹´ä»½èŒƒå›´',data:{hasYearRange:!!yearRange,yearRange:yearRange,displayStartYear:displayStartYear,displayEndYear:displayEndYear,yearCount:displayEndYear-displayStartYear+1},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                
                // æ˜¾ç¤ºå¹´ä»½
                for(let y = displayStartYear; y <= displayEndYear; y++) {
                    let lYr = Lunar.fromYmd(y, 1, 1);
                    let yGan = lYr.getYearGan();
                    let yZhi = lYr.getYearZhi();
                    let age = y - birthYear + 1;
                    
                    let cell = document.createElement('div');
                    cell.style.cssText = 'padding: 8px 12px; border-right: 1px solid #ddd; cursor: pointer; white-space: nowrap; min-width: 100px; text-align: center; transition: background 0.2s; position: relative; z-index: 10; pointer-events: auto; user-select: none;';
                    if(y === currentYear) {
                        cell.style.background = '#fff3cd';
                    }
                    // æ ¹æ®æ–‡å¢¨å¤©æœºï¼šæ˜¾ç¤ºæ ¼å¼ä¸º"2079å¹´ å·±äº¥80"ï¼ˆå¹´ä»½+ç©ºæ ¼+å¹²æ”¯+å¹´é¾„ï¼ŒåŒä¸€è¡Œï¼‰
                    cell.innerHTML = `${y}å¹´ ${yGan}${yZhi}${age}`;
                    cell.onmouseenter = () => { if(y !== currentYear) cell.style.background = '#e9ecef'; };
                    cell.onmouseleave = () => { if(y !== currentYear) cell.style.background = ''; };
                    // ç¡®ä¿å¯ä»¥ç‚¹å‡»
                    cell.style.pointerEvents = 'auto';
                    cell.onclick = (e) => {
                        // #region agent log
                        fetch('http://127.0.0.1:7245/ingest/2e765a66-50eb-4f53-af9f-2607f8b1e582',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updateLiunianTable-cell.onclick',message:'æµå¹´æŒ‰é’®è¢«ç‚¹å‡»',data:{year:y,eventType:e.type,hasSelYr:!!document.getElementById('sel-yr')},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                        // #endregion
                        e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                        e.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º
                        const sel = document.getElementById('sel-yr');
                        if(sel) {
                            // ç¡®ä¿è¯¥å¹´ä»½åœ¨é€‰é¡¹ä¸­ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æ·»åŠ 
                            let optionExists = false;
                            for(let i = 0; i < sel.options.length; i++) {
                                if(parseInt(sel.options[i].value) === y) {
                                    optionExists = true;
                                    break;
                                }
                            }
                            if(!optionExists) {
                                // æ·»åŠ è¯¥å¹´ä»½é€‰é¡¹
                                const option = new Option(y + 'å¹´', y);
                                sel.add(option);
                            }
                            // è®¾ç½®sel-yrçš„å€¼
                            sel.value = y;
                            // #region agent log
                            fetch('http://127.0.0.1:7245/ingest/2e765a66-50eb-4f53-af9f-2607f8b1e582',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updateLiunianTable-cell.onclick',message:'è®¾ç½®sel-yrå€¼',data:{year:y,selValue:sel.value,optionExists:optionExists,optionsCount:sel.options.length},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                            // #endregion
                            // æ¸…é™¤æµæœˆæµæ—¥æµæ—¶çš„é€‰æ‹©
                            const moSel = document.getElementById('sel-mo');
                            const dySel = document.getElementById('sel-dy');
                            const hrSel = document.getElementById('sel-hr');
                            if(moSel) moSel.value = '';
                            if(dySel) dySel.value = '';
                            if(hrSel) hrSel.value = '';
                            // ç›´æ¥ä½¿ç”¨ç‚¹å‡»çš„å¹´ä»½æ›´æ–°æµè¿æ ‡è®°å’Œè¡¨æ ¼
                            // å…ˆæ›´æ–°æµæœˆæµæ—¥æµæ—¶è¡¨æ ¼ï¼ˆå› ä¸ºæµå¹´æ”¹å˜äº†ï¼Œåœ¨updateFlowä¹‹å‰æ›´æ–°ï¼Œç¡®ä¿sel-yræœ‰å€¼ï¼‰
                            ZW.updateLiuyueTable();
                            ZW.updateLiuriTable();
                            ZW.updateLiushiTable();
                            // ç„¶åæ›´æ–°æµè¿æ ‡è®°ï¼ˆä¼ å…¥å¹´ä»½yï¼Œè€Œä¸æ˜¯ä»DOMè¯»å–ï¼‰
                            // æ³¨æ„ï¼šupdateFlowä¼šè°ƒç”¨updateFlowTablesï¼Œå…¶ä¸­ä¼šè°ƒç”¨updateLiunianTableé‡æ–°ç”Ÿæˆè¡¨æ ¼
                            // ä½†æ­¤æ—¶sel-yrå·²ç»æœ‰å€¼äº†ï¼Œæ‰€ä»¥ä¸ä¼šä¸¢å¤±
                            ZW.updateFlow('yr', y);
                        } else {
                            // #region agent log
                            fetch('http://127.0.0.1:7245/ingest/2e765a66-50eb-4f53-af9f-2607f8b1e582',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:updateLiunianTable-cell.onclick',message:'sel-yrå…ƒç´ ä¸å­˜åœ¨',data:{year:y},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                            // #endregion
                        }
                    };
                    // åŒæ—¶æ·»åŠ mousedownäº‹ä»¶ä½œä¸ºå¤‡ç”¨
                    cell.onmousedown = (e) => {
                        e.stopPropagation();
                        e.preventDefault();
                    };
                    content.appendChild(cell);
                }
            },
            
            updateLiuyueTable: function() {
                const content = document.getElementById('liuyue-content');
                if(!content) return;
                
                content.innerHTML = '';
                const yrEl = document.getElementById('sel-yr');
                if(!yrEl || !yrEl.value) return;
                
                const yr = parseInt(yrEl.value);
                let lYr = Lunar.fromYmd(yr, 1, 1);
                let yZhi = ZHIS.indexOf(lYr.getYearZhi());
                
                // æ ¹æ®æ–‡å¢¨å¤©æœºï¼šæµæœˆè¡¨æ ¼æ˜¾ç¤ºä¸ºå†œå†æœˆä»½åç§°ï¼Œå¦‚"æ­£æœˆ"ã€"å…«æœˆ"ç­‰ï¼Œå¹¶æ˜¾ç¤ºå¹²æ”¯
                const moEl = document.getElementById('sel-mo');
                const currentMo = moEl && moEl.value ? parseInt(moEl.value) : null;
                
                // å†œå†æœˆä»½åç§°æ•°ç»„
                const MONTH_NAMES = ['æ­£æœˆ','äºŒæœˆ','ä¸‰æœˆ','å››æœˆ','äº”æœˆ','å…­æœˆ','ä¸ƒæœˆ','å…«æœˆ','ä¹æœˆ','åæœˆ','å†¬æœˆ','è…Šæœˆ'];
                
                for(let mo = 1; mo <= 12; mo++) {
                    let moIdx = (yZhi + mo - 1) % 12;
                    
                    // è®¡ç®—æµæœˆçš„å¹²æ”¯
                    let moGan = GANS[(GANS.indexOf(lYr.getYearGan()) + mo - 1) % 10];
                    let moZhi = ZHIS[(yZhi + mo - 1) % 12];
                    
                    let cell = document.createElement('div');
                    cell.style.cssText = 'padding: 8px 12px; border-right: 1px solid #ddd; cursor: pointer; white-space: nowrap; min-width: 80px; text-align: center; transition: background 0.2s; position: relative; z-index: 10;';
                    if(mo === currentMo) {
                        cell.style.background = '#fff3cd';
                    }
                    // æ ¹æ®æ–‡å¢¨å¤©æœºï¼šæ˜¾ç¤ºæ ¼å¼ä¸º"å…«æœˆ ç™¸é…‰"ï¼ˆå†œå†æœˆä»½åç§°ï¼Œç©ºæ ¼ï¼Œå¹²æ”¯ï¼‰
                    cell.innerHTML = `${MONTH_NAMES[mo-1]}<br>${moGan}${moZhi}`;
                    cell.onmouseenter = () => { if(mo !== currentMo) cell.style.background = '#e9ecef'; };
                    cell.onmouseleave = () => { if(mo !== currentMo) cell.style.background = ''; };
                    cell.onclick = (e) => {
                        e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                        e.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º
                        if(moEl) {
                            moEl.value = mo;
                            // æ¸…é™¤æµæ—¥æµæ—¶çš„é€‰æ‹©
                            const dySel = document.getElementById('sel-dy');
                            const hrSel = document.getElementById('sel-hr');
                            if(dySel) dySel.value = '';
                            if(hrSel) hrSel.value = '';
                            // å…ˆæ›´æ–°æµæ—¥è¡¨æ ¼ï¼Œç¡®ä¿sel-moæœ‰å€¼
                            ZW.updateLiuriTable();
                            ZW.updateLiushiTable();
                            // ç„¶åæ›´æ–°æµè¿æ ‡è®°
                            ZW.updateFlow('mo');
                        }
                    };
                    content.appendChild(cell);
                }
            },
            
            updateLiuriTable: function() {
                const content = document.getElementById('liuri-content');
                if(!content) {
                    console.warn('updateLiuriTable: liuri-contentå…ƒç´ ä¸å­˜åœ¨');
                    return;
                }
                
                content.innerHTML = '';
                const moEl = document.getElementById('sel-mo');
                if(!moEl || !moEl.value) {
                    // å¦‚æœæ²¡æœ‰é€‰æ‹©æµæœˆï¼Œæ˜¾ç¤ºæç¤º
                    let cell = document.createElement('div');
                    cell.style.cssText = 'padding: 8px 12px; color: #999; font-size: 11px;';
                    cell.innerText = 'è¯·å…ˆé€‰æ‹©æµæœˆ';
                    content.appendChild(cell);
                    return;
                }
                
                const yrEl = document.getElementById('sel-yr');
                if(!yrEl || !yrEl.value) {
                    let cell = document.createElement('div');
                    cell.style.cssText = 'padding: 8px 12px; color: #999; font-size: 11px;';
                    cell.innerText = 'è¯·å…ˆé€‰æ‹©æµå¹´';
                    content.appendChild(cell);
                    return;
                }
                
                const yr = parseInt(yrEl.value);
                const mo = parseInt(moEl.value);
                let lYr = Lunar.fromYmd(yr, 1, 1);
                let yZhi = ZHIS.indexOf(lYr.getYearZhi());
                let moIdx = (yZhi + mo - 1) % 12;
                
                // è®¡ç®—è¯¥æœˆçš„å¤©æ•°ï¼ˆå†œå†ï¼‰
                // æ³¨æ„ï¼šè¿™é‡Œmoæ˜¯å…¬å†æœˆä»½ï¼ˆ1-12ï¼‰ï¼Œéœ€è¦è½¬æ¢ä¸ºå¯¹åº”çš„å†œå†æœˆä»½
                // æµæœˆè¡¨æ ¼ä¸­çš„æœˆä»½æ˜¯å…¬å†æœˆä»½ï¼Œä½†æµæ—¥åº”è¯¥æ˜¾ç¤ºè¯¥å…¬å†æœˆä»½å¯¹åº”çš„å†œå†æ—¥æœŸ
                let daysInMonth = 30; // é»˜è®¤30å¤©
                try {
                    // è·å–è¯¥å…¬å†æœˆä»½çš„ç¬¬ä¸€å¤©å¯¹åº”çš„å†œå†ä¿¡æ¯
                    let solarDate = new Date(yr, mo - 1, 1);
                    let lunarDate = Solar.fromDate(solarDate).getLunar();
                    // è·å–è¯¥å†œå†æœˆçš„å¤©æ•°
                    // lunar-javascriptåº“ä¸­ï¼Œå¦‚æœgetDayCountä¸å­˜åœ¨ï¼Œå°è¯•å…¶ä»–æ–¹æ³•
                    if(typeof lunarDate.getDayCount === 'function') {
                        daysInMonth = lunarDate.getDayCount();
                    } else if(typeof lunarDate.getDayCountInMonth === 'function') {
                        daysInMonth = lunarDate.getDayCountInMonth();
                    } else {
                        // å¤‡ç”¨æ–¹æ³•ï¼šä½¿ç”¨å…¬å†æœˆä»½çš„å¤©æ•°
                        daysInMonth = new Date(yr, mo, 0).getDate();
                    }
                } catch(e) {
                    console.warn('è®¡ç®—å†œå†æœˆä»½å¤©æ•°å¤±è´¥:', e);
                    daysInMonth = 30;
                }
                
                const dyEl = document.getElementById('sel-dy');
                const currentDy = dyEl && dyEl.value ? parseInt(dyEl.value) : null;
                
                // æ ¹æ®æ–‡å¢¨å¤©æœºï¼šæµæ—¥è¡¨æ ¼æ˜¾ç¤ºå†œå†æ—¥æœŸæ ¼å¼ï¼Œå¦‚"åˆä¸€"ã€"åˆå…«"ç­‰ï¼Œå¹¶æ˜¾ç¤ºå¹²æ”¯
                for(let dy = 1; dy <= Math.min(daysInMonth, 30); dy++) {
                    let dyIdx = (moIdx + dy - 1) % 12;
                    // è½¬æ¢ä¸ºå†œå†æ—¥æœŸæ ¼å¼ï¼šåˆä¸€ã€åˆäºŒ...åˆåã€åä¸€...äºŒåã€å»¿ä¸€...ä¸‰å
                    let dayName = dy <= 10 ? `åˆ${['','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹','å'][dy]}` : 
                                   dy < 20 ? `å${['','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹'][dy-10]}` :
                                   dy === 20 ? 'äºŒå' :
                                   dy < 30 ? `å»¿${['','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹'][dy-20]}` :
                                   dy === 30 ? 'ä¸‰å' : 'å…' + ['','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹'][dy-30];
                    
                    // è®¡ç®—æµæ—¥çš„å¹²æ”¯ï¼ˆæ ¹æ®æµæœˆå¹²æ”¯æ¨ç®—ï¼‰
                    // æµæ—¥å¹²æ”¯ = æµæœˆå¹²æ”¯ + (dy - 1)
                    let moGanIdx = (GANS.indexOf(lYr.getYearGan()) + mo - 1) % 10;
                    let moZhiIdx = (yZhi + mo - 1) % 12;
                    let dyGanIdx = (moGanIdx + dy - 1) % 10;
                    let dyZhiIdx = (moZhiIdx + dy - 1) % 12;
                    let dyGan = GANS[dyGanIdx];
                    let dyZhi = ZHIS[dyZhiIdx];
                    
                    let cell = document.createElement('div');
                    cell.style.cssText = 'padding: 8px 12px; border-right: 1px solid #ddd; cursor: pointer; white-space: nowrap; min-width: 80px; text-align: center; transition: background 0.2s; position: relative; z-index: 10;';
                    if(dy === currentDy) {
                        cell.style.background = '#fff3cd';
                    }
                    // æ ¹æ®æ–‡å¢¨å¤©æœºï¼šæ˜¾ç¤ºæ ¼å¼ä¸º"åˆå…«"ï¼ˆç¬¬ä¸€è¡Œï¼‰ï¼Œ"ä¸å·³"ï¼ˆç¬¬äºŒè¡Œï¼‰
                    cell.innerHTML = `${dayName}<br>${dyGan}${dyZhi}`;
                    cell.onmouseenter = () => { if(dy !== currentDy) cell.style.background = '#e9ecef'; };
                    cell.onmouseleave = () => { if(dy !== currentDy) cell.style.background = ''; };
                    cell.onclick = (e) => {
                        e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                        e.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º
                        if(dyEl) {
                            dyEl.value = dy;
                            // æ¸…é™¤æµæ—¶çš„é€‰æ‹©
                            const hrSel = document.getElementById('sel-hr');
                            if(hrSel) hrSel.value = '';
                            // å…ˆæ›´æ–°æµæ—¶è¡¨æ ¼ï¼Œç¡®ä¿sel-dyæœ‰å€¼
                            ZW.updateLiushiTable();
                            // ç„¶åæ›´æ–°æµè¿æ ‡è®°
                            ZW.updateFlow('dy');
                        }
                    };
                    content.appendChild(cell);
                }
            },
            
            updateLiushiTable: function() {
                const content = document.getElementById('liushi-content');
                if(!content) {
                    console.warn('updateLiushiTable: liushi-contentå…ƒç´ ä¸å­˜åœ¨');
                    return;
                }
                
                content.innerHTML = '';
                const dyEl = document.getElementById('sel-dy');
                const moEl = document.getElementById('sel-mo');
                if(!dyEl || !dyEl.value || !moEl || !moEl.value) {
                    // å¦‚æœæ²¡æœ‰é€‰æ‹©æµæ—¥æˆ–æµæœˆï¼Œæ˜¾ç¤ºæç¤º
                    let cell = document.createElement('div');
                    cell.style.cssText = 'padding: 8px 12px; color: #999; font-size: 11px;';
                    cell.innerText = 'è¯·å…ˆé€‰æ‹©æµæœˆå’Œæµæ—¥';
                    content.appendChild(cell);
                    return;
                }
                
                const yrEl = document.getElementById('sel-yr');
                if(!yrEl || !yrEl.value) return;
                
                const yr = parseInt(yrEl.value);
                const mo = parseInt(moEl.value);
                const dy = parseInt(dyEl.value);
                
                let lYr = Lunar.fromYmd(yr, 1, 1);
                let yZhi = ZHIS.indexOf(lYr.getYearZhi());
                let moIdx = (yZhi + mo - 1) % 12;
                let dyIdx = (moIdx + dy - 1) % 12;
                
                const hrEl = document.getElementById('sel-hr');
                const currentHr = hrEl && hrEl.value !== '' ? parseInt(hrEl.value) : null;
                
                for(let hr = 0; hr < 12; hr++) {
                    let hrIdx = (dyIdx + hr) % 12;
                    
                    let cell = document.createElement('div');
                    cell.style.cssText = 'padding: 8px 12px; border-right: 1px solid #ddd; cursor: pointer; white-space: nowrap; min-width: 80px; text-align: center; transition: background 0.2s; position: relative; z-index: 10;';
                    if(hr === currentHr) {
                        cell.style.background = '#fff3cd';
                    }
                    cell.innerHTML = `${ZHIS[hr]}æ—¶`;
                    cell.onmouseenter = () => { if(hr !== currentHr) cell.style.background = '#e9ecef'; };
                    cell.onmouseleave = () => { if(hr !== currentHr) cell.style.background = ''; };
                    cell.onclick = (e) => {
                        e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                        e.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º
                        if(hrEl) {
                            hrEl.value = hr;
                            ZW.updateFlow('hr');
                        }
                    };
                    content.appendChild(cell);
                }
            },

            addLimit: function(i, txt, bg) {
                let d = document.getElementById(`lim-${i}`);
                if(!d) return;
                // å…ˆæ¸…é™¤ç›¸åŒæ–‡æœ¬çš„æ—§æ ‡è®°ï¼Œé¿å…é‡å¤æ·»åŠ 
                Array.from(d.children).forEach(child => {
                    if(child.classList.contains('limit-tag') && child.innerText.trim() === txt.trim()) {
                        child.remove();
                    }
                });
                let s = document.createElement('span');
                s.className = 'limit-tag';
                s.innerText = txt;
                d.appendChild(s);
            },
            
            addFlowStar: function(i, txt) {
                let d = document.getElementById(`s-sub-${i}`);
                if(!d) return;
                let s = document.createElement('span');
                s.className = 'star s-flow';
                s.setAttribute('data-order', 5); // æµæ›œ - ç¬¬äº”ä¼˜å…ˆçº§ï¼ˆæœ€åï¼‰
                // å°†åç§°æ‹†åˆ†æˆå•ä¸ªå­—ç¬¦å¹¶ç«–å‘æ’åˆ—
                let chars = txt.split('');
                chars.forEach(char => {
                    let charSpan = document.createElement('span');
                    charSpan.className = 'star-char';
                    charSpan.innerText = char;
                    s.appendChild(charSpan);
                });
                
                // æŒ‰ç…§é¡ºåºæ’å…¥ï¼ˆæµæ›œåº”è¯¥åœ¨æœ€åï¼‰
                let children = Array.from(d.children);
                let insertIndex = children.findIndex(child => {
                    let childOrder = parseInt(child.getAttribute('data-order') || '999');
                    return childOrder > 5;
                });
                
                if(insertIndex === -1) {
                    d.appendChild(s);
                } else {
                    d.insertBefore(s, children[insertIndex]);
                }
            },

            flyHua: function(gan, label, cls, limitIdx=null) {
                const TABLE = {
                    'ç”²':['å»‰è´','ç ´å†›','æ­¦æ›²','å¤ªé˜³'], 'ä¹™':['å¤©æœº','å¤©æ¢','ç´«å¾®','å¤ªé˜´'],
                    'ä¸™':['å¤©åŒ','å¤©æœº','æ–‡æ˜Œ','å»‰è´'], 'ä¸':['å¤ªé˜´','å¤©åŒ','å¤©æœº','å·¨é—¨'],
                    'æˆŠ':['è´ªç‹¼','å¤ªé˜´','å³å¼¼','å¤©æœº'], 'å·±':['æ­¦æ›²','è´ªç‹¼','å¤©æ¢','æ–‡æ›²'],
                    'åºš':['å¤ªé˜³','æ­¦æ›²','å¤ªé˜´','å¤©åŒ'], 'è¾›':['å·¨é—¨','å¤ªé˜³','æ–‡æ›²','æ–‡æ˜Œ'],
                    'å£¬':['å¤©æ¢','ç´«å¾®','å·¦è¾…','æ­¦æ›²'], 'ç™¸':['ç ´å†›','å·¨é—¨','å¤ªé˜´','è´ªç‹¼']
                };
                const TYPES = ['h-lu','h-quan','h-ke','h-ji'];
                const CHARS = ['ç¦„','æƒ','ç§‘','å¿Œ'];
                
                let stars = TABLE[GANS[gan]];
                if(!stars) return;
                
                const ziweiSection = document.getElementById('ziwei');
                if(!ziweiSection) return;
                
                stars.forEach((sn, k) => {
                    let doms = ziweiSection.querySelectorAll('.star');
                    doms.forEach(el => {
                        if(limitIdx!==null) {
                            let pid = parseInt(el.parentElement.parentElement.id.split('-')[1]);
                            if(pid !== limitIdx) return;
                        }
                        // ä½¿ç”¨ textContent åŒ¹é…ï¼Œå› ä¸ºæ˜Ÿå®¿åç§°å·²æ‹†åˆ†æˆå­—ç¬¦
                        if(el.textContent === sn || el.textContent.replace(/\s/g, '') === sn) {
                            let b = document.createElement('span');
                            b.className = `hua ${TYPES[k]}`;
                            // ç«–æ’æ˜¾ç¤ºï¼šæ ‡ç­¾åœ¨ä¸Šï¼Œå­—ç¬¦åœ¨ä¸‹
                            let tagSpan = document.createElement('span');
                            tagSpan.className = 'h-tag';
                            tagSpan.innerText = label;
                            tagSpan.style.display = 'block';
                            tagSpan.style.lineHeight = '1';
                            let charSpan = document.createElement('span');
                            charSpan.className = 'h-char';
                            charSpan.innerText = CHARS[k];
                            charSpan.style.display = 'block';
                            charSpan.style.lineHeight = '1';
                            b.appendChild(tagSpan);
                            b.appendChild(charSpan);
                            el.appendChild(b);
                            
                            // #region agent log
                            fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:flyHua',message:'æ·»åŠ å››åŒ–æ ‡è®°',data:{starName:sn,label:label,char:CHARS[k],type:TYPES[k]},timestamp:Date.now(),sessionId:'debug-session',runId:'hua-vertical',hypothesisId:'A'})}).catch(()=>{});
                            // #endregion
                        }
                    });
                });
            },

            setTaiji: function(idx) {
                const ziweiSection = document.getElementById('ziwei');
                if(!ziweiSection) return;
                ziweiSection.querySelectorAll('.palace').forEach(p => {
                    p.classList.remove('active','sanfang','duigong');
                    const rel = p.querySelector('.rel-label');
                    if(rel) rel.innerText = '';
                });
                let p = document.getElementById(`p-${idx}`);
                if(p) {
                    p.classList.add('active');
                    
                    // ä¸‰æ–¹å››æ­£
                    [4,8].forEach(o => {
                        const pal = document.getElementById(`p-${(idx+o)%12}`);
                        if(pal) pal.classList.add('sanfang');
                    });
                    const duigong = document.getElementById(`p-${(idx+6)%12}`);
                    if(duigong) duigong.classList.add('duigong');
                    
                    // å…³ç³»
                    const R = ['å‘½','å…„','å¤«','å­','è´¢','ç–¾','è¿','å‹','å®˜','ç”°','ç¦','çˆ¶'];
                    for(let i=0; i<12; i++) {
                        if(i===idx) continue;
                        let rel = (i - idx + 12)%12;
                        const relEl = document.getElementById(`rel-${i}`);
                        if(relEl) relEl.innerText = R[rel];
                    }
                }
            },

            renderCenter: function() {
                console.log('=== renderCenterå¼€å§‹æ‰§è¡Œ ===', {
                    lunar: !!this.lunar, 
                    solar: !!this.solar,
                    gender: this.gender,
                    wuxing: this.wuxing,
                    mingIdx: this.mingIdx
                });
                
                // æ£€æŸ¥center-zoneå…ƒç´ æ˜¯å¦å­˜åœ¨
                const centerZone = document.querySelector('.center-zone');
                console.log('center-zoneå…ƒç´ :', !!centerZone);
                
                if(!this.lunar || !this.solar) {
                    console.error('renderCenter: lunaræˆ–solaræœªå®šä¹‰', {
                        lunar: this.lunar,
                        solar: this.solar
                    });
                    return;
                }
                
                try {
                    // å§“å
                    const nameInput = document.getElementById('name');
                    const txtName = document.getElementById('txt-name');
                    console.log('å§“åå…ƒç´ :', {nameInput: !!nameInput, txtName: !!txtName});
                    if(txtName) {
                        txtName.innerText = (nameInput && nameInput.value.trim()) ? nameInput.value.trim() : 'åŒ¿å';
                    }
                
                // æ€§åˆ«å’Œäº”è¡Œå±€ï¼ˆæ–‡å¢¨å¤©æœºæ ¼å¼ï¼šé˜³ç”·: æœ¨ä¸‰å±€ï¼‰
                const txtGenderWuxing = document.getElementById('txt-gender-wuxing');
                if(txtGenderWuxing) {
                    const genderText = this.gender === 1 ? 'é˜³ç”·' : 'é˜´å¥³';
                    const wuxingText = ['','','æ°´äºŒå±€','æœ¨ä¸‰å±€','é‡‘å››å±€','åœŸäº”å±€','ç«å…­å±€'][this.wuxing] || '';
                    txtGenderWuxing.innerHTML = `<span style="font-weight: bold;">${genderText}:</span> ${wuxingText}`;
                }
                
                // çœŸå¤ªé˜³æ—¶å’Œé’Ÿè¡¨æ—¶é—´
                const birthDateInput = document.getElementById('birth-date');
                if(birthDateInput && birthDateInput.value) {
                    const clockDate = new Date(birthDateInput.value);
                    const txtClockTime = document.getElementById('txt-clock-time');
                    if(txtClockTime) {
                        const year = clockDate.getFullYear();
                        const month = String(clockDate.getMonth() + 1).padStart(2, '0');
                        const day = String(clockDate.getDate()).padStart(2, '0');
                        const hour = String(clockDate.getHours()).padStart(2, '0');
                        const minute = String(clockDate.getMinutes()).padStart(2, '0');
                        txtClockTime.innerText = `${year}-${month}-${day} ${hour}:${minute}`;
                    }
                    
                    const txtTrueSolarTime = document.getElementById('txt-true-solar-time');
                    if(txtTrueSolarTime) {
                        const trueSolarStr = this.solar.toYmdHms();
                        txtTrueSolarTime.innerText = trueSolarStr.slice(0, 16);
                    }
                }
                
                // å†œå†ï¼ˆæ–‡å¢¨å¤©æœºæ ¼å¼ï¼šäºŒâ—‹äºŒäº”å¹´å†¬æœˆå»¿å››ï¼‰
                const txtLunarDate = document.getElementById('txt-lunar-date');
                if(txtLunarDate) {
                    const lunarYear = this.lunar.getYearInChinese();
                    const lunarMonth = this.lunar.getMonthInChinese();
                    const lunarDay = this.lunar.getDayInChinese();
                    txtLunarDate.innerText = lunarYear + lunarMonth + lunarDay;
                }
                
                // å‘½ä¸»ã€èº«ä¸»ã€å­æ–—ï¼ˆæ–‡å¢¨å¤©æœºæ ¼å¼ï¼šå‘½ä¸»: ç ´å†› èº«ä¸»: å¤©æœº å­æ–—: å·³ï¼‰
                const txtMingzhu = document.getElementById('txt-mingzhu');
                const mingzhuText = ['è´ªç‹¼','å·¨é—¨','ç¦„å­˜','æ–‡æ›²','å»‰è´','æ­¦æ›²','ç ´å†›','æ­¦æ›²','å»‰è´','æ–‡æ›²','ç¦„å­˜','å·¨é—¨'][this.mingIdx];
                if(txtMingzhu) txtMingzhu.innerText = mingzhuText;
                
                const txtShenzhu = document.getElementById('txt-shenzhu');
                const shenzhuText = ['é“ƒæ˜Ÿ','å¤©ç›¸','å¤©æ¢','å¤©åŒ','æ–‡æ˜Œ','å¤©æœº','ç«æ˜Ÿ','å¤©ç›¸','å¤©æ¢','å¤©åŒ','æ–‡æ˜Œ','å¤©æœº'][ZHIS.indexOf(this.lunar.getYearZhi())];
                if(txtShenzhu) txtShenzhu.innerText = shenzhuText;
                
                const txtZidou = document.getElementById('txt-zidou');
                const zidouZhi = this.lunar.getYearZhi();
                if(txtZidou) txtZidou.innerText = zidouZhi;
                
                // èŠ‚æ°”å››æŸ±å’ŒéèŠ‚æ°”å››æŸ±
                let bz, yearGan, yearZhi, monthGan, monthZhi, dayGan, dayZhi, timeGan, timeZhi;
                try {
                    bz = this.lunar.getEightChar();
                    yearGan = bz.getYearGan();
                    yearZhi = bz.getYearZhi();
                    monthGan = bz.getMonthGan();
                    monthZhi = bz.getMonthZhi();
                    dayGan = bz.getDayGan();
                    dayZhi = bz.getDayZhi();
                    timeGan = bz.getTimeGan();
                    timeZhi = bz.getTimeZhi();
                } catch(e) {
                    console.error('è·å–å…«å­—å¤±è´¥:', e);
                    return;
                }
                
                // èŠ‚æ°”å››æŸ±ï¼ˆæ–‡å¢¨å¤©æœºæ ¼å¼ï¼šä¸¤è¡Œï¼Œå¤©å¹²åœ°æ”¯ï¼‰
                const baziJieqi = document.getElementById('bazi-jieqi');
                if(baziJieqi) {
                    baziJieqi.innerHTML = `
                        <div>${yearGan}${monthGan}${dayGan}${timeGan}</div>
                        <div>${yearZhi}${monthZhi}${dayZhi}${timeZhi}</div>
                    `;
                }
                
                // éèŠ‚æ°”å››æŸ±ï¼ˆæ–‡å¢¨å¤©æœºæ ¼å¼ï¼šä¸¤è¡Œï¼Œå¤©å¹²åœ°æ”¯ï¼‰
                const baziNormal = document.getElementById('bazi-normal');
                if(baziNormal) {
                    baziNormal.innerHTML = `
                        <div>${yearGan}${monthGan}${dayGan}${timeGan}</div>
                        <div>${yearZhi}${monthZhi}${dayZhi}${timeZhi}</div>
                    `;
                }
                
                // å¤§è¿ä¿¡æ¯ï¼ˆç®€åŒ–æ˜¾ç¤ºï¼Œå®é™…å¤§è¿è®¡ç®—è¾ƒå¤æ‚ï¼‰
                const txtDayunStart = document.getElementById('txt-dayun-start');
                const txtDayun = document.getElementById('txt-dayun');
                if(txtDayunStart || txtDayun) {
                    // è¿™é‡Œå¯ä»¥åç»­æ·»åŠ å®Œæ•´çš„å¤§è¿è®¡ç®—é€»è¾‘
                    // æš‚æ—¶æ˜¾ç¤ºæç¤ºä¿¡æ¯
                    if(txtDayunStart) {
                        txtDayunStart.innerText = 'å¤§è¿ä¿¡æ¯ï¼ˆå¾…å®Œå–„ï¼‰';
                    }
                    if(txtDayun) {
                        txtDayun.innerHTML = '';
                    }
                }
                } catch(e) {
                    console.error('renderCenteré”™è¯¯:', e);
                    console.error('é”™è¯¯å †æ ˆ:', e.stack);
                }
                console.log('renderCenteræ‰§è¡Œå®Œæˆ');
            }
        };

        // Excel å¤šSheetç­›é€‰å·¥å…·
        const EXCEL = {
            wb: null,
            sheets: [],
            currSheetIdx: 0,
            data: [], headers: [],

            load: function(input) {
                let f = input.files[0];
                if(!f) return;
                let r = new FileReader();
                r.onload = e => {
                    this.wb = XLSX.read(e.target.result, {type:'binary'});
                    this.sheets = this.wb.SheetNames;
                    this.renderSheetTabs();
                    this.switchSheet(0);
                    const emptyMsg = document.getElementById('empty-msg');
                    if(emptyMsg) emptyMsg.style.display = 'none';
                };
                r.readAsBinaryString(f);
            },

            renderSheetTabs: function() {
                let div = document.getElementById('sheet-tabs');
                if(!div) return;
                div.innerHTML = '';
                if(this.sheets.length > 1) {
                    div.classList.remove('hidden');
                    this.sheets.forEach((name, i) => {
                        let btn = document.createElement('button');
                        btn.className = `px-2 py-1 border rounded bg-gray-100 hover:bg-gray-200 whitespace-nowrap ${i===0?'bg-blue-100 border-blue-300 text-blue-700':''}`;
                        btn.innerText = name;
                        btn.onclick = () => this.switchSheet(i, btn);
                        div.appendChild(btn);
                    });
                } else {
                    div.classList.add('hidden');
                }
            },

            switchSheet: function(idx, btn) {
                this.currSheetIdx = idx;
                if(btn) {
                    Array.from(btn.parentElement.children).forEach(b => b.className = b.className.replace('bg-blue-100 border-blue-300 text-blue-700', 'bg-gray-100'));
                    btn.className = btn.className.replace('bg-gray-100', 'bg-blue-100 border-blue-300 text-blue-700');
                }
                
                let ws = this.wb.Sheets[this.sheets[idx]];
                this.data = XLSX.utils.sheet_to_json(ws, {header:1});
                if(this.data.length) {
                    this.headers = this.data[0];
                    this.renderCols();
                    this.renderTable();
                } else {
                    const thead = document.getElementById('t-head');
                    const tbody = document.getElementById('t-body');
                    if(thead) thead.innerHTML = '';
                    if(tbody) tbody.innerHTML = '<tr><td colspan="10" class="text-center">ç©ºè¡¨</td></tr>';
                }
            },

            renderCols: function() {
                let div = document.getElementById('col-filters');
                if(!div) return;
                div.innerHTML = '';
                this.headers.forEach((h, i) => {
                    let lbl = document.createElement('label');
                    lbl.className = 'flex items-center bg-white border px-2 py-1 rounded cursor-pointer hover:bg-gray-50';
                    lbl.innerHTML = `<input type="checkbox" checked value="${i}" onchange="EXCEL.renderTable()" class="mr-1"> ${h}`;
                    div.appendChild(lbl);
                });
            },

            renderTable: function() {
                const colFilters = document.querySelectorAll('#col-filters input:checked');
                let idxs = Array.from(colFilters).map(e=>parseInt(e.value));
                
                let thead = document.getElementById('t-head');
                if(thead) {
                    thead.innerHTML = '';
                    idxs.forEach(i => {
                        let th = document.createElement('th');
                        th.innerText = this.headers[i];
                        thead.appendChild(th);
                    });
                }
                
                let tbody = document.getElementById('t-body');
                if(tbody) {
                    tbody.innerHTML = '';
                    this.data.slice(1, 200).forEach(row => {
                        let tr = document.createElement('tr');
                        idxs.forEach(i => {
                            let td = document.createElement('td');
                            td.innerText = row[i] || '';
                            tr.appendChild(td);
                        });
                        tbody.appendChild(tr);
                    });
                }
            },

            export: function() {
                if(!this.wb) return;
                let t = document.getElementById('data-table');
                if(!t) return;
                let newWb = XLSX.utils.table_to_book(t);
                XLSX.writeFile(newWb, `ç­›é€‰ç»“æœ_${this.sheets[this.currSheetIdx]}.xlsx`);
            }
        };

        // ================== çœŸå¤ªé˜³æ—¶ç»çº¬åº¦æ’ä»¶ (æ™ºèƒ½é€‚é…ç‰ˆ v5.0) ==================
        // åŠŸèƒ½ï¼šè‡ªåŠ¨åŠ«æŒæ’ç›˜æ—¶é—´ï¼Œæ³¨å…¥ç»çº¬åº¦æ§åˆ¶é¢æ¿
        (function() {
            // 1. å®‰å…¨å¯åŠ¨æ£€æµ‹ï¼šæ¯ 300ms æ£€æŸ¥ä¸€æ¬¡ ZW å¯¹è±¡å’Œè¾“å…¥æ¡†æ˜¯å¦å‡†å¤‡å¥½
            var initTimer = setInterval(function() {
                var dateInput = document.getElementById('birth-date');
                // åªæœ‰å½“ ZWå¯¹è±¡å­˜åœ¨ã€Solaråº“å­˜åœ¨ã€ä¸”é¡µé¢ä¸Šçš„æ—¥æœŸè¾“å…¥æ¡†å­˜åœ¨æ—¶ï¼Œæ‰å¯åŠ¨
                if (typeof ZW !== 'undefined' && typeof Solar !== 'undefined' && dateInput) {
                    clearInterval(initTimer); // åœæ­¢æ£€æµ‹
                    console.log("ç´«å¾®æ–—æ•°å¼•æ“æ£€æµ‹é€šè¿‡ï¼Œæ­£åœ¨åŠ è½½çœŸå¤ªé˜³æ—¶æ’ä»¶...");
                    startPlugin(dateInput);
                }
            }, 300);

            function startPlugin(dateInput) {
                try {
                    // === å†…éƒ¨é…ç½®çŠ¶æ€ ===
                    var STATE = {
                        enable: false, // é»˜è®¤å…³é—­
                        lon: 120.0,    // é»˜è®¤ç»åº¦
                        lat: 30.0,     // é»˜è®¤çº¬åº¦
                        isSouthern: false // æ˜¯å¦å—åŠçƒ
                    };

                    // === A. æ ¸å¿ƒæ‹¦æˆªé€»è¾‘ (æ ¸å¿ƒæŠ€æœ¯) ===
                    // ä¿å­˜åŸå§‹çš„ Solar.fromDate æ–¹æ³•
                    var originalSolarFromDate = Solar.fromDate;

                    // é‡å†™è¯¥æ–¹æ³•ï¼Œè®© ZW.calc åœ¨è°ƒç”¨å®ƒæ—¶ï¼Œä¸çŸ¥ä¸è§‰åœ°æ‹¿åˆ°ä¿®æ­£åçš„æ—¶é—´
                    Solar.fromDate = function(date) {
                        // åªæœ‰åœ¨å¼€å…³å¼€å¯ï¼Œä¸”ä¼ å…¥çš„æ˜¯ Date å¯¹è±¡æ—¶æ‰ä¿®æ­£
                        if (STATE.enable && date instanceof Date) {
                            try {
                                // 1. ç»åº¦æ—¶å·®: (å½“åœ°ç»åº¦ - 120) * 4åˆ†é’Ÿ
                                var lonOffset = (STATE.lon - 120.0) * 4 * 60 * 1000;

                                // 2. å‡æ—¶å·® (EOT) è®¡ç®—
                                var start = new Date(date.getFullYear(), 0, 0);
                                var diff = date - start;
                                var day = Math.floor(diff / (1000 * 60 * 60 * 24));
                                var b = 2 * Math.PI * (day - 81) / 365;
                                var eotMin = 9.87 * Math.sin(2 * b) - 7.53 * Math.cos(b) - 1.5 * Math.sin(b);
                                var eotOffset = eotMin * 60 * 1000;

                                // 3. è®¡ç®—ä¿®æ­£åçš„æ—¶é—´
                                var totalOffset = lonOffset + eotOffset;
                                var trueDate = new Date(date.getTime() + totalOffset);

                                // 4. æ ‡è®°å—åŠçƒ (çº¬åº¦ < 0)
                                STATE.isSouthern = (STATE.lat < 0);

                                // 5. æ›´æ–° UI æç¤ºæ–‡å­—
                                updateUIFeedback(trueDate, totalOffset);

                                // 6. è¿”å›ä¿®æ­£åçš„æ—¶é—´ç»™ ZW å¼•æ“
                                return originalSolarFromDate(trueDate);

                            } catch (e) {
                                console.error("çœŸå¤ªé˜³æ—¶è®¡ç®—é”™è¯¯:", e);
                                return originalSolarFromDate(date); // å‡ºé”™åˆ™å›é€€
                            }
                        } 
                        
                        // å…³é—­çŠ¶æ€ï¼šéšè—æç¤ºï¼Œä½¿ç”¨åŸå§‹æ—¶é—´
                        var feedback = document.getElementById('ts-feedback');
                        if(feedback) feedback.style.display = 'none';
                        return originalSolarFromDate(date);
                    };

                    // === B. ç•Œé¢æ³¨å…¥é€»è¾‘ ===
                    // åˆ›å»ºä¸€ä¸ªæ§åˆ¶å®¹å™¨ï¼Œæ”¾åœ¨åŸºç¡€æ’ç›˜è¡Œï¼ˆå’Œæ€§åˆ«ã€æ—¥æœŸè¾“å…¥æ¡†åœ¨ä¸€èµ·ï¼‰
                    var container = document.getElementById('ts-container');
                    if(!container) {
                        container = document.createElement('div');
                        container.id = 'ts-container';
                        var baseRow = dateInput.parentNode;
                        if(baseRow) baseRow.appendChild(container);
                    }
                    // ä½¿ç”¨ Flex å¸ƒå±€ï¼Œæ”¾åœ¨åŸºç¡€æ’ç›˜è¡Œ
                    container.className = "flex flex-wrap items-center gap-0.5 text-sm";
                    
                    container.innerHTML = `
                        <!-- å¼€å…³ -->
                        <label class="flex items-center cursor-pointer hover:text-red-700 font-bold select-none mr-0.5" title="å¯ç”¨çœŸå¤ªé˜³æ—¶æ ¡æ­£">
                            <input type="checkbox" id="ts-switch" class="mr-0.5 w-3.5 h-3.5 accent-red-600">çœŸå¤ªé˜³
                        </label>
                        
                        <!-- åŸå¸‚é€‰æ‹©æŒ‰é’® -->
                        <button id="ts-city-btn" type="button" class="text-green-600 hover:text-green-800 px-0 py-0 text-xs" title="é€‰æ‹©å‡ºç”ŸåŸå¸‚" style="min-width: 16px; font-size: 11px; margin: 0 1px;">
                            <i class="fa fa-map-marker" style="font-size: 11px;"></i>
                        </button>
                        
                        <!-- å®šä½æŒ‰é’® -->
                        <button id="ts-loc-btn" type="button" class="text-blue-600 hover:text-blue-800 px-0 py-0 text-xs" title="ç‚¹å‡»è‡ªåŠ¨è·å–ç»çº¬åº¦" style="min-width: 16px; font-size: 11px; margin: 0 1px;">
                            <i class="fa fa-location-arrow" style="font-size: 11px;"></i>
                        </button>
                        
                        <!-- ç»çº¬åº¦è¾“å…¥æ¡† (é»˜è®¤éšè—) -->
                        <div id="ts-inputs" class="hidden flex-row items-center gap-0.5 ml-0.5">
                            <div class="flex items-center border rounded bg-white px-0.5 shadow-sm">
                                <span class="text-gray-400 text-xs mr-0.5 select-none">ç»</span>
                                <input type="number" id="ts-lon" value="120.0" step="0.1" class="w-14 text-center outline-none text-xs py-0.5 font-mono" placeholder="120">
                            </div>
                            <div class="flex items-center border rounded bg-white px-0.5 shadow-sm">
                                <span class="text-gray-400 text-xs mr-0.5 select-none">çº¬</span>
                                <input type="number" id="ts-lat" value="30.0" step="0.1" class="w-12 text-center outline-none text-xs py-0.5 font-mono" placeholder="30">
                            </div>
                        </div>

                        <!-- ç»“æœåé¦ˆ (æ˜¾ç¤ºä¿®æ­£äº†å¤šå°‘åˆ†é’Ÿ) -->
                        <div id="ts-feedback" class="hidden items-center px-1 py-0.5 bg-yellow-50 border border-yellow-200 rounded text-xs whitespace-nowrap text-gray-700"></div>
                    `;

                    // === å…¨å›½çœä»½åœ°çº§å¸‚æ•°æ®ï¼ˆæ²¿æµ·+ä¸æ²¿æµ·ï¼‰ ===
                    var COASTAL_CITIES = {
                        'è¾½å®': [
                            {name: 'å¤§è¿', lon: 121.6147, lat: 38.9140},
                            {name: 'ä¸¹ä¸œ', lon: 124.3840, lat: 40.1290},
                            {name: 'è¥å£', lon: 122.2350, lat: 40.6670},
                            {name: 'ç›˜é”¦', lon: 122.0707, lat: 41.1199},
                            {name: 'é”¦å·', lon: 121.1270, lat: 41.0950},
                            {name: 'è‘«èŠ¦å²›', lon: 120.8360, lat: 40.7110},
                            {name: 'æ²ˆé˜³', lon: 123.4315, lat: 41.8057}
                        ],
                        'æ²³åŒ—': [
                            {name: 'ç§¦çš‡å²›', lon: 119.6005, lat: 39.9354},
                            {name: 'å”å±±', lon: 118.1802, lat: 39.6309},
                            {name: 'æ²§å·', lon: 116.8388, lat: 38.3045},
                            {name: 'çŸ³å®¶åº„', lon: 114.5149, lat: 38.0428}
                        ],
                        'å¤©æ´¥': [
                            {name: 'å¤©æ´¥', lon: 117.2008, lat: 39.0842}
                        ],
                        'å±±ä¸œ': [
                            {name: 'é’å²›', lon: 120.3826, lat: 36.0671},
                            {name: 'çƒŸå°', lon: 121.3914, lat: 37.5393},
                            {name: 'å¨æµ·', lon: 122.1204, lat: 37.5133},
                            {name: 'æ—¥ç…§', lon: 119.5269, lat: 35.4167},
                            {name: 'æ½åŠ', lon: 119.1071, lat: 36.7069},
                            {name: 'ä¸œè¥', lon: 118.6746, lat: 37.4348},
                            {name: 'æ»¨å·', lon: 117.9707, lat: 37.3820},
                            {name: 'æµå—', lon: 117.0009, lat: 36.6512}
                        ],
                        'æ±Ÿè‹': [
                            {name: 'è¿äº‘æ¸¯', lon: 119.1788, lat: 34.6000},
                            {name: 'ç›åŸ', lon: 120.1398, lat: 33.3776},
                            {name: 'å—é€š', lon: 120.8564, lat: 32.0162},
                            {name: 'è‹å·', lon: 120.5853, lat: 31.2989},
                            {name: 'æ— é”¡', lon: 120.3013, lat: 31.4912},
                            {name: 'å¸¸å·', lon: 119.9739, lat: 31.8108},
                            {name: 'å—äº¬', lon: 118.8062, lat: 32.0581}
                        ],
                        'ä¸Šæµ·': [
                            {name: 'ä¸Šæµ·', lon: 121.4737, lat: 31.2304}
                        ],
                        'æµ™æ±Ÿ': [
                            {name: 'æ­å·', lon: 120.1551, lat: 30.2741},
                            {name: 'å®æ³¢', lon: 121.5440, lat: 29.8683},
                            {name: 'æ¸©å·', lon: 120.6994, lat: 28.0006},
                            {name: 'å°å·', lon: 121.4208, lat: 28.6564},
                            {name: 'èˆŸå±±', lon: 122.2072, lat: 29.9853},
                            {name: 'å˜‰å…´', lon: 120.7509, lat: 30.7627},
                            {name: 'ç»å…´', lon: 120.5820, lat: 29.9974},
                            {name: 'æ¹–å·', lon: 120.0868, lat: 30.8944}
                        ],
                        'ç¦å»º': [
                            {name: 'ç¦å·', lon: 119.3062, lat: 26.0745},
                            {name: 'å¦é—¨', lon: 118.1100, lat: 24.4798},
                            {name: 'æ³‰å·', lon: 118.5859, lat: 24.9089},
                            {name: 'æ¼³å·', lon: 117.6760, lat: 24.5170},
                            {name: 'è†ç”°', lon: 119.0078, lat: 25.4541},
                            {name: 'å®å¾·', lon: 119.5272, lat: 26.6592},
                            {name: 'ä¸‰æ˜', lon: 117.6390, lat: 26.2650}
                        ],
                        'å¹¿ä¸œ': [
                            {name: 'å¹¿å·', lon: 113.2644, lat: 23.1291},
                            {name: 'æ·±åœ³', lon: 114.0579, lat: 22.5431},
                            {name: 'ç æµ·', lon: 113.5767, lat: 22.2707},
                            {name: 'æ±•å¤´', lon: 116.6819, lat: 23.3541},
                            {name: 'æ¹›æ±Ÿ', lon: 110.3647, lat: 21.2707},
                            {name: 'æ±Ÿé—¨', lon: 113.0819, lat: 22.5787},
                            {name: 'é˜³æ±Ÿ', lon: 111.9822, lat: 21.8579},
                            {name: 'èŒ‚å', lon: 110.9254, lat: 21.6629},
                            {name: 'æ±•å°¾', lon: 115.3753, lat: 22.7864},
                            {name: 'æƒ å·', lon: 114.4158, lat: 23.1104},
                            {name: 'ä¸œè', lon: 113.7518, lat: 23.0207},
                            {name: 'ä¸­å±±', lon: 113.3928, lat: 22.5170},
                            {name: 'æ½®å·', lon: 116.6226, lat: 23.6569},
                            {name: 'æ­é˜³', lon: 116.3728, lat: 23.5497}
                        ],
                        'å¹¿è¥¿': [
                            {name: 'åŒ—æµ·', lon: 109.1201, lat: 21.4733},
                            {name: 'é˜²åŸæ¸¯', lon: 108.3455, lat: 21.6174},
                            {name: 'é’¦å·', lon: 108.6541, lat: 21.9667},
                            {name: 'å—å®', lon: 108.3200, lat: 22.8170}
                        ],
                        'æµ·å—': [
                            {name: 'æµ·å£', lon: 110.3308, lat: 20.0221},
                            {name: 'ä¸‰äºš', lon: 109.5083, lat: 18.2479},
                            {name: 'ä¸‰æ²™', lon: 112.3387, lat: 16.8310},
                            {name: 'å„‹å·', lon: 109.5807, lat: 19.5209},
                            {name: 'ç¼æµ·', lon: 110.4669, lat: 19.2583},
                            {name: 'æ–‡æ˜Œ', lon: 110.7530, lat: 19.6129},
                            {name: 'ä¸‡å®', lon: 110.3888, lat: 18.7962},
                            {name: 'ä¸œæ–¹', lon: 108.6538, lat: 19.1010}
                        ],
                        // ä¸æ²¿æµ·çœä»½
                        'åŒ—äº¬': [
                            {name: 'åŒ—äº¬', lon: 116.4074, lat: 39.9042}
                        ],
                        'å±±è¥¿': [
                            {name: 'å¤ªåŸ', lon: 112.5489, lat: 37.8706},
                            {name: 'å¤§åŒ', lon: 113.3001, lat: 40.0768},
                            {name: 'é˜³æ³‰', lon: 113.5804, lat: 37.8569},
                            {name: 'é•¿æ²»', lon: 113.1163, lat: 36.1954},
                            {name: 'æ™‹åŸ', lon: 112.8513, lat: 35.4907},
                            {name: 'æœ”å·', lon: 112.4328, lat: 39.3316},
                            {name: 'æ™‹ä¸­', lon: 112.7527, lat: 37.6870},
                            {name: 'è¿åŸ', lon: 111.0069, lat: 35.0264},
                            {name: 'å¿»å·', lon: 112.7341, lat: 38.4167},
                            {name: 'ä¸´æ±¾', lon: 111.5189, lat: 36.0882},
                            {name: 'å•æ¢', lon: 111.1443, lat: 37.5183}
                        ],
                        'å†…è’™å¤': [
                            {name: 'å‘¼å’Œæµ©ç‰¹', lon: 111.7519, lat: 40.8414},
                            {name: 'åŒ…å¤´', lon: 109.8404, lat: 40.6569},
                            {name: 'ä¹Œæµ·', lon: 106.7942, lat: 39.6554},
                            {name: 'èµ¤å³°', lon: 118.8868, lat: 42.2578},
                            {name: 'é€šè¾½', lon: 122.2631, lat: 43.6174},
                            {name: 'é„‚å°”å¤šæ–¯', lon: 109.7811, lat: 39.6083},
                            {name: 'å‘¼ä¼¦è´å°”', lon: 119.7658, lat: 49.2116},
                            {name: 'å·´å½¦æ·–å°”', lon: 107.3870, lat: 40.7433},
                            {name: 'ä¹Œå…°å¯Ÿå¸ƒ', lon: 113.1337, lat: 40.9953},
                            {name: 'å…´å®‰ç›Ÿ', lon: 122.0695, lat: 46.0763},
                            {name: 'é”¡æ—éƒ­å‹’ç›Ÿ', lon: 116.0909, lat: 43.9440},
                            {name: 'é˜¿æ‹‰å–„ç›Ÿ', lon: 105.7289, lat: 38.8462}
                        ],
                        'å‰æ—': [
                            {name: 'é•¿æ˜¥', lon: 125.3235, lat: 43.8171},
                            {name: 'å‰æ—', lon: 126.5496, lat: 43.8379},
                            {name: 'å››å¹³', lon: 124.3508, lat: 43.1664},
                            {name: 'è¾½æº', lon: 125.1435, lat: 42.8880},
                            {name: 'é€šåŒ–', lon: 125.9365, lat: 41.7284},
                            {name: 'ç™½å±±', lon: 126.4239, lat: 41.9430},
                            {name: 'æ¾åŸ', lon: 124.8250, lat: 45.1412},
                            {name: 'ç™½åŸ', lon: 122.8387, lat: 45.6196},
                            {name: 'å»¶è¾¹', lon: 129.5089, lat: 42.9047}
                        ],
                        'é»‘é¾™æ±Ÿ': [
                            {name: 'å“ˆå°”æ»¨', lon: 126.5358, lat: 45.8020},
                            {name: 'é½é½å“ˆå°”', lon: 123.9181, lat: 47.3543},
                            {name: 'é¸¡è¥¿', lon: 130.9693, lat: 45.2952},
                            {name: 'é¹¤å²—', lon: 130.2774, lat: 47.3499},
                            {name: 'åŒé¸­å±±', lon: 131.1591, lat: 46.6469},
                            {name: 'å¤§åº†', lon: 125.1031, lat: 46.5876},
                            {name: 'ä¼Šæ˜¥', lon: 128.8411, lat: 47.7275},
                            {name: 'ä½³æœ¨æ–¯', lon: 130.3616, lat: 46.8096},
                            {name: 'ä¸ƒå°æ²³', lon: 131.0031, lat: 45.7717},
                            {name: 'ç‰¡ä¸¹æ±Ÿ', lon: 129.6329, lat: 44.5517},
                            {name: 'é»‘æ²³', lon: 127.5285, lat: 50.2453},
                            {name: 'ç»¥åŒ–', lon: 126.9929, lat: 46.6374},
                            {name: 'å¤§å…´å®‰å²­', lon: 124.7115, lat: 52.3352}
                        ],
                        'å®‰å¾½': [
                            {name: 'åˆè‚¥', lon: 117.2272, lat: 31.8206},
                            {name: 'èŠœæ¹–', lon: 118.3765, lat: 31.3263},
                            {name: 'èšŒåŸ ', lon: 117.3647, lat: 32.9397},
                            {name: 'æ·®å—', lon: 116.9999, lat: 32.6265},
                            {name: 'é©¬éå±±', lon: 118.5079, lat: 31.6894},
                            {name: 'æ·®åŒ—', lon: 116.7948, lat: 33.9548},
                            {name: 'é“œé™µ', lon: 117.8121, lat: 30.9454},
                            {name: 'å®‰åº†', lon: 117.0536, lat: 30.5255},
                            {name: 'é»„å±±', lon: 118.3370, lat: 29.7147},
                            {name: 'æ»å·', lon: 118.3163, lat: 32.3016},
                            {name: 'é˜œé˜³', lon: 115.8197, lat: 32.8969},
                            {name: 'å®¿å·', lon: 116.9841, lat: 33.6339},
                            {name: 'å…­å®‰', lon: 116.5077, lat: 31.7529},
                            {name: 'äº³å·', lon: 115.7789, lat: 33.8693},
                            {name: 'æ± å·', lon: 117.4892, lat: 30.6560},
                            {name: 'å®£åŸ', lon: 118.7588, lat: 30.9457}
                        ],
                        'æ±Ÿè¥¿': [
                            {name: 'å—æ˜Œ', lon: 115.8921, lat: 28.6765},
                            {name: 'æ™¯å¾·é•‡', lon: 117.2147, lat: 29.2926},
                            {name: 'èä¹¡', lon: 113.8522, lat: 27.6229},
                            {name: 'ä¹æ±Ÿ', lon: 115.9928, lat: 29.7120},
                            {name: 'æ–°ä½™', lon: 114.9308, lat: 27.8108},
                            {name: 'é¹°æ½­', lon: 117.0692, lat: 28.2602},
                            {name: 'èµ£å·', lon: 114.9350, lat: 25.8310},
                            {name: 'å‰å®‰', lon: 114.9864, lat: 27.1117},
                            {name: 'å®œæ˜¥', lon: 114.3911, lat: 27.8043},
                            {name: 'æŠšå·', lon: 116.3582, lat: 27.9838},
                            {name: 'ä¸Šé¥¶', lon: 117.9712, lat: 28.4444}
                        ],
                        'æ²³å—': [
                            {name: 'éƒ‘å·', lon: 113.6654, lat: 34.7579},
                            {name: 'å¼€å°', lon: 114.3074, lat: 34.7971},
                            {name: 'æ´›é˜³', lon: 112.4540, lat: 34.6197},
                            {name: 'å¹³é¡¶å±±', lon: 113.1927, lat: 33.7662},
                            {name: 'å®‰é˜³', lon: 114.3525, lat: 36.1034},
                            {name: 'é¹¤å£', lon: 114.2954, lat: 35.7472},
                            {name: 'æ–°ä¹¡', lon: 113.8839, lat: 35.3026},
                            {name: 'ç„¦ä½œ', lon: 113.2383, lat: 35.2390},
                            {name: 'æ¿®é˜³', lon: 115.0292, lat: 35.7618},
                            {name: 'è®¸æ˜Œ', lon: 113.8261, lat: 34.0229},
                            {name: 'æ¼¯æ²³', lon: 114.0168, lat: 33.5814},
                            {name: 'ä¸‰é—¨å³¡', lon: 111.2001, lat: 34.7733},
                            {name: 'å—é˜³', lon: 112.5283, lat: 32.9907},
                            {name: 'å•†ä¸˜', lon: 115.6505, lat: 34.4371},
                            {name: 'ä¿¡é˜³', lon: 114.0750, lat: 32.1234},
                            {name: 'å‘¨å£', lon: 114.6497, lat: 33.6204},
                            {name: 'é©»é©¬åº—', lon: 114.0247, lat: 32.9802},
                            {name: 'æµæº', lon: 112.6019, lat: 35.0671}
                        ],
                        'æ¹–åŒ—': [
                            {name: 'æ­¦æ±‰', lon: 114.3162, lat: 30.5810},
                            {name: 'é»„çŸ³', lon: 115.0770, lat: 30.2201},
                            {name: 'åå °', lon: 110.7879, lat: 32.6470},
                            {name: 'å®œæ˜Œ', lon: 111.2865, lat: 30.6920},
                            {name: 'è¥„é˜³', lon: 112.1441, lat: 32.0424},
                            {name: 'é„‚å·', lon: 114.8948, lat: 30.3919},
                            {name: 'è†é—¨', lon: 112.2043, lat: 31.0354},
                            {name: 'å­æ„Ÿ', lon: 113.9169, lat: 30.9246},
                            {name: 'è†å·', lon: 112.2397, lat: 30.3352},
                            {name: 'é»„å†ˆ', lon: 114.8793, lat: 30.4477},
                            {name: 'å’¸å®', lon: 114.3224, lat: 29.8328},
                            {name: 'éšå·', lon: 113.3825, lat: 31.6902},
                            {name: 'æ©æ–½', lon: 109.4867, lat: 30.2831}
                        ],
                        'æ¹–å—': [
                            {name: 'é•¿æ²™', lon: 112.9823, lat: 28.1941},
                            {name: 'æ ªæ´²', lon: 113.1339, lat: 27.8298},
                            {name: 'æ¹˜æ½­', lon: 112.9441, lat: 27.8297},
                            {name: 'è¡¡é˜³', lon: 112.5719, lat: 26.9004},
                            {name: 'é‚µé˜³', lon: 111.4677, lat: 27.2389},
                            {name: 'å²³é˜³', lon: 113.1329, lat: 29.3703},
                            {name: 'å¸¸å¾·', lon: 111.6913, lat: 29.0402},
                            {name: 'å¼ å®¶ç•Œ', lon: 110.4792, lat: 29.1274},
                            {name: 'ç›Šé˜³', lon: 112.3550, lat: 28.5540},
                            {name: 'éƒ´å·', lon: 113.0321, lat: 25.7936},
                            {name: 'æ°¸å·', lon: 111.6080, lat: 26.4345},
                            {name: 'æ€€åŒ–', lon: 109.9782, lat: 27.5501},
                            {name: 'å¨„åº•', lon: 111.9944, lat: 27.7000},
                            {name: 'æ¹˜è¥¿', lon: 109.7389, lat: 28.3143}
                        ],
                        'é‡åº†': [
                            {name: 'é‡åº†', lon: 106.5516, lat: 29.5630}
                        ],
                        'å››å·': [
                            {name: 'æˆéƒ½', lon: 104.0665, lat: 30.5723},
                            {name: 'è‡ªè´¡', lon: 104.7784, lat: 29.3390},
                            {name: 'æ”€æèŠ±', lon: 101.7186, lat: 26.5824},
                            {name: 'æ³¸å·', lon: 105.4433, lat: 28.8717},
                            {name: 'å¾·é˜³', lon: 104.3979, lat: 31.1268},
                            {name: 'ç»µé˜³', lon: 104.6791, lat: 31.4675},
                            {name: 'å¹¿å…ƒ', lon: 105.8297, lat: 32.4337},
                            {name: 'é‚å®', lon: 105.5929, lat: 30.5328},
                            {name: 'å†…æ±Ÿ', lon: 105.0584, lat: 29.5802},
                            {name: 'ä¹å±±', lon: 103.7657, lat: 29.5820},
                            {name: 'å—å……', lon: 106.1107, lat: 30.8378},
                            {name: 'çœ‰å±±', lon: 103.8317, lat: 30.0483},
                            {name: 'å®œå®¾', lon: 104.6432, lat: 28.7518},
                            {name: 'å¹¿å®‰', lon: 106.6334, lat: 30.4564},
                            {name: 'è¾¾å·', lon: 107.5023, lat: 31.2096},
                            {name: 'é›…å®‰', lon: 103.0010, lat: 29.9817},
                            {name: 'å·´ä¸­', lon: 106.7536, lat: 31.8588},
                            {name: 'èµ„é˜³', lon: 104.6419, lat: 30.1210},
                            {name: 'é˜¿å', lon: 102.2248, lat: 31.8994},
                            {name: 'ç”˜å­œ', lon: 101.9638, lat: 30.0505},
                            {name: 'å‡‰å±±', lon: 102.2587, lat: 27.8819}
                        ],
                        'è´µå·': [
                            {name: 'è´µé˜³', lon: 106.7135, lat: 26.5783},
                            {name: 'å…­ç›˜æ°´', lon: 104.8467, lat: 26.5926},
                            {name: 'éµä¹‰', lon: 106.9274, lat: 27.7257},
                            {name: 'å®‰é¡º', lon: 105.9462, lat: 26.2450},
                            {name: 'æ¯•èŠ‚', lon: 105.2850, lat: 27.3015},
                            {name: 'é“œä»', lon: 109.1915, lat: 27.7183},
                            {name: 'é»”è¥¿å—', lon: 104.8976, lat: 25.0881},
                            {name: 'é»”ä¸œå—', lon: 107.9828, lat: 26.5834},
                            {name: 'é»”å—', lon: 107.5171, lat: 26.2582}
                        ],
                        'äº‘å—': [
                            {name: 'æ˜†æ˜', lon: 102.7123, lat: 25.0406},
                            {name: 'æ›²é–', lon: 103.7978, lat: 25.5015},
                            {name: 'ç‰æºª', lon: 102.5439, lat: 24.3505},
                            {name: 'ä¿å±±', lon: 99.1671, lat: 25.1118},
                            {name: 'æ˜­é€š', lon: 103.7167, lat: 27.3370},
                            {name: 'ä¸½æ±Ÿ', lon: 100.2270, lat: 26.8555},
                            {name: 'æ™®æ´±', lon: 100.9724, lat: 22.7773},
                            {name: 'ä¸´æ²§', lon: 100.0869, lat: 23.8865},
                            {name: 'æ¥šé›„', lon: 101.5460, lat: 25.0430},
                            {name: 'çº¢æ²³', lon: 103.3846, lat: 23.3631},
                            {name: 'æ–‡å±±', lon: 104.2433, lat: 23.3690},
                            {name: 'è¥¿åŒç‰ˆçº³', lon: 100.7979, lat: 22.0094},
                            {name: 'å¤§ç†', lon: 100.2676, lat: 25.6065},
                            {name: 'å¾·å®', lon: 98.5894, lat: 24.4333},
                            {name: 'æ€’æ±Ÿ', lon: 98.8543, lat: 25.8506},
                            {name: 'è¿ªåº†', lon: 99.7022, lat: 27.8189}
                        ],
                        'è¥¿è—': [
                            {name: 'æ‹‰è¨', lon: 91.1145, lat: 29.6456},
                            {name: 'æ—¥å–€åˆ™', lon: 88.8806, lat: 29.2670},
                            {name: 'æ˜Œéƒ½', lon: 97.1784, lat: 31.1369},
                            {name: 'æ—èŠ', lon: 94.3614, lat: 29.6487},
                            {name: 'å±±å—', lon: 91.7731, lat: 29.2370},
                            {name: 'é‚£æ›²', lon: 92.0512, lat: 31.4762},
                            {name: 'é˜¿é‡Œ', lon: 80.1058, lat: 32.5011}
                        ],
                        'é™•è¥¿': [
                            {name: 'è¥¿å®‰', lon: 108.9398, lat: 34.3416},
                            {name: 'é“œå·', lon: 108.9792, lat: 34.9089},
                            {name: 'å®é¸¡', lon: 107.2379, lat: 34.3619},
                            {name: 'å’¸é˜³', lon: 108.7090, lat: 34.3334},
                            {name: 'æ¸­å—', lon: 109.4897, lat: 34.4993},
                            {name: 'å»¶å®‰', lon: 109.4897, lat: 36.5965},
                            {name: 'æ±‰ä¸­', lon: 107.0233, lat: 33.0778},
                            {name: 'æ¦†æ—', lon: 109.7346, lat: 38.2853},
                            {name: 'å®‰åº·', lon: 109.0293, lat: 32.6903},
                            {name: 'å•†æ´›', lon: 109.9399, lat: 33.8683}
                        ],
                        'ç”˜è‚ƒ': [
                            {name: 'å…°å·', lon: 103.8343, lat: 36.0613},
                            {name: 'å˜‰å³ªå…³', lon: 98.2891, lat: 39.7731},
                            {name: 'é‡‘æ˜Œ', lon: 102.1880, lat: 38.5142},
                            {name: 'ç™½é“¶', lon: 104.1736, lat: 36.5456},
                            {name: 'å¤©æ°´', lon: 105.7249, lat: 34.5809},
                            {name: 'æ­¦å¨', lon: 102.6347, lat: 37.9299},
                            {name: 'å¼ æ–', lon: 100.4498, lat: 38.9259},
                            {name: 'å¹³å‡‰', lon: 106.6652, lat: 35.5430},
                            {name: 'é…’æ³‰', lon: 98.4944, lat: 39.7324},
                            {name: 'åº†é˜³', lon: 107.6325, lat: 35.7380},
                            {name: 'å®šè¥¿', lon: 104.6263, lat: 35.5806},
                            {name: 'é™‡å—', lon: 104.9214, lat: 33.4007},
                            {name: 'ä¸´å¤', lon: 103.2105, lat: 35.5994},
                            {name: 'ç”˜å—', lon: 102.9110, lat: 34.9834}
                        ],
                        'é’æµ·': [
                            {name: 'è¥¿å®', lon: 101.7782, lat: 36.6171},
                            {name: 'æµ·ä¸œ', lon: 102.1043, lat: 36.5020},
                            {name: 'æµ·åŒ—', lon: 100.9009, lat: 36.9544},
                            {name: 'é»„å—', lon: 102.0199, lat: 35.5195},
                            {name: 'æµ·å—', lon: 100.6195, lat: 36.2803},
                            {name: 'æœæ´›', lon: 100.2447, lat: 34.4714},
                            {name: 'ç‰æ ‘', lon: 97.0086, lat: 33.0040},
                            {name: 'æµ·è¥¿', lon: 97.3708, lat: 37.3771}
                        ],
                        'å®å¤': [
                            {name: 'é“¶å·', lon: 106.2309, lat: 38.4872},
                            {name: 'çŸ³å˜´å±±', lon: 106.3830, lat: 39.0202},
                            {name: 'å´å¿ ', lon: 106.1984, lat: 37.9974},
                            {name: 'å›ºåŸ', lon: 106.2852, lat: 36.0045},
                            {name: 'ä¸­å«', lon: 105.1967, lat: 37.5002}
                        ],
                        'æ–°ç–†': [
                            {name: 'ä¹Œé²æœ¨é½', lon: 87.6168, lat: 43.8256},
                            {name: 'å…‹æ‹‰ç›ä¾', lon: 84.8739, lat: 45.5958},
                            {name: 'åé²ç•ª', lon: 89.1895, lat: 42.9513},
                            {name: 'å“ˆå¯†', lon: 93.5149, lat: 42.8332},
                            {name: 'æ˜Œå‰', lon: 87.3087, lat: 44.0146},
                            {name: 'åšå°”å¡”æ‹‰', lon: 82.0748, lat: 44.9032},
                            {name: 'å·´éŸ³éƒ­æ¥', lon: 86.1506, lat: 41.7685},
                            {name: 'é˜¿å…‹è‹', lon: 80.2606, lat: 41.1688},
                            {name: 'å…‹å­œå‹’è‹', lon: 76.1728, lat: 39.7153},
                            {name: 'å–€ä»€', lon: 75.9891, lat: 39.4676},
                            {name: 'å’Œç”°', lon: 79.9222, lat: 37.1141},
                            {name: 'ä¼ŠçŠ', lon: 81.3179, lat: 43.9219},
                            {name: 'å¡”åŸ', lon: 82.9798, lat: 46.7453},
                            {name: 'é˜¿å‹’æ³°', lon: 88.1318, lat: 47.8489}
                        ],
                        'å°æ¹¾': [
                            {name: 'å°åŒ—', lon: 121.5654, lat: 25.0320},
                            {name: 'æ–°åŒ—', lon: 121.4656, lat: 25.0169},
                            {name: 'æ¡ƒå›­', lon: 121.3010, lat: 24.9936},
                            {name: 'å°ä¸­', lon: 120.6739, lat: 24.1477},
                            {name: 'å°å—', lon: 120.2133, lat: 22.9994},
                            {name: 'é«˜é›„', lon: 120.3013, lat: 22.6273},
                            {name: 'åŸºéš†', lon: 121.7462, lat: 25.1276},
                            {name: 'æ–°ç«¹', lon: 120.9688, lat: 24.8038},
                            {name: 'å˜‰ä¹‰', lon: 120.4521, lat: 23.4799},
                            {name: 'å®œå…°', lon: 121.7535, lat: 24.7021},
                            {name: 'è‹—æ —', lon: 120.8189, lat: 24.5648},
                            {name: 'å½°åŒ–', lon: 120.5417, lat: 24.0815},
                            {name: 'å—æŠ•', lon: 120.6870, lat: 23.9098},
                            {name: 'äº‘æ—', lon: 120.5272, lat: 23.7079},
                            {name: 'å±ä¸œ', lon: 120.4879, lat: 22.6826},
                            {name: 'å°ä¸œ', lon: 121.1444, lat: 22.7559},
                            {name: 'èŠ±è²', lon: 121.6010, lat: 23.9739},
                            {name: 'æ¾æ¹–', lon: 119.5664, lat: 23.5655}
                        ]
                    };

                    // === C. äº‹ä»¶ç»‘å®š ===
                    var elSwitch = document.getElementById('ts-switch');
                    var elInputs = document.getElementById('ts-inputs');
                    var elLon = document.getElementById('ts-lon');
                    var elLat = document.getElementById('ts-lat');
                    var elBtn = document.getElementById('ts-loc-btn');
                    var elCityBtn = document.getElementById('ts-city-btn');

                    // 1. å¼€å…³åˆ‡æ¢
                    elSwitch.onchange = function() {
                        STATE.enable = this.checked;
                        elInputs.style.display = this.checked ? 'flex' : 'none'; // æ˜¾ç¤º/éšè—è¾“å…¥æ¡†
                        if (!this.checked) document.getElementById('ts-feedback').style.display = 'none';
                        ZW.calc(); // ï¼ï¼ï¼å…³é”®ï¼šè§¦å‘åŸç¨‹åºçš„é‡æ’é€»è¾‘ï¼ï¼ï¼
                    };

                    // 2. è¾“å…¥æ¡†æ•°å€¼æ”¹å˜
                    function onValChange() {
                        STATE.lon = parseFloat(elLon.value) || 120.0;
                        STATE.lat = parseFloat(elLat.value) || 30.0;
                        // é™åˆ¶ç»çº¬åº¦èŒƒå›´
                        if(STATE.lon > 180) STATE.lon = 180; if(STATE.lon < -180) STATE.lon = -180;
                        if(STATE.lat > 90) STATE.lat = 90;   if(STATE.lat < -90) STATE.lat = -90;
                        
                        if(STATE.enable) ZW.calc(); // è§¦å‘é‡æ’
                    }
                    elLon.onchange = onValChange;
                    elLat.onchange = onValChange;

                    // 3. åŸå¸‚é€‰æ‹©å¯¹è¯æ¡†
                    if(elCityBtn) {
                        elCityBtn.onclick = function() {
                            // ç§»é™¤å·²å­˜åœ¨çš„å¯¹è¯æ¡†
                            var oldDialog = document.getElementById('ts-city-dialog');
                            if(oldDialog) oldDialog.remove();
                            
                            // åˆ›å»ºå¯¹è¯æ¡†
                            var dialog = document.createElement('div');
                            dialog.id = 'ts-city-dialog';
                            dialog.style.cssText = 'position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
                            
                            var content = document.createElement('div');
                            content.style.cssText = 'background: white; border-radius: 8px; padding: 20px; min-width: 400px; max-width: 500px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative;';
                            
                            // ä¸–ç•Œå„å›½å®¶é¦–éƒ½å‡†ç¡®ç»çº¬åº¦æ•°æ®
                            var CAPITAL_COORDINATES = {
                                'ä¸œäº¬': {lon: 139.6917, lat: 35.6895},
                                'é¦–å°”': {lon: 126.9780, lat: 37.5665},
                                'å¹³å£¤': {lon: 125.7625, lat: 39.0392},
                                'ä¹Œå…°å·´æ‰˜': {lon: 106.9057, lat: 47.8864},
                                'æ²³å†…': {lon: 105.8342, lat: 21.0285},
                                'ä¸‡è±¡': {lon: 102.6331, lat: 17.9757},
                                'é‡‘è¾¹': {lon: 104.9160, lat: 11.5564},
                                'æ›¼è°·': {lon: 100.5018, lat: 13.7563},
                                'å†…æ¯”éƒ½': {lon: 96.1299, lat: 19.7633},
                                'å‰éš†å¡': {lon: 101.6869, lat: 3.1390},
                                'æ–°åŠ å¡': {lon: 103.8198, lat: 1.3521},
                                'é›…åŠ è¾¾': {lon: 106.8451, lat: -6.2088},
                                'æ–¯é‡Œå·´åŠ æ¹¾å¸‚': {lon: 114.9398, lat: 4.9031},
                                'é©¬å°¼æ‹‰': {lon: 120.9842, lat: 14.5995},
                                'å¸åŠ›': {lon: 125.5736, lat: -8.5569},
                                'æ–°å¾·é‡Œ': {lon: 77.2090, lat: 28.6139},
                                'ä¼Šæ–¯å…°å ¡': {lon: 73.0479, lat: 33.6844},
                                'è¾¾å¡': {lon: 90.4125, lat: 23.8103},
                                'ç§‘ä¼¦å¡': {lon: 79.8612, lat: 6.9271},
                                'é©¬ç´¯': {lon: 73.5089, lat: 4.1755},
                                'åŠ å¾·æ»¡éƒ½': {lon: 85.3240, lat: 27.7172},
                                'å»·å¸ƒ': {lon: 89.6390, lat: 27.4728},
                                'å–€å¸ƒå°”': {lon: 69.2075, lat: 34.5553},
                                'å¾·é»‘å…°': {lon: 51.3890, lat: 35.6892},
                                'å·´æ ¼è¾¾': {lon: 44.3661, lat: 33.3152},
                                'ç§‘å¨ç‰¹åŸ': {lon: 47.9774, lat: 29.3759},
                                'åˆ©é›…å¾—': {lon: 46.6753, lat: 24.7136},
                                'éº¦çº³éº¦': {lon: 50.5577, lat: 26.0667},
                                'å¤šå“ˆ': {lon: 51.5310, lat: 25.2854},
                                'é˜¿å¸ƒæ‰æ¯”': {lon: 54.3773, lat: 24.4539},
                                'é©¬æ–¯å–€ç‰¹': {lon: 58.4078, lat: 23.5859},
                                'è¨é‚£': {lon: 44.2067, lat: 15.3694},
                                'å®‰æ›¼': {lon: 35.9306, lat: 31.9539},
                                'è´é²ç‰¹': {lon: 35.5018, lat: 33.8938},
                                'å¤§é©¬å£«é©': {lon: 36.2765, lat: 33.5138},
                                'è€¶è·¯æ’’å†·': {lon: 35.2137, lat: 31.7683},
                                'æ‹‰å§†å®‰æ‹‰': {lon: 35.2062, lat: 31.9522},
                                'å®‰å¡æ‹‰': {lon: 32.8597, lat: 39.9334},
                                'ç¬¬æ¯”åˆ©æ–¯': {lon: 44.8271, lat: 41.7151},
                                'åŸƒé‡Œæ¸©': {lon: 44.5035, lat: 40.1811},
                                'å·´åº“': {lon: 49.8671, lat: 40.4093},
                                'é˜¿æ–¯å¡”çº³': {lon: 71.4306, lat: 51.1605},
                                'å¡”ä»€å¹²': {lon: 69.2401, lat: 41.2995},
                                'é˜¿ä»€å“ˆå·´å¾·': {lon: 58.3833, lat: 37.9601},
                                'æœå°šåˆ«': {lon: 68.7738, lat: 38.5598},
                                'æ¯”ä»€å‡¯å…‹': {lon: 74.5698, lat: 42.8746},
                                'è«æ–¯ç§‘': {lon: 37.6173, lat: 55.7558},
                                'ä¼¦æ•¦': {lon: -0.1278, lat: 51.5074},
                                'å·´é»': {lon: 2.3522, lat: 48.8566},
                                'æŸæ—': {lon: 13.4050, lat: 52.5200},
                                'ç½—é©¬': {lon: 12.4964, lat: 41.9028},
                                'é©¬å¾·é‡Œ': {lon: -3.7038, lat: 40.4168},
                                'é‡Œæ–¯æœ¬': {lon: -9.1393, lat: 38.7223},
                                'é›…å…¸': {lon: 23.7275, lat: 37.9838},
                                'é˜¿å§†æ–¯ç‰¹ä¸¹': {lon: 4.9041, lat: 52.3676},
                                'å¸ƒé²å¡å°”': {lon: 4.3517, lat: 50.8503},
                                'ä¼¯å°”å°¼': {lon: 7.4474, lat: 46.9481},
                                'ç»´ä¹Ÿçº³': {lon: 16.3738, lat: 48.2082},
                                'æ–¯å¾·å“¥å°”æ‘©': {lon: 18.0686, lat: 59.3293},
                                'å¥¥æ–¯é™†': {lon: 10.7522, lat: 59.9139},
                                'å“¥æœ¬å“ˆæ ¹': {lon: 12.5683, lat: 55.6761},
                                'èµ«å°”è¾›åŸº': {lon: 24.9458, lat: 60.1699},
                                'é›·å…‹é›…æœªå…‹': {lon: -21.8278, lat: 64.1466},
                                'éƒ½æŸæ—': {lon: -6.2603, lat: 53.3498},
                                'åæ²™': {lon: 21.0122, lat: 52.2297},
                                'å¸ƒæ‹‰æ ¼': {lon: 14.4378, lat: 50.0755},
                                'å¸ƒæ‹‰è¿ªæ–¯æ‹‰å‘': {lon: 17.1077, lat: 48.1486},
                                'å¸ƒè¾¾ä½©æ–¯': {lon: 19.0402, lat: 47.4979},
                                'å¸ƒåŠ å‹’æ–¯ç‰¹': {lon: 26.0969, lat: 44.4268},
                                'ç´¢è²äºš': {lon: 23.3219, lat: 42.6977},
                                'è´å°”æ ¼è±å¾·': {lon: 20.4489, lat: 44.7866},
                                'è¨æ ¼å‹’å¸ƒ': {lon: 15.9819, lat: 45.8150},
                                'å¢å¸ƒå°”é›…é‚£': {lon: 14.5058, lat: 46.0569},
                                'è¨æ‹‰çƒ­çª': {lon: 18.4131, lat: 43.8563},
                                'æ–¯ç§‘æ™®é‡Œ': {lon: 21.4333, lat: 41.9981},
                                'åœ°æ‹‰é‚£': {lon: 19.8186, lat: 41.3275},
                                'åŸºè¾…': {lon: 30.5234, lat: 50.4501},
                                'æ˜æ–¯å…‹': {lon: 27.5615, lat: 53.9045},
                                'ç»´å°”çº½æ–¯': {lon: 25.2797, lat: 54.6872},
                                'é‡ŒåŠ ': {lon: 24.1052, lat: 56.9496},
                                'å¡”æ—': {lon: 24.7536, lat: 59.4370},
                                'åŸºå¸Œè®·ä¹Œ': {lon: 28.8575, lat: 47.0104},
                                'å¼€ç½—': {lon: 31.2357, lat: 30.0444},
                                'çš„é»æ³¢é‡Œ': {lon: 13.1913, lat: 32.8872},
                                'çªå°¼æ–¯': {lon: 10.1815, lat: 36.8065},
                                'é˜¿å°”åŠå°”': {lon: 3.0588, lat: 36.7538},
                                'æ‹‰å·´ç‰¹': {lon: -6.8498, lat: 33.9716},
                                'å–€åœŸç©†': {lon: 32.5599, lat: 15.5007},
                                'äºšçš„æ–¯äºšè´å·´': {lon: 38.7469, lat: 9.1450},
                                'å†…ç½—æ¯•': {lon: 36.8219, lat: -1.2921},
                                'è¾¾ç´¯æ–¯è¨æ‹‰å§†': {lon: 39.2083, lat: -6.7924},
                                'åå¸•æ‹‰': {lon: 32.5822, lat: 0.3476},
                                'åŸºåŠ åˆ©': {lon: 30.0619, lat: -1.9441},
                                'é‡‘æ²™è¨': {lon: 15.2663, lat: -4.3276},
                                'å¸ƒæ‹‰æŸ´ç»´å°”': {lon: 15.2832, lat: -4.2634},
                                'åˆ©ä¼¯ç»´å°”': {lon: 9.4673, lat: 0.4162},
                                'é›…æ¸©å¾—': {lon: 11.5021, lat: 3.8480},
                                'é˜¿å¸ƒè´¾': {lon: 7.4951, lat: 9.0765},
                                'é˜¿å…‹æ‹‰': {lon: -0.1869, lat: 5.6037},
                                'äºšç©†è‹å…‹ç½—': {lon: -5.2893, lat: 6.8276},
                                'è¾¾å–€å°”': {lon: -17.4677, lat: 14.7167},
                                'å·´é©¬ç§‘': {lon: -8.0029, lat: 12.6392},
                                'ç“¦åŠ æœå¤': {lon: -1.5197, lat: 12.3714},
                                'å°¼äºšç¾': {lon: 2.1058, lat: 13.5127},
                                'æ©è´¾æ¢…çº³': {lon: 15.0442, lat: 12.1348},
                                'æ¯”å‹’é™€åˆ©äºš': {lon: 28.2293, lat: -25.7479},
                                'å“ˆæ‹‰é›·': {lon: 31.0333, lat: -17.8292},
                                'å“ˆåšç½—å†…': {lon: 25.9157, lat: -24.6282},
                                'æ¸©å¾—å’Œå…‹': {lon: 17.0832, lat: -22.5597},
                                'ç½—å®‰è¾¾': {lon: 13.2344, lat: -8.8383},
                                'å¢è¨å¡': {lon: 28.3228, lat: -15.3875},
                                'é©¬æ™®æ‰˜': {lon: 32.5739, lat: -25.9692},
                                'å¡”é‚£é‚£åˆ©ä½›': {lon: 47.5361, lat: -18.8792},
                                'è·¯æ˜“æ¸¯': {lon: 57.5522, lat: -20.1609},
                                'åç››é¡¿': {lon: -77.0369, lat: 38.9072},
                                'æ¸¥å¤ªå': {lon: -75.6972, lat: 45.4215},
                                'å¢¨è¥¿å“¥åŸ': {lon: -99.1332, lat: 19.4326},
                                'å“ˆç“¦é‚£': {lon: -82.3666, lat: 23.1136},
                                'é‡‘æ–¯æ•¦': {lon: -76.7936, lat: 18.0179},
                                'å¤ªå­æ¸¯': {lon: -72.3350, lat: 18.5944},
                                'åœ£å¤šæ˜å„': {lon: -69.9312, lat: 18.4861},
                                'åœ£ä½•å¡': {lon: -84.0907, lat: 9.9281},
                                'å·´æ‹¿é©¬åŸ': {lon: -79.5199, lat: 8.9824},
                                'å±åœ°é©¬æ‹‰åŸ': {lon: -90.5069, lat: 14.6349},
                                'ç‰¹å¤è¥¿åŠ å°”å·´': {lon: -87.2044, lat: 14.0723},
                                'é©¬é‚£ç“œ': {lon: -86.2514, lat: 12.1364},
                                'åœ£è¨å°”ç“¦å¤š': {lon: -89.1872, lat: 13.6929},
                                'è´å°”è«æ½˜': {lon: -88.7670, lat: 17.2510},
                                'å·´è¥¿åˆ©äºš': {lon: -47.8825, lat: -15.7942},
                                'å¸ƒå®œè¯ºæ–¯è‰¾åˆ©æ–¯': {lon: -58.3816, lat: -34.6037},
                                'åœ£åœ°äºšå“¥': {lon: -70.6483, lat: -33.4489},
                                'åˆ©é©¬': {lon: -77.0428, lat: -12.0464},
                                'æ³¢å“¥å¤§': {lon: -74.0721, lat: 4.7110},
                                'åŠ æ‹‰åŠ æ–¯': {lon: -66.9036, lat: 10.4806},
                                'åŸºå¤š': {lon: -78.4678, lat: -0.1807},
                                'æ‹‰å·´æ–¯': {lon: -68.1193, lat: -16.5000},
                                'äºšæ¾æ£®': {lon: -57.5759, lat: -25.2637},
                                'è’™å¾—ç»´çš„äºš': {lon: -56.1645, lat: -34.9011},
                                'è‹å…‹é›·': {lon: -65.2590, lat: -19.0476},
                                'ä¹”æ²»æ•¦': {lon: -58.1551, lat: 6.8013},
                                'å¸•æ‹‰é©¬é‡Œåš': {lon: -55.2038, lat: 5.8520},
                                'å¡å®´': {lon: -52.3135, lat: 4.9224},
                                'å ªåŸ¹æ‹‰': {lon: 149.1300, lat: -35.2809},
                                'æƒ çµé¡¿': {lon: 174.7633, lat: -41.2865},
                                'è‹ç“¦': {lon: 178.4419, lat: -18.1248},
                                'åŠªåº“é˜¿æ´›æ³•': {lon: -175.1982, lat: -21.1393},
                                'é˜¿çš®äºš': {lon: -171.7514, lat: -13.8333},
                                'è«å°”å…¹æ¯”æ¸¯': {lon: 147.1803, lat: -9.4438}
                            };
                            
                            // æ„å»ºå›½å¤–é¦–éƒ½æ•°æ®ï¼ˆåªåŒ…å«é¦–éƒ½ï¼ŒåŒ…å«å‡†ç¡®ç»çº¬åº¦ï¼‰
                            // æ„å»ºæ‰€æœ‰åŸå¸‚çš„æ•°æ®ç»“æ„ï¼ˆåŒ…æ‹¬é¦–éƒ½å’ŒçŸ¥ååŸå¸‚ï¼‰
                            var FOREIGN_CITIES = {};
                            FOREIGN_CITY_DATABASE.forEach(function(item) {
                                if(!FOREIGN_CITIES[item.continent]) {
                                    FOREIGN_CITIES[item.continent] = {};
                                }
                                if(!FOREIGN_CITIES[item.continent][item.country]) {
                                    FOREIGN_CITIES[item.continent][item.country] = [];
                                }
                                
                                // ä»å‡†ç¡®åæ ‡è¡¨ä¸­è·å–ç»çº¬åº¦
                                var coords = CAPITAL_COORDINATES[item.city];
                                var lat = 0;
                                if(coords) {
                                    lat = coords.lat;
                                } else {
                                    // å¦‚æœæ‰¾ä¸åˆ°å‡†ç¡®åæ ‡ï¼Œä½¿ç”¨æ•°æ®åº“ä¸­çš„ç»åº¦ï¼Œçº¬åº¦æ ¹æ®å¤§æ´²ä¼°ç®—
                                    if(item.continent === 'äºšæ´²') lat = item.longitude > 100 ? 35 : (item.longitude > 70 ? 30 : 25);
                                    else if(item.continent === 'æ¬§æ´²') lat = item.longitude > 20 ? 50 : 40;
                                    else if(item.continent === 'éæ´²') lat = item.longitude > 30 ? 5 : (item.longitude > 0 ? 10 : 15);
                                    else if(item.continent === 'åŒ—ç¾æ´²') lat = item.longitude > -80 ? 40 : 50;
                                    else if(item.continent === 'å—ç¾æ´²') lat = item.longitude > -60 ? -15 : -35;
                                    else if(item.continent === 'å¤§æ´‹æ´²') lat = item.longitude > 150 ? -25 : -35;
                                }
                                
                                FOREIGN_CITIES[item.continent][item.country].push({
                                    name: item.city,
                                    lon: coords ? coords.lon : item.longitude,
                                    lat: coords ? coords.lat : lat,
                                    isCapital: item.isCapital
                                });
                            });
                            
                            // å¯¹æ¯ä¸ªå›½å®¶çš„åŸå¸‚è¿›è¡Œæ’åºï¼šé¦–éƒ½ä¼˜å…ˆï¼Œç„¶åæŒ‰åç§°æ’åº
                            for(var continent in FOREIGN_CITIES) {
                                for(var country in FOREIGN_CITIES[continent]) {
                                    FOREIGN_CITIES[continent][country].sort(function(a, b) {
                                        if(a.isCapital && !b.isCapital) return -1;
                                        if(!a.isCapital && b.isCapital) return 1;
                                        return a.name.localeCompare(b.name);
                                    });
                                }
                            }
                            
                            // ä¿ç•™FOREIGN_CAPITALSç”¨äºå…¼å®¹ï¼ˆåªåŒ…å«é¦–éƒ½ï¼‰
                            var FOREIGN_CAPITALS = {};
                            for(var continent in FOREIGN_CITIES) {
                                FOREIGN_CAPITALS[continent] = {};
                                for(var country in FOREIGN_CITIES[continent]) {
                                    var capital = FOREIGN_CITIES[continent][country].find(function(city) {
                                        return city.isCapital;
                                    });
                                    if(capital) {
                                        FOREIGN_CAPITALS[continent][country] = {
                                            name: capital.name,
                                            lon: capital.lon,
                                            lat: capital.lat
                                        };
                                    }
                                }
                            }
                            
                            var html = '<div style="margin-bottom: 15px; font-size: 16px; font-weight: bold; color: #333;">å‡ºç”Ÿåœ°</div>';
                            html += '<div style="margin-bottom: 15px;">';
                            html += '<label style="margin-right: 15px;"><input type="radio" name="ts-location-type" value="domestic" checked> å›½å†…</label>';
                            html += '<label><input type="radio" name="ts-location-type" value="foreign"> å›½å¤–</label>';
                            html += '</div>';
                            
                            // å›½å†…é€‰æ‹©åŒºåŸŸ
                            html += '<div id="ts-domestic-area" style="margin-bottom: 15px;">';
                            html += '<div style="display: flex; gap: 10px; margin-bottom: 15px;">';
                            html += '<select id="ts-province" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"><option value="">è¯·é€‰æ‹©çœä»½</option>';
                            // åŒ—äº¬æ’åœ¨ç¬¬ä¸€ä¸ª
                            html += '<option value="åŒ—äº¬">åŒ—äº¬</option>';
                            // å…¶ä»–çœä»½æŒ‰é¡ºåºæ·»åŠ 
                            for(var prov in COASTAL_CITIES) {
                                if(prov !== 'åŒ—äº¬') {
                                    html += '<option value="' + prov + '">' + prov + '</option>';
                                }
                            }
                            html += '</select>';
                            html += '<select id="ts-city" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"><option value="">è¯·é€‰æ‹©åŸå¸‚</option></select>';
                            html += '</div>';
                            html += '</div>';
                            
                            // å›½å¤–é€‰æ‹©åŒºåŸŸï¼ˆé»˜è®¤éšè—ï¼‰
                            html += '<div id="ts-foreign-area" style="display: none; margin-bottom: 15px;">';
                            html += '<div style="display: flex; gap: 10px; margin-bottom: 10px;">';
                            html += '<select id="ts-continent" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"><option value="">è¯·é€‰æ‹©å¤§æ´²</option></select>';
                            html += '<select id="ts-country" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"><option value="">è¯·é€‰æ‹©å›½å®¶</option></select>';
                            html += '</div>';
                            html += '<select id="ts-capital" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"><option value="">è¯·é€‰æ‹©åŸå¸‚</option></select>';
                            html += '</div>';
                            
                            html += '<div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 15px;">';
                            html += '<button id="ts-city-cancel" style="padding: 8px 20px; background: #f0f0f0; color: #333; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; font-size: 14px;">å–æ¶ˆ</button>';
                            html += '<button id="ts-city-confirm" style="padding: 8px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">ç¡®å®š</button>';
                            html += '</div>';
                            html += '<button id="ts-city-close" style="position: absolute; top: 8px; right: 8px; background: transparent; color: #999; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 20px; line-height: 1;">Ã—</button>';
                            
                            content.innerHTML = html;
                            dialog.appendChild(content);
                            document.body.appendChild(dialog);
                            
                            // å›½å†…/å›½å¤–åˆ‡æ¢
                            var locationTypeRadios = document.querySelectorAll('input[name="ts-location-type"]');
                            var domesticArea = document.getElementById('ts-domestic-area');
                            var foreignArea = document.getElementById('ts-foreign-area');
                            
                            locationTypeRadios.forEach(function(radio) {
                                radio.onchange = function() {
                                    if(this.value === 'domestic') {
                                        domesticArea.style.display = 'block';
                                        foreignArea.style.display = 'none';
                                    } else {
                                        domesticArea.style.display = 'none';
                                        foreignArea.style.display = 'block';
                                    }
                                };
                            });
                            
                            // åˆå§‹åŒ–å¤§æ´²ä¸‹æ‹‰æ¡†
                            var continentSelect = document.getElementById('ts-continent');
                            var countrySelect = document.getElementById('ts-country');
                            var capitalSelect = document.getElementById('ts-capital');
                            
                            for(var continent in FOREIGN_CAPITALS) {
                                if(FOREIGN_CAPITALS.hasOwnProperty(continent)) {
                                    var option = document.createElement('option');
                                    option.value = continent;
                                    option.textContent = continent;
                                    continentSelect.appendChild(option);
                                }
                            }
                            
                            // å¤§æ´²é€‰æ‹©äº‹ä»¶
                            continentSelect.onchange = function() {
                                var continent = this.value;
                                countrySelect.innerHTML = '<option value="">è¯·é€‰æ‹©å›½å®¶</option>';
                                capitalSelect.innerHTML = '<option value="">è¯·é€‰æ‹©åŸå¸‚</option>';
                                
                                if(continent && FOREIGN_CAPITALS[continent]) {
                                    for(var country in FOREIGN_CAPITALS[continent]) {
                                        if(FOREIGN_CAPITALS[continent].hasOwnProperty(country)) {
                                            var option = document.createElement('option');
                                            option.value = country;
                                            option.textContent = country;
                                            countrySelect.appendChild(option);
                                        }
                                    }
                                }
                            };
                            
                            // å›½å®¶é€‰æ‹©äº‹ä»¶
                            countrySelect.onchange = function() {
                                var continent = continentSelect.value;
                                var country = this.value;
                                capitalSelect.innerHTML = '<option value="">è¯·é€‰æ‹©åŸå¸‚</option>';
                                
                                // æ˜¾ç¤ºè¯¥å›½å®¶çš„æ‰€æœ‰åŸå¸‚ï¼ˆåŒ…æ‹¬é¦–éƒ½å’ŒçŸ¥ååŸå¸‚ï¼‰
                                if(continent && country && FOREIGN_CITIES[continent] && FOREIGN_CITIES[continent][country]) {
                                    var cities = FOREIGN_CITIES[continent][country];
                                    cities.forEach(function(city) {
                                        var option = document.createElement('option');
                                        option.value = city.name;
                                        option.setAttribute('data-lon', city.lon);
                                        option.setAttribute('data-lat', city.lat);
                                        // å¦‚æœæ˜¯é¦–éƒ½ï¼Œåœ¨åç§°åæ·»åŠ æ ‡è¯†
                                        option.textContent = city.isCapital ? city.name + ' (é¦–éƒ½)' : city.name;
                                        capitalSelect.appendChild(option);
                                    });
                                }
                            };
                            
                            // çœä»½é€‰æ‹©äº‹ä»¶
                            var provinceSelect = document.getElementById('ts-province');
                            var citySelect = document.getElementById('ts-city');
                            
                            provinceSelect.onchange = function() {
                                var prov = this.value;
                                citySelect.innerHTML = '<option value="">è¯·é€‰æ‹©åŸå¸‚</option>';
                                if(prov && COASTAL_CITIES[prov]) {
                                    COASTAL_CITIES[prov].forEach(function(city) {
                                        citySelect.innerHTML += '<option value="' + city.name + '" data-lon="' + city.lon + '" data-lat="' + city.lat + '">' + city.name + '</option>';
                                    });
                                }
                            };
                            
                            // ç¡®å®šæŒ‰é’®
                            var confirmBtn = document.getElementById('ts-city-confirm');
                            if(confirmBtn) {
                                confirmBtn.onclick = function() {
                                    var locationType = document.querySelector('input[name="ts-location-type"]:checked').value;
                                    var lon, lat, cityName;
                                    
                                    if(locationType === 'domestic') {
                                        // å›½å†…é€‰æ‹©
                                        if(!citySelect) {
                                            alert('åŸå¸‚é€‰æ‹©å™¨æœªæ‰¾åˆ°');
                                            return;
                                        }
                                        
                                        var selectedCity = citySelect.options[citySelect.selectedIndex];
                                        if(!selectedCity || !selectedCity.value) {
                                            alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªåŸå¸‚');
                                            return;
                                        }
                                        
                                        lon = parseFloat(selectedCity.getAttribute('data-lon'));
                                        lat = parseFloat(selectedCity.getAttribute('data-lat'));
                                        cityName = selectedCity.value;
                                    } else {
                                        // å›½å¤–é€‰æ‹©
                                        if(!capitalSelect) {
                                            alert('åŸå¸‚é€‰æ‹©å™¨æœªæ‰¾åˆ°');
                                            return;
                                        }
                                        
                                        var selectedCapital = capitalSelect.options[capitalSelect.selectedIndex];
                                        if(!selectedCapital || !selectedCapital.value) {
                                            alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªåŸå¸‚');
                                            return;
                                        }
                                        
                                        lon = parseFloat(selectedCapital.getAttribute('data-lon'));
                                        lat = parseFloat(selectedCapital.getAttribute('data-lat'));
                                        cityName = selectedCapital.value;
                                    }
                                    
                                    if(isNaN(lon) || isNaN(lat)) {
                                        alert('æ— æ³•è·å–åŸå¸‚çš„ç»çº¬åº¦ä¿¡æ¯ï¼Œè¯·é‡æ–°é€‰æ‹©');
                                        return;
                                    }
                                    
                                    if(!elLon || !elLat) {
                                        alert('ç»çº¬åº¦è¾“å…¥æ¡†æœªæ‰¾åˆ°');
                                        return;
                                    }
                                    
                                    elLon.value = lon.toFixed(4);
                                    elLat.value = lat.toFixed(4);
                                    
                                    if(typeof onValChange === 'function') {
                                        onValChange();
                                    }
                                    
                                    // è‡ªåŠ¨å¼€å¯å¼€å…³
                                    if(elSwitch) {
                                        elSwitch.checked = true;
                                        if(typeof elSwitch.onchange === 'function') {
                                            elSwitch.onchange();
                                        }
                                    }
                                    
                                    dialog.remove();
                                };
                            }
                            
                            // å–æ¶ˆå’Œå…³é—­æŒ‰é’®
                            var closeDialog = function() { dialog.remove(); };
                            document.getElementById('ts-city-cancel').onclick = closeDialog;
                            document.getElementById('ts-city-close').onclick = closeDialog;
                            dialog.onclick = function(e) {
                                if(e.target === dialog) closeDialog();
                            };
                        };
                    }

                    // 4. GPS å®šä½åŠŸèƒ½
                    elBtn.onclick = function() {
                        if (!navigator.geolocation) return alert("æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒå®šä½åŠŸèƒ½");
                        var icon = this.querySelector('i');
                        icon.className = "fa fa-spin fa-spinner"; // è®©å›¾æ ‡è½¬èµ·æ¥
                        
                        navigator.geolocation.getCurrentPosition(function(pos) {
                            icon.className = "fa fa-location-arrow";
                            // è·å–åæ ‡
                            var lon = parseFloat(pos.coords.longitude.toFixed(4));
                            var lat = parseFloat(pos.coords.latitude.toFixed(4));
                            
                            // æ›´æ–°æ•°æ®
                            elLon.value = lon;
                            elLat.value = lat;
                            onValChange(); // æ›´æ–°çŠ¶æ€
                            
                            // è‡ªåŠ¨å¼€å¯å¼€å…³
                            elSwitch.checked = true;
                            elSwitch.onchange();
                            
                            alert("å®šä½æˆåŠŸï¼\nç»åº¦: " + lon + "\nçº¬åº¦: " + lat);
                        }, function(err) {
                            icon.className = "fa fa-location-arrow";
                            alert("å®šä½å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è¾“å…¥ã€‚\n(é”™è¯¯ä¿¡æ¯: " + err.message + ")");
                        });
                    };

                    // === D. è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°UIæ˜¾ç¤º ===
                    function updateUIFeedback(date, offsetMs) {
                        var tip = document.getElementById('ts-feedback');
                        if (!tip) return;
                        
                        var h = ('0' + date.getHours()).slice(-2);
                        var m = ('0' + date.getMinutes()).slice(-2);
                        var minDiff = (offsetMs / 60000).toFixed(1);
                        var sign = minDiff > 0 ? '+' : '';
                        
                        // æ„é€ æç¤º HTML
                        var html = `çœŸä»¤ <b class="text-red-700">${h}:${m}</b>`;
                        html += ` <span class="text-gray-500">(${sign}${minDiff}åˆ†)</span>`;
                        if (STATE.isSouthern) html += ` <span class="text-blue-600 font-bold ml-1">[å—åŠçƒ]</span>`;
                        
                        tip.innerHTML = html;
                        tip.style.display = 'flex';
                    }

                    console.log("çœŸå¤ªé˜³æ—¶æ’ä»¶åŠ è½½æˆåŠŸï¼");

                } catch (err) {
                    console.error("æ’ä»¶åˆå§‹åŒ–å¼‚å¸¸:", err);
                }
            }
        })();

        // ========================================
        // é¡µé¢åˆ‡æ¢åŠŸèƒ½
        // ========================================
        document.addEventListener('DOMContentLoaded', function() {
            // #region agent log
            fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded',message:'DOMContentLoadedäº‹ä»¶è§¦å‘',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            
            const pageSelector = document.getElementById('pageSelector');
            const pageContents = document.querySelectorAll('.page-content');
            
            // #region agent log
            fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded',message:'è·å–é¡µé¢é€‰æ‹©å™¨å’Œå†…å®¹',data:{pageSelectorExists:!!pageSelector,pageContentsCount:pageContents.length},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            
            // åˆå§‹åŒ–æ˜¾ç¤ºç¬¬ä¸€ä¸ªé¡µé¢
            if (!pageSelector) {
                console.error('é¡µé¢é€‰æ‹©å™¨æœªæ‰¾åˆ°ï¼Œæ— æ³•åˆå§‹åŒ–é¡µé¢');
                return;
            }
            const initialPage = pageSelector.value;
            // #region agent log
            fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded',message:'åˆå§‹åŒ–é¡µé¢',data:{initialPage:initialPage,pageContentsLength:pageContents.length,allPageIds:Array.from(pageContents).map(p=>p.id)},timestamp:Date.now(),sessionId:'debug-session',runId:'page-init',hypothesisId:'A'})}).catch(()=>{});
            // #endregion
            
            pageContents.forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });
            const initialPageElement = document.getElementById(initialPage);
            if (initialPageElement) {
                initialPageElement.classList.add('active');
                initialPageElement.style.display = 'block';
                // #region agent log
                fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded',message:'åˆå§‹é¡µé¢å·²æ˜¾ç¤º',data:{initialPage:initialPage,hasActiveClass:initialPageElement.classList.contains('active'),displayStyle:initialPageElement.style.display},timestamp:Date.now(),sessionId:'debug-session',runId:'page-init',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                // å¦‚æœæ˜¯æ˜“ç»ä»·å€¼è§‚æˆ–æ˜“ç»æ–‡åŒ–ä¼ æ‰¿é¡µé¢ï¼Œç«‹å³æ˜¾ç¤ºå…¶ä¸­çš„æ‰€æœ‰sections
                if (initialPage === 'custom2' || initialPage === 'statemenc') {
                    const sections = initialPageElement.querySelectorAll('section');
                    sections.forEach(section => {
                        section.style.opacity = 1;
                        section.style.transform = 'translateY(0)';
                    });
                }
                // å¦‚æœæ˜¯ç´«å¾®æ–—æ•°æ’ç›˜é¡µé¢ï¼Œåˆå§‹åŒ–ZWï¼ˆç¡®ä¿Solaråº“å·²åŠ è½½ï¼‰
                if (initialPage === 'ziwei') {
                    if(typeof ZW !== 'undefined' && typeof Solar !== 'undefined') {
                        setTimeout(() => {
                            ZW.init();
                        }, 100);
                    } else {
                        // ç­‰å¾…Solaråº“åŠ è½½å®Œæˆåå†åˆå§‹åŒ–
                        let checkCount = 0;
                        const maxChecks = 100; // å¢åŠ åˆ°10ç§’
                        const checkInterval = setInterval(() => {
                            checkCount++;
                            // #region agent log
                            fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded-check',message:'æ£€æŸ¥Solaråº“åŠ è½½çŠ¶æ€',data:{checkCount:checkCount,hasZW:typeof ZW !== 'undefined',hasSolar:typeof Solar !== 'undefined'},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'D'})}).catch(()=>{});
                            // #endregion
                            
                            if(typeof Solar !== 'undefined' && typeof ZW !== 'undefined') {
                                clearInterval(checkInterval);
                                setTimeout(() => {
                                    ZW.init();
                                }, 100);
                            } else if(checkCount >= maxChecks) {
                                clearInterval(checkInterval);
                                console.error('Solaråº“åŠ è½½è¶…æ—¶ï¼Œä½†é¡µé¢å·²æ˜¾ç¤º');
                                // #region agent log
                                fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded',message:'Solaråº“åŠ è½½è¶…æ—¶',data:{checkCount:checkCount,hasZW:typeof ZW !== 'undefined',hasSolar:typeof Solar !== 'undefined'},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'D'})}).catch(()=>{});
                                // #endregion
                            }
                        }, 100);
                    }
                }
            }
            
            // é¡µé¢åˆ‡æ¢å‡½æ•°ï¼ˆå…ˆå®šä¹‰ï¼Œä¾›äº‹ä»¶ç›‘å¬å™¨ä½¿ç”¨ï¼‰
            function doPageSwitch(targetPage) {
                // #region agent log
                fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:doPageSwitch',message:'å‡½æ•°å…¥å£',data:{targetPage:targetPage,pageContentsLength:pageContents.length},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                // #endregion
                console.log('å¼€å§‹åˆ‡æ¢é¡µé¢:', targetPage);
                
                // éšè—æ‰€æœ‰é¡µé¢å†…å®¹ï¼ˆç§»é™¤activeç±»ï¼Œå¹¶å¼ºåˆ¶è®¾ç½®displayä¸ºnoneï¼‰
                pageContents.forEach(content => {
                    content.classList.remove('active');
                    content.style.setProperty('display', 'none', 'important');
                });
                
                // æ˜¾ç¤ºç›®æ ‡é¡µé¢å†…å®¹
                const targetPageElement = document.getElementById(targetPage);
                // #region agent log
                fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:doPageSwitch',message:'æŸ¥æ‰¾ç›®æ ‡é¡µé¢å…ƒç´ ',data:{targetPage:targetPage,elementExists:!!targetPageElement,allPageIds:Array.from(pageContents).map(p=>p.id)},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                // #endregion
                console.log('ç›®æ ‡é¡µé¢å…ƒç´ :', targetPageElement);
                
                if (targetPageElement) {
                    // æ·»åŠ activeç±»ï¼ŒCSSä¼šè‡ªåŠ¨æ˜¾ç¤ºï¼ˆå› ä¸º.activeæœ‰display: block !importantï¼‰
                    const beforeActive = targetPageElement.classList.contains('active');
                    const beforeDisplay = window.getComputedStyle(targetPageElement).display;
                    const beforeVisibility = window.getComputedStyle(targetPageElement).visibility;
                    // #region agent log
                    fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:doPageSwitch',message:'æ·»åŠ activeç±»å‰',data:{targetPage:targetPage,beforeActive:beforeActive,beforeDisplay:beforeDisplay,beforeVisibility:beforeVisibility},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
                    // #endregion
                    
                    targetPageElement.classList.add('active');
                    
                    // å¼ºåˆ¶è®¾ç½®displayæ ·å¼ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆï¼ˆå³ä½¿CSSæœ‰!importantï¼Œå†…è”æ ·å¼ä¼˜å…ˆçº§æ›´é«˜ï¼‰
                    targetPageElement.style.setProperty('display', 'block', 'important');
                    
                    const afterActive = targetPageElement.classList.contains('active');
                    const afterDisplay = window.getComputedStyle(targetPageElement).display;
                    const afterVisibility = window.getComputedStyle(targetPageElement).visibility;
                    const hasActiveClass = targetPageElement.className.includes('active');
                    const inlineDisplay = targetPageElement.style.display;
                    // #region agent log
                    fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:doPageSwitch',message:'æ·»åŠ activeç±»å',data:{targetPage:targetPage,afterActive:afterActive,afterDisplay:afterDisplay,afterVisibility:afterVisibility,hasActiveClass:hasActiveClass,inlineDisplay:inlineDisplay,className:targetPageElement.className},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
                    // #endregion
                    console.log('å·²æ·»åŠ activeç±»ï¼Œé¡µé¢åº”è¯¥æ˜¾ç¤º');
                    console.log('activeç±»çŠ¶æ€:', afterActive, 'è®¡ç®—display:', afterDisplay, 'å†…è”display:', inlineDisplay);
                    
                    // å¦‚æœæ˜¯æ˜“ç»ä»·å€¼è§‚æˆ–æ˜“ç»æ–‡åŒ–ä¼ æ‰¿é¡µé¢ï¼Œç«‹å³æ˜¾ç¤ºå…¶ä¸­çš„æ‰€æœ‰sections
                    if (targetPage === 'custom2' || targetPage === 'statemenc') {
                        const sections = targetPageElement.querySelectorAll('section');
                        sections.forEach(section => {
                            section.style.opacity = 1;
                            section.style.transform = 'translateY(0)';
                        });
                    }
                    
                    // å¦‚æœæ˜¯ç´«å¾®æ–—æ•°æ’ç›˜é¡µé¢ï¼Œåˆå§‹åŒ–ZWï¼ˆç¡®ä¿Solaråº“å·²åŠ è½½ï¼‰
                    if (targetPage === 'ziwei') {
                        if(typeof ZW !== 'undefined' && typeof Solar !== 'undefined') {
                            setTimeout(() => {
                                ZW.init();
                            }, 100);
                        } else {
                            console.warn('åˆ‡æ¢åˆ°ziweié¡µé¢æ—¶ï¼ŒSolaræˆ–ZWæœªå®šä¹‰', {
                                hasZW: typeof ZW !== 'undefined',
                                hasSolar: typeof Solar !== 'undefined'
                            });
                            // #region agent log
                            fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:doPageSwitch',message:'åˆ‡æ¢åˆ°ziweié¡µé¢æ—¶Solaræˆ–ZWæœªå®šä¹‰',data:{hasZW:typeof ZW !== 'undefined',hasSolar:typeof Solar !== 'undefined'},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'D'})}).catch(()=>{});
                            // #endregion
                            
                            // å³ä½¿åº“æœªåŠ è½½ï¼Œä¹Ÿå°è¯•ç­‰å¾…å¹¶åˆå§‹åŒ–
                            if(typeof Solar === 'undefined') {
                                let checkCount = 0;
                                const maxChecks = 100;
                                const checkInterval = setInterval(() => {
                                    checkCount++;
                                    if(typeof Solar !== 'undefined' && typeof ZW !== 'undefined') {
                                        clearInterval(checkInterval);
                                        setTimeout(() => {
                                            ZW.init();
                                        }, 100);
                                    } else if(checkCount >= maxChecks) {
                                        clearInterval(checkInterval);
                                        console.error('Solaråº“åŠ è½½è¶…æ—¶ï¼Œä½†é¡µé¢å·²æ˜¾ç¤º');
                                    }
                                }, 100);
                            }
                        }
                    }
                } else {
                    // #region agent log
                    fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:doPageSwitch',message:'ç›®æ ‡é¡µé¢å…ƒç´ ä¸å­˜åœ¨',data:{targetPage:targetPage,allPageIds:Array.from(pageContents).map(p=>p.id)},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                    // #endregion
                    console.error('é¡µé¢å…ƒç´ ä¸å­˜åœ¨:', targetPage);
                    console.log('æ‰€æœ‰é¡µé¢ID:', Array.from(pageContents).map(p => p.id));
                }
                
                // æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
                window.scrollTo(0, 0);
            }
            
            // ç›‘å¬é€‰æ‹©æ¡†å˜åŒ–
            if (!pageSelector) {
                // #region agent log
                fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded',message:'é¡µé¢é€‰æ‹©å™¨æœªæ‰¾åˆ°',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                console.error('âŒ é¡µé¢é€‰æ‹©å™¨æœªæ‰¾åˆ°ï¼');
            } else {
                // #region agent log
                fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded',message:'é¡µé¢é€‰æ‹©å™¨å·²æ‰¾åˆ°ï¼Œç»‘å®šäº‹ä»¶',data:{pageSelectorId:pageSelector.id,pageSelectorValue:pageSelector.value},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'})}).catch(()=>{});
                // #endregion
                console.log('âœ… é¡µé¢é€‰æ‹©å™¨å·²æ‰¾åˆ°ï¼Œç»‘å®šchangeäº‹ä»¶');
                pageSelector.addEventListener('change', function() {
                    // #region agent log
                    fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:pageSelector-change',message:'changeäº‹ä»¶è§¦å‘',data:{targetPage:this.value,oldValue:this.getAttribute('data-old-value')||'none'},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                    // #endregion
                    console.log('ğŸ”„ é¡µé¢åˆ‡æ¢äº‹ä»¶è§¦å‘ï¼Œç›®æ ‡é¡µé¢:', this.value);
                    
                    // è·å–ç›®æ ‡é¡µé¢ID
                    const targetPage = this.value;
                    
                    // #region agent log
                    fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:pageSelector-change',message:'å‡†å¤‡è°ƒç”¨doPageSwitch',data:{targetPage:targetPage,doPageSwitchExists:typeof doPageSwitch==='function'},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                    // #endregion
                
                // å¦‚æœåˆ‡æ¢åˆ°ziweié¡µé¢ï¼Œæ£€æŸ¥Solaråº“æ˜¯å¦å·²åŠ è½½
                if(targetPage === 'ziwei') {
                    // #region agent log
                    fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:pageSelector-change',message:'åˆ‡æ¢åˆ°ziweié¡µé¢ï¼Œæ£€æŸ¥Solaråº“',data:{typeofSolar:typeof Solar,typeofLunar:typeof Lunar,windowSolar:typeof window.Solar,scriptTags:document.querySelectorAll('script[src*="lunar"]').length},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'D'})}).catch(()=>{});
                    // #endregion
                    
                    if(typeof Solar === 'undefined') {
                        console.warn('Solaråº“æœªåŠ è½½ï¼Œå…ˆåˆ‡æ¢é¡µé¢ï¼Œç„¶åç­‰å¾…åº“åŠ è½½å®Œæˆ...');
                        // å…ˆåˆ‡æ¢é¡µé¢ï¼Œè®©ç”¨æˆ·çœ‹åˆ°ç•Œé¢
                        doPageSwitch(targetPage);
                        
                        // ç„¶åç­‰å¾…åº“åŠ è½½å®Œæˆ
                        let checkCount = 0;
                        const maxChecks = 100; // æœ€å¤šæ£€æŸ¥10ç§’ï¼ˆ100æ¬¡ * 100msï¼‰
                        const checkInterval = setInterval(() => {
                            checkCount++;
                            // #region agent log
                            fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:pageSelector-change-check',message:'æ£€æŸ¥Solaråº“åŠ è½½çŠ¶æ€',data:{checkCount:checkCount,typeofSolar:typeof Solar,typeofLunar:typeof Lunar},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'D'})}).catch(()=>{});
                            // #endregion
                            
                            if(typeof Solar !== 'undefined') {
                                clearInterval(checkInterval);
                                // åº“åŠ è½½å®Œæˆï¼Œåˆå§‹åŒ–ZW
                                // #region agent log
                                fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:pageSelector-change',message:'Solaråº“åŠ è½½å®Œæˆï¼Œåˆå§‹åŒ–ZW',data:{checkCount:checkCount},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'D'})}).catch(()=>{});
                                // #endregion
                                if(typeof ZW !== 'undefined') {
                                    setTimeout(() => {
                                        ZW.init();
                                    }, 100);
                                }
                            } else if(checkCount >= maxChecks) {
                                clearInterval(checkInterval);
                                console.error('Solaråº“åŠ è½½è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢ã€‚');
                                // #region agent log
                                fetch('http://127.0.0.1:7244/ingest/862422ac-550d-4053-a32b-ba0867b81610',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:pageSelector-change',message:'Solaråº“åŠ è½½è¶…æ—¶',data:{checkCount:checkCount,scriptTags:document.querySelectorAll('script[src*="lunar"]').length},timestamp:Date.now(),sessionId:'debug-session',runId:'check-loading',hypothesisId:'D'})}).catch(()=>{});
                                // #endregion
                                // æ˜¾ç¤ºè­¦å‘Šï¼Œä½†ä¸é˜»æ­¢é¡µé¢æ˜¾ç¤º
                                alert('å†œå†åº“åŠ è½½è¶…æ—¶ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½æ— æ³•ä½¿ç”¨ã€‚è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢ã€‚');
                            }
                        }, 100);
                        return; // å·²ç»åˆ‡æ¢é¡µé¢ï¼Œä¸éœ€è¦å†æ¬¡è°ƒç”¨doPageSwitch
                    }
                }
                
                // æ‰§è¡Œé¡µé¢åˆ‡æ¢ï¼ˆéziweié¡µé¢æˆ–ziweié¡µé¢ä½†åº“å·²åŠ è½½ï¼‰
                // #region agent log
                fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:pageSelector-change',message:'å‡†å¤‡è°ƒç”¨doPageSwitch',data:{targetPage:targetPage},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                // #endregion
                doPageSwitch(targetPage);
                // #region agent log
                fetch('http://127.0.0.1:7246/ingest/30b0ac25-dd79-4c1e-9d03-1b2ea0cee6eb',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:pageSelector-change',message:'doPageSwitchè°ƒç”¨å®Œæˆ',data:{targetPage:targetPage},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                // #endregion
                
                // å¦‚æœæ˜¯å……å€¼é¡µé¢ï¼Œåˆå§‹åŒ–å……å€¼åŠŸèƒ½
                if (targetPage === 'recharge') {
                    // å»¶è¿Ÿåˆå§‹åŒ–ï¼Œç¡®ä¿é¡µé¢å·²æ˜¾ç¤º
                    setTimeout(() => {
                        initRechargePage();
                    }, 100);
                }
                }); // å…³é—­ addEventListener
            } // å…³é—­ else
        }); // å…³é—­ DOMContentLoaded

        // ========================================
        // èŠå¤©åŠŸèƒ½é…ç½®
        // ========================================
        const BOT_APP_KEY = "FPvXNmsbpKPpcZjsGYvasAKsrYjsmPSJanQszXGwQGWOvtImCruOvfySJhoMYknhnNlwpCWEZYfcTtrfIjAwbSFHsjsnYxldOchhMSXPEnPHYPTqAnxEVxZaKBqHIqqO";
        const API_URL = "https://wss.lke.cloud.tencent.com/v1/qbot/chat/sse";
        
        // ========================================
        // å…¨å±€å˜é‡
        // ========================================
        let currentEventSource = null;
        let isThinking = false;
        let currentBotMessage = null;
        let currentContent = "";
        
        // ========================================
        // DOMå…ƒç´ 
        // ========================================
        const chatBox = document.getElementById('chatBox');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const statusDiv = document.getElementById('status');
        const connectionStatus = document.getElementById('connectionStatus');
        
        // ========================================
        // æ ¸å¿ƒåŠŸèƒ½å‡½æ•°
        // ========================================
        
        // 1. æ·»åŠ æ¶ˆæ¯åˆ°å¯¹è¯æ¡†
        function addMessage(text, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + (isUser ? 'user-message' : 'bot-message');
            messageDiv.textContent = text;
            chatBox.appendChild(messageDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
            return messageDiv;
        }
        
        // 2. åˆ›å»ºæµå¼æ¶ˆæ¯æ¡†
        function createStreamingMessage() {
            // å¦‚æœå­˜åœ¨æ­£åœ¨æµå¼æ˜¾ç¤ºçš„æ¶ˆæ¯æ¡†ï¼Œå…ˆå®Œæˆå®ƒ
            if (currentBotMessage) {
                const cursor = currentBotMessage.querySelector('.typing-cursor');
                if (cursor) cursor.remove();
            }
            
            // åˆ›å»ºæ–°çš„æµå¼æ¶ˆæ¯æ¡†
            currentBotMessage = document.createElement('div');
            currentBotMessage.className = 'message bot-message streaming-message';
            
            const textSpan = document.createElement('span');
            textSpan.className = 'streaming-text';
            textSpan.textContent = '';
            
            const cursorSpan = document.createElement('span');
            cursorSpan.className = 'typing-cursor';
            
            currentBotMessage.appendChild(textSpan);
            currentBotMessage.appendChild(cursorSpan);
            chatBox.appendChild(currentBotMessage);
            chatBox.scrollTop = chatBox.scrollHeight;
            
            return currentBotMessage;
        }
        
        // 3. æ›´æ–°æµå¼æ¶ˆæ¯
        function updateStreamingMessage(newContent, isFinal = false) {
            if (!currentBotMessage) {
                createStreamingMessage();
            }

            const textSpan = currentBotMessage.querySelector('.streaming-text');
            if (textSpan) {
                textSpan.textContent += newContent;
            }
            
            chatBox.scrollTop = chatBox.scrollHeight;
            
            // å¦‚æœæ˜¯æœ€ç»ˆæ¶ˆæ¯ï¼Œç§»é™¤å…‰æ ‡
            if (isFinal) {
                const cursor = currentBotMessage.querySelector('.typing-cursor');
                if (cursor) cursor.remove();
                currentBotMessage.classList.remove('streaming-message');
                currentBotMessage = null;
            }
        }
        
        // 4. æå–å›å¤å†…å®¹
        function extractReplyContent(data) {
            let content = "";
            let isFinal = false;
            
            if (data.content !== undefined && data.content !== null) {
                content = String(data.content);
                isFinal = data.is_final === true;
            }
            else if (data.payload && data.payload.content !== undefined) {
                content = String(data.payload.content);
                isFinal = data.payload.is_final === true;
            }
            else if (data.data && data.data.content !== undefined) {
                content = String(data.data.content);
                isFinal = data.data.is_final === true;
            }
            
            return { content, isFinal };
        }
        
        // 5. æ˜¾ç¤º/éšè—"æ€è€ƒä¸­"
        function showThinking(show) {
            let thinkingDiv = document.querySelector('.thinking');
            if (show && !thinkingDiv) {
                thinkingDiv = document.createElement('div');
                thinkingDiv.className = 'thinking';
                thinkingDiv.textContent = 'æ€è€ƒä¸­...';
                chatBox.appendChild(thinkingDiv);
                chatBox.scrollTop = chatBox.scrollHeight;
            } else if (!show && thinkingDiv) {
                thinkingDiv.remove();
            }
        }
        
        // ä½¿ç”¨æ¬¡æ•°ç®¡ç†
        function getUsageRecords() {
            var records = localStorage.getItem('chatUsageRecords');
            return records ? JSON.parse(records) : [];
        }
        
        function saveUsageRecord() {
            var records = getUsageRecords();
            records.push(Date.now());
            // åªä¿ç•™æœ€è¿‘30å¤©çš„è®°å½•
            var thirtyDaysAgo = Date.now() - 30 * 24 * 60 * 60 * 1000;
            records = records.filter(function(time) {
                return time > thirtyDaysAgo;
            });
            localStorage.setItem('chatUsageRecords', JSON.stringify(records));
        }
        
        function getUsageCount(hours) {
            var records = getUsageRecords();
            var cutoffTime = Date.now() - hours * 60 * 60 * 1000;
            return records.filter(function(time) {
                return time > cutoffTime;
            }).length;
        }
        
        function getDailyRemaining() {
            var used = getUsageCount(24);
            return Math.max(0, 7 - used);
        }
        
        function getWeeklyRemaining() {
            var used = getUsageCount(24 * 7);
            return Math.max(0, 21 - used);
        }
        
        function updateUsageDisplay() {
            var dailyRemaining = getDailyRemaining();
            var weeklyRemaining = getWeeklyRemaining();
            var dailySpan = document.getElementById('dailyRemaining');
            var weeklySpan = document.getElementById('weeklyRemaining');
            if(dailySpan) {
                dailySpan.textContent = dailyRemaining;
                dailySpan.style.color = dailyRemaining > 2 ? '#28a745' : (dailyRemaining > 0 ? '#ffc107' : '#dc3545');
            }
            if(weeklySpan) {
                weeklySpan.textContent = weeklyRemaining;
                weeklySpan.style.color = weeklyRemaining > 7 ? '#28a745' : (weeklyRemaining > 0 ? '#ffc107' : '#dc3545');
            }
        }
        
        function canUse() {
            var dailyRemaining = getDailyRemaining();
            var weeklyRemaining = getWeeklyRemaining();
            return dailyRemaining > 0 && weeklyRemaining > 0;
        }
        
        // 6. å‘é€æ¶ˆæ¯åˆ°è…¾è®¯äº‘
        async function sendMessage() {
            const userText = messageInput.value.trim();
            if (!userText || isThinking) return;
            
            // å¦‚æœå·²ç™»å½•ï¼Œæ£€æŸ¥ä½™é¢å¹¶æ‰£è´¹
            if (userToken) {
                try {
                    // å…ˆæ£€æŸ¥ä½™é¢
                    if (!userBalance || userBalance.balance < 0.1) {
                        if (confirm('ä½™é¢ä¸è¶³ï¼ˆéœ€è¦0.1å…ƒï¼‰ï¼Œæ˜¯å¦å‰å¾€å……å€¼ï¼Ÿ')) {
                            switchToRecharge();
                        }
                        return;
                    }
                    
                    // æ‰£è´¹
                    const useData = await apiUseService('assistant', 0.1);
                    if (useData.success) {
                        // æ›´æ–°ä½™é¢
                        userBalance.balance = useData.data.balanceAfter;
                        userBalance.availableTimes = useData.data.availableTimes;
                        updateBalanceDisplay();
                    } else {
                        alert(useData.message || 'æ‰£è´¹å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
                        return;
                    }
                } catch (error) {
                    console.error('æ‰£è´¹å¤±è´¥:', error);
                    alert('æ‰£è´¹å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
                    return;
                }
            } else {
                // æœªç™»å½•ï¼Œä½¿ç”¨åŸæ¥çš„æ¬¡æ•°é™åˆ¶é€»è¾‘
                if (!canUse()) {
                    var dailyRemaining = getDailyRemaining();
                    var weeklyRemaining = getWeeklyRemaining();
                    var msg = '';
                    if (dailyRemaining <= 0) {
                        msg = 'ä»Šæ—¥ä½¿ç”¨æ¬¡æ•°å·²ç”¨å®Œï¼ˆ24å°æ—¶å†…é™ç”¨7æ¬¡ï¼‰ï¼Œè¯·æ˜å¤©å†è¯•ã€‚';
                    } else if (weeklyRemaining <= 0) {
                        msg = 'æœ¬å‘¨ä½¿ç”¨æ¬¡æ•°å·²ç”¨å®Œï¼ˆä¸€å‘¨é™ç”¨21æ¬¡ï¼‰ï¼Œè¯·ä¸‹å‘¨å†è¯•ã€‚';
                    }
                    alert(msg);
                    return;
                }
                
                // è®°å½•ä½¿ç”¨
                saveUsageRecord();
                updateUsageDisplay();
            }
            
            // æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
            addMessage(userText, true);
            messageInput.value = '';
            messageInput.disabled = true;
            sendButton.disabled = true;
            isThinking = true;
            
            statusDiv.textContent = 'çŠ¶æ€: è¿æ¥ä¸­...';
            connectionStatus.textContent = 'ğŸŸ¡ è¿æ¥ä¸­';
            connectionStatus.style.color = '#ffc107';
            showThinking(true);
            
            // å…³é—­ä¹‹å‰çš„è¿æ¥
            if (currentEventSource) {
                currentEventSource.close();
                currentEventSource = null;
            }
            
            // å‡†å¤‡è¯·æ±‚æ•°æ®
            const requestData = {
                request_id: 'req-' + Date.now(),
                session_id: 'session-' + Date.now(),
                bot_app_key: BOT_APP_KEY,
                visitor_biz_id: 'visitor-' + Date.now(),
                content: userText,
                incremental: true,
                streaming_throttle: 3,
                visitor_labels: [],
                custom_variables: {},
                search_network: "disable",
                stream: "enable",
                workflow_status: "disable",
                tcadp_user_id: ""
            };
            
            try {
                statusDiv.textContent = 'çŠ¶æ€: ç­‰å¾…å“åº”...';
                
                // åˆ›å»ºSSEè¿æ¥
                const eventSource = new SimpleSSE(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'text/event-stream'
                    },
                    body: JSON.stringify(requestData)
                });
                
                currentEventSource = eventSource;
                
                // ä¸ºè¿™ä¸ªé—®é¢˜çš„å›ç­”åˆ›å»ºæ–°çš„æµå¼æ¶ˆæ¯æ¡†
                createStreamingMessage();
                
                // è¿æ¥æˆåŠŸ
                eventSource.on('open', function() {
                    showThinking(false);
                    statusDiv.textContent = 'çŠ¶æ€: å·²è¿æ¥ï¼Œç”Ÿæˆä¸­...';
                    connectionStatus.textContent = 'ğŸŸ¢ å·²è¿æ¥';
                    connectionStatus.style.color = '#28a745';
                });
                
                // å¤„ç†å›å¤äº‹ä»¶
                eventSource.on('reply', function(data) {
                    const { content, isFinal } = extractReplyContent(data);
                    
                    if (content) {
                        updateStreamingMessage(content, isFinal);
                        
                        if (isFinal) {
                            connectionStatus.textContent = 'ğŸŸ¢ å®Œæˆ';
                            setTimeout(() => {
                                eventSource.close();
                                resetInputState();
                            }, 500);
                        }
                    }
                });
                
                // é”™è¯¯å¤„ç†
                eventSource.on('error', function(err) {
                    console.error('è¿æ¥é”™è¯¯:', err);
                    connectionStatus.textContent = 'ğŸ”´ é”™è¯¯';
                    connectionStatus.style.color = '#dc3545';
                    
                    if (currentBotMessage) {
                        const textSpan = currentBotMessage.querySelector('.streaming-text');
                        if (textSpan && textSpan.textContent === '') {
                            textSpan.textContent = 'æŠ±æ­‰ï¼Œè¿æ¥æœåŠ¡å™¨æ—¶å‡ºç°é—®é¢˜ã€‚';
                        }
                        const cursor = currentBotMessage.querySelector('.typing-cursor');
                        if (cursor) cursor.remove();
                        currentBotMessage.classList.remove('streaming-message');
                        currentBotMessage = null;
                    }
                    
                    resetInputState();
                });
                
                // è¶…æ—¶è®¾ç½®
                setTimeout(function() {
                    if (isThinking) {
                        if (currentBotMessage) {
                            const textSpan = currentBotMessage.querySelector('.streaming-text');
                            if (textSpan && textSpan.textContent === '') {
                                textSpan.textContent = 'è¯·æ±‚è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•ã€‚';
                            }
                            const cursor = currentBotMessage.querySelector('.typing-cursor');
                            if (cursor) cursor.remove();
                            currentBotMessage.classList.remove('streaming-message');
                            currentBotMessage = null;
                        }
                        if (eventSource && eventSource.readyState !== 2) {
                            eventSource.close();
                        }
                        resetInputState();
                    }
                }, 30000);
                
            } catch (error) {
                console.error('åˆ›å»ºè¿æ¥å¤±è´¥:', error);
                if (currentBotMessage) {
                    const textSpan = currentBotMessage.querySelector('.streaming-text');
                    if (textSpan) {
                        textSpan.textContent = 'åˆ›å»ºè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥é…ç½®ã€‚';
                    }
                    const cursor = currentBotMessage.querySelector('.typing-cursor');
                    if (cursor) cursor.remove();
                    currentBotMessage.classList.remove('streaming-message');
                    currentBotMessage = null;
                }
                resetInputState();
            }
        }
        
        // 7. é‡ç½®è¾“å…¥çŠ¶æ€
        function resetInputState() {
            messageInput.disabled = false;
            sendButton.disabled = false;
            messageInput.focus();
            isThinking = false;
            showThinking(false);
            
            if (currentEventSource) {
                currentEventSource.close();
                currentEventSource = null;
            }
            
            connectionStatus.textContent = 'ğŸŸ¢ å°±ç»ª';
            connectionStatus.style.color = '#28a745';
            statusDiv.textContent = 'çŠ¶æ€: ç­‰å¾…è¾“å…¥';
            updateUsageDisplay(); // æ›´æ–°ä½¿ç”¨æ¬¡æ•°æ˜¾ç¤º
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–ä½¿ç”¨æ¬¡æ•°æ˜¾ç¤º
        (function initUsageDisplay() {
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    setTimeout(updateUsageDisplay, 100);
                });
            } else {
                setTimeout(updateUsageDisplay, 100);
            }
        })();
        
        // ========================================
        // SSEå®ç°
        // ========================================
        class SimpleSSE {
            constructor(url, options) {
                this.url = url;
                this.options = options || {};
                this.listeners = {};
                this.readyState = 0;
                this.connect();
            }
            
            connect() {
                const self = this;
                this.readyState = 0;
                
                const headers = {
                    'Content-Type': 'application/json',
                    'Accept': 'text/event-stream',
                    ...this.options.headers
                };
                
                fetch(this.url, {
                    method: this.options.method || 'POST',
                    headers: headers,
                    body: this.options.body
                }).then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    self.readyState = 1;
                    self.dispatchEvent('open', {});
                    
                    const reader = response.body.getReader();
                    const decoder = new TextDecoder();
                    let buffer = '';
                    let eventType = 'message';
                    
                    function processChunk(result) {
                        if (result.done) {
                            self.close();
                            return;
                        }
                        
                        buffer += decoder.decode(result.value, { stream: true });
                        const lines = buffer.split('\n');
                        buffer = lines.pop() || '';
                        
                        for (let line of lines) {
                            if (line.startsWith('event:')) {
                                eventType = line.substring(6).trim();
                            } else if (line.startsWith('data:')) {
                                const data = line.substring(5).trim();
                                if (data) {
                                    try {
                                        const jsonData = JSON.parse(data);
                                        self.dispatchEvent(eventType, jsonData);
                                    } catch (e) {
                                        console.warn('è§£ææ•°æ®å¤±è´¥:', data);
                                    }
                                }
                            }
                        }
                        
                        return reader.read().then(processChunk);
                    }
                    
                    return reader.read().then(processChunk);
                }).catch(error => {
                    self.dispatchEvent('error', error);
                    self.close();
                });
            }
            
            on(event, callback) {
                if (!this.listeners[event]) {
                    this.listeners[event] = [];
                }
                this.listeners[event].push(callback);
            }
            
            dispatchEvent(event, data) {
                const listeners = this.listeners[event] || [];
                listeners.forEach(listener => {
                    try {
                        listener(data);
                    } catch (error) {
                        console.error(`äº‹ä»¶å¤„ç†é”™è¯¯:`, error);
                    }
                });
            }
            
            close() {
                if (this.readyState === 2) return;
                this.readyState = 2;
                this.dispatchEvent('close', {});
            }
        }
        
        // ========================================
        // äº‹ä»¶ç›‘å¬
        // ========================================
        messageInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        });
        
        // é¡µé¢åŠ è½½åè‡ªåŠ¨èšç„¦è¾“å…¥æ¡†
        window.addEventListener('load', function() {
            messageInput.focus();
            console.log('å‘¨æ˜“å­¦ä¹ ç³»ç»Ÿå·²åŠ è½½');
        });
    </script>

    <!-- å¼€åœºè§†é¢‘æ§åˆ¶è„šæœ¬ -->
    <script>
        // #region agent log
        // è„šæœ¬å¼€å§‹æ‰§è¡Œ
        console.log('å¼€åœºè§†é¢‘è„šæœ¬å¼€å§‹æ‰§è¡Œ');
        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-script',message:'å¼€åœºè§†é¢‘è„šæœ¬å¼€å§‹æ‰§è¡Œ',data:{timestamp:Date.now()},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
        // #endregion
        
        document.addEventListener('DOMContentLoaded', function() {
            // #region agent log
            console.log('DOMContentLoadedäº‹ä»¶è§¦å‘');
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded',message:'DOMåŠ è½½å®Œæˆ',data:{timestamp:Date.now()},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
            // #endregion
            
            const openingVideoContainer = document.getElementById('opening-video-container');
            const openingVideo = document.getElementById('opening-video');
            const openingVideoBg = document.getElementById('opening-video-bg');
            const mainContent = document.getElementById('main-content');
            const enterButton = document.getElementById('enter-button');
            
            // #region agent log
            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:DOMContentLoaded',message:'å…ƒç´ æŸ¥æ‰¾ç»“æœ',data:{hasContainer:!!openingVideoContainer,hasVideo:!!openingVideo,hasBg:!!openingVideoBg,hasMain:!!mainContent,hasButton:!!enterButton},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
            // #endregion

            // ç¡®ä¿èƒŒæ™¯è§†é¢‘æ’­æ”¾
            if(openingVideoBg) {
                openingVideoBg.play().catch(err => {
                    console.log('èƒŒæ™¯è§†é¢‘æ’­æ”¾å¤±è´¥:', err);
                    // #region agent log
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-bg-play',message:'èƒŒæ™¯è§†é¢‘æ’­æ”¾å¤±è´¥',data:{error:err.message},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                    // #endregion
                });
            }
            
            // åˆå§‹åŒ–ï¼šç¡®ä¿æŒ‰é’®å¯ç”¨
            if(enterButton) {
                enterButton.style.pointerEvents = 'auto';
                enterButton.style.cursor = 'pointer';
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:button-init',message:'æŒ‰é’®åˆå§‹åŒ–',data:{pointerEvents:enterButton.style.pointerEvents},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                // #endregion
            } else {
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:button-init',message:'æŒ‰é’®å…ƒç´ ä¸å­˜åœ¨',data:{},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'})}).catch(()=>{});
                // #endregion
            }
            
            // é˜²æ­¢è§†é¢‘å®¹å™¨æœ¬èº«çš„ç‚¹å‡»äº‹ä»¶å¹²æ‰°
            if(openingVideoContainer) {
                openingVideoContainer.addEventListener('click', function(e) {
                    // å¦‚æœç‚¹å‡»çš„æ˜¯å®¹å™¨æœ¬èº«è€Œä¸æ˜¯æŒ‰é’®ï¼Œä¸åšä»»ä½•å¤„ç†
                    if(e.target === openingVideoContainer || e.target === openingVideo || e.target === openingVideoBg) {
                        e.stopPropagation();
                    }
                }, true);
            }

            // "ç‚¹å‡»è¿›å…¥"æŒ‰é’®ç‚¹å‡»äº‹ä»¶ - æ·»åŠ é˜²æŠ–å’Œäº‹ä»¶å¤„ç†ä¼˜åŒ–
            var isProcessing = false; // é˜²æ­¢é‡å¤ç‚¹å‡»
            var clickHandler = function(e) {
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:clickHandler',message:'clickHandlerè¢«è°ƒç”¨',data:{type:e.type,isProcessing:isProcessing,hasVideo:!!openingVideo,videoEnded:openingVideo?openingVideo.ended:null,videoCurrentTime:openingVideo?openingVideo.currentTime:null},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                
                e.preventDefault();
                e.stopPropagation();
                
                // å¦‚æœæ­£åœ¨å¤„ç†ä¸­ï¼Œç›´æ¥è¿”å›
                if(isProcessing) {
                    // #region agent log
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:clickHandler',message:'æ­£åœ¨å¤„ç†ä¸­ï¼Œå¿½ç•¥é‡å¤ç‚¹å‡»',data:{isProcessing:isProcessing},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                    // #endregion
                    console.log('æ­£åœ¨å¤„ç†ä¸­ï¼Œå¿½ç•¥é‡å¤ç‚¹å‡»');
                    return false;
                }
                
                // å¦‚æœè§†é¢‘å·²ç»æ’­æ”¾å®Œæˆæˆ–ä¸åœ¨åˆå§‹çŠ¶æ€ï¼Œé‡ç½®çŠ¶æ€
                if(openingVideo && (openingVideo.ended || openingVideo.currentTime > 0)) {
                    // #region agent log
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:clickHandler',message:'é‡ç½®è§†é¢‘çŠ¶æ€',data:{ended:openingVideo.ended,currentTime:openingVideo.currentTime},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                    // #endregion
                    openingVideo.currentTime = 0;
                    openingVideo.ended = false;
                }
                
                isProcessing = true;
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:clickHandler',message:'è®¾ç½®isProcessing=true',data:{isProcessing:true},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                // #endregion
                
                // ç¡®ä¿main-contentå®Œå…¨éšè—
                mainContent.style.opacity = '0';
                mainContent.style.visibility = 'hidden';
                mainContent.style.pointerEvents = 'none';
                mainContent.classList.remove('visible');
                
                // éšè—æŒ‰é’®å¹¶ç¦ç”¨ç‚¹å‡»
                enterButton.classList.add('hidden');
                enterButton.style.pointerEvents = 'none';
                
                // æš‚åœå¹¶å®Œå…¨éšè—èƒŒæ™¯è§†é¢‘
                openingVideoBg.pause();
                openingVideoBg.style.display = 'none';
                openingVideoBg.style.opacity = '0';
                openingVideoBg.style.visibility = 'hidden';
                openingVideoBg.classList.add('hidden');
                
                // æ˜¾ç¤ºä¸»è§†é¢‘
                openingVideo.classList.add('playing');
                openingVideo.style.opacity = '1';
                openingVideo.style.visibility = 'visible';
                openingVideo.style.display = 'block';
                
                // é‡ç½®è§†é¢‘çŠ¶æ€
                openingVideo.currentTime = 0;
                openingVideo.muted = false;
                
                // åŠ è½½è§†é¢‘æºï¼ˆç¡®ä¿åœ¨æ’­æ”¾å‰åŠ è½½ï¼‰
                if(!openingVideo.src || openingVideo.src.indexOf('å¼€æœºåŠ¨æ¼«.mp4') < 0) {
                    openingVideo.src = 'å¼€æœºåŠ¨æ¼«.mp4';
                    openingVideo.load();
                }
                
                // ä½¿ç”¨setTimeoutç¡®ä¿DOMæ›´æ–°åå†æ’­æ”¾
                setTimeout(function() {
                    var playPromise = openingVideo.play();
                    
                    if(playPromise !== undefined) {
                        playPromise.then(() => {
                            // #region agent log
                            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-play',message:'è§†é¢‘æ’­æ”¾æˆåŠŸ',data:{isProcessing_before:isProcessing},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                            // #endregion
                            console.log('è§†é¢‘å¼€å§‹æ’­æ”¾ï¼ˆæœ‰å£°éŸ³ï¼‰');
                            isProcessing = false; // æ’­æ”¾æˆåŠŸåé‡ç½®æ ‡å¿—
                            // #region agent log
                            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-play',message:'é‡ç½®isProcessing=falseï¼ˆæˆåŠŸï¼‰',data:{isProcessing:false},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                            // #endregion
                        }).catch(error => {
                            // #region agent log
                            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-play',message:'è§†é¢‘æ’­æ”¾å¤±è´¥',data:{error:error.message,isProcessing_before:isProcessing},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                            // #endregion
                            console.log('æ’­æ”¾å¤±è´¥:', error);
                            isProcessing = false; // æ’­æ”¾å¤±è´¥åé‡ç½®æ ‡å¿—
                            // #region agent log
                            fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-play',message:'é‡ç½®isProcessing=falseï¼ˆå¤±è´¥ï¼‰',data:{isProcessing:false},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                            // #endregion
                            // å¦‚æœæ’­æ”¾å¤±è´¥ï¼Œç›´æ¥æ˜¾ç¤ºä¸»è¦å†…å®¹
                            if(openingVideoContainer) {
                                openingVideoContainer.classList.add('hidden');
                                openingVideoContainer.style.display = 'none';
                            }
                            // æ¸…é™¤ä¹‹å‰è®¾ç½®çš„style
                            if(mainContent) {
                                mainContent.style.opacity = '';
                                mainContent.style.visibility = '';
                                mainContent.style.pointerEvents = '';
                                mainContent.classList.add('visible');
                            }
                        });
                    } else {
                        // #region agent log
                        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-play',message:'æ²¡æœ‰playPromiseï¼Œç«‹å³é‡ç½®',data:{isProcessing_before:isProcessing},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                        // #endregion
                        isProcessing = false; // å¦‚æœæ²¡æœ‰promiseï¼Œç«‹å³é‡ç½®æ ‡å¿—
                        // #region agent log
                        fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-play',message:'é‡ç½®isProcessing=falseï¼ˆæ— promiseï¼‰',data:{isProcessing:false},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                        // #endregion
                    }
                }, 100); // å»¶è¿Ÿ100msç¡®ä¿DOMæ›´æ–°
                
                return false;
            };
            
            // æ·»åŠ å¤šç§äº‹ä»¶ç›‘å¬ï¼Œç¡®ä¿åœ¨ç§»åŠ¨ç«¯ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ
            if(!enterButton) {
                console.error('enter-button å…ƒç´ ä¸å­˜åœ¨');
                return;
            }
            
            // é˜²æ­¢è§¦æ‘¸æ—¶å‡ºç°300mså»¶è¿Ÿ
            var touchStartTime = 0;
            var touchHandled = false;
            
            // ä½¿ç”¨ç»Ÿä¸€çš„äº‹ä»¶å¤„ç†ï¼Œé¿å…é‡å¤è§¦å‘
            var handleEnterClick = function(e) {
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:handleEnterClick',message:'handleEnterClickè¢«è°ƒç”¨',data:{type:e.type,isProcessing:isProcessing},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                e.preventDefault();
                e.stopPropagation();
                clickHandler(e);
                return false;
            };
            
            // æ·»åŠ touchstartå¤„ç†ï¼ˆépassiveï¼Œä»¥ä¾¿ç«‹å³å“åº”ï¼‰
            enterButton.addEventListener('touchstart', function(e) {
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:touchstart',message:'touchstartäº‹ä»¶è§¦å‘',data:{isProcessing:isProcessing},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                touchStartTime = Date.now();
                touchHandled = false;
                // æ·»åŠ è§†è§‰åé¦ˆ
                enterButton.style.opacity = '0.8';
                enterButton.style.transform = 'scale(0.95)';
                // ç«‹å³è§¦å‘å¤„ç†ï¼Œé¿å…ç­‰å¾…touchend
                if(!isProcessing) {
                    touchHandled = true;
                    handleEnterClick(e);
                }
            }, {passive: false, capture: true});
            
            // æ·»åŠ touchendå¤„ç†ï¼ˆä½œä¸ºå¤‡ç”¨ï¼Œä½†é€šå¸¸ä¸ä¼šæ‰§è¡Œå› ä¸ºtouchstartå·²ç»å¤„ç†äº†ï¼‰
            enterButton.addEventListener('touchend', function(e) {
                // #region agent log
                var touchDuration = Date.now() - touchStartTime;
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:touchend',message:'touchendäº‹ä»¶è§¦å‘',data:{touchDuration:touchDuration,touchHandled:touchHandled,isProcessing:isProcessing},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                e.preventDefault();
                e.stopPropagation();
                enterButton.style.opacity = '1';
                enterButton.style.transform = 'scale(1)';
                
                // å¦‚æœtouchstartæ²¡æœ‰å¤„ç†ï¼Œtouchendæ‰å¤„ç†
                if(!touchHandled && Date.now() - touchStartTime < 500 && !isProcessing) {
                    touchHandled = true;
                    handleEnterClick(e);
                }
            }, {passive: false, capture: true});
            
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼ˆä½œä¸ºæœ€åå¤‡ç”¨ï¼Œåªåœ¨éè§¦æ‘¸è®¾å¤‡ä¸Šä½¿ç”¨ï¼‰
            enterButton.addEventListener('click', function(e) {
                // #region agent log
                fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:click-event',message:'clickäº‹ä»¶è§¦å‘',data:{touchHandled:touchHandled,isProcessing:isProcessing},timestamp:Date.now(),sessionId:'debug-session',runId:'run2',hypothesisId:'E'})}).catch(()=>{});
                // #endregion
                // å¦‚æœè§¦æ‘¸äº‹ä»¶å·²ç»å¤„ç†äº†ï¼Œå°±ä¸é‡å¤å¤„ç†
                if(!touchHandled && !isProcessing) {
                    handleEnterClick(e);
                }
            }, {passive: false, capture: true});

            // è§†é¢‘æ’­æ”¾å®Œæˆåçš„å¤„ç†
            if(openingVideo) {
                openingVideo.addEventListener('ended', function() {
                    // #region agent log
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-ended',message:'è§†é¢‘æ’­æ”¾å®Œæˆäº‹ä»¶',data:{isProcessing_before:isProcessing},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                    // #endregion
                    console.log('è§†é¢‘æ’­æ”¾å®Œæˆ');
                    isProcessing = false; // é‡ç½®å¤„ç†æ ‡å¿—
                    // #region agent log
                    fetch('http://127.0.0.1:7242/ingest/5a1f2dbc-c50d-4e3d-88cc-81b126ea16f9',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:video-ended',message:'è§†é¢‘æ’­æ”¾å®Œæˆï¼Œé‡ç½®isProcessing=false',data:{isProcessing:false},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
                    // #endregion
                    
                    // éšè—å¼€åœºè§†é¢‘å®¹å™¨
                    if(openingVideoContainer) {
                        openingVideoContainer.classList.add('hidden');
                        openingVideoContainer.style.display = 'none';
                    }
                    
                    // é‡ç½®è§†é¢‘çŠ¶æ€
                    openingVideo.currentTime = 0;
                    openingVideo.pause();
                    openingVideo.muted = true;
                    
                    // æ¢å¤æŒ‰é’®çŠ¶æ€ï¼ˆè™½ç„¶å·²ç»éšè—ï¼Œä½†é‡ç½®ä»¥é˜²ä¸‹æ¬¡éœ€è¦ï¼‰
                    if(enterButton) {
                        enterButton.classList.remove('hidden');
                        enterButton.style.pointerEvents = '';
                    }
                    
                    // æ˜¾ç¤ºä¸»è¦å†…å®¹ - æ¸…é™¤ä¹‹å‰è®¾ç½®çš„styleï¼Œä½¿ç”¨CSSç±»
                    if(mainContent) {
                        mainContent.style.opacity = '';
                        mainContent.style.visibility = '';
                        mainContent.style.pointerEvents = '';
                        mainContent.classList.add('visible');
                    }
                });

                // å¦‚æœè§†é¢‘åŠ è½½å¤±è´¥æˆ–æ— æ³•æ’­æ”¾ï¼Œç›´æ¥æ˜¾ç¤ºä¸»è¦å†…å®¹
                openingVideo.addEventListener('error', function(e) {
                    console.log('å¼€åœºè§†é¢‘åŠ è½½å¤±è´¥:', e);
                    if(openingVideoContainer) {
                        openingVideoContainer.classList.add('hidden');
                        openingVideoContainer.style.display = 'none';
                    }
                    // æ¸…é™¤ä¹‹å‰è®¾ç½®çš„style
                    if(mainContent) {
                        mainContent.style.opacity = '';
                        mainContent.style.visibility = '';
                        mainContent.style.pointerEvents = '';
                        mainContent.classList.add('visible');
                    }
                });

                // è§†é¢‘å¯ä»¥æ’­æ”¾æ—¶ï¼ˆç¡®ä¿è§†é¢‘å·²åŠ è½½ï¼‰
                openingVideo.addEventListener('canplay', function() {
                    console.log('è§†é¢‘å¯ä»¥æ’­æ”¾');
                    // æ¢å¤æŒ‰é’®çš„ç‚¹å‡»èƒ½åŠ›
                    if(enterButton) {
                        enterButton.style.pointerEvents = 'auto';
                    }
                });
                
                // è§†é¢‘åŠ è½½å®Œæˆ
                openingVideo.addEventListener('loadeddata', function() {
                    console.log('è§†é¢‘æ•°æ®åŠ è½½å®Œæˆ');
                    isProcessing = false; // ç¡®ä¿åŠ è½½å®Œæˆåé‡ç½®æ ‡å¿—
                });
                
                // è§†é¢‘å¼€å§‹æ’­æ”¾æ—¶
                openingVideo.addEventListener('playing', function() {
                    console.log('è§†é¢‘æ­£åœ¨æ’­æ”¾');
                    isProcessing = false; // ç¡®ä¿æ’­æ”¾å¼€å§‹æ—¶é‡ç½®æ ‡å¿—
                });
            }
        });
        
        // ========================================
        // ç¬¬ä¸€éƒ¨åˆ†ï¼šAPIæœåŠ¡å°è£…å’ŒåŸºç¡€ç™»å½•åŠŸèƒ½
        // ========================================
        
        // APIåŸºç¡€é…ç½®
        const API_BASE = window.location.protocol === 'file:' 
            ? 'http://localhost:3000' 
            : window.location.origin;
        
        // ç”¨æˆ·çŠ¶æ€ç®¡ç†
        let currentUser = null;
        let userToken = null;
        let userBindings = null;
        
        // ========================================
        // APIæœåŠ¡å°è£…
        // ========================================
        
        /**
         * ç»Ÿä¸€çš„APIè¯·æ±‚å‡½æ•°
         */
        async function apiRequest(url, options = {}) {
            const defaultOptions = {
                headers: {
                    'Content-Type': 'application/json'
                }
            };
            
            // å¦‚æœæœ‰Tokenï¼Œæ·»åŠ åˆ°è¯·æ±‚å¤´
            if (userToken) {
                defaultOptions.headers['Authorization'] = `Bearer ${userToken}`;
            }
            
            const finalOptions = {
                ...defaultOptions,
                ...options,
                headers: {
                    ...defaultOptions.headers,
                    ...(options.headers || {})
                }
            };
            
            try {
                const response = await fetch(`${API_BASE}${url}`, finalOptions);
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('APIè¯·æ±‚å¤±è´¥:', error);
                throw error;
            }
        }
        
        // ========================================
        // ç”¨æˆ·è®¤è¯ç›¸å…³API
        // ========================================
        
        /**
         * ç”Ÿæˆ50ä½å”¯ä¸€ID
         */
        async function generateUserId() {
            return await apiRequest('/api/user/generate-id', {
                method: 'POST'
            });
        }
        
        /**
         * IDç™»å½•
         */
        async function apiLoginWithId(uniqueId) {
            return await apiRequest('/api/user/login/id', {
                method: 'POST',
                body: JSON.stringify({ unique_id: uniqueId })
            });
        }
        
        /**
         * é‚®ç®±ç™»å½•
         */
        async function apiLoginWithEmail(email, code) {
            return await apiRequest('/api/user/login/email', {
                method: 'POST',
                body: JSON.stringify({ email, code })
            });
        }
        
        /**
         * é‚®ç®±æ³¨å†Œ
         */
        async function apiRegisterWithEmail(email, code, nickname) {
            return await apiRequest('/api/user/register', {
                method: 'POST',
                body: JSON.stringify({ email, code, nickname: nickname || null })
            });
        }
        
        /**
         * å‘é€éªŒè¯ç 
         */
        async function apiSendVerificationCode(email, type) {
            return await apiRequest('/api/user/send-verification-code', {
                method: 'POST',
                body: JSON.stringify({ email, type })
            });
        }
        
        /**
         * è·å–ç”¨æˆ·ä¿¡æ¯
         */
        async function apiGetUserProfile() {
            return await apiRequest('/api/user/profile', {
                method: 'GET'
            });
        }
        
        /**
         * éªŒè¯Token
         */
        async function apiVerifyToken(token) {
            return await apiRequest('/api/user/verify-token', {
                method: 'POST',
                body: JSON.stringify({ token })
            });
        }
        
        // ========================================
        // ç¬¬äºŒéƒ¨åˆ†ï¼šè´¦å·ç»‘å®šç›¸å…³API
        // ========================================
        
        /**
         * è·å–ç»‘å®šä¿¡æ¯
         */
        async function apiGetBindings() {
            return await apiRequest('/api/user/bindings', {
                method: 'GET'
            });
        }
        
        /**
         * ç»‘å®šæ”¯ä»˜å®
         */
        async function apiBindAlipay(authCode) {
            return await apiRequest('/api/user/bind/alipay', {
                method: 'POST',
                body: JSON.stringify({ auth_code: authCode })
            });
        }
        
        /**
         * ç»‘å®šå¾®ä¿¡
         */
        async function apiBindWechat(code) {
            return await apiRequest('/api/user/bind/wechat', {
                method: 'POST',
                body: JSON.stringify({ code: code })
            });
        }
        
        /**
         * ç»‘å®šé‚®ç®±
         */
        async function apiBindEmail(email, code) {
            return await apiRequest('/api/user/bind/email', {
                method: 'POST',
                body: JSON.stringify({ email: email, code: code })
            });
        }
        
        /**
         * è§£ç»‘è´¦å·
         */
        async function apiUnbindAccount(bindType) {
            return await apiRequest('/api/user/unbind', {
                method: 'POST',
                body: JSON.stringify({ bind_type: bindType })
            });
        }
        
        // ========================================
        // åˆå§‹åŒ–ï¼šæ£€æŸ¥ç™»å½•çŠ¶æ€
        // ========================================
        
        function initUserAuth() {
            userToken = localStorage.getItem('userToken');
            const savedUserId = localStorage.getItem('userId');
            
            if (userToken && savedUserId) {
                checkLoginStatus();
            }
        }
        
        /**
         * æ£€æŸ¥ç™»å½•çŠ¶æ€
         */
        async function checkLoginStatus() {
            if (!userToken) return;
            
            try {
                const data = await apiGetUserProfile();
                
                if (data.success) {
                    currentUser = data.data;
                    showUserInfo();
                    // åŠ è½½ä½™é¢
                    await loadBalance();
                } else {
                    // Tokenæ— æ•ˆï¼Œæ¸…é™¤ç™»å½•çŠ¶æ€
                    logout();
                }
            } catch (error) {
                console.error('æ£€æŸ¥ç™»å½•çŠ¶æ€å¤±è´¥:', error);
                // ç½‘ç»œé”™è¯¯æ—¶ä¸è‡ªåŠ¨é€€å‡ºï¼Œä¿ç•™Token
            }
        }
        
        // ========================================
        // ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
        // ========================================
        
        /**
         * æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯é¢æ¿
         */
        async function showUserInfo() {
            if (!currentUser) return;
            
            document.getElementById('loginFormPanel').style.display = 'none';
            document.getElementById('userInfoPanel').style.display = 'block';
            
            // è·å–æœ€æ–°çš„ç»‘å®šä¿¡æ¯
            await loadBindings();
            
            const userInfoContent = document.getElementById('userInfoContent');
            userInfoContent.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <p><strong>å”¯ä¸€IDï¼š</strong><span id="userUniqueId" style="font-family: monospace; font-size: 12px;">${currentUser.unique_id}</span> 
                    <button onclick="copyUserId()" style="margin-left: 10px; padding: 5px 10px; background: #3498db; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 12px;">å¤åˆ¶</button></p>
                    <p style="margin-top: 10px;"><strong>æ˜µç§°ï¼š</strong>${currentUser.nickname || 'æœªè®¾ç½®'}</p>
                </div>
                
                <div style="border-top: 1px solid #eee; padding-top: 15px; margin-top: 15px;">
                    <h4 style="margin-bottom: 10px; color: #2c3e50;">è´¦å·ç»‘å®š</h4>
                    
                    <!-- é‚®ç®±ç»‘å®š -->
                    <div style="margin-bottom: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>é‚®ç®±ï¼š</strong>
                                <span id="emailDisplay">${userBindings?.email?.account || currentUser.email || 'æœªç»‘å®š'}</span>
                                ${userBindings?.email?.verified ? ' <span style="color: green;">âœ“</span>' : ''}
                            </div>
                            <div>
                                ${userBindings?.email?.bound 
                                    ? '<button onclick="unbindAccount(\'email\')" class="btn-unbind">è§£ç»‘</button>'
                                    : '<button onclick="showBindEmailForm()" class="btn-bind">ç»‘å®š</button>'
                                }
                            </div>
                        </div>
                        <div id="bindEmailForm" style="display: none; margin-top: 10px; padding-top: 10px; border-top: 1px solid #ddd;">
                            <input type="email" id="bindEmailInput" placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€" style="width: 60%; padding: 5px; margin-right: 5px;">
                            <input type="text" id="bindEmailCodeInput" placeholder="éªŒè¯ç " maxlength="6" style="width: 20%; padding: 5px; margin-right: 5px;">
                            <button onclick="sendBindEmailCode()" id="sendBindEmailCodeBtn" class="btn-secondary" style="padding: 5px 10px; font-size: 12px;">å‘é€</button>
                            <div id="bindEmailCodeCountdown" style="display: none; color: #666; font-size: 12px; margin-top: 5px;"></div>
                            <div style="margin-top: 10px;">
                                <button onclick="bindEmail()" class="btn-bind" style="padding: 5px 15px;">ç¡®è®¤ç»‘å®š</button>
                                <button onclick="hideBindEmailForm()" class="btn-secondary" style="padding: 5px 15px; margin-left: 10px;">å–æ¶ˆ</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ”¯ä»˜å®ç»‘å®š -->
                    <div style="margin-bottom: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>æ”¯ä»˜å®ï¼š</strong>
                                <span id="alipayDisplay">${userBindings?.alipay?.account || currentUser.alipay_account || 'æœªç»‘å®š'}</span>
                            </div>
                            <div>
                                ${userBindings?.alipay?.bound 
                                    ? '<button onclick="unbindAccount(\'alipay\')" class="btn-unbind">è§£ç»‘</button>'
                                    : '<button onclick="bindAlipay()" class="btn-bind">ç»‘å®š</button>'
                                }
                            </div>
                        </div>
                    </div>
                    
                    <!-- å¾®ä¿¡ç»‘å®š -->
                    <div style="margin-bottom: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>å¾®ä¿¡ï¼š</strong>
                                <span id="wechatDisplay">${userBindings?.wechat?.account || currentUser.wechat_account || 'æœªç»‘å®š'}</span>
                            </div>
                            <div>
                                ${userBindings?.wechat?.bound 
                                    ? '<button onclick="unbindAccount(\'wechat\')" class="btn-unbind">è§£ç»‘</button>'
                                    : '<button onclick="bindWechat()" class="btn-bind">ç»‘å®š</button>'
                                }
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // æ·»åŠ ç»‘å®šæŒ‰é’®æ ·å¼
            if (!document.getElementById('bindingStyles')) {
                const style = document.createElement('style');
                style.id = 'bindingStyles';
                style.textContent = `
                    .btn-bind {
                        padding: 5px 15px;
                        background: #8B4513;
                        color: white;
                        border: none;
                        border-radius: 3px;
                        cursor: pointer;
                        font-size: 12px;
                    }
                    .btn-bind:hover {
                        background: #A0522D;
                    }
                    .btn-unbind {
                        padding: 5px 15px;
                        background: #e74c3c;
                        color: white;
                        border: none;
                        border-radius: 3px;
                        cursor: pointer;
                        font-size: 12px;
                    }
                    .btn-unbind:hover {
                        background: #c0392b;
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        /**
         * æ˜¾ç¤ºç™»å½•è¡¨å•
         */
        function showLoginForm() {
            document.getElementById('userInfoPanel').style.display = 'none';
            document.getElementById('loginFormPanel').style.display = 'block';
        }
        
        // ========================================
        // ç™»å½•/æ³¨å†ŒåŠŸèƒ½
        // ========================================
        
        /**
         * åˆ‡æ¢ç™»å½•/æ³¨å†Œæ ‡ç­¾
         */
        function switchLoginTab(tab) {
            document.querySelectorAll('.login-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (tab === 'login') {
                document.getElementById('registerEmailSection').style.display = 'none';
                document.getElementById('loginEmailSection').style.display = 'block';
            } else {
                document.getElementById('loginEmailSection').style.display = 'none';
                document.getElementById('registerEmailSection').style.display = 'block';
            }
        }
        
        /**
         * æ˜¾ç¤ºæ¶ˆæ¯æç¤º
         */
        function showMessage(message, type = 'success') {
            const msgDiv = document.getElementById('loginMessage');
            msgDiv.textContent = message;
            msgDiv.className = type;
            msgDiv.style.display = 'block';
            
            setTimeout(() => {
                msgDiv.style.display = 'none';
            }, 3000);
        }
        
        /**
         * IDç™»å½•
         */
        async function loginWithId() {
            const uniqueId = document.getElementById('loginIdInput').value.trim();
            
            if (!uniqueId || uniqueId.length !== 50) {
                showMessage('è¯·è¾“å…¥æ­£ç¡®çš„50ä½å”¯ä¸€ID', 'error');
                return;
            }
            
            try {
                const data = await apiLoginWithId(uniqueId);
                
                if (data.success) {
                    userToken = data.data.token;
                    currentUser = data.data.user;
                    localStorage.setItem('userToken', userToken);
                    localStorage.setItem('userId', currentUser.unique_id);
                    showMessage('ç™»å½•æˆåŠŸï¼', 'success');
                    showUserInfo();
                } else {
                    showMessage(data.message || 'ç™»å½•å¤±è´¥', 'error');
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                console.error('IDç™»å½•å¤±è´¥:', error);
            }
        }
        
        /**
         * å‘é€ç™»å½•éªŒè¯ç 
         */
        async function sendLoginCode() {
            const email = document.getElementById('loginEmailInput').value.trim();
            
            if (!email) {
                showMessage('è¯·è¾“å…¥é‚®ç®±åœ°å€', 'error');
                return;
            }
            
            const btn = document.getElementById('sendLoginCodeBtn');
            btn.disabled = true;
            
            try {
                const data = await apiSendVerificationCode(email, 'login');
                
                if (data.success) {
                    showMessage('éªŒè¯ç å·²å‘é€ï¼Œè¯·æŸ¥æ”¶é‚®ä»¶', 'success');
                    startCountdown('loginCodeCountdown', 60, btn);
                } else {
                    showMessage(data.message || 'å‘é€å¤±è´¥', 'error');
                    btn.disabled = false;
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                btn.disabled = false;
                console.error('å‘é€éªŒè¯ç å¤±è´¥:', error);
            }
        }
        
        /**
         * é‚®ç®±ç™»å½•
         */
        async function loginWithEmail() {
            const email = document.getElementById('loginEmailInput').value.trim();
            const code = document.getElementById('loginCodeInput').value.trim();
            
            if (!email || !code) {
                showMessage('è¯·è¾“å…¥é‚®ç®±å’ŒéªŒè¯ç ', 'error');
                return;
            }
            
            try {
                const data = await apiLoginWithEmail(email, code);
                
                if (data.success) {
                    userToken = data.data.token;
                    currentUser = data.data.user;
                    localStorage.setItem('userToken', userToken);
                    localStorage.setItem('userId', currentUser.unique_id);
                    showMessage('ç™»å½•æˆåŠŸï¼', 'success');
                    showUserInfo();
                } else {
                    showMessage(data.message || 'ç™»å½•å¤±è´¥', 'error');
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                console.error('é‚®ç®±ç™»å½•å¤±è´¥:', error);
            }
        }
        
        /**
         * å‘é€æ³¨å†ŒéªŒè¯ç 
         */
        async function sendRegisterCode() {
            const email = document.getElementById('registerEmailInput').value.trim();
            
            if (!email) {
                showMessage('è¯·è¾“å…¥é‚®ç®±åœ°å€', 'error');
                return;
            }
            
            const btn = document.getElementById('sendRegisterCodeBtn');
            btn.disabled = true;
            
            try {
                const data = await apiSendVerificationCode(email, 'register');
                
                if (data.success) {
                    showMessage('éªŒè¯ç å·²å‘é€ï¼Œè¯·æŸ¥æ”¶é‚®ä»¶', 'success');
                    startCountdown('registerCodeCountdown', 60, btn);
                } else {
                    showMessage(data.message || 'å‘é€å¤±è´¥', 'error');
                    btn.disabled = false;
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                btn.disabled = false;
                console.error('å‘é€éªŒè¯ç å¤±è´¥:', error);
            }
        }
        
        /**
         * é‚®ç®±æ³¨å†Œ
         */
        async function registerWithEmail() {
            const email = document.getElementById('registerEmailInput').value.trim();
            const code = document.getElementById('registerCodeInput').value.trim();
            const nickname = document.getElementById('registerNicknameInput').value.trim();
            
            if (!email || !code) {
                showMessage('è¯·è¾“å…¥é‚®ç®±å’ŒéªŒè¯ç ', 'error');
                return;
            }
            
            try {
                const data = await apiRegisterWithEmail(email, code, nickname);
                
                if (data.success) {
                    userToken = data.data.token;
                    currentUser = data.data.user;
                    localStorage.setItem('userToken', userToken);
                    localStorage.setItem('userId', currentUser.unique_id);
                    showMessage('æ³¨å†ŒæˆåŠŸï¼å·²è‡ªåŠ¨ç™»å½•', 'success');
                    showUserInfo();
                } else {
                    showMessage(data.message || 'æ³¨å†Œå¤±è´¥', 'error');
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                console.error('æ³¨å†Œå¤±è´¥:', error);
            }
        }
        
        /**
         * æ”¯ä»˜å®ç™»å½•ï¼ˆéœ€è¦é›†æˆæ”¯ä»˜å®SDKï¼‰
         */
        function loginWithAlipay() {
            showMessage('æ”¯ä»˜å®ç™»å½•åŠŸèƒ½éœ€è¦é›†æˆæ”¯ä»˜å®SDKï¼Œè¯·å‚è€ƒæ–‡æ¡£', 'error');
            // TODO: é›†æˆæ”¯ä»˜å®SDK
            // 1. è°ƒç”¨æ”¯ä»˜å®SDKè·å–æˆæƒç 
            // 2. è°ƒç”¨åç«¯API: POST /api/user/login/alipay
        }
        
        /**
         * å¾®ä¿¡ç™»å½•ï¼ˆéœ€è¦é›†æˆå¾®ä¿¡SDKï¼‰
         */
        function loginWithWechat() {
            showMessage('å¾®ä¿¡ç™»å½•åŠŸèƒ½éœ€è¦é›†æˆå¾®ä¿¡SDKï¼Œè¯·å‚è€ƒæ–‡æ¡£', 'error');
            // TODO: é›†æˆå¾®ä¿¡SDK
            // 1. è°ƒç”¨å¾®ä¿¡SDKè·å–æˆæƒç 
            // 2. è°ƒç”¨åç«¯API: POST /api/user/login/wechat
        }
        
        /**
         * é€€å‡ºç™»å½•
         */
        function logout() {
            userToken = null;
            currentUser = null;
            localStorage.removeItem('userToken');
            localStorage.removeItem('userId');
            showLoginForm();
            showMessage('å·²é€€å‡ºç™»å½•', 'success');
        }
        
        /**
         * å¤åˆ¶ç”¨æˆ·ID
         */
        function copyUserId() {
            const userId = document.getElementById('userUniqueId').textContent;
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(userId).then(() => {
                    showMessage('IDå·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                }).catch(() => {
                    fallbackCopy(userId);
                });
            } else {
                fallbackCopy(userId);
            }
        }
        
        /**
         * å¤‡ç”¨å¤åˆ¶æ–¹æ³•
         */
        function fallbackCopy(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                showMessage('IDå·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            } catch (err) {
                showMessage('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
            }
            document.body.removeChild(textarea);
        }
        
        /**
         * å€’è®¡æ—¶åŠŸèƒ½
         */
        function startCountdown(countdownId, seconds, btn) {
            const countdownDiv = document.getElementById(countdownId);
            countdownDiv.style.display = 'block';
            
            let remaining = seconds;
            countdownDiv.textContent = `${remaining}ç§’åå¯é‡æ–°å‘é€`;
            
            const timer = setInterval(() => {
                remaining--;
                if (remaining > 0) {
                    countdownDiv.textContent = `${remaining}ç§’åå¯é‡æ–°å‘é€`;
                } else {
                    clearInterval(timer);
                    countdownDiv.style.display = 'none';
                    btn.disabled = false;
                }
            }, 1000);
        }
        
        // ========================================
        // ç¬¬äºŒéƒ¨åˆ†ï¼šè´¦å·ç»‘å®šåŠŸèƒ½å®ç°
        // ========================================
        
        /**
         * åŠ è½½ç»‘å®šä¿¡æ¯
         */
        async function loadBindings() {
            if (!userToken) return;
            
            try {
                const data = await apiGetBindings();
                if (data.success) {
                    userBindings = data.data;
                }
            } catch (error) {
                console.error('è·å–ç»‘å®šä¿¡æ¯å¤±è´¥:', error);
            }
        }
        
        /**
         * æ˜¾ç¤ºç»‘å®šé‚®ç®±è¡¨å•
         */
        function showBindEmailForm() {
            document.getElementById('bindEmailForm').style.display = 'block';
        }
        
        /**
         * éšè—ç»‘å®šé‚®ç®±è¡¨å•
         */
        function hideBindEmailForm() {
            document.getElementById('bindEmailForm').style.display = 'none';
            document.getElementById('bindEmailInput').value = '';
            document.getElementById('bindEmailCodeInput').value = '';
        }
        
        /**
         * å‘é€ç»‘å®šé‚®ç®±éªŒè¯ç 
         */
        async function sendBindEmailCode() {
            const email = document.getElementById('bindEmailInput').value.trim();
            
            if (!email) {
                showMessage('è¯·è¾“å…¥é‚®ç®±åœ°å€', 'error');
                return;
            }
            
            const btn = document.getElementById('sendBindEmailCodeBtn');
            btn.disabled = true;
            
            try {
                const data = await apiSendVerificationCode(email, 'bind');
                
                if (data.success) {
                    showMessage('éªŒè¯ç å·²å‘é€ï¼Œè¯·æŸ¥æ”¶é‚®ä»¶', 'success');
                    startCountdown('bindEmailCodeCountdown', 60, btn);
                } else {
                    showMessage(data.message || 'å‘é€å¤±è´¥', 'error');
                    btn.disabled = false;
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                btn.disabled = false;
            }
        }
        
        /**
         * ç»‘å®šé‚®ç®±
         */
        async function bindEmail() {
            const email = document.getElementById('bindEmailInput').value.trim();
            const code = document.getElementById('bindEmailCodeInput').value.trim();
            
            if (!email || !code) {
                showMessage('è¯·è¾“å…¥é‚®ç®±å’ŒéªŒè¯ç ', 'error');
                return;
            }
            
            try {
                const data = await apiBindEmail(email, code);
                
                if (data.success) {
                    showMessage('é‚®ç®±ç»‘å®šæˆåŠŸï¼', 'success');
                    hideBindEmailForm();
                    // åˆ·æ–°ç”¨æˆ·ä¿¡æ¯å’Œç»‘å®šä¿¡æ¯
                    await refreshUserInfo();
                } else {
                    showMessage(data.message || 'ç»‘å®šå¤±è´¥', 'error');
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
            }
        }
        
        /**
         * ç»‘å®šæ”¯ä»˜å®
         */
        async function bindAlipay() {
            showMessage('æ”¯ä»˜å®ç»‘å®šéœ€è¦é›†æˆæ”¯ä»˜å®SDKè·å–æˆæƒç ', 'error');
            // TODO: é›†æˆæ”¯ä»˜å®SDK
            // 1. è°ƒç”¨æ”¯ä»˜å®SDKè·å–æˆæƒç 
            // 2. è°ƒç”¨ apiBindAlipay(authCode)
            /*
            try {
                // å‡è®¾ä»SDKè·å–åˆ°æˆæƒç 
                const authCode = await getAlipayAuthCode();
                const data = await apiBindAlipay(authCode);
                
                if (data.success) {
                    showMessage('æ”¯ä»˜å®ç»‘å®šæˆåŠŸï¼', 'success');
                    await refreshUserInfo();
                } else {
                    showMessage(data.message || 'ç»‘å®šå¤±è´¥', 'error');
                }
            } catch (error) {
                showMessage('ç»‘å®šå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
            }
            */
        }
        
        /**
         * ç»‘å®šå¾®ä¿¡
         */
        async function bindWechat() {
            showMessage('å¾®ä¿¡ç»‘å®šéœ€è¦é›†æˆå¾®ä¿¡SDKè·å–æˆæƒç ', 'error');
            // TODO: é›†æˆå¾®ä¿¡SDK
            // 1. è°ƒç”¨å¾®ä¿¡SDKè·å–æˆæƒç 
            // 2. è°ƒç”¨ apiBindWechat(code)
            /*
            try {
                // å‡è®¾ä»SDKè·å–åˆ°æˆæƒç 
                const code = await getWechatAuthCode();
                const data = await apiBindWechat(code);
                
                if (data.success) {
                    showMessage('å¾®ä¿¡ç»‘å®šæˆåŠŸï¼', 'success');
                    await refreshUserInfo();
                } else {
                    showMessage(data.message || 'ç»‘å®šå¤±è´¥', 'error');
                }
            } catch (error) {
                showMessage('ç»‘å®šå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
            }
            */
        }
        
        /**
         * è§£ç»‘è´¦å·
         */
        async function unbindAccount(bindType) {
            const typeNames = {
                'email': 'é‚®ç®±',
                'alipay': 'æ”¯ä»˜å®',
                'wechat': 'å¾®ä¿¡'
            };
            
            if (!confirm(`ç¡®å®šè¦è§£ç»‘${typeNames[bindType]}è´¦å·å—ï¼Ÿè§£ç»‘åè¯¥è´¦å·å°†æ— æ³•ç”¨äºç™»å½•ã€‚`)) {
                return;
            }
            
            try {
                const data = await apiUnbindAccount(bindType);
                
                if (data.success) {
                    showMessage(`${typeNames[bindType]}è´¦å·è§£ç»‘æˆåŠŸ`, 'success');
                    // åˆ·æ–°ç”¨æˆ·ä¿¡æ¯å’Œç»‘å®šä¿¡æ¯
                    await refreshUserInfo();
                } else {
                    showMessage(data.message || 'è§£ç»‘å¤±è´¥', 'error');
                }
            } catch (error) {
                showMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
            }
        }
        
        /**
         * åˆ·æ–°ç”¨æˆ·ä¿¡æ¯
         */
        async function refreshUserInfo() {
            try {
                // é‡æ–°è·å–ç”¨æˆ·ä¿¡æ¯
                const profileData = await apiGetUserProfile();
                if (profileData.success) {
                    currentUser = profileData.data;
                }
                
                // é‡æ–°è·å–ç»‘å®šä¿¡æ¯
                await loadBindings();
                
                // é‡æ–°æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
                await showUserInfo();
                
                // å¦‚æœå·²ç™»å½•ï¼Œåˆ·æ–°ä½™é¢
                if (userToken) {
                    await loadBalance();
                }
            } catch (error) {
                console.error('åˆ·æ–°ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
            }
        }
        
        // ========================================
        // æ”¯ä»˜ç›¸å…³API
        // ========================================
        
        /**
         * è·å–ç”¨æˆ·ä½™é¢
         */
        async function apiGetBalance() {
            return await apiRequest('/api/payment/balance', {
                method: 'GET'
            });
        }
        
        /**
         * åˆ›å»ºå……å€¼è®¢å•
         */
        async function apiCreateRechargeOrder(times, paymentMethod) {
            return await apiRequest('/api/payment/recharge', {
                method: 'POST',
                body: JSON.stringify({ times, paymentMethod })
            });
        }
        
        /**
         * ä½¿ç”¨æœåŠ¡ï¼ˆæ‰£è´¹ï¼‰
         */
        async function apiUseService(serviceType = 'assistant', amount = 0.1) {
            return await apiRequest('/api/payment/use', {
                method: 'POST',
                body: JSON.stringify({ serviceType, amount })
            });
        }
        
        /**
         * è·å–å……å€¼è®°å½•
         */
        async function apiGetRechargeRecords(page = 1, pageSize = 20) {
            return await apiRequest(`/api/payment/recharge-records?page=${page}&pageSize=${pageSize}`, {
                method: 'GET'
            });
        }
        
        /**
         * è·å–ä½¿ç”¨è®°å½•
         */
        async function apiGetUsageRecords(page = 1, pageSize = 20) {
            return await apiRequest(`/api/payment/usage-records?page=${page}&pageSize=${pageSize}`, {
                method: 'GET'
            });
        }
        
        // ========================================
        // æ”¯ä»˜ç›¸å…³åŠŸèƒ½
        // ========================================
        
        let userBalance = null;
        
        /**
         * åŠ è½½ç”¨æˆ·ä½™é¢
         */
        async function loadBalance() {
            if (!userToken) {
                return;
            }
            
            try {
                const data = await apiGetBalance();
                if (data.success) {
                    userBalance = data.data;
                    updateBalanceDisplay();
                }
            } catch (error) {
                console.error('åŠ è½½ä½™é¢å¤±è´¥:', error);
            }
        }
        
        /**
         * æ›´æ–°ä½™é¢æ˜¾ç¤º
         */
        function updateBalanceDisplay() {
            if (!userBalance) return;
            
            // æ›´æ–°å……å€¼é¡µé¢ä½™é¢
            const currentBalanceEl = document.getElementById('currentBalance');
            const availableTimesEl = document.getElementById('availableTimes');
            const totalRechargedEl = document.getElementById('totalRecharged');
            const totalUsedEl = document.getElementById('totalUsed');
            
            if (currentBalanceEl) {
                currentBalanceEl.textContent = 'Â¥' + userBalance.balance.toFixed(2);
            }
            if (availableTimesEl) {
                availableTimesEl.textContent = userBalance.availableTimes + 'æ¬¡';
            }
            if (totalRechargedEl) {
                totalRechargedEl.textContent = 'Â¥' + userBalance.totalRecharged.toFixed(2);
            }
            if (totalUsedEl) {
                totalUsedEl.textContent = 'Â¥' + userBalance.totalUsed.toFixed(2);
            }
            
            // æ›´æ–°èŠå¤©é¡µé¢ä½™é¢
            const chatBalanceEl = document.getElementById('chatBalance');
            const chatAvailableTimesEl = document.getElementById('chatAvailableTimes');
            const balanceDisplayEl = document.getElementById('balanceDisplay');
            
            if (chatBalanceEl) {
                chatBalanceEl.textContent = userBalance.balance.toFixed(2);
            }
            if (chatAvailableTimesEl) {
                chatAvailableTimesEl.textContent = userBalance.availableTimes;
            }
            if (balanceDisplayEl && userToken) {
                balanceDisplayEl.style.display = 'block';
            }
        }
        
        /**
         * è°ƒæ•´å……å€¼æ¬¡æ•°
         */
        function adjustRechargeTimes(delta) {
            const input = document.getElementById('rechargeTimes');
            if (!input) return;
            
            let times = parseInt(input.value) || 10;
            times = Math.max(10, times + delta); // æœ€å°‘10æ¬¡
            input.value = times;
            
            // æ›´æ–°é‡‘é¢æ˜¾ç¤º
            const amount = (times * 0.1).toFixed(2);
            const amountEl = document.getElementById('rechargeAmount');
            if (amountEl) {
                amountEl.textContent = 'Â¥' + amount;
            }
        }
        
        /**
         * åˆ›å»ºå……å€¼è®¢å•
         */
        async function createRechargeOrder() {
            if (!userToken) {
                showMessage('è¯·å…ˆç™»å½•', 'error');
                return;
            }
            
            const timesInput = document.getElementById('rechargeTimes');
            const paymentMethodInput = document.querySelector('input[name="paymentMethod"]:checked');
            const messageEl = document.getElementById('rechargeMessage');
            
            if (!timesInput || !paymentMethodInput) {
                showMessage('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯', 'error');
                return;
            }
            
            const times = parseInt(timesInput.value);
            const paymentMethod = paymentMethodInput.value;
            
            if (times < 10) {
                showMessage('æœ€å°‘å……å€¼10æ¬¡ï¼ˆ1å…ƒï¼‰', 'error');
                return;
            }
            
            try {
                const data = await apiCreateRechargeOrder(times, paymentMethod);
                
                if (data.success) {
                    const order = data.data;
                    showRechargeMessage(`è®¢å•åˆ›å»ºæˆåŠŸï¼è®¢å•å·ï¼š${order.orderNo}ï¼Œé‡‘é¢ï¼šÂ¥${order.amount.toFixed(2)}ï¼Œè¯·å®Œæˆæ”¯ä»˜åè”ç³»ç®¡ç†å‘˜ç¡®è®¤ã€‚`, 'success');
                    
                    // æ˜¾ç¤ºæ”¯ä»˜äºŒç»´ç 
                    showPaymentQRCode(paymentMethod, order);
                    
                    // åˆ·æ–°å……å€¼è®°å½•
                    await loadRechargeRecords();
                } else {
                    showRechargeMessage(data.message || 'åˆ›å»ºè®¢å•å¤±è´¥', 'error');
                }
            } catch (error) {
                showRechargeMessage('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
            }
        }
        
        /**
         * æ˜¾ç¤ºæ”¯ä»˜äºŒç»´ç 
         */
        function showPaymentQRCode(paymentMethod, order) {
            const messageEl = document.getElementById('rechargeMessage');
            if (!messageEl) return;
            
            let qrCodeUrl = '';
            let paymentName = '';
            
            if (paymentMethod === 'wechat') {
                qrCodeUrl = 'gua_images/è‘£å¾·é¾™å¾®ä¿¡æ”¯ä»˜ç .png';
                paymentName = 'å¾®ä¿¡æ”¯ä»˜';
            } else if (paymentMethod === 'alipay') {
                qrCodeUrl = 'gua_images/è‘£å¾·é¾™æ”¯ä»˜å®æ”¯ä»˜ç .png';
                paymentName = 'æ”¯ä»˜å®æ”¯ä»˜';
            } else {
                messageEl.innerHTML += '<div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px;"><p><strong>é“¶è¡Œå¡ä¿¡æ¯ï¼š</strong></p><p>å§“åï¼šè‘£å¾·é¾™</p><p>å¡å·ï¼š6231700190021083768</p><p>é‡‘é¢ï¼šÂ¥' + order.amount.toFixed(2) + '</p></div>';
                return;
            }
            
            messageEl.innerHTML += `
                <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px; text-align: center;">
                    <p><strong>è¯·ä½¿ç”¨${paymentName}æ‰«æä¸‹æ–¹äºŒç»´ç æ”¯ä»˜</strong></p>
                    <p style="font-size: 14px; color: #666; margin: 10px 0;">è®¢å•å·ï¼š${order.orderNo}</p>
                    <p style="font-size: 18px; color: #667eea; font-weight: bold; margin: 10px 0;">æ”¯ä»˜é‡‘é¢ï¼šÂ¥${order.amount.toFixed(2)}</p>
                    <img src="${qrCodeUrl}" style="max-width: 200px; max-height: 200px; border-radius: 4px; margin: 10px 0;">
                    <p style="font-size: 12px; color: #666; margin-top: 10px;">æ”¯ä»˜å®Œæˆåï¼Œè¯·è”ç³»ç®¡ç†å‘˜ç¡®è®¤å……å€¼</p>
                </div>
            `;
        }
        
        /**
         * æ˜¾ç¤ºå……å€¼æ¶ˆæ¯
         */
        function showRechargeMessage(message, type) {
            const messageEl = document.getElementById('rechargeMessage');
            if (!messageEl) return;
            
            messageEl.style.display = 'block';
            messageEl.textContent = message;
            messageEl.style.backgroundColor = type === 'success' ? '#d4edda' : '#f8d7da';
            messageEl.style.color = type === 'success' ? '#155724' : '#721c24';
            messageEl.style.border = `1px solid ${type === 'success' ? '#c3e6cb' : '#f5c6cb'}`;
        }
        
        /**
         * åŠ è½½å……å€¼è®°å½•
         */
        async function loadRechargeRecords() {
            if (!userToken) return;
            
            try {
                const data = await apiGetRechargeRecords(1, 10);
                if (data.success) {
                    renderRechargeRecords(data.data.records);
                }
            } catch (error) {
                console.error('åŠ è½½å……å€¼è®°å½•å¤±è´¥:', error);
            }
        }
        
        /**
         * æ¸²æŸ“å……å€¼è®°å½•
         */
        function renderRechargeRecords(records) {
            const listEl = document.getElementById('rechargeRecordsList');
            if (!listEl) return;
            
            if (records.length === 0) {
                listEl.innerHTML = '<p style="color: #666; text-align: center;">æš‚æ— å……å€¼è®°å½•</p>';
                return;
            }
            
            const statusMap = {
                0: { text: 'å¾…æ”¯ä»˜', color: '#ffc107' },
                1: { text: 'å·²æ”¯ä»˜', color: '#28a745' },
                2: { text: 'å·²å–æ¶ˆ', color: '#6c757d' },
                3: { text: 'å·²é€€æ¬¾', color: '#dc3545' }
            };
            
            const methodMap = {
                wechat: 'å¾®ä¿¡æ”¯ä»˜',
                alipay: 'æ”¯ä»˜å®',
                bank: 'é“¶è¡Œå¡'
            };
            
            listEl.innerHTML = records.map(record => `
                <div style="padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-weight: bold; margin-bottom: 5px;">è®¢å•å·ï¼š${record.order_no}</div>
                        <div style="font-size: 14px; color: #666;">
                            ${methodMap[record.payment_method] || record.payment_method} | 
                            ${record.times}æ¬¡ | 
                            Â¥${parseFloat(record.amount).toFixed(2)}
                        </div>
                        <div style="font-size: 12px; color: #999; margin-top: 5px;">
                            ${new Date(record.created_at).toLocaleString('zh-CN')}
                        </div>
                    </div>
                    <div>
                        <span style="padding: 4px 8px; border-radius: 4px; background: ${statusMap[record.payment_status].color}; color: white; font-size: 12px;">
                            ${statusMap[record.payment_status].text}
                        </span>
                    </div>
                </div>
            `).join('');
        }
        
        /**
         * åŠ è½½ä½¿ç”¨è®°å½•
         */
        async function loadUsageRecords() {
            if (!userToken) return;
            
            try {
                const data = await apiGetUsageRecords(1, 10);
                if (data.success) {
                    renderUsageRecords(data.data.records);
                }
            } catch (error) {
                console.error('åŠ è½½ä½¿ç”¨è®°å½•å¤±è´¥:', error);
            }
        }
        
        /**
         * æ¸²æŸ“ä½¿ç”¨è®°å½•
         */
        function renderUsageRecords(records) {
            const listEl = document.getElementById('usageRecordsList');
            if (!listEl) return;
            
            if (records.length === 0) {
                listEl.innerHTML = '<p style="color: #666; text-align: center;">æš‚æ— ä½¿ç”¨è®°å½•</p>';
                return;
            }
            
            listEl.innerHTML = records.map(record => `
                <div style="padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-weight: bold; margin-bottom: 5px;">${record.service_type === 'assistant' ? 'å‘¨æ˜“å°åŠ©æ‰‹' : record.service_type}</div>
                        <div style="font-size: 14px; color: #666;">
                            ä½¿ç”¨ï¼šÂ¥${parseFloat(record.amount).toFixed(2)} | 
                            ä½™é¢ï¼šÂ¥${parseFloat(record.balance_before).toFixed(2)} â†’ Â¥${parseFloat(record.balance_after).toFixed(2)}
                        </div>
                        <div style="font-size: 12px; color: #999; margin-top: 5px;">
                            ${new Date(record.created_at).toLocaleString('zh-CN')}
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        /**
         * åˆ‡æ¢åˆ°å……å€¼é¡µé¢
         */
        function switchToRecharge() {
            const selector = document.getElementById('pageSelector');
            if (selector) {
                selector.value = 'recharge';
                selector.dispatchEvent(new Event('change'));
            }
        }
        
        /**
         * å……å€¼é¡µé¢åˆå§‹åŒ–
         */
        function initRechargePage() {
            // æ›´æ–°å……å€¼æ¬¡æ•°å˜åŒ–æ—¶çš„é‡‘é¢
            const timesInput = document.getElementById('rechargeTimes');
            if (timesInput) {
                timesInput.addEventListener('input', function() {
                    let times = parseInt(this.value) || 10;
                    times = Math.max(10, times);
                    this.value = times;
                    const amount = (times * 0.1).toFixed(2);
                    const amountEl = document.getElementById('rechargeAmount');
                    if (amountEl) {
                        amountEl.textContent = 'Â¥' + amount;
                    }
                });
            }
            
            // å¦‚æœå·²ç™»å½•ï¼ŒåŠ è½½ä½™é¢å’Œè®°å½•
            if (userToken) {
                loadBalance();
                loadRechargeRecords();
                loadUsageRecords();
            }
        }
        
        // ========================================
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        // ========================================
        
        window.addEventListener('DOMContentLoaded', function() {
            initUserAuth();
        });
    </script>
    </div>
    <!-- ä¸»è¦å†…å®¹å®¹å™¨ç»“æŸ -->
</body>
</html>
</html>